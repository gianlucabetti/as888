000100080213     h DECEDIT('0,') DATEDIT(*DMY.)
000200080213?     *--------------------------------------------------------------*
000300080213      * FIDN65R                                                      *
000400080213      *     *----------------------------------------------*         *
000500080213      *         Lancio Stampa Comunicazione LT a Clienti             *
000600080213      *     *---------------------------------------------*          *
000700080213      *                                                              *
000800080213?     *--------------------------------------------------------------*
000900080213      * KC - FINE LAVORO                                             *
001000080213      * KF - CONFERMA                                                *
001100080213?     *--------------------------------------------------------------*
001200080213      * 28 - Visualizzazione messaggio di errore                     *
001300080213      * 41 - Reverse Immage su data a                                *
001400080213?     *--------------------------------------------------------------*
001500080213     fFIDN65D   CF   E             WORKSTN
001600080213      *---------------------------------------------------------------*
001700080213      * SCHIERA
001800080213      *---------------------------------------------------------------*
001900080213     d ERR             S             70    DIM(03) CTDATA PERRCD(1)
002000080213?     *--------------------------------------------------------------*
002100080213?     *  DS                                                          *
002200080213?     *--------------------------------------------------------------*
002300080213     d KPJBA         E DS
002400080213      *
002500080213     d TIBS34ds      e ds                  inz
002600080213     d dDatiUte      e ds                  inz
002700080213     d AZUTEds       e ds                  extname(AZUTE00F) inz
002800080213      *
002900080213     d WLBDA8          DS
003000080213     d  G02DAT                 1      8  0
003100080213     d  G02INV                 9     16  0
003200080213     d  G02ERR                17     17
003300080213     d  G02TGI                18     22  0
003400080213      *
003500080213     d  wdataa         s              8  0
003600080213?     *--------------------------------------------------------------*
003700080213?     *  CICLO PRINCIPALE                                            *
003800080213?     *--------------------------------------------------------------*
003900080213      *  Impostazione parametri prima videata
004000080213     c                   EXSR      INZ01
004100080213      *
004200080213      *  Loop gestione videata
004300080213     c     WFINE         DOUEQ     'S'
004400080213     c                   EXSR      GESD01
004500080213     c                   END
004600080213      *  Fine Lavoro
004700080213     c                   SETON                                        LR
004800080213?     *--------------------------------------------------------------*
004900080213?     *  INZ01: Inizializzazione prima videata                       *
005000080213?     *--------------------------------------------------------------*
005100080213     c     INZ01         BEGSR
005200080213      *
005300080213     c                   setoff                                       2841
005400080213     c                   move      *zeros        d1adat
005500080213      *
005600080213     c                   ENDSR
005700950928?     *--------------------------------------------------------------*
005800080213?     *  GESD01: Gestione prima videata                              *
005900950928?     *--------------------------------------------------------------*
006000080213     c     GESD01        BEGSR
006100080213      *
006200080213     c                   Do        *hival
006300080213     c                   EXFMT     DN65d01
006400080213     c                   SETOFF                                       4128
006500080213      *  Fine Lavoro
006600080213     c                   IF        *inkc
006700080213     c                   eval      wfine = 'S'
006800080213     c                   leave
006900080213     c                   endif
007000950928      *  Controlli
007100080213     c                   exsr      ctr01
007200080213     c   28              iter
007300040927      *
007400080213      *  Conferma: Sbm. FIDN66R
007500080213     c                   if        *inkf
007600080213     c                   exsr      sbmp66
007700080213     c                   eval      wfine = 'S'
007800080213     c                   leave
007900080213     c                   endif
008000080213      *
008100080213     c                   enddo
008200950928      *
008300080213     c                   endsr
008400080213?     *--------------------------------------------------------------*
008500080213?     *  CTR01: Controlli prima videata                              *
008600080213?     *--------------------------------------------------------------*
008700080213     c     CTR01         Begsr
008800950928      *
008900040928      *  Controllo data al
009000080213     c                   select
009100080213
009200080213     c                   when      d1adat = 0
009300080213     c                   seton                                        4128
009400080213     c                   movel     err(1)        $MSG
009500080213
009600080213     c                   other
009700080213
009800080213     c                   z-add     d1adat        G02DAT
009900080213     c                   z-add     0             G02INV
010000080213     c                   clear                   G02ERR
010100080213     c                   call      'XSRDA8'
010200080213     c                   parm                    WLBDA8
010300080213     c                   IF        g02err = '1'
010400080213     c                   seton                                        4128
010500080213     c                   movel     err(2)        $MSG
010600080213     c                   else
010700080213     c                   z-add     g02inv        wdataa
010800080213     c                   z-add     g02dat        d1adat
010900080213      * se non ci sono errori controllo con la data di oggi
011000080213     c                   if        wdataa > woggi
011100080213     c                   seton                                        4128
011200080213     c                   movel     err(3)        $MSG
011300080213     c                   endif
011400080213
011500080213     c                   endif
011600080213
011700080213     c                   endsl
011800080213
011900080213     c                   Endsr
012000080213?     *--------------------------------------------------------------*
012100080213?     *  SBMP66: Sottometto stampa Comunicazione LT ai Clienti       *
012200080213?     *--------------------------------------------------------------*
012300080213     c     SBMP66        BEGSR
012400080213      *
012500080213     c                   clear                   kpjbu
012600080213     c                   movel     wdataa        kpjbu
012700080213      *
012800080529     c                   movel     'DN66'        KCOAZ
012900080529     c********           call      'FIDN66R'
013000080529     c                   CALL      'BCH10'
013100080213     c                   PARM                    KPJBA
013200080213
013300080213     c                   Endsr
013400080213?     *--------------------------------------------------------------*
013500080213?     *  *INZSR: Operazioni iniziali                                 *
013600080213?     *--------------------------------------------------------------*
013700080213     C     *INZSR        BEGSR
013800080213
013900080213     c     *ENTRY        PLIST
014000080213     c                   PARM                    KPJBA
014100080213      *
014200080213      * Reperisco le aree dati necessarie (TUTTE IN UNA VOLTA SOLA)
014300080213     c     *dtaara       define    §azute        AZUTEds
014400080213     c     *dtaara       define    §datiute      dDatiUte
014500080213      *
014600080213     c                   clear                   AZUTEds
014700080213     c                   clear                   dDatiUte
014800080213     c                   clear                   TIBS34ds
014900080213     c                   in(E)     *dtaara
015000080213if  1c                   if        %Error  or  RSUT = *blanks
015100080213     c                   call      'TIBS34R'
015200080213     c                   parm                    TIBS34ds
015300080213     c                   in        *dtaara
015400080213e   1c                   endif
015500080213      *
015600080213      *  Inizializzazione
015700080213     c                   MOVEL     'N'           WFINE             1
015800080213     c                   TIME                    WHHDAT           14 0
015900080213      *
016000080213     C                   MOVE      WHHDAT        G02DAT
016100080213     C                   Z-ADD     0             G02INV
016200080213     C                   MOVEL     *BLANKS       G02ERR
016300080213     C                   CALL      'XSRDA8'
016400080213     C                   PARM                    WLBDA8
016500080213     C                   Z-ADD     G02INV        WOGGI             8 0
016600080213      *
016700080213     C                   ENDSR
016800080213**
016900080213Data obbligatoria                                                     01
017000080213Data formalmente errata                                               02
017100040927Data maggiore della data del giorno                                   03
