000100050408     h Decedit('0,') Datedit(*ymd.) Option(*nodebugio)
000200050408
000300050408      *------------------------------------------------------------------------*
000400050408      *
000500050607      *  Archiviazione Eventi/denunce C.A.
000600050408      *
000700050408      *------------------------------------------------------------------------*
000800050408
000900050607     fFidn94d   cf   e             workstn
001000050408
001100050408      *------------------------------------------------------------------------*
001200050408      *  RIEPILOGO INDICATORI
001300050408      *------------------------------------------------------------------------*
001400050408      * 28 - ERRORE GENERICO DSPF
001500050516      * 40 - ERRORE anno
001600050408      *------------------------------------------------------------------------*
001700050408
001800050408      *------------------------------------------------------------------------*
001900050408      *   V A R I A B I L I
002000050408      *------------------------------------------------------------------------*
002100050408
002200050408      *------------------------------------------------------------------------*
002300050408      *   S C H I E R E
002400050408      *------------------------------------------------------------------------*
002500050408     d msg             s             35    dim(4) ctdata perrcd(1)
002600050408
002700050408      *------------------------------------------------------------------------*
002800050408      *   D S   I N T E R N E / E S T E R N E
002900050408      *------------------------------------------------------------------------*
003000050408     d parm01          ds
003100050516     d  waaca                         4  0
003200050408
003300050516     d azuteds       e ds                  extname(AZUTE00F)
003400050516     d ddatiute      e ds
003500050408     d kpjba         e ds
003600050516     d tibs34ds      e ds                  inz
003700050516
003800050516     d                sds
003900050516     d  vtcpgm                 1     10
004000050516
004100050516      *------------------------------------------------------------------------*
004200050516      *   C O S T A N T I
004300050516      *------------------------------------------------------------------------*
004400050516      *  titolo videata (lunghezza massima 35)
004500050607     d vtctit          C                   CONST(' ARCHIVIAZIONE EVENTI C.A. PE-
004600050607     d                                     R ANNO')
004700050408      *------------------------------------------------------------------------*
004800050408
004900050408      * Pulizia Videata
005000050408     c                   ExSr      Sr_Pulvid
005100050408
005200050408      * Emissione Videata
005300050408     c                   Do        *Hival
005400050607     c                   Exfmt     dn94d01
005500050408
005600050408      * F3=Fine
005700050408     c   kc              Leave
005800050408
005900050408     c                   Setoff                                       28
006000050408
006100050408      * Controlli videata
006200050408     c                   ExSr      Sr_Contr
006300050408     c   28              Iter
006400050408
006500050408      * F6=Conferma
006600050408     c                   If        *inkf = *on
006700050408     c                   ExSr      Sr_Conferma
006800050408     c                   Leave
006900050408     c                   EndIf
007000050408
007100050408     c                   EndDo
007200050408
007300050408     c                   Eval      *InLr = *On
007400050408      *------------------------------------------------------------------------*
007500050408      * PULIZIA VIDEATA
007600050408      *------------------------------------------------------------------------*
007700050408     c     Sr_Pulvid     BegSr
007800050408
007900050516     c                   Clear                   v1caac
008000050408
008100050408     c                   EndSr
008200050408      *------------------------------------------------------------------------*
008300050408      * CONTROLLI VIDEO
008400050408      *------------------------------------------------------------------------*
008500050408     c     Sr_Contr      BegSr
008600050408
008700050408      * Reset indicatori
008800050408     c                   Eval      *In40 = *Off
008900050408
009000050516      * l'anno deve essere impostato
009100050516     c                   If        v1caac = *zeros
009200050408     c                   Eval      *In28 = *On
009300050408     c                   Eval      *In40 = *On
009400050408     c                   Eval      v1cmsg = msg(1)
009500050408     c                   Leavesr
009600050408     c                   EndIf
009700050516
009800050516      * non deve essere maggiore dell'anno in corso
009900050516     c                   If        v1caac > *year
010000050516     c                   Eval      *In40 = *On
010100050516     c                   Eval      *In28 = *On
010200050516     c                   Eval      v1cmsg = msg(2)
010300050516     c                   Leavesr
010400050516     c                   EndIf
010500050408
010600050408     c                   EndSr
010700050408      *------------------------------------------------------------------------*
010800050408      * RICHIAMA IL PROGRAMMA DI CREAZIONE FILE
010900050408      *------------------------------------------------------------------------*
011000050408     c     Sr_Conferma   begsr
011100050408
011200050516     c                   Eval      waaca = v1caac
011300050408     c                   Movel     parm01        kpjbu
011400050614     c                   Eval      kcoaz = 'DN95'
011500050614     c**!!!              Call      'FIDN95C'
011600050614     c                   Call      'BCH10'
011700050408     c                   Parm                    kpjba
011800050408
011900050408     c                   EndSr
012000050408      *------------------------------------------------------------------------*
012100050408      * ROUTINE INIZIALE
012200050408      *------------------------------------------------------------------------*
012300050408     c     *Inzsr        BegSr
012400050408
012500050408     c     *Entry        Plist
012600050408     c                   Parm                    kpjba
012700050516
012800050516     c     *dtaara       define    §azute        azuteds
012900050516     c     *dtaara       define    §datiute      ddatiute
013000050516
013100050516     c                   in(E)     *dtaara
013200050516     c                   IF        %ERROR or RSUT = *blanks
013300050516     c                   clear                   Tibs34Ds
013400050516     c                   call      'TIBS34R'
013500050516     c                   parm                    Tibs34Ds
013600050516     c                   in        *dtaara
013700050516     c                   ENDIF
013800050408
013900050408     c                   EndSr
014000050408      *
014100050408** MSG
014200050516Immettere l'anno                                                                    1
014300050516Anno errato                                                                         2
