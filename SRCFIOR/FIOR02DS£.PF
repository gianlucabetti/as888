000100001011      *--------------------------------------------------------------*
000200001011      *                                                              *
000300001011      *      DS PER PGM DI GESTIONE ANAGRAFICA CLIENTI RITIRO        *
000400001011      *                                                              *
000500001011      *--------------------------------------------------------------*
000600001011      *
000700001011     A                                      REF(CNDIZION)
000800001011     A          R R01REC                    TEXT('DS PER GES.ANAG.CLI.RIT.')
000900001011      *
001000001011      *--------------------------------------------------------------*
001100001011      *      INPUT                                                   *
001200001011      *--------------------------------------------------------------*
001300001011      *
001400001011      *  PER PRIMA COSA DEVO SCEGLIERE COME UTILIZZARE IL PROGRAMMA:
001500001011      *  1=INTERROGAZIONE DEI DATI DELL'ANAGRAFICA CLIENTI RITIRI
001600001011      *  2=VARIAZIONE DEI DATI DELL'ANAGRAFICA CLIENTI RITIRI
001700001011      *  3=IMMISSIONE DI UN NUOVO CODICE CLIENTE RITIRO
001800001011      *  4=SCELTA DI UN CODICE CLIENTE RITIRO
001900040401      *  A=SCELTA DI UN CODICE CLIENTE RITIRO DA CNC100R
002000001011      *
002100001011     A            I01RIC         1          TEXT('PGM RICHIAMATO: 1=INTERR. -
002200001011     A                                      2=VARIAZ. 3=IMMISS. 4=SCELTA')
002300001011      *
002400001011      *  PER SECONDA COSA DEVO SCEGLIERE SE VOGLIO TROVARE UN CLIENTE
002500001011      *  RITIRO SPECIFICO O VOGLIO EFFETTUARE UNA RICERCA TRAMITE
002600001011      *  SUBFILE:
002700001011      *  1=RICERCA TRAMITE SUBFILE
002800001011      *  2=RICERCA DI UN CODICE SECCO
002900040409      * (NON VIENE MAI USATA LA RICERCA DI UN CODICE SECCO)
003000001011      *
003100001011      *  (VALIDO SOLO PER 1="INTERROGAZIONE" E 2="VARIAZIONE" IN "I01RIC";)
003200001011      *  (SE "I01RIC"=4 DI SCELTA, VIENE FORZATO "I01ACC"=1.)
003300040401      *  (SE "I01RIC"=A DI SCELTA, VIENE FORZATO "I01ACC"=1.)
003400001011      *
003500001011     A            I01ACC         1          TEXT('ACCESSO AI DATI: 1=RICERCA-
003600001011     A                                       2=CODICE SECCO')
003700001011      *
003800001011      *  I SEGUENTI TRE CAMPI CHIAVE LI DEVO IMPOSTARE A SECONDA DI CIO' CHE
003900001011      *  VOGLIO TROVARE; SONO IN ALTERNATIVA TRA LORO. NON IMMETTENDO
004000001011      *  NESSUNO DI QUESTI IL PROGRAMMA EMETTE LA VIDEATA INIZIALE DI
004100001011      *  IMMISSIONE PARAMETRI E NON AVRA' PIU' VALORE IL CAMPO "I01ACC"
004200001011      *
004300001011      *  (NOTA BENE: SE VIENE IMPOSTATO "I01RAG" VERRA' FORZATO
004400001011      *                 AUTOMATICAMENTE "I01ACC"=1 DI RICERCA TRAMITE
004500001011      *                 SUBFILE;
004600001012      *
004700001011     A            I01CRO        10S 0       TEXT('CODICE CLIENTE RITIRO')
004800001011     A            I01RAG        30          TEXT('RAGIONE SOCIALE')
004900040409      * NON USATO - CALL CENTER NON ESISTE PIU'
005000001011     A            I01CCC         7S 0       TEXT('CALL CENTER: P.O.+CODICE')
005100001011      *
005200001011      *  I SEGUENTI CAMPI SONO LE PARZIALIZZAZIONI VALIDE SOLAMENTE SE
005300001011      *  HO IMPOSTATO 1="RICERCA TRAMITE SUBFILE" IN "I01ACC" OPPURE NON
005400001011      *  HO IMPOSTATO NESSUNO DEI TRE CAMPI CHIAVE SOPRASTANTI (IN QUESTO
005500001011      *  CASO VERRANNO PROPOSTE A VIDEO)
005600001011      *
005700001011      *  (NOTA BENE: "I01POA" E' OBBLIGATORIO SE SONO IN "VARIAZIONE"
005800001011      *                       OPPURE IN "IMMISSIONE": "I01RIC" = 2 O 3;
005900001011      *              "I01KSC" VIENE PROPOSTO PROTETTO DI DEFAULT SE VALORIZZATO
006000001011      *                       E SONO IN "IMMISSIONE": "I01RIC" = 3.)
006100001011      *
006200001011      *
006300001011     A            I01POA         3S 0       TEXT('P.O. APPARTENENZA/GESTIONE')
006400001011     A            I01TAC         1          TEXT('TIPO ANAGRAFICA')
006500001222     A            I01TCR         1          TEXT('FREQUENZA RITIRO')
006600001011     A            I01ZNR         2          TEXT('ZONA RITIRO')
006700040409      * NON USATO - CALL CENTER NON ESISTE PIU'
006800001011     A            I01FCC         1          TEXT('CLIENTI CALL CENTER: S=SOLO-
006900001011     A                                       CLIENTI CALL CENTER')
007000001011     A            I01KSC         7S 0       TEXT('CODICE CLIENTE PDC')
007100001011      *
007200001011      *--------------------------------------------------------------*
007300001011      *      OUTPUT                                                  *
007400001011      *--------------------------------------------------------------*
007500001011      *
007600001011      *  SE SONO IN "IMMISSIONE" O "SCELTA": I01RIC=3, 4, VIENE RESTITUITO IL CODICE
007700001011      *  CLIENTE RITIRO SE NON HO ERRORI (O01ERR=' ') O NON HO PREMUTO
007800001011      *  F12.
007900001011      *
008000001011     A            O01CRO        10S 0       TEXT('CODICE CLIENTE RITIRO SCELTO/-
008100001011                                            IMMESSO')
008200001011      *
008300001011      *  QUALSIASI ERRORE VIENE VALORIZZATO CON:
008400001011      *  O01ERR=E;
008500001012      *  O01MSG=MESSAGGIO DI ERRORE
008600001011      *
008700001011     A            O01ERR         1          TEXT('E=ERRORE')
008800001011     A            O01MSG        78          TEXT('MESSAGGIO DI ERRORE')
