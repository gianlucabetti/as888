000100001018      *--------------------------------------------------------------*
000200001018      *                                                              *
000300001018      *      DS PER PGM DI GESTIONE ORDINI RITIRO MERCE              *
000400001018      *                                                              *
000500001018      *--------------------------------------------------------------*
000600001018      *
000700001018     A                                      REF(CNDIZION)
000800001018     A          R R50REC                    TEXT('DS PER GESTIONE O.R.M.')
000900001023     A*  TLA = 0 RICHIAMATO QUANDO UTENTE SELEZIONA TOTALMENTE I RECORD
001000001023     A*          PGM FIOR05 CONTROLLO I DATI SENZA VISUALIZZARE E SE CI SONO ERRORI
001100001023     A*          RITORNA FLAG §RMERR VALORIZZATO
001200001023     A*  TLA = 1 RICHIAMATO QUANDO UTENTE SELEZIONA UN RECORD ALLA VOLTA
001300001023     A*          PGM FIOR05 CONTROLLO I DATI SENZA VISUALIZZARE E SE CI SONO ERRORI
001400001023     A*          VISUALIZZA LA VIDEATA SEGNALANDO L'ERRORE
001500001023     A*  TLA = 2 RICHIAMATO QUANDO UTENTE SELEZIONA UN RECORD ALLA VOLTA
001600001023     A*          PGM FIOR05 VISUALIZZA I DATI A VIDEO E SE NON VIENE DATO F6
001700001023     A*          RITORNA FLAG §RMERR VALORIZZATO
001800010213
001900001023     A            §RMTLA         1A         TEXT('FLAG RICHIAMO   2=VISUALIZZA -
002000001023     A                                      1=CONTROLLI + CONFERMA 0=CONTROLLI')
002100010213
002200010213     A*  FPR = B DA IMMISSIONE PREPAGATO (BOLLA)
002300010213     A*  FPR = C DA CONFERMA ORM CALL CENTER/FILE/IT
002400010213     A*  FPR = F DA CONFERMA ORM FISSI
002500010213     A*  FPR = O DA CONFERMA ORM ALTRI P.O.
002600010213     A*  FPR = P DA CONFERMA PROPOSTE
002700010213
002800010213     A            §RMFPR         1A         TEXT('FLAG PROVENIENZA')
002900010213
003000001018     A            §RMPOE    R               REFFLD($FIL)
003100001018     A                                      TEXT('PUNTO OPERATIVO EMITTENTE')
003200001018     A                                      COLHDG('P.O.' 'EMI.')
003300001018     A                                      EDTCDE(Z)
003400001018     A            §RMNSR    R               REFFLD($NRS)
003500001019     A            §RMNOR    R               REFFLD($NRI)
003600001019     A            §RMNRV    R               REFFLD($NVI)
003700001018     A            §RMTOR    R               REFFLD($TIPO)
003800001018     A                                      TEXT('TIPO ORM')
003900001018     A                                      COLHDG('TIPO' 'ORM')
004000001129     A            §RMTCO    R               REFFLD($TIPO)
004100001129     A                                      TEXT('TIPO COMUNICAZIONE ORM')
004200001129     A                                      COLHDG('TIPO' 'COM' 'ORM')
004300001018     A            §RMDAO    R               REFFLD($DA8)
004400001018     A                                      TEXT('DATA AP.ORM/CHIAMATA')
004500001018     A                                      COLHDG('DATA' 'AP.' 'ORM')
004600001019     A            §RMOAO    R               REFFLD($ORV)
004700001018     A                                      TEXT('ORA AP.ORM/CHIAMATA')
004800001018     A                                      COLHDG('ORA' 'AP.' 'ORM')
004900001018     A            §RMCOR    R               REFFLD($CRO)
005000001018     A                                      TEXT('CODICE ORDINANTE')
005100001018     A                                      COLHDG('CODICE' 'ORDINANTE')
005200001018     A            §RMRSO    R               REFFLD($RSC)
005300001018     A                                      TEXT('RAGIONE SOC.ORDINANTE')
005400001018     A                                      COLHDG('RAG.' 'SOC.' 'ORDINANTE')
005500001018     A            §RMINO    R               REFFLD($IND)
005600001018     A                                      TEXT('INDIRIZZO ORDINANTE')
005700001018     A                                      COLHDG('IND.' 'ORDINANTE')
005800001018     A            §RMCAO    R               REFFLD($CAD)
005900001018     A                                      TEXT('CAP ORDINANTE')
006000001018     A                                      COLHDG('CAP' 'ORDINANTE')
006100001018     A            §RMLOO    R               REFFLD($LOC)
006200001018     A                                      TEXT('LOCALITA ORDINANTE')
006300001018     A                                      COLHDG('LOC.' 'ORDINANTE')
006400001018     A            §RMPRO    R               REFFLD($PRO)
006500001018     A                                      TEXT('PROVINCIA ORDINANTE')
006600001018     A                                      COLHDG('PROV.' 'ORDINANTE')
006700001018     A            §RMNAO    R               REFFLD($NAR)
006800001018     A                                      TEXT('NAZIONE ORDINANTE')
006900001018     A                                      COLHDG('NAZ.' 'ORDINANTE')
007000001018     A            §RMCRA    R               REFFLD($CRO)
007100001018     A                                      TEXT('CODICE RITIRO')
007200001018     A                                      COLHDG('CODICE' 'RITIRO')
007300001018     A            §RMRSR    R               REFFLD($RSC)
007400001018     A                                      TEXT('RAGIONE SOC.RITIRO')
007500001018     A                                      COLHDG('RAG.' 'SOC.' 'RITIRO')
007600001018     A            §RMINR    R               REFFLD($IND)
007700001018     A                                      TEXT('INDIRIZZO RITIRO')
007800001018     A                                      COLHDG('IND.' 'RITIRO')
007900001018     A            §RMCAR    R               REFFLD($CAD)
008000001018     A                                      TEXT('CAP RITIRO')
008100001018     A                                      COLHDG('CAP' 'RITIRO')
008200001018     A            §RMLOR    R               REFFLD($LOC)
008300001018     A                                      TEXT('LOCALITA RITIRO')
008400001018     A                                      COLHDG('LOC.' 'RITIRO')
008500001018     A            §RMPRR    R               REFFLD($PRO)
008600001018     A                                      TEXT('PROVINCIA RITIRO')
008700001018     A                                      COLHDG('PROV.' 'RITIRO')
008800001018     A            §RMNAR    R               REFFLD($NAR)
008900001018     A                                      TEXT('NAZIONE RITIRO')
009000001018     A                                      COLHDG('NAZ.' 'RITIRO')
009100001018     A            §RMRER    R               REFFLD($RSC)
009200001018     A                                      TEXT('REFERENTE RITIRO')
009300001018     A                                      COLHDG('REFERENTE ' 'RITIRO')
009400001018     A            §RMTER    R               REFFLD($TELE)
009500001018     A                                      TEXT('TELEFONO RITIRO')
009600001018     A                                      COLHDG('TELEFONO ' 'RITIRO')
009700001018     A            §RMCRC    R               REFFLD($CRO)
009800001018     A                                      TEXT('CODICE CONSEGNA')
009900001018     A                                      COLHDG('CODICE' 'CONSEGNA')
010000001018     A            §RMRSC    R               REFFLD($RSC)
010100001018     A                                      TEXT('RAGIONE SOC.CONSEGNA')
010200001018     A                                      COLHDG('RAG.' 'SOC.' 'CONSEGNA')
010300001018     A            §RMINC    R               REFFLD($IND)
010400001018     A                                      TEXT('INDIRIZZO CONSEGNA')
010500001018     A                                      COLHDG('IND.' 'CONSEGNA')
010600001018     A            §RMCAC    R               REFFLD($CAD)
010700001018     A                                      TEXT('CAP CONSEGNA')
010800001018     A                                      COLHDG('CAP' 'CONSEGNA')
010900001018     A            §RMLOC    R               REFFLD($LOC)
011000001018     A                                      TEXT('LOCALITA CONSEGNA')
011100001018     A                                      COLHDG('LOC.' 'CONSEGNA')
011200001018     A            §RMPRC    R               REFFLD($PRO)
011300001018     A                                      TEXT('PROVINCIA CONSEGNA')
011400001018     A                                      COLHDG('PROV.' 'CONSEGNA')
011500001018     A            §RMNAC    R               REFFLD($NAR)
011600001018     A                                      TEXT('NAZIONE CONSEGNA')
011700001018     A                                      COLHDG('NAZ.' 'CONSEGNA')
011800001018     A            §RMFFD    R               REFFLD($FLA)
011900001018     A                                      TEXT('S=FERMO DEPOSITO')
012000001018     A                                      COLHDG('F' 'F' 'D')
012100001018     A            §RMDAR    R               REFFLD($DA8)
012200001018     A                                      TEXT('DATA RITIRO RICHIESTA')
012300001018     A                                      COLHDG('DATA' 'RIT.' 'RICH.')
012400001018     A            §RMORR    R               REFFLD($HM)
012500001018     A                                      TEXT('ORA RITIRO RICHIESTA')
012600001018     A                                      COLHDG('ORA' 'RIT.' 'RICH.')
012700001018     A            §RMRMP    R               REFFLD($FLA)
012800001018     A                                      TEXT('FLAG RITIRO:M-MATTINO -
012900001018     A                                      P-POMERIGGIO')
013000001018     A                                      COLHDG('M/P' 'RITIRO' 'MERCE')
013100001018     A            §RMNAM    R               REFFLD($NTM)
013200001018     A            §RMNCL    R               REFFLD($NCL)
013300001018     A            §RMPKG    R               REFFLD($PKL)
013400001018     A            §RMVLM    R               REFFLD($VLU)
013500001018     A            §RMBNC    R               REFFLD($NBN)
013600001019     A            §RMBLC    R               REFFLD($NBI)
013700001019     A            §RMATT    R               REFFLD($NAU)
013800001019     A            §RMMTC    R               REFFLD($NMO)
013900001018     A            §RMPAG    R               REFFLD($FLA)
014000001018     A                                      TEXT('FLAG CHI PAGA:M=MITT.+
014100001018     A                                      D=DESTIN. O=ORDINANTE')
014200001018     A                                      COLHDG('PAG.' 'M/D/O')
014300001018     A            §RMKSC    R               REFFLD($KSC)
014400001018     A                                      TEXT('COD.CLIENTE PAGANTE')
014500001018     A                                      COLHDG('COD.' 'CLI.' 'PAG.')
014600010201     A            §RMCTR    R               REFFLD($CTRA)
014700001018     A            §RMPOR    R               REFFLD($FIL)
014800001018     A                                      TEXT('PUNTO OPERATIVO RITIRO')
014900001018     A                                      COLHDG('P.O.' 'RIT.')
015000001018     A                                      EDTCDE(Z)
015100001018     A            §RMZOR    R               REFFLD($ZNR)
015200001018     A            §RMPOC    R               REFFLD($FIL)
015300001018     A                                      TEXT('PUNTO OPERATIVO CONSEGNA')
015400001018     A                                      COLHDG('P.O.' 'CONS.')
015500001018     A                                      EDTCDE(Z)
015600001018     A            §RMNO1    R               REFFLD($NOT)
015700001018     A                                      TEXT('NOTE - 1')
015800001018     A                                      COLHDG('NOTE - 1')
015900001018     A            §RMNO2    R               REFFLD($NOT)
016000001018     A                                      TEXT('NOTE - 2')
016100001018     A                                      COLHDG('NOTE - 2')
016200010201     A            §RMDDT    R               REFFLD($FLA)
016300010201     A                                      TEXT('FLAG DDT S/N')
016400010201     A                                      COLHDG('DDT' 'S/N')
016500001019     A            §RMCST    R               REFFLD($CPA)
016600001018     A            §RMVCS    R               REFFLD($VLT)
016700001018     A                                      TEXT('VALUTA COSTO AUTOTR.')
016800001018     A                                      COLHDG('VAL.' 'COSTO' 'AUTOTR.')
016900001018     A            §RMFCS    R               REFFLD($FLA)
017000001018     A                                      TEXT('FLAG COSTO PATTUITO:A=AGGIUN-
017100001018     A                                      TA S=SOSTITUZIONE')
017200001018     A                                      COLHDG('COSTO' 'A/S')
017300010201     A            §RMSTO    R               REFFLD($STO)
017400001018     A            §RMPOS    R               REFFLD($FIL)
017500001018     A                                      TEXT('PUNTO OPERATIVO ORM FISSO')
017600001018     A                                      COLHDG('P.O.' 'ORM' 'FISSO')
017700001018     A                                      EDTCDE(Z)
017800001018     A            §RMORS    R               REFFLD($NRP)
017900001018     A                                      TEXT('NUMERO RITIRO FISSO')
018000001018     A                                      COLHDG('NUM.' 'RIT.' 'FISSO')
018100001018     A                                      EDTCDE(Z)
018200001027     A            §RMRFA    R               REFFLD($DES15)
018300001027     A                                      TEXT('RIFERIMENTO ALFANUM.')
018400001027     A                                      COLHDG('RIF.' 'ALF.')
018500001129     A            §RMTAP    R               REFFLD($FLA)
018600001129     A                                      TEXT('TIPO ASSEGN.PADRONCINO')
018700001129     A                                      COLHDG('TP.' 'ASS' 'PAD')
018800001129     A            §RMETI    R               REFFLD($FLA)
018900070706     A                                      TEXT('ORM IN FASE ASSEGNABILE')
019000070706     A                                      COLHDG('ORM' 'ASS')
019100010118     A            §RMSPI    R               REFFLD($FLA)
019200010118     A                                      TEXT('FLAG SPONDA IDRAULICA')
019300010118     A                                      COLHDG('FLG' 'SPO.' 'IDR.')
019400010209     A            §RMCAU    R               REFFLD($CMR)
019500010209     A                                      TEXT('CAUSALE CHIUSURA ORM')
019600010209     A                                      COLHDG('CAU' 'CHI.' 'ORM')
019700010508      * posizione 1 = S: oltre all'ORM vengono inviati anche i dati delle
019800010508      * spedizioni tramite l'archivio FNVAB
019900010504     A            §RMFLO    R               REFFLD($FLV)
020000010504     A            §RMFLV        10A         TEXT('ALTRI FLAG OPERATIVI')
020100001023     A            §RMERR         1A         TEXT('FLAG RITORNO = 5/ERRORE -
020200001023     A                                      3/RITORNO')
020300010201      *
020400010201      * DATI DI RITORNO
020500010201      *
020600010201     A            §RMPOEO   R               REFFLD($FIL)
020700010201     A                                      TEXT('PUNTO OPERATIVO EMITTENTE')
020800010201     A                                      COLHDG('P.O.' 'EMI.')
020900010201     A                                      EDTCDE(Z)
021000010201     A            §RMNSRO   R               REFFLD($NRS)
021100010201     A            §RMNORO   R               REFFLD($NRI)
021200010201     A            §RMNRVO   R               REFFLD($NVI)
021300131106     A            §RMDTV         8S 0       TEXT('DATA VARIAZIONE')
021400131106     A            §RMORV         6S 0       TEXT('ORA VARIAZIONE')
