000100110412      //--------------------------------------------------------------
000200110412      //?FIOR58RTSR - TEST DEMO FIOR58R
000300110412      //--------------------------------------------------------------
000400110412
000500110412     h decedit('0,') datedit(*dmy/) option(*nodebugio)
000600110412     h dftactgrp(*no) actgrp(*caller)
000700110412
000800110412      //---------------------------------------------------------------
000900110412      //?Dichiarazione file.
001000110412      //---------------------------------------------------------------
001100110412
001200110412      // - Video
001300110412     fFIOR58RTSDcf   e             workstn
001400110412
001500110412      //---------------------------------------------------------------
001600110412      //?Definizione aree dati.
001700110412      //---------------------------------------------------------------
001800110412
001900110412      // - Dati utente
002000110412     d §AzUte        e ds                  extname(AZUTE00F)
002100110412     d                                     dtaara
002200110412     d §DatiUte      e ds                  extname(dDatiUte)
002300110412     d                                     dtaara
002400110412
002500110412      //---------------------------------------------------------------
002600110412      //?Definizione strutture dati.
002700110412      //---------------------------------------------------------------
002800110412
002900110412      // - Parametri ricevuti
003000110412     d KPJBA         e ds
003100110412
003200110412      // - Reperimento dati utente
003300110412     d TIBS34ds      e ds
003400110412
003500110412     d FIOR58ds      e ds                  inz
003600110412
003700110412      //---------------------------------------------------------------
003800110412      //?Definizione variabili globali.
003900110412      //---------------------------------------------------------------
004000110412
004100110412      // - Flags booleani
004200110412     d $Fine           s               n   inz(*off)
004300110412
004400110412      //---------------------------------------------------------------
004500110412      //?Definizione procedure usate.
004600110412      //---------------------------------------------------------------
004700110412
004800110412      // - Interrogazione ORM
004900110412     d fior58r         pr                  extpgm('FIOR58R')
005000110412     d  kpjba                              likeds(KPJBA)
005100110412     d  fior58ds                           likeds(FIOR58DS)
005200110412
005300110412      //---------------------------------------------------------------
005400110412      //?prototipi
005500110412      //---------------------------------------------------------------
005600110412      /copy gaitrasrc/srcprotopr,tibs34r
005700110412
005800110412      //---------------------------------------------------------------
005900110412      //?M A I N - L I N E
006000110412      //---------------------------------------------------------------
006100110412
006200110412     c     *Entry        plist
006300110412     c                   parm                    kpjba
006400110412
006500110412      /free
006600110412
006700110412       //?Operazioni iniziali
006800110412       exsr RoutInz;
006900110412
007000110412       //?Gestione video
007100110412       DOW $Fine = *off;
007200110412         exsr GesVID;
007300110412       ENDDO;
007400110412
007500110412       //?Operazioni finali
007600110412       exsr RoutEnd;
007700110412
007800110412       //--------------------------------------------------------------
007900110412       //?Operazioni iniziali.
008000110412       //--------------------------------------------------------------
008100110412       BEGSR RoutInz;
008200110412
008300110412       //?Reperimento dati job
008400110412         exsr DatiJob;
008500110412
008600110412       ENDSR;
008700110412
008800110412       //--------------------------------------------------------------
008900110412       //?Reperimento Dati del job (Utente/Operativi).
009000110412       //--------------------------------------------------------------
009100110412       BEGSR DatiJob;
009200110412
009300110412         in(E) §AzUte;
009400110412         if NOT %error;
009500110412           in(E) §DatiUte;
009600110412         endif;
009700110412         if %error or RSut = *blanks;
009800110412           clear TIBS34ds;
009900110412           tibs34r(tibs34ds);
010000110412           in §AzUte;
010100110412           in §DatiUte;
010200110412         endif;
010300110412
010400110412       ENDSR;
010500110412
010600110412       //--------------------------------------------------------------
010700110412       //?Gestione videata.
010800110412       //--------------------------------------------------------------
010900110412       BEGSR GesVID;
011000110412
011100110412       //?Emissione videata
011200110412         exfmt  rec01;
011300110412
011400110412         SELECT;
011500110412
011600110412       //?- F03=Fine
011700110412           WHEN  *INkc;
011800110412             exsr F03vid;
011900110412
012000110412       //?Invio
012100110412           OTHER;
012200110412             exsr enter;
012300110412
012400110412         ENDSL;
012500110412
012600110412       ENDSR;
012700110412
012800110412       //--------------------------------------------------------------
012900110412       //?Gestione tasto funzionale F03 da videata.
013000110412       //?F03=Fine
013100110412       //--------------------------------------------------------------
013200110412       BEGSR F03vid;
013300110412
013400110412         $Fine = *on;
013500110412
013600110412       ENDSR;
013700110412
013800110412       //--------------------------------------------------------------
013900110412       //?Gestione enter.
014000110412       //--------------------------------------------------------------
014100110412       BEGSR Enter;
014200110412
014300110412         IOR58pdr = codaut;
014400110412         IOR58fgs = %dec(%subst(%editc(codaut:'X'):1:3):3:0);
014500110412
014600110412         FIOR58R (kpjba:FIOR58ds);
014700110412
014800110412         poe = OOR58poe;
014900110412         nsr = OOR58nsr;
015000110412         nor = OOR58nor;
015100110412         nrv = OOR58nrv;
015200110412
015300110412       ENDSR;
015400110412
015500110412       //--------------------------------------------------------------
015600110412       //?Operazioni finali.
015700110412       //--------------------------------------------------------------
015800110412       BEGSR RoutEnd;
015900110412
016000110412         *inLR = *on;
016100110412         return;
016200110412
016300110412       ENDSR;
016400110412
016500110412      /end-free
