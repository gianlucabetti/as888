000100071010      * FIOR76R1 *----------------------------------------------------*
000200071010      *?STAMPA DETTAGLIO ORM DA ASSEGNARE IN ASSEGNAZIONE DISTINTE   ?*
000300071010      *---------------------------------------------------------------*
000400071010
000500071010     h decedit('0,') datedit(*dmy/) option(*nodebugio)
000600071010
000700071010      *---------------------------------------------------------------*
000800071010
000900071010     fFIOR76P1  o    e             printer oflind(*in25)
001000071010
001100071010      *---------------------------------------------------------------*
001200071010
001300071010      *
001400071010      *?  C O S T A N T I   - - - - - - - - - - - - - - - - - - - - -?*
001500071010      *
001600071010      *
001700071010      *?  S C H I E R E   - - - - - - - - - - - - - - - - - - - - - -?*
001800071010      *
001900071010      *
002000071010      *?  S T R U T T U R E   D A T I   - - - - - - - - - - - - - - -?*
002100071010      *
002200071010      * - Parametri
002300071010     d KPJBA         e ds
002400071010     d FIOR76ds      e ds
002500071010     d £FNORMds        s                   like(FNORMds)
002600071010     d £FNORGds        s                   like(FNORGds)
002700071010      *
002800071010      * - Reperimento dati utente
002900071010     d TIBS34ds      e ds
003000071010     d AZUTEds       e ds                  extname(AZUTE00F)
003100071010     d dDatiUte      e ds
003200071010      *
003300071010      * - Dati del singolo ORM da stampare
003400071010     d FNORMds       e ds                  extname(FNORM00F)  inz
003500071010     d FNORGds       e ds                  extname(FNORG00F)  inz
003600071010      *
003700071010     d Status         sds           333
003800071010     d   SDSpgm          *proc
003900071010     d   SDSprm          *parms
004000071010      *
004100071010      *?  V A R I A B I L I   - - - - - - - - - - - - - - - - - - - -?*
004200071010      *
004300071010      * - Flags
004400071010      * - Indici di schiera
004500071010      * - Comodo
004600071010      *
004700071010      *?  K E Y - L I S T   - - - - - - - - - - - - - - - - - - - - -?*
004800071010      *
004900071010
005000071010      *---------------------------------------------------------------*
005100071010      *?RIEPILOGO INDICATORI                                         ?*
005200071010      *---------------------------------------------------------------*
005300071010      *  25    - OverFlow                                             *
005400071010      *---------------------------------------------------------------*
005500071010
005600071010     c     *Entry        plist
005700071010     c                   parm                    KPJBA
005800071010     c                   parm                    £FNORMds
005900071010     c                   parm                    £FNORGds
006000071010      *
006100071010      * Operazioni iniziali
006200071010     c                   exsr      sr_Start
006300071010      *
006400071010      * Stampa dettaglio del singolo O.R.M.
006500071010     c                   if        SDSprm  > 1
006600071010     c                   exsr      sr_PrtORM
006700071010     c                   endif
006800071010      *
006900071010      * Fine
007000071010     c                   exsr      sr_End
007100071010
007200071010      *---------------------------------------------------------------*
007300071010      *?Subroutine Iniziale                                          ?*
007400071010      *---------------------------------------------------------------*
007500071010     c     *InzSR        BEGSR
007600071010      *
007700071010      * Reperimento dati job
007800071010     c                   exsr      DatiJob
007900071010      *
008000071010      * Stampa testata
008100071010     c                   write     OR76T1
008200071010     c                   eval      *in25   = *off
008300071010      *
008400071010     c                   ENDSR
008500071010
008600071010      *---------------------------------------------------------------*
008700071010      *?Reperimento Dati del job (Utente/Operativi)                  ?*
008800071010      *---------------------------------------------------------------*
008900071010     c     DatiJob       BEGSR
009000071010      *
009100071010     c     *dtaara       define    §azute        azuteds
009200071010     c     *dtaara       define    §datiute      ddatiute
009300071010      *
009400071010     c                   in(E)     *dtaara
009500071010     c                   IF        %ERROR or RSUT = *blanks
009600071010     c                   clear                   Tibs34Ds
009700071010     c                   call      'TIBS34R'
009800071010     c                   parm                    Tibs34Ds
009900071010     c                   in        *dtaara
010000071010     c                   ENDIF
010100071010      *
010200071010     c                   ENDSR
010300071010
010400071010      *---------------------------------------------------------------*
010500071010      *?Operazioni Iniziali                                          ?*
010600071010      *---------------------------------------------------------------*
010700071010     c     sr_Start      BEGSR
010800071010      *
010900071010     c                   if        SDSprm  > 1
011000071010     c                   movel     £FNORMds      FNORMds
011100071010     c                   movel     £FNORGds      FNORGds
011200071010     c                   else
011300071010     c                   clear                   FNORMds
011400071010     c                   clear                   FNORGds
011500071010     c                   endif
011600071010      *
011700071010     c                   ENDSR
011800071010
011900071010      *---------------------------------------------------------------*
012000071010      *?Operazioni Finali                                            ?*
012100071010      *---------------------------------------------------------------*
012200071010     c     sr_End        BEGSR
012300071010      *
012400071010if  1c                   if             SDSprm <= 1
012500071010     c                             or  (ORMpoe  = *zeros
012600071010     c                              and ORMnsr  = *zeros
012700071010     c                              and ORMnor  = *zeros
012800071010     c                              and ORMnrv  = *zeros)
012900071010     c                   write     OR76E1
013000071010     c***                close     FIOR76P1
013100071010     c                   eval      *inLR   = *on
013200071010e   1c                   endif
013300071010      *
013400071010     c                   return
013500071010      *
013600071010     c                   ENDSR
013700071010
013800071010      *---------------------------------------------------------------*
013900071010      *?Stampa del singolo ORM (ricevuto come parametro)             ?*
014000071010      *---------------------------------------------------------------*
014100071010     c     sr_PrtORM     BEGSR
014200071010      *
014300071010      * Gestione testata (se overflow)
014400071010if  1c                   if        *in25
014500071010     c                   write     OR76T1
014600071010     c                   eval      *in25   = *off
014700071010e   1c                   endif
014800071010      *
014900071010      * Stampa dettaglio
015000071010     c                   write     OR76D1
015100071010      *
015200071010     c                   ENDSR
