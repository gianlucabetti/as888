000100060918      //********************************************************************************************
000200060918      //
000300060918      // Definizione variabili.
000400060918      //
000500060918      //********************************************************************************************
000600061017     D Profilo         S             10
000700061031     D IDdispositivo   S             35
000800061017     D RTNesito        S             10I 0
000900061017     D RTNopcode       S             10
001000061017     D RTNstatus       S             10I 0
001100060918
001200060918      //********************************************************************************************
001300060918      //
001400060918      // Definizione parametri procedura.
001500060918      //
001600060918      //********************************************************************************************
001700060918     C     *ENTRY        PLIST
001800061017     C                   PARM                    Profilo
001900061031     C                   PARM                    IDdispositivo
002000061017     C                   PARM                    rtnesito
002100061017     C                   PARM                    rtnopcode
002200061017     C                   PARM                    rtnstatus
002300060918      /FREE
002400060918
002500060918       //*******************************************************************************************
002600060918       //
002700060918       // Main.
002800060918       //
002900060918       //*******************************************************************************************
003000061017       CLEAR rtnesito;
003100061017       CLEAR rtnopcode;
003200061017       CLEAR rtnstatus;
003300061031       *inLR = *ON;
003400061030
003500060918      /END-FREE
003600060918     C/EXEC SQL
003700070116     C+ DECLARE AZORG CURSOR FOR
003800060918     C+ SELECT ORGFIL, ORGDES
003900061017     C+ FROM AZORG00F
004000060926     C+ WHERE ORGFVA <> '*' and ORGFAG <> 'V'
004100060926     C+ ORDER BY ORGFIL
004200060918     C+ FOR READ ONLY
004300060918     C/END-EXEC
004400061016     C
004500060918     C/EXEC SQL
004600060918     C+ OPEN AZORG
004700060918     C/END-EXEC
004800060918      /FREE
004900060918
005000061017       select;
005100061017       When sqlCode = 100;
005200061017         RTNstatus = sqlCode;
005300061017         RTNopcode = 'SQLCODE';
005400061017         RTNesito  = -1;
005500061017         RETURN;
005600061017       When sqlCode < 0;
005700061017         RTNstatus = sqlCode;
005800061017         RTNopcode = 'SQLCODE';
005900061017         RTNesito  = -1;
006000061017         RETURN;
006100061017       Endsl;
006200060918
006300060918      /END-FREE
006400060918     C/EXEC SQL
006500060918     C+ SET RESULT SETS CURSOR AZORG
006600060918     C/END-EXEC
006700060918      /FREE
006800060918
006900061017       IF sqlCode < 0;
007000061017         RTNstatus = sqlCode;
007100061017         RTNopcode = 'SQLCODE';
007200061017         RTNesito  = -1;
007300061017         RETURN;
007400061017       ENDIF;
007500060918
007600060918       RETURN;
007700060918
007800060918      /END-FREE
