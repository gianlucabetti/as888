000100060112     H Decedit('0,') Datedit(*ymd.) Option(*nodebugio)
000200060112
000300060112      *------------------------------------------------------------------------*
000400060112      *            ANNULLAMENTO ORM LEGATO A BOLLA RC
000500060112      *            con DELETE
000600060112      *------------------------------------------------------------------------*
000700060112
000800060112      * INPUT
000900060112      * -----
001000060112      *  I25TLA   Tipo di lancio
001100060112      *  I25KSC   Codice cliente
001200060112      *  I25AAS   Anno spedizione
001300060112      *  I25SPE   Spedizione
001400060112
001500060112      * OUTPUT
001600060112      * ------
001700060112      *  O25ERR   Codice di errore:
001800060112      *  O25MSG   Messaggio di errore
001900060112
002000060112      *------------------------------------------------------------------------*
002100060112
002200060112     fFnorm09l  if   e           k Disk
002300060112
002400060112      *------------------------------------------------------------------------*
002500060112      *   C A M P I   D I   L A V O R O
002600060112      *------------------------------------------------------------------------*
002700060112
002800060112     d kOrmCor         s                   Like(OrmCor)
002900060112     d kOrmRfa         s                   Like(OrmRfa)
003000060112
003100060112      *------------------------------------------------------------------------*
003200060112      *   S C H I E R E
003300060112      *------------------------------------------------------------------------*
003400060112
003500060112      *------------------------------------------------------------------------*
003600060112      *   D S   I N T E R N E / E S T E R N E
003700060112      *------------------------------------------------------------------------*
003800060112
003900060112     d  OrmRfa         ds
004000060112     d  wrmbolla               1      1
004100060112     d  wrmaas                 2      3
004200060112     d  wrmlnp                 4      6
004300060112     d  wrmnrs                 7      8
004400060112     d  wrmnsp                 9     15
004500060112
004600060112      * Passaggio Parametri
004700060112     d Fior30ds      e ds
004800060112     d Fnls25ds      e ds
004900060112
005000060112     d Kpjba         e ds
005100060112
005200060112      *------------------------------------------------------------------------*
005300060112      * RIEPILOGO INDICATORI
005400060112      *------------------------------------------------------------------------*
005500060112
005600060112
005700060112      *------------------------------------------------------------------------*
005800060112
005900060112     c     *Entry        Plist
006000060112     c                   Parm                    Fnls25ds
006100060112
006200060112      * Controllo il tipo lancio
006300060112if  1c                   If        I25Tla <> *Blanks and I25Tla <> 'C' and
006400060112     c                             I25Tla <> 'L'
006500060112     c                   Clear                   I25Tla
006600060112    1c                   EndIf
006700060112
006800060112      * Deleto l'ORM
006900060112     c                   If        I25tla <> 'C'
007000060112     c                   ExSr      Sr_DelOrm
007100060112     c                   EndIf
007200060112
007300060112      * Fine
007400060112     c                   ExSr      Sr_EndPgm
007500060112
007600060112      *------------------------------------------------------------------------*
007700060112      * Deleto l'ORM
007800060112      *------------------------------------------------------------------------*
007900060112     c     Sr_DelOrm     BegSr
008000060112
008100060112      * pulisco i campi di output
008200060112     c                   Clear                   O25Err
008300060112     c                   Clear                   O25Msg
008400060112
008500060112      * preparo la chiave
008600060112     c                   Clear                   kOrmCor
008700060112     c                   Clear                   kOrmRfa
008800060112     c                   Movel     I25Ksc        kOrmCor
008900060112     c                   Move      '333'         kOrmCor
009000060112
009100060112     c                   Eval      %subst(kOrmRfa:1:1)  = 'B'
009200060112     c                   Eval      %subst(kOrmRfa:2:2)  = I25Aas
009300060112     c                   Eval      %subst(kOrmRfa:4:12) = I25Spe
009400060112
009500060112      * cerco l'ORM
009600060112     c     kFnorm9       Chain     Fnorm09l
009700060112
009800060126      * non trovo l'orm esco
009900060112     c                   If        Not %Found(Fnorm09l)
010000060112     c                   Leavesr
010100060112     c                   EndIf
010200060112      * deleto l'ORM
010300060112     c                   clear                   fior30ds
010400060112     c                   eval      i30mod = 'D'
010500060112     c                   eval      i30poe = ormpoe
010600060112     c                   eval      i30nsr = ormnsr
010700060112     c                   eval      i30nor = ormnor
010800060112     c                   eval      i30nrv = ormnrv
010900060112     c                   call      'FIOR30R'
011000060112     c                   parm                    kpjba
011100060112     c                   parm                    fior30ds
011200060112
011300060112     c                   EndSr
011400060112
011500060112      *------------------------------------------------------------------------*
011600060112      * Fine programma
011700060112      *------------------------------------------------------------------------*
011800060112     c     Sr_EndPgm     BegSr
011900060112
012000060112if  1c                   If        I25Tla = *Blanks
012100060112     c                   Eval      *InRt = *On
012200060112   x1c                   Else
012300060112     c                   Eval      *InLr = *On
012400060112    1c                   EndIf
012500060112
012600060112     c                   Return
012700060112
012800060112     c                   EndSr
012900060112
013000060112      *------------------------------------------------------------------------*
013100060112      * Operazioni iniziali
013200060112      *------------------------------------------------------------------------*
013300060112     c     *Inzsr        BegSr
013400060112
013500060112      * Klist
013600060112
013700060112     c     kFnOrm9       Klist
013800060112     c                   Kfld                    kOrmCor
013900060112     c                   Kfld                    kOrmRfa
014000060112
014100060112     c                   EndSr
014200060112
