000100080215      *------------*
000200080215      *? FNLV5RZS ?*--------------------------------------------------*
000300080215      *------------*                                                  *
000400080215      *?STAMPA SEGNACOLLO   DISTINTA USCITA   CON   ZEBRA 8 DOT/MM   ?*
000500080215      *---------------------------------------------------------------*
000600080215      *
000700080215     h decedit('0,') datedit(*dmy.)
000800080215      *
000900080215      *?ARCHIVI?------------------------------------------------------*
001000080215      *
001100080215     fFNLV22P   o    f  132        printer
001200080215      *
001300080215      *?COSTANTI?-----------------------------------------------------*
001400080215      *
001500080215      *
001600080215      *?SCHIERE?------------------------------------------------------*
001700080215      *
001800080215      *
001900080215      *?STRUTTURE DATI?-----------------------------------------------*
002000080215      *
002100080215      * - Parametri
002200080215     d FNLV25ds      e ds
002300080215      *
002400080215      * Schiere per calcolo del check-digit
002500080215     d ds_BarCode      ds             6             inz
002600080215     d  $CB                    1      6  0 dim(06)  inz
002700080215     d ds2a            ds             2             inz
002800080215     d  §2N                    1      2  0 dim(2)   inz
002900080215      *
003000080215      *?VARIABILI?----------------------------------------------------*
003100080215      *
003200080215      * - Indici di schiera
003300080215     d XY              s              3  0 inz
003400080215     d XZ              s              3  0 inz
003500080215      * - Campi di comodo per calcolo Check-Digit
003600080215     d wCHKDGT         s              1  0 inz
003700080215     d §TT             s              3  0 inz
003800080215     d §TT2            s              3  0 inz
003900080215     d §CTR            s              3  0 inz
004000080215     d §RST            s              3  0 inz
004100080215      *
004200080215      * - Campi di comodo
004300080215     d W25rsc          s             25    inz
004400080215     d W05nfv          s              5    inz
004500080215     d WCDbar          s              6    inz
004600080215
004700080215      *---------------------------------------------------------------*
004800080215      *?INDICATORI UTILIZZATI                                        ?*
004900080215      *---------------------------------------------------------------*
005000080215      *                                                               *
005100080215      *---------------------------------------------------------------*
005200080215
005300080215     c     *Entry        plist
005400080215     c                   parm                    FNLV25ds
005500080215      *
005600080215      * "Accorcia" aanagrafica autotrasportatore
005700080215     c                   movel     D25rsc        W25rsc
005800080215      *
005900080215      * Calcola cifra di controllo (check-digit) x modulo 10 IBM
006000080215     c                   clear                   ds_BarCode
006100080215     c                   movel     D25nfv        ds_BarCode
006200080215     c                   exsr      sr_M10
006300080215     c                   movel     ds_BarCode    wCDbar
006400080215      *
006500080215      * Inizializzazione stampante
006600080215     c                   except    LV25
006700080215      *
006800080215      * Stampa cod. autotrasportatore
006900080215     c                   except    LV25D1
007000080215      *
007100080215      * Stampa descrizione autotrasportatore
007200080215     c                   except    LV25H
007300080215      *
007400080215      * Stampa data distinta
007500080215     c                   except    LV25H1
007600080215      *
007700080215      * Stampa numero bolle
007800080215     c                   except    LV25D8
007900080215      *
008000080215      * Stampa note
008100080215     c                   except    LV25D7
008200080215      *
008300080215      * Stampa numero distinta
008400080215     c                   except    LV25X2
008500080215      *
008600080215      * Stampa barcode
008700080215     c                   except    LV25D6
008800080215      *
008900080215      * Stampa chiusura etichetta
009000080215     c                   except    LV25D9
009100080215      *
009200080215     c                   eval      *inLR   =  *on
009300080215
009400080215      *---------------------------------------------------------------*
009500080215      *?Calcolo cifra di controllo secondo "modulo 10 IBM"           ?*
009600080215      *?"CHIODI": codice (di cui calcolare il check digit) lungo 5   ?*
009700080215      *?¯¯¯¯¯¯¯¯  check-digit alla 6ª posizione dello stesso campo   ?*
009800080215      *---------------------------------------------------------------*
009900080215     c     sr_M10        BEGSR
010000080215      *
010100080215     c                   clear                   §TT
010200080215     c                   clear                   §TT2
010300080215     c                   clear                   §CTR
010400080215     c                   clear                   §RST
010500080215     c                   clear                   wCHKDGT
010600080215     c                   eval      XY      =  06
010700080215      *
010800080215do  1c                   DO        05            XZ
010900080215      *
011000080215     c                   sub       1             XY
011100080215     c     XZ            div       2             §CTR
011200080215     c                   mvr                     §RST
011300080215      *
011400080215if  2c                   if        §RST    >  0
011500080215      *
011600080215     c                   eval      §CTR    =  $CB(XY) * 2
011700080215     c                   move      §CTR          ds2a
011800080215     c                   xfoot     §2N           §CTR
011900080215      *
012000080215x   2c                   else
012100080215      *
012200080215     c                   eval      §CTR    =  $CB(XY)
012300080215      *
012400080215e   2c                   endif
012500080215      *
012600080215     c                   add       §CTR          §TT
012700080215      *
012800080215e   1c                   ENDDO
012900080215      *
013000080215     c                   eval      §TT2    =  §TT  + 9
013100080215     c                   move      0             §TT2
013200080215     c                   eval      wCHKDGT = §TT2 - §TT
013300080215      *
013400080215     c                   eval      $CB(06) = wCHKDGT
013500080215      *
013600080215     c                   ENDSR
013700080215
013800080215      *===============================================================*
013900080215      *?ETICHETTA  DISTINTA  USCITA                                  ?*
014000080215      *===============================================================*
014100080215     oFNLV22P   e            LV25             01
014200080215     o                                              '^XA'
014300080215     o          e            LV25        1
014400080215     o                                              '^POI'
014500080215     o          e            LV25        1
014600080215     o                                              '^LH80,00'
014700080215     o          e            LV25        1
014800080215     o                                              '^PRC^MSY^FS'
014900080215      ********* Costante Padroncino
015000080215     o          e            LV25D1      1
015100080310     o***                                           '^FO060,010'
015200080310     o                                              '^FO100,035'
015300080215     o                                              '^ACN,36,10'
015400080215     o                                              '^FD'
015500080215     o                                              'Padroncino: '
015600080215     o                                              '^FS'
015700080215     o          e            LV25D1      1
015800080310     o***                                           '^FO220,010'
015900080310     o                                              '^FO250,020'
016000080215     o                                              '^ACN,54,20'
016100080215     o                                              '^FD'
016200080215     o                       D25pdr                 '   .    '
016300080215     o                                              '^FS'
016400080215      ********* descrizione padroncino
016500080215     o          e            LV25H       1
016600080310     o***                                           '^FO060,065'
016700080310     o                                              '^FO095,075'
016800080215     o                                              '^A0N,060,048'
016900080215     o                                              '^FD'
017000080215     o                       W25rsc
017100080215     o                                              '^FS'
017200080215      ********* DATA DISTINTA
017300080215     o          e            LV25H1      1
017400080310     o***                                           '^FO060,130'
017500080310     o                                              '^FO100,145'
017600080215     o                                              '^ACN,36,10'
017700080215     o                                              '^FD'
017800080215     o                                              'Data:'
017900080215     o                                              '^FS'
018000080215     o          e            LV25H1      1
018100080310     o***                                           '^FO220,120'
018200080310     o                                              '^FO250,130'
018300080215     o                                              '^ACN,54,20'
018400080215     o                                              '^FD'
018500080215     o                       D25ddc                 '  /  /    '
018600080307      ********* M=Mattina, P=Pomeriggio
018700080215     o                                              '^FS'
018800080310     o***                                           '^FO560,130'
018900080310     o                                              '^FO590,130'
019000080215     o                                              '^A0N,100,090'
019100080215     o                                              '^FD'
019200080215     o                       D25fpp
019300080215     o                                              '^FS'
019400080215      ********* Num. Bolle
019500080215     o          e            LV25D7      1
019600080310     o***                                           '^FO060,200'
019700080310     o                                              '^FO100,205'
019800080215     o                                              '^ACN,36,10'
019900080215     o                                              '^FD'
020000080215     o                                              'N.Bolle:'
020100080215     o                                              '^FS'
020200080215     o          e            LV25D7      1
020300080310     o***                                           '^FO220,180'
020400080310     o                                              '^FO250,190'
020500080215     o                                              '^A0N,060,048'
020600080215     o                                              '^FD'
020700080215     o                       D25nbl        Z
020800080215     o                                              '^FS'
020900080215      ********* Note
021000080215     o          e            LV25D8      1
021100080310     o***                                           '^FO060,250'
021200080310     o                                              '^FO010,260'
021300080215     o                                              '^A0N,060,048'
021400080215     o                                              '^FD'
021500080215     o                       D25not
021600080215     o                                              '^FS'
021700080215      ********* Bar Code distinta
021800080215     o          e            LV25D6      1
021900080215     o                                              '^BY4,3,0^FS'
022000080215     o          e            LV25D6      1
022100080310     o***                                           '^FO060,330'
022200080310     o                                              '^FO090,340'
022300080215     o                                              '^B2N,140,N,N,N'
022400080215     o                                              '^FD'
022500080215     o                       wCDbar
022600080215     o                                              '^FS'
022700080215      ********* N° distinta
022800080215     o          e            LV25X2      1
022900080310     o***                                           '^FO360,330'
023000080310     o                                              '^FO390,340'
023100080215     o                                              '^ACN,36,10'
023200080215     o                                              '^FD'
023300080215     o                                              'Num.Distinta'
023400080215     o                                              '^FS'
023500080215     o          e            LV25X2      1
023600080310     o***                                           '^FO360,380'
023700080310     o                                              '^FO400,390'
023800080215     o                                              '^A0N,075,060'
023900080215     o                                              '^FD'
024000080215     o                       D25nfv
024100080215     o                                              '^FS'
024200080215      ********* Chiusura etchetta
024300080215     o          e            LV25D9      1
024400080215     o                                              '^XZ'
