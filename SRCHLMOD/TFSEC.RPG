000100900102     H              J
000200930611     FTFCDP00FIF  E           K        DISK
000300930611     F                                              KINFDS INFO
000400880429     F*****************************************************************
000500930216     F*     CONTROLLO SECURITY       -CLIENTE BARTOLINI-              *
000600890620     F*****************************************************************
000700890620     F*
000800890620     F*  PERSONALIZZAZIONI PER INSTALLAZIONE DAL CLIENTE :
000900890620     F*
001000890620     F*
001100920728     F*    1. INSERIRE CODICE SERIAL NUMBER (SPC. 81.00 E SEGG.)
001200920728     F*    2. INSERIRE CODICE MODELLO (SPC.  E SEGG.)
001300920728     F*    3. INSERIRE NUMERO MAX. DI PC (SPC 25.00)
001400890620     F*    4. INSERIRE CODICE AZIENDA
001500920630     F*    5. INSERIRE DATA DI SCADENZA
001600890529     F*
001700890620     F*****************************************************************
001800900102     E*
001900900102     E                    DTSY        6  1 0
002000900102     E                    PAR       130  1
002100900102     E                    INF         7  1
002200900102     E                    M$          3  1
002300900102     I*
002400920728     I******************************************************************
002500920728     I* INSERIRE QUI
002600920728     I* N. MAX PC COLLEGABILI
002700931203     I              999                   C         PCMAX
002800920728     I*
002900920728     I******************************************************************
003000920728     I* INSERIRE QUI
003100920728     I* DATA DI SCADENZA UTILIZZO IN PROVA (AA/MM/GG)
003200920729     I              999999                C         DCONT
003300920728     I*
003400920728     I******************************************************************
003500920728     I*
003600930611     I* INFDS REPERIMENTO NUMERO RECORD TFCDP00F
003700930611     IINFO        DS
003800930611     I                                    B 156 1590NUMREC
003900930611     I*
004000920630     I* DS DI SISTEMA PER REPERIRE IDENTIFICATIVI LAVORO E DATA SIST.
004100920630     I           SDS
004200920630     I                                      244 253 JOB
004300920630     I                                      254 263 USER
004400920630     I                                      264 2690NUM
004500920630     I                                      276 2810DTSYS
004600920714     I                                      276 2810DTSY
004700920630     I*
004800900102     ICTL         DS
004900900102     I                                        1   4 CHASSI
005000900102     I                                        5   7 MODEL
005100900102     I                                        5   5 M1
005200900102     I                                        6   6 M2
005300900102     I                                        7   7 M3
005400900102     I                                        5   7 M$
005500900102     I                                        9   9 INF1
005600900102     I                                       10  10 INF2
005700900102     I                                       11  11 INF3
005800900102     I                                       12  12 INF4
005900900102     I                                       13  13 INF5
006000900102     I                                       14  14 INF6
006100900102     I                                       15  15 INF7
006200900102     I                                        9  15 INF
006300900102     I            DS
006400900102     I                                        1 130 PARM
006500900102     I                                        1 130 PAR
006600890620     I*
006700920714     I* DS DI GESTIONE ELEMENTI DATA
006800920714     I            DS
006900920714     I                                        1   60DATA
007000920714     I                                        1   20AA
007100920714     I                                        3   40MM
007200920714     I                                        5   60GG
007300890529     C*****************************************************************
007400880429     C*
007500880429     C           *ENTRY    PLIST
007600880429     C                     PARM           LADATA  60
007700920728     C                     PARM           PCADD   20
007800880502     C                     PARM           AZIEND  3
007900880429     C                     PARM           ERRORE  1
008000880429     C*
008100890529     C*    -------------------
008200920714     C*         SECURITY
008300890529     C*    -------------------
008400890529     C*
008500931209     C                     MOVE *ALL'1794'PARM  130
008600931209     C                     CALL 'XPARMCH'
008700931209     C                     PARM           PARM  130
008800931209     C                     EXSR DECOD
008900900102     C*
009000900102     C*   -----------------------
009100900102     C*   CONTROLLO SERIAL NUMBER
009200900102     C*   -----------------------
009300900102     C*
009400900102     C*    *- SERIAL NUMBER CLIENTE -*
009500900102     C*
009600931203     C*          INF1      IFNE '4'                        CLIENTE
009700931203     C*          INF2      ORNE '4'
009800931203     C*          INF3      ORNE 'D'
009900931203     C*          INF4      ORNE '0'
010000931203     C*          INF5      ORNE '7'
010100931203     C*          INF6      ORNE '3'
010200931203     C*          INF7      ORNE '8'
010300931203     C*
010400931203     C*    *- SERIAL NUMBER PROGET -*
010500931203     C*
010600931203     C*          INF1      IFNE '4'                        PROGET
010700931203     C*          INF2      ORNE '4'
010800931203     C*          INF3      ORNE 'A'
010900931203     C*          INF4      ORNE '2'
011000931203     C*          INF5      ORNE '8'
011100931203     C*          INF6      ORNE '1'
011200931203     C*          INF7      ORNE '6'
011300931203     C*
011400931203     C*                    MOVE 'E'       ERRORE
011500931203     C*                    GOTO FINE
011600900102     C*
011700931203     C*                    END
011800931203     C*                    END
011900900102     C*   -----------------
012000900102     C*   CONTROLLO MODELLO
012100900102     C*   -----------------
012200900102     C*
012300900102     C*    *- MODELLO CLIENTE -*
012400900102     C*
012500931203     C*          PAR,130   IFNE '$'
012600931203     C*          M1        IFNE 'D'
012700931203     C*          M2        ORNE '7'
012800931203     C*          M3        ORNE '0'
012900900102     C*
013000900102     C*    *- MODELLO PROGET -*
013100900102     C*
013200931203     C*          M1        IFNE 'D'
013300931203     C*          M2        ORNE '4'
013400931203     C*          M3        ORNE '5'
013500900102     C*
013600931203     C*                    MOVE 'E'       ERRORE
013700931203     C*                    GOTO FINE
013800900102     C*
013900931203     C*                    END
014000931203     C*                    END
014100931203     C*                    END
014200890529     C*
014300880429     C*
014400890529     C*   ---------------------
014500890529     C*   CALCOLI SU ORA E DATA
014600890529     C*   ---------------------
014700890529     C*
014800931209     C                     Z-ADDLADATA    LORA    60
014900931209     C                     MOVELLORA      LORAH   20
015000931209     C                     MOVE LORA      LORAS   20
015100931209     C           LORAH     MULT LORAS     LADATA
015200890529     C*
015300890529     C*
015400890529     C*   ---------------------------
015500890529     C*   CONTROLLO MAX. NUMERO DI PC
015600890529     C*   ---------------------------
015700880429     C*
015800920728     C           PCADD     CABEQ99        FINE
015900880429     C*
016000930611     C                     Z-ADDNUMREC    NPC     50
016100930611     C                     ADD  PCADD     NPC
016200920728     C           NPC       IFGT PCMAX                      3 PC
016300931209     C***                  MOVE 'P'       ERRORE
016400880429     C                     GOTO FINE
016500880429     C                     END
016600880429     C*
016700920630     C*   ---------------------------
016800920630     C*   CONTROLLO DATA SCADENZA UTILIZZO IN PROVA
016900920630     C*   ---------------------------
017000920630     C*
017100920714     C* ROVESCIA LA DATA DI SISTEMA
017200920714     C                     MOVE DTSYS     DATA
017300920714     C                     EXSR ROVDAT
017400920714     C*
017500920729     C           DATA      IFGT DCONT
017600931209     C***                  MOVE 'D'       ERRORE
017700920729     C                     GOTO FINE
017800920729     C                     END
017900920630     C*
018000890620     C*   --------------
018100890620     C*   CODICE AZIENDA
018200890620     C*   --------------
018300890620     C*
018400880429     C           FINE      TAG
018500890620     C*
018600930216     C                     MOVE '&&F'     AZIEND           BARTOLINI
018700890620     C*
018800930611     C                     MOVE '1'       *INLR
018900930611     C                     RETRN
019000930611     C*
019100930611     C* LETTURA DUMMY SU FILE TFCDP00F
019200930611     C                     READ TFCDP00F                 01
019300930611     C*
019400880429     C********************************************************************
019500900102     C*----------------------------------------------------*-
019600900102     C*--- DECOD  -------
019700900102     C*----------------------------------------------------*-
019800900102     C           DECOD     BEGSR
019900900102     C                     Z-ADD1         I       50
020000900102     C                     DO   6         I
020100900102     C           I         MULT 10        K       50
020200900102     C           K         SUB  DTSY,I    P       50
020300900102     C                     MOVE PAR,P     INF,I
020400900102     C                     END
020500900102     C*
020600900102     C           61        ADD  DTSY,1    P
020700900102     C                     MOVE PAR,P     INF,7
020800900102     C*
020900900102     C           2         DO   4         I
021000900102     C           I         MULT 10        K       50
021100900102     C                     ADD  51        K
021200900102     C           K         ADD  DTSY,I    P       50
021300900102     C           I         SUB  1         II      50
021400900102     C                     MOVE PAR,P     M$,II
021500900102     C                     END
021600900102     C                     ENDSR
021700900102     C*---------------------------------------------------------------*
021800920714     C************
021900920714     C* ROVESCIA DATA
022000920714     C************
022100920714     C*
022200920714     C           ROVDAT    BEGSR
022300920714     C*
022400920714     C                     Z-ADDAA        TT      20
022500920714     C                     Z-ADDGG        AA
022600920714     C                     Z-ADDTT        GG
022700920714     C                     ENDSR
