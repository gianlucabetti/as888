000100121010-- RUNSQLSTM SRCFILE(GAITRASRC/SRCPITECO) SRCMBR(P2VIEW) NAMING(*SQL)
000200121010-- DFTRDBCOL(PJBARPTC|P2PROJTST)
000300120920
000400120921CREATE VIEW PJBARSOC.BISCDFOL AS SELECT
000500120920SCDSOCIETA , SCDUNITA , SCDCTB , SCDKCC , SCDKSC , SCDSNATURA , SCDDTPAR ,
000600120920SCDNRPAR , SCDSERPAR , SCDSYS, SCDNRASINT , SCDNRRIGAM , SCDDTSCA ,
000700120920SCDNRRATA , SCDIMPRMC , SCDIMPRD , SCDIMPOMC , SCDIMPOD , SCDMDRD ,
000800120920SCDMDPAG , SCDTITOLI , SCDSYSEFF , SCDNRASEFF , SCDNREFF , SCDCAUS1 , SCDCAUS2 ,
000900120920SCDCAURISC , SCDFLG , SCDTPSCAD ,
001000120920CASE WHEN PPSBKAMM IS NULL THEN '  ' ELSE PPSBKAMM END AS PPSBKAMM ,
001100120920CASE WHEN PPADIVISA IS NULL THEN 'EUR ' ELSE PPADIVISA END AS PPADIVISA,
001200120920PPANRASGEN AS SCDNRASREG
001300120920FROM PJBARSOC.NDSCD00F
001400120920LEFT OUTER JOIN PJBARSOC.NDPPS00F ON SCDSYS = PPSSYS AND SCDNRASINT = PPSNRASINT
001500120920LEFT OUTER JOIN PJBARSOC.NDPPA00F ON SCDSYS = PPASYS AND SCDNRASINT = PPANRASINT
001600120920WHERE SCDTPSCAD = '0' ;
001700120920
001800120921CREATE VIEW PJBARGRU.BIFORFOL AS SELECT FRNSOCIETA AS FORSOCIETA, FRNKCC AS
001900120920  FORKCC, FRNKSC AS FORKSC, FRNKCC CONCAT ' - ' CONCAT FRNKSC AS CONTO
002000120920  , FRNKCC CONCAT '/' CONCAT FRNKSC AS CONTORICL, FRNKCC CONCAT ' - '
002100120920  CONCAT FRNKSC CONCAT ' ' CONCAT TRIM(SOGDES) AS IDFORNIT,
002200120920  TRIM(SOGDES) AS RAGSOCIALE, TRIM(FRNDESBREV) AS DESBREVE,
002300120920  TRIM(SOGPARTIVA) AS PARTITAIVA, TRIM(INDINDRIZ) AS INDIRIZZO,
002400120920  TRIM(INDCAP) AS CAP, TRIM(INDLOCALIT) AS LOCALITA, INDPROV AS
002500120920  SIGLAPROV, INDSTATO AS NAZIONE,TRIM(INDTELEFON) AS TELEFONO,
002600120920  TRIM(INDTELEFAX) AS FAX, FRNSOGG AS IDSOGGETTO, FRNCONDPAG AS
002700120920  IDCONDPAG, CASE WHEN AGEKSC IS NOT NULL THEN 'AGENTE' ELSE
002800120920  CASE WHEN APEKSC IS NOT NULL THEN 'PERCIPIENTE' ELSE
002900120920  'FORNITORE' END END AS TIPOFORN, TRIM(SOGCDFISC) AS CDFISCALE,
003000120920  FRNDTFIRPF AS DATAFINE, TRIM(CNTEMAIL) AS EMAIL
003100120920  FROM PJBARGRU.ANFRN00F
003200120920  JOIN PJBARGRU.ANSOG00F ON FRNSOGG = SOGSOGG JOIN
003300120920  PJBARGRU.ANCNT00F ON SOGSOGG = CNTSOGG AND CNTTPIND = ' ' AND
003400120920  CNTCDIND = ' ' AND CNTTPCNT = ' ' JOIN PJBARGRU.ANIND00F ON
003500120920  FRNSOGG = INDSOGG AND FRNTPIND = INDTPIND AND FRNCDIND = INDCDIND
003600120920  LEFT OUTER JOIN PJBARGRU.ANAPE00F ON FRNSOCIETA = APESOCIETA AND
003700120920  FRNKCC = APEKCC AND FRNKSC = APEKSC LEFT OUTER JOIN PJBARGRU.ANAGE00F
003800120920  ON FRNSOCIETA = AGESOCIETA AND FRNKSC = AGEKSC
003900120920  WHERE FRNFILIALE = 0 AND FRNKCC <> ' ' ;
