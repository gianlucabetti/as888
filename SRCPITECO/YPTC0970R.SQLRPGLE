000100141216      //************************************************************************
000101141216      //
000102141216      // Questo programma genera un file.csv con i saldi di tutti i conti del
000103141216      // capo conto 000201 e 000202.
000104141216      //
000105141216      //************************************************************************
000106141216
000107141216     H DFTACTGRP(*NO) ACTGRP(*NEW)
000108141216
000109141216      //************************************************************************
000110141216      //
000111141216      // Strutture dati.
000113141216      //
000114141216      //************************************************************************
000115141216
000116141216     D kpjba         E DS                  QUALIFIED
000124141216     D this            DS                  QUALIFIED INZ
000125170607     D  cpyToImpF                   512A
000126141216
000127141216      //************************************************************************
000128141216      //
000129141216      // Prototitpi.
000130141216      //
000131141216      //************************************************************************
000132141216
000133141216      /COPY GAITRASRC/SRCPROTOPR,SYSTEM
000134141216
000135141216      //************************************************************************
000136141216      //
000137141216      // Parametri.
000138141216      //
000139141216      //************************************************************************
000140141216
000141141216     C     *ENTRY        PLIST
000142141216     C                   PARM                    kpjba
000143141216
000144141216      //************************************************************************
000145141216      //
000146141216      // Main.
000147141216      //
000148141216      //************************************************************************
000149141216
000150141216      /FREE
000151141216
000152141216       EVAL *INLR = *ON;
000153141216
000154170607       // Gruppo BRT.
000155170607
000156170607       this.cpyToImpF = 'CPYTOIMPF FROMFILE(GAITRAGRU/YSALDBANK) +
000157141216                         TOSTMF(''/Bartolini/Piteco/saldi/saldi.csv'') +
000158141216                         MBROPT(*REPLACE) STMFCCSID(*PCASCII) RCDDLM(*CRLF) +
000159141216                         STRDLM(*NONE) RMVBLANK(*TRAILING) FLDDLM('';'') +
000160141219                         DECPNT(*COMMA) ORDERBY(''SOCIETA, KSC'') +
000161141219                         ADDCOLNAM(*SQL)';
000162141216
000163141216       IF ExecuteCommand(this.cpyToImpF) < *ZERO;
000164141216         DUMP(A);
000165141216         ExecuteCommand('DSPJOBLOG OUTPUT(*PRINT)');
000166141216       ENDIF;
000167170607
000168170607       // Gruppo EDB.
000169170607
000170170607       this.cpyToImpF = 'CPYTOIMPF FROMFILE(GAIEDBGRU/YSALDBANK) +
000171170607                         TOSTMF(''/EDB/Piteco/saldi/saldi.csv'') +
000172170607                         MBROPT(*REPLACE) STMFCCSID(*PCASCII) RCDDLM(*CRLF) +
000173170607                         STRDLM(*NONE) RMVBLANK(*TRAILING) FLDDLM('';'') +
000174170607                         DECPNT(*COMMA) ORDERBY(''SOCIETA, KSC'') +
000175170607                         ADDCOLNAM(*SQL)';
000176170607
000177170607       IF ExecuteCommand(this.cpyToImpF) < *ZERO;
000178170607         DUMP(A);
000179170607         ExecuteCommand('DSPJOBLOG OUTPUT(*PRINT)');
000180170607       ENDIF;
000181141216
000182141216      /END-FREE
