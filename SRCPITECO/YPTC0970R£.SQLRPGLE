000100141216      //************************************************************************
000101141216      //
000102141216      // Questo programma genera un file.csv con i saldi di tutti i conti del
000103141216      // capo conto 000201 e 000202.
000104141216      //
000105141216      //************************************************************************
000106141216
000107141216     H DFTACTGRP(*NO) ACTGRP(*NEW)
000108141216
000109141216      //************************************************************************
000110141216      //
000111141216      // Strutture dati.
000113141216      //
000114141216      //************************************************************************
000115141216
000116141216     D kpjba         E DS                  QUALIFIED
000124141216     D this            DS                  QUALIFIED INZ
000125141216     D  cpyToImpF                   256A
000126141216
000127141216      //************************************************************************
000128141216      //
000129141216      // Prototitpi.
000130141216      //
000131141216      //************************************************************************
000132141216
000133141216      /COPY GAITRASRC/SRCPROTOPR,SYSTEM
000134141216
000135141216      //************************************************************************
000136141216      //
000137141216      // Parametri.
000138141216      //
000139141216      //************************************************************************
000140141216
000141141216     C     *ENTRY        PLIST
000142141216     C                   PARM                    kpjba
000143141216
000144141216      //************************************************************************
000145141216      //
000146141216      // Main.
000147141216      //
000148141216      //************************************************************************
000149141216
000150141216      /FREE
000151141216
000152141216       EVAL *INLR = *ON;
000153141216
000154141216       this.cpyToImpF = 'CPYTOIMPF FROMFILE(YSALDIBANK) +
000155141216                         TOSTMF(''/Bartolini/Piteco/saldi/saldi.csv'') +
000156141216                         MBROPT(*REPLACE) STMFCCSID(*PCASCII) RCDDLM(*CRLF) +
000157141216                         STRDLM(*NONE) RMVBLANK(*TRAILING) FLDDLM('';'') +
000158141219                         DECPNT(*COMMA) ORDERBY(''SOCIETA, KSC'') +
000159141219                         ADDCOLNAM(*SQL)';
000160141216
000161141216       IF ExecuteCommand(this.cpyToImpF) < *ZERO;
000162141216         DUMP(A);
000163141216         ExecuteCommand('DSPJOBLOG OUTPUT(*PRINT)');
000164141216       ENDIF;
000165141216
000166141216      /END-FREE
