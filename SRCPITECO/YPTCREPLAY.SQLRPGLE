000100140721      //************************************************************************
000101140721      //
000102140721      // Questo programma esegue una esportazione di massa da Proj a Piteco di
000103140721      // tutti i movimenti a partire dal 1 novembre 2013 generando 1 file.txt
000104140721      // ogni 10 giorni (altrimenti il file.txt diventa troppo pesante).
000105140721      //
000106140721      // Gira solo su AS888.
000107140721      //
000108140721      //************************************************************************
000109140721     H DFTACTGRP(*NO) ACTGRP(*NEW)
000110140721
000111140721      //************************************************************************
000112140721      //
000113140721      // Strutture dati.
000114140721      //
000115140721      //************************************************************************
000116140721     D kpjba         E DS                  QUALIFIED
000117140722     D this            DS                  QUALIFIED
000118140722     D  nomeSistema                   8A
000119140721
000120140721      //************************************************************************
000121140721      //
000122140721      // Prototipi.
000123140721      //
000124140721      //************************************************************************
000125140721      /COPY GAITRASRC/SRCPROTOPR,ABP
000126140722      /COPY GAITRASRC/SRCPROTOPR,XNETA
000127140721
000128140721      //************************************************************************
000129140721      //
000130140721      // Parametri.
000131140721      //
000132140721      //************************************************************************
000133140721     C     *ENTRY        PLIST
000134140721     C                   PARM                    kpjba
000135140721
000136140721      //************************************************************************
000137140721      //
000138140721      // Main.
000139140721      //
000140140721      //************************************************************************
000141140721
000142140721      /FREE
000143140721
000144140721       *INLR = *ON;
000145140721
000146140722       GetNomeSistema(this.nomeSistema);
000147140722
000148140722       IF this.nomeSistema <> 'AS888';
000149140722         DUMP(A);
000150140722         RETURN;
000151140722       ENDIF;
000152140722
000153140721       EXEC SQL
000154140804         INSERT INTO PJBARGRU/ANBOB00F SELECT '888', BOBCAUBAN, BOBCATEG,
000155140804         BOBDESCR, BOBDESBREV, BOBTIPOPE, BOBCAUTESO, BOBCAURIF, BOBSEGNO,
000156140804         BOBCAUSALE, BOBOPEFAT, BOBOPEBCP, BOBKCCCPT, BOBKSCCPT, BOBTPAFFID,
000157140804         BOBCAURIF2 FROM ANBOB00F WHERE BOBSOCIETA = '201' AND BOBCAUBAN NOT
000158140804         IN (SELECT BOBCAUBAN FROM ANBOB00F WHERE BOBSOCIETA = '888') WITH NC
000159140804       ;
000160140804
000161140804       IF sqlCode < *ZERO;
000162140804         DUMP(A);
000163140804         RETURN;
000164140804       ENDIF;
000165140804
000166140804       EXEC SQL
000167140804         UPDATE PJBARGRU/ANBOB00F
000168140804           SET BOBCAUTESO = 'PJTA'
000169140804           WHERE BOBCAUBAN = 'ASTA'
000170140804           WITH NC
000171140804       ;
000172140804
000173140804       IF sqlCode < *ZERO;
000174140804         DUMP(A);
000175140804         RETURN;
000176140804       ENDIF;
000177140804
000178140804       EXEC SQL
000179140804         UPDATE PJBARGRU/ANBOB00F
000180140804           SET BOBCAUTESO = 'PJRA'
000181140804           WHERE BOBCAUBAN = 'BIRA'
000182140804           WITH NC
000183140804       ;
000184140804
000185140804       IF sqlCode < *ZERO;
000186140804         DUMP(A);
000187140804         RETURN;
000188140804       ENDIF;
000189140804
000190140804       EXEC SQL
000191140804         UPDATE PJBARGRU/ANBOB00F
000192140804           SET BOBCAUTESO = 'PJRD'
000193140804           WHERE BOBCAUBAN = 'BIRD'
000194140804           WITH NC
000195140804       ;
000196140804
000197140804       IF sqlCode < *ZERO;
000198140804         DUMP(A);
000199140804         RETURN;
000200140804       ENDIF;
000201140804
000202140804       EXEC SQL
000203140804         UPDATE PJBARGRU/ANBOB00F
000204140804           SET BOBCAUTESO = 'PJFO'
000205140804           WHERE BOBCAUBAN = 'INFO'
000206140804           WITH NC
000207140804       ;
000208140804
000209140804       IF sqlCode < *ZERO;
000210140804         DUMP(A);
000211140804         RETURN;
000212140804       ENDIF;
000213140804
000214140804       EXEC SQL
000215140804         UPDATE PJBARGRU/ANBOB00F
000216140804           SET BOBCAUTESO = 'PJMU'
000217140804           WHERE BOBCAUBAN = 'RAMU'
000218140804           WITH NC
000219140804       ;
000220140804
000221140804       IF sqlCode < *ZERO;
000222140804         DUMP(A);
000223140804         RETURN;
000224140804       ENDIF;
000225140804
000226140804       EXEC SQL
000227140804         UPDATE PJBARGRU/ANBOB00F
000228140804           SET BOBCAUTESO = 'PJBC'
000229140804           WHERE BOBCAUBAN = 'SPBC'
000230140804           WITH NC
000231140804       ;
000232140804
000233140804       IF sqlCode < *ZERO;
000234140804         DUMP(A);
000235140804         RETURN;
000236140804       ENDIF;
000237140804
000238140804       EXEC SQL
000239140804         UPDATE PJBARGRU/ANBOB00F
000240140804           SET BOBCAUTESO = 'PJON'
000241140804           WHERE BOBCAUBAN = 'VBON'
000242140804           WITH NC
000243140804       ;
000244140804
000245140804       IF sqlCode < *ZERO;
000246140804         DUMP(A);
000247140804         RETURN;
000248140804       ENDIF;
000249140804
000250140804       EXEC SQL
000251140804         UPDATE PJBARGRU/ANBOB00F
000252140804           SET BOBCAUTESO = 'PJPA'
000253140804           WHERE BOBCAUBAN = 'PTCA'
000254140804           WITH NC
000255140804       ;
000256140804
000257140804       IF sqlCode < *ZERO;
000258140804         DUMP(A);
000259140804         RETURN;
000260140804       ENDIF;
000261140804
000262140804       EXEC SQL
000263140804         UPDATE PJBARGRU/ANBOB00F
000264140804           SET BOBCAUTESO = 'PJPD'
000265140804           WHERE BOBCAUBAN = 'PTCD'
000266140804           WITH NC
000267140804       ;
000268140804
000269140804       IF sqlCode < *ZERO;
000270140804         DUMP(A);
000271140804         RETURN;
000272140804       ENDIF;
000273140804
000274140804       EXEC SQL
000275140804         UPDATE PJBARGRU/ANBOB00F
000276140804           SET BOBCAUTESO = 'PJFD'
000277140804           WHERE BOBCAUBAN = 'PAFO'
000278140804           WITH NC
000279140804       ;
000280140804
000281140804       IF sqlCode < *ZERO;
000282140804         DUMP(A);
000283140804         RETURN;
000284140804       ENDIF;
000285140804
000286140804       EXEC SQL
000287140804         UPDATE PJBARGRU/ANBOB00F
000288140804           SET BOBCAUTESO = 'PJAS'
000289140804           WHERE BOBCAUBAN = 'SPAS'
000290140804           WITH NC
000291140804       ;
000292140804
000293140804       IF sqlCode < *ZERO;
000294140804         DUMP(A);
000295140804         RETURN;
000296140804       ENDIF;
000297140804
000298140804       EXEC SQL
000299140804         UPDATE PJBARGRU/ANBOB00F
000300140804           SET BOBCAUTESO = 'PJOR'
000301140804           WHERE BOBCAUBAN = 'STOR'
000302140804           WITH NC
000303140804       ;
000304140804
000305140804       IF sqlCode < *ZERO;
000306140804         DUMP(A);
000307140804         RETURN;
000308140804       ENDIF;
000309140804
000310140804       EXEC SQL
000311140804         UPDATE PJBARGRU/ANBOB00F
000312140804           SET BOBCAUTESO = 'PJOD'
000313140804           WHERE BOBCAUBAN = 'STOD'
000314140804           WITH NC
000315140804       ;
000316140804
000317140804       IF sqlCode < *ZERO;
000318140804         DUMP(A);
000319140804         RETURN;
000320140804       ENDIF;
000321140804
000322140804       EXEC SQL
000323140804         UPDATE PJBARGRU/ANBOB00F
000324140804           SET BOBCAUTESO = 'PJIN'
000325140804           WHERE BOBCAUBAN = 'SPIN'
000326140804           WITH NC
000327140804       ;
000328140804
000329140804       IF sqlCode < *ZERO;
000330140804         DUMP(A);
000331140804         RETURN;
000332140804       ENDIF;
000333140804
000334140804       EXEC SQL
000335140804         UPDATE PJBARGRU/ANBOB00F
000336140804           SET BOBCAUTESO = 'PJES'
000337140804           WHERE BOBCAUBAN = 'SPES'
000338140804           WITH NC
000339140804       ;
000340140804
000341140804       IF sqlCode < *ZERO;
000342140804         DUMP(A);
000343140804         RETURN;
000344140804       ENDIF;
000345140804
000346140804       EXEC SQL
000347140804         UPDATE PJBARGRU/ANBOB00F
000348140804           SET BOBCAUTESO = 'PJOA'
000349140804           WHERE BOBCAUBAN = 'STOA'
000350140804           WITH NC
000351140804       ;
000352140804
000353140804       IF sqlCode < *ZERO;
000354140804         DUMP(A);
000355140804         RETURN;
000356140804       ENDIF;
000357140804
000358140804       EXEC SQL
000359140721         UPDATE ndbmv00f
000360140721            SET ndbmv00f.bmvNrTeso = 0
000361140721              , ndbmv00f.bmvStatus = ''
000362140721              , ndbmv00f.bmvDest = ''
000363140722          WHERE ndbmv00f.bmvStatus > ''
000364140722            AND ndbmv00f.bmvDtReg > '2013-10-31'
000365140724            AND ndbmv00f.bmvSocieta = '201'
000366140724            AND ndbmv00f.bmvKcc = '000201'
000367140721           WITH NC
000368140721       ;
000369140721
000370140721       IF sqlCode < *ZERO;
000371140721         DUMP(A);
000372140721         RETURN;
000373140721       ENDIF;
000374140721
000375140721       kpjba.kcoaz = 'Y084';
000376140721
000377140721       %SUBST(kpjba.kpjbu : 1) = '2013-11-01';
000378140721       %SUBST(kpjba.kpjbu : 11) = '2013-11-10';
000379140721       ABP_LancioAzioneBatch(kpjba);
000380140721
000381140721       %SUBST(kpjba.kpjbu : 1) = '2013-11-11';
000382140721       %SUBST(kpjba.kpjbu : 11) = '2013-11-20';
000383140721       ABP_LancioAzioneBatch(kpjba);
000384140721
000385140721       %SUBST(kpjba.kpjbu : 1) = '2013-11-21';
000386140721       %SUBST(kpjba.kpjbu : 11) = '2013-11-30';
000387140721       ABP_LancioAzioneBatch(kpjba);
000388140721
000389140721       %SUBST(kpjba.kpjbu : 1) = '2013-12-01';
000390140721       %SUBST(kpjba.kpjbu : 11) = '2013-12-10';
000391140721       ABP_LancioAzioneBatch(kpjba);
000392140721
000393140721       %SUBST(kpjba.kpjbu : 1) = '2013-12-11';
000394140721       %SUBST(kpjba.kpjbu : 11) = '2013-12-20';
000395140721       ABP_LancioAzioneBatch(kpjba);
000396140721
000397140721       %SUBST(kpjba.kpjbu : 1) = '2013-12-21';
000398140721       %SUBST(kpjba.kpjbu : 11) = '2013-12-31';
000399140721       ABP_LancioAzioneBatch(kpjba);
000400140721
000401140721       %SUBST(kpjba.kpjbu : 1) = '2014-01-01';
000402140721       %SUBST(kpjba.kpjbu : 11) = '2014-01-10';
000403140721       ABP_LancioAzioneBatch(kpjba);
000404140721
000405140721       %SUBST(kpjba.kpjbu : 1) = '2014-01-11';
000406140721       %SUBST(kpjba.kpjbu : 11) = '2014-01-20';
000407140721       ABP_LancioAzioneBatch(kpjba);
000408140721
000409140721       %SUBST(kpjba.kpjbu : 1) = '2014-01-21';
000410140721       %SUBST(kpjba.kpjbu : 11) = '2014-01-31';
000411140721       ABP_LancioAzioneBatch(kpjba);
000412140721
000413140721       %SUBST(kpjba.kpjbu : 1) = '2014-02-01';
000414140721       %SUBST(kpjba.kpjbu : 11) = '2014-02-10';
000415140721       ABP_LancioAzioneBatch(kpjba);
000416140721
000417140721       %SUBST(kpjba.kpjbu : 1) = '2014-02-11';
000418140721       %SUBST(kpjba.kpjbu : 11) = '2014-02-20';
000419140721       ABP_LancioAzioneBatch(kpjba);
000420140721
000421140721       %SUBST(kpjba.kpjbu : 1) = '2014-02-21';
000422140721       %SUBST(kpjba.kpjbu : 11) = '2014-02-28';
000423140721       ABP_LancioAzioneBatch(kpjba);
000424140721
000425140721       %SUBST(kpjba.kpjbu : 1) = '2014-03-01';
000426140721       %SUBST(kpjba.kpjbu : 11) = '2014-03-10';
000427140721       ABP_LancioAzioneBatch(kpjba);
000428140721
000429140721       %SUBST(kpjba.kpjbu : 1) = '2014-03-11';
000430140721       %SUBST(kpjba.kpjbu : 11) = '2014-03-20';
000431140721       ABP_LancioAzioneBatch(kpjba);
000432140721
000433140721       %SUBST(kpjba.kpjbu : 1) = '2014-03-21';
000434140721       %SUBST(kpjba.kpjbu : 11) = '2014-03-31';
000435140721       ABP_LancioAzioneBatch(kpjba);
000436140721
000437140721       %SUBST(kpjba.kpjbu : 1) = '2014-04-01';
000438140721       %SUBST(kpjba.kpjbu : 11) = '2014-04-10';
000439140721       ABP_LancioAzioneBatch(kpjba);
000440140721
000441140721       %SUBST(kpjba.kpjbu : 1) = '2014-04-11';
000442140721       %SUBST(kpjba.kpjbu : 11) = '2014-04-20';
000443140721       ABP_LancioAzioneBatch(kpjba);
000444140721
000445140721       %SUBST(kpjba.kpjbu : 1) = '2014-04-21';
000446140721       %SUBST(kpjba.kpjbu : 11) = '2014-04-30';
000447140721       ABP_LancioAzioneBatch(kpjba);
000448140721
000449140721       %SUBST(kpjba.kpjbu : 1) = '2014-05-01';
000450140721       %SUBST(kpjba.kpjbu : 11) = '2014-05-10';
000451140721       ABP_LancioAzioneBatch(kpjba);
000452140721
000453140721       %SUBST(kpjba.kpjbu : 1) = '2014-05-11';
000454140721       %SUBST(kpjba.kpjbu : 11) = '2014-05-20';
000455140721       ABP_LancioAzioneBatch(kpjba);
000456140721
000457140721       %SUBST(kpjba.kpjbu : 1) = '2014-05-21';
000458140721       %SUBST(kpjba.kpjbu : 11) = '2014-05-31';
000459140721       ABP_LancioAzioneBatch(kpjba);
000460140721
000461140721       %SUBST(kpjba.kpjbu : 1) = '2014-06-01';
000462140721       %SUBST(kpjba.kpjbu : 11) = '2014-06-10';
000463140721       ABP_LancioAzioneBatch(kpjba);
000464140721
000465140721       %SUBST(kpjba.kpjbu : 1) = '2014-06-11';
000466140721       %SUBST(kpjba.kpjbu : 11) = '2014-06-20';
000467140721       ABP_LancioAzioneBatch(kpjba);
000468140721
000469140721       %SUBST(kpjba.kpjbu : 1) = '2014-06-21';
000470140721       %SUBST(kpjba.kpjbu : 11) = '2014-06-30';
000471140721       ABP_LancioAzioneBatch(kpjba);
000472140721
000473140721       %SUBST(kpjba.kpjbu : 1) = '2014-07-01';
000474140721       %SUBST(kpjba.kpjbu : 11) = '2014-07-10';
000475140721       ABP_LancioAzioneBatch(kpjba);
000476140721
000477140721       %SUBST(kpjba.kpjbu : 1) = '2014-07-11';
000478140721       %SUBST(kpjba.kpjbu : 11) = '2014-07-20';
000479140721       ABP_LancioAzioneBatch(kpjba);
000480140721
000481140721       %SUBST(kpjba.kpjbu : 1) = '2014-07-21';
000482140721       %SUBST(kpjba.kpjbu : 11) = '2014-07-31';
000483140721       ABP_LancioAzioneBatch(kpjba);
000484140721
000485140721      /END-FREE
