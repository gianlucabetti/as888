000100000000     H*PARMS OPTION(*NOXREF) DFTACTGRP(*NO) BNDDIR(PJXBND) ACTGRP(QILE)
000200000000     H*PARMS CVTOPT(*NONE)
000300000000     H DECEDIT('0,') DATEDIT(*DMY.)
000400000000      *----------------------------------------------------*
000500170727     FSDGCSF01L UF A E           K DISK
000600000000      *-------------
000700170727     FSDGSI62D  CF   E             WORKSTN USROPN
000800000000      *-------------
000900000000      *Controlli validità per valore di una legenda
001000000000     D X07DS         E DS                  EXTNAME(X07VALDS)
001100000000      *-------------
001200000000      * Parametri pgm
001300000000     D Video           S              1A
001400000000     D ZDateISO        S               D
001500000000      *----------------------------------------------------*
001600000000      *                MAIN LINE PROGRAM
001700000000      *----------------------------------------------------*
001800000000      *
001900000000     C                   ExSr      InzVar
002000000000      *
002100000000      * Emissione window (se richiesta)
002200000000     C                   DoW       Video=*On
002300000000     C                   ExSr      GesD1
002400000000     C                   EndDo
002500000000      *
002600000000      * Aggiornamento catalogo
002700000000     C                   ExSr      AggCat
002800000000      *
002900000000      * Fine programma
003000000000     C                   ExSr      EndPgm
003100000000      *
003200000000      ************************************************************
003300000000      * Gestione video D1
003400000000      ************************************************************
003500000000     C     GesD1         BegSr
003600000000      *
003700170727     C                   ExFmt     SDGSI62D1
003800000000      *
003900000000     C                   ExSr      CtrD1
004000000000      *
004100000000   B3C                   If        *InKF=*On
004200000000     C                             and *In99=*Off
004300000000      *
004400000000     C                   Move      *Off          Video
004500000000      *
004600000000   E3C                   EndIf
004700000000      *
004800000000     C                   EndSr
004900000000      ************************************************************
005000000000      * Controllo video D1
005100000000      ************************************************************
005200000000     C     CtrD1         BegSr
005300000000      *
005400000000     C                   If        D1Descr=*Blank
005500000000     C                   SetOn                                        5099
005600000000     C                   EndIf
005700000000      *
005800000000     C                   EndSr
005900000000      ************************************************************
006000000000      * Aggiornamento catalogo
006100000000      ************************************************************
006200000000     C     AggCat        BegSr
006300000000      *
006400170727     C     K02Csf01      Chain     SdgCsf01L                          21
006500000000      *
006600170727     C                   MoveL     D1Descr       CSFNote
006700000000      *
006800000000     C                   If        *In21=*Off
006900170727     C                   Update    SdgCsf000
007000000000     C                   Else
007100170727     C                   Write     SdgCsf000
007200000000     C                   EndIf
007300000000      *
007400000000     C                   EndSr
007500000000      ************************************************************
007600000000      * Inizializzazioni
007700000000      ************************************************************
007800000000     C     InzVar        BegSr
007900000000      *
008000000000     C                   If        Video=*On
008100000000      *
008200170727     C                   Open      SDGSI62D
008300000000      *
008400170727     C                   eval      D1Societa = CSFSocieta
008500000000      *
008600170809     C                   eval      D1File     = %trim(CsfFile) + '.xml'
008700170809     C                   eval      D1Descr    = CsfNote
008800170809     C                   eval      D1ProgrInt = %dec($ProgrInt:3:0)
008900000000      *
009000170727     C                   eval      D1Path = Cartella
009100170727      *
009200170727     C                   EndIf
009300000000      *
009400000000     C                   EndSr
009500000000      ************************************************************
009600000000      * Fine programma
009700000000      ************************************************************
009800000000     C     EndPgm        BEGSR
009900000000      *
010000000000     C                   SetOn                                            LR
010100000000     C                   Return
010200000000      *
010300000000     C                   EndSr
010400000000      ************************************************************
010500000000      * Definizioni e inizializzazioni
010600000000      ************************************************************
010700000000     C     *InzSr        BegSr
010800000000      *
010900000000     C     *DMY          Move      Udate         ZDateISO
011000000000     C     *JobRun       Move      ZDateISO      ZDate             6 0
011100000000      *
011200000000     C     *Entry        PList
011300170727     C                   parm                    CsfSocieta
011400170727     C                   parm                    CsfFile
011500170727     C                   parm                    CsfNote
011600170809     C                   parm                    $ProgrInt         3
011700170727     C                   parm                    Cartella         90
011800000000     C                   Parm                    Video
011900000000      *
012000170727     C     k02csf01      KList
012100170727     C                   KFld                    CSFSocieta
012200170727     C                   KFld                    CSFFile
012300000000      *
012400000000     C                   EndSr
