000100090923     H*PARMS OPTION(*NOXREF *NODEBUGIO) DFTACTGRP(*NO) BNDDIR(PJXBND)
000200060824     H*ACTGRP(QILE)
000300060824      **********************************************************************
000400060824     H DECEDIT('0,') DATEDIT(*DMY.)
000500060824      **********************************************************************
000600060824      *
000700060824      **********************************************************************
000800060824      *====================================================*
000900060824      * PARAMETRI DI INGRESSO
001000060824      *----------*
001100060824     D KPJBA         E DS
001200060824      * Dati di ambiente per la società impostata in contesto
001300090923     D XSOPRO        E DS                  EXTNAME(SDGSOCDS)
001400060824      *====================================================*
001500090923      *
001600060824      *====================================================*
001700060824      *----------*
001800090923     D WInterSW        S              1
001900060824      ******************************************************
002000060824      *                MAIN LINE PROGRAM
002100060824      ******************************************************
002200060824      *
002300060824      * inizializzazione variabili
002400090923     C                   Exsr      InzVar
002500060824      *
002600060824      * chiamata pgm specifico
002700090923   B1C                   Select
002800090923     C*
002900090923    >C                   WHEN      WInterSW   = '1'
003000090923     C                   Exsr      CallPgmSW1
003100060824      *
003200090923    >C                   WHEN      WInterSW   = '2'
003300090923     C                   Exsr      CallPgmSW2
003400090923      *
003500090923    >C                   WHEN      WInterSW   = '3'
003600090923     C                   Exsr      CallPgmSW3
003700090923      *
003800090923     C                   EndSl
003900090923      *
004000060824      * fine pgm
004100090923     C                   Exsr      EndPgm
004200060824      ************************************************************
004300060824      * Operazioni iniziali
004400060824      ************************************************************
004500060824     C     *Inzsr        Begsr
004600060824      *
004700060824      * Reperimento parametri
004800090923     C     *Entry        Plist
004900090923     C                   Parm                    TIPXSC            6
005000090923     C                   Parm                    SOCXSC            3
005100090923     C                   Parm                    CDSXSC            9 0
005200090923     C                   Parm                    MODXSC            3
005300090923     C                   Parm                    RTNXSC            1
005400090923     C                   Parm                    XSOPRO
005500090923     C                   Parm                    KPJBA
005600060824      *
005700060824     C     XInzSr        Endsr
005800060824      ************************************************************
005900060824      * Inizializzazione variabili
006000060824      ************************************************************
006100060824     C     InzVar        Begsr
006200060824      *
006300060824      * reperisco da ANMPE parametro da passare
006400090923     C                   Exsr      RieParamIn
006500060824      *
006600060824     C     XInzVar       Endsr
006700060824      ******************************************************
006800090923      * Reperisco da SDGPAR il tipo di ERP
006900060824      ******************************************************
007000060824     C     RieParamIn    Begsr
007100060824      *
007200090923     C                   Eval      WInterSW  = '1'
007300090923      *
007400060824     C     XRieParamIn   Endsr
007500060824      ************************************************************
007600090923      * Chiamo programma specifico per collegamento ERP
007700060824      ************************************************************
007800090923     C     CallPgmSW1    Begsr
007900060824      *
008000090923     C                   CALLB     'XSOC'
008100090923     C                   PARM                    TIPXSC            6
008200090923     C                   PARM                    SOCXSC            3
008300090923     C                   PARM                    CDSXSC            9 0
008400090923     C                   PARM                    MODXSC            3
008500090923     C                   PARM      *BLANKS       RTNXSC            1
008600090923     C                   PARM                    XSOPRO
008700090923     C                   PARM                    KPJBA
008800060824      *
008900090923     C     XCallPgmSW1   Endsr
009000090923      ************************************************************
009100090923      * Chiamo programma specifico per collegamento ERP
009200090923      ************************************************************
009300090923     C     CallPgmSW2    Begsr
009400090923      *
009500090923      *
009600090923     C     XCallPgmSW2   Endsr
009700090923      ************************************************************
009800090923      * Chiamo programma specifico per collegamento ERP
009900090923      ************************************************************
010000090923     C     CallPgmSW3    Begsr
010100090923      *
010200090923      *
010300090923     C     XCallPgmSW3   Endsr
010400060824      ************************************************************
010500060824      * FINE PROGRAMMA
010600060824      ************************************************************
010700060824     C     EndPgm        Begsr
010800060824      *
010900090923     C                   Move      *on           *inRT
011000060824     C                   RETURN
011100060824      *
011200060824     C     XEndPgm       Endsr
011300060824      ************************************************************
011400060824      * Definizione Klist
011500060824      ************************************************************
011600060824     C     DefKList      Begsr
011700060824      *
011800060824      *
011900060824     C     XDefKlist     Endsr
