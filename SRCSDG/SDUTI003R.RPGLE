000100000000     H*PARMS DFTACTGRP(*NO) BNDDIR(PJXBND PJCBND) ACTGRP(*CALLER)
000200000000     H*PARMS OPTION(*NOXREF *NODEBUGIO) CVTOPT(*DATETIME)
000300000000     H DECEDIT('0,') DATEDIT(*DMY.)
000400000000      ********************************************************************
000500000000      *
000600110824      *         ------------------------------------------------
000700110824      *                   Comunicazione Operazioni Iva
000800110824      *                      Riempimeto tabella HD1
000900110824      *         ------------------------------------------------
001000110418      *
001100000000     F*----------------------------------------------------------------
001200110418     D* Passaggio Parametri
001300110418     D KPJBA         E DS
001400110418     D*-------------
001500110418     D* Dati ottenuti da XSOC
001600110418     D SOC001        E DS                  EXTNAME(SDGSOCDS )
001700110418     D*-------------
001800110418     D* DS Interna per dati di output di SDGSOCDR
001900110418     D XSOCDS          DS          1000
002000000000      *-------------
002100000000     D* Reperimento nome PGM
002200000000     D STATUS         SDS           333
002300000000     D  DSPGM            *PROC
002400000000     D  PARMS            *PARMS
002500000000     D*----------------
002600000000     D* Richiamo a XATB
002700000000     D XATBDS        E DS
002800000000     D*-------------
002900000000     D* Parametri per ricerca codice ANATB00F
003000000000     D XTABDS        E DS
003100000000     D*----------------
003200000000     D* Parametri
003300000000     D*----------------
003400110418     D SDGHD1DS      E DS
003500000000     D*----------------
003600110418     D ANGG12DS      E DS
003700000000     D*----------------
003800000000     D $Efile          S              1
003900000000     D $RcdOK          S              1A
004000000000     D*----------------
004100000000     D UDateISO        S               D
004200110801     D DatMin          C                   Const('0001-01-01')
004300110418     D*----------------
004400110418     D SkSoc           S              3    Dim(100)
004500110418     D SkKey           S             15    Dim(100)
004600110418     D SkUni           S            256    Dim(100)
004700000000     D*---------------------------------------------------------------*
004800000000     C*  CICLO PRINCIPALE DEL PROGRAMMA                               *
004900000000     C*---------------------------------------------------------------*
005000000000     C*
005100000000     C                   Exsr      InzVar
005200000000     C*
005300110418     C                   Exsr      ElaboraG12
005400110418     C*
005500110418     C                   Exsr      WriteHD1
005600110418     C*
005700000000     C                   Exsr      EndPgm
005800110418     C*
005900000000     C************************************************************
006000110418     C* Lettura tabella G12
006100000000     C************************************************************
006200110418     C     ElaboraG12    BegSr
006300000000     C*
006400000000     C                   Z-add     0             K                 3 0
006500110418     C*
006600000000     C                   MOVE      'G12'         XTBCOD
006700000000     C*
006800000000     C                   MOVE      XscSoc        XTBAZI
006900000000     C                   MOVE      XscLin        XTBLIN
007000000000     C                   MOVE      '9'           XTBRIC
007100000000     C                   MOVE      '0'           XTBALC
007200000000     C                   MOVE      XscCut        XTBUTE
007300000000     C                   MOVE      '0'           XTBERR
007400000000     C                   CALL      'XATB'
007500000000     C                   PARM                    XATBDS
007600000000     C*
007700000000     C     XTBERR        IFNE      '0'
007800000000     C                   MOVEL     *ON           $EFILE
007900000000     C                   ENDIF
008000000000     C*
008100000000     C                   MOVEL     *OFF          $EFILE
008200000000     C                   MOVEL     *OFF          $RCDOK
008300000000     C*
008400110418     C     $EFILE        DOUEq     *ON
008500000000     C     $RCDOK        OrEq      *ON
008600000000     C*
008700000000     C                   MOVE      '3'           XTBRIC
008800000000     C                   MOVE      '0'           XTBERR
008900000000     C                   CALL      'XATB'
009000000000     C                   PARM                    XATBDS
009100000000     C*
009200000000     C     XTBERR        IFNE      '0'
009300000000     C                   MOVEL     *ON           $EFILE
009400000000     C                   ENDIF
009500000000     C*
009600110418     C     $EFILE        IfEq      *OFF
009700110418     C                   MoveL     XtbUni        AngG12DS
009800110916R066 C****               If        CodUICg12     <>  086
009900110916     C                   If        BLACKLG12     <> ' '
010000110418     C                   Exsr      SalvaDati
010100110916     C                   EndIf
010200110916R066 C****               EndIf
010300110418     C                   EndIf
010400000000     C*
010500110418     C                   EndDo
010600000000     C*
010700000000     C                   Endsr
010800000000     C************************************************************
010900110418     C* Salvataggio dati
011000000000     C************************************************************
011100110418     C     SalvaDati     BegSr
011200000000     C*
011300110418     C                   Add       1             K
011400110418     C                   MoveL     XtbKey        SkKey(K)
011500110418     C                   MoveL     XtbUni        SkUni(K)
011600110418     C*
011700110418     C                   Endsr
011800110418     C************************************************************
011900110418     C* Crea HD1
012000110418     C************************************************************
012100110418     C     WriteHD1      BegSr
012200110418     C*
012300110418     C                   Do        K             K1                3 0
012400110418     C*
012500110418     C                   MoveL     SkKey(k1)     XTBKEY
012600110418     C                   Move      'HD1'         XTBCOD
012700110418     C*
012800110418     C                   EXSR      RieHD1
012900110418     C*
013000110418     C                   MOVE      XSCCUT        XTBUTE
013100110418     C                   MOVE      '5'           XTBRIC
013200110418     C                   CALLb     'XATB'
013300110418     C                   PARM                    XATBDS
013400110418     C*
013500110418     C                   EndDo
013600110418     C*
013700110418     C                   Endsr
013800110418     C************************************************************
013900110418     C* Riempimento HD1
014000110418     C************************************************************
014100110418     C     RieHD1        Begsr
014200110418     C*
014300110418     C                   Clear                   XTBUNI
014400110801     C                   Move      DatMin        XTBDSC
014500110418     C                   Move      '0'           XTBRIS
014600110418     C                   MoveL     SkUni(K1)     AngG12ds
014700110418     C                   MoveL     DESG12        DESHD1
014800110418     C                   MoveL     DESG12        DESCRHD1
014900110418     C                   MoveL     CODUICG12     CODUICHD1
015000110418     C                   MoveL     SDGHD1DS      XTBUNI
015100110418     C*
015200110418     C                   EndSr
015300110418     C************************************************************
015400110418     C* Inizializzazioni variabili
015500110418     C************************************************************
015600110418     C     InzVar        BegSr
015700110418     C*
015800110824     C**** *ENTRY        PLIST
015900110824     C****               PARM                    KPJBA
016000000000      *
016100110801     C* Reperimento dati società
016200110801    >C                   MOVEL     'SOC001'      TIPXSC
016300110801     C                   MOVEL     *BLANK        SOCXSC
016400110801     C                   EXSR      REPSOC
016500110801     C     RTNXSC        IFNE      '1'
016600110801     C                   MOVEL     XSOCDS        SOC001
016700110801     C                   ELSE
016800110801     C                   RETURN
016900110801     C                   ENDIF
017000000000      *
017100000000     C     *DMY          Move      Udate         UDateISO
017200000000     C*
017300000000     C                   EndSr                                                  *
017400000000     C************************************************************
017500000000     C* DEFINIZIONE KLIST
017600000000     C**************klis******************************************
017700000000     C     DefKlist      BegSr
017800000000     C*
017900000000     C* KLIST
018000000000     C*
018100000000     C                   EndSr
018200000000     C************************************************************
018300000000     C* FINE PROGRAMMA
018400000000     C************************************************************
018500000000     C     EndPgm        BegSr
018600000000     C*
018700000000     C                   SETON                                        LR
018800000000     C*
018900000000     C                   RETURN
019000000000     C*
019100000000     C                   EndSr
019200000000     C************************************************************
019300000000     C* REPERIMENTO DATI SOCIETA'
019400000000     C************************************************************
019500000000     C     REPSOC        BEGSR
019600000000     C*
019700110418     C                   CALL      'SDGSOCDR'
019800110418     C                   PARM      'SOC001'      TIPXSC            6
019900110418     C                   PARM                    SOCXSC            3
020000110418     C                   PARM                    CDSXSC            9 0
020100110418     C                   PARM                    MODXSC            3
020200110418     C                   PARM      *BLANKS       RTNXSC            1
020300110418     C                   PARM                    XSOCDS
020400110418     C                   PARM                    KPJBA
020500110418     C*
020600110418     C                   If        RtnXsc     <> '1'
020700110418     C                   MoveL     XSOCDS        SOC001
020800110418     C                   Else
020900110418     C                   Exsr      EndPgm
021000110418     C                   EndIf
021100110418     C*
021200000000     C                   EndSr
021300000000     C************************************************************
021400000000     C* Elabora Errori
021500000000     C************************************************************
021600000000     C     ElaErrori     BEGSR
021700000000     C*
021800000000     C*                  Select
021900000000     C*
022000000000     C*                  When      Errore        ='1'
022100000000     C*  OF              Except    TESTA
022200000000     C*  OF              Setoff                                       OF
022300000000     C*                  Except    Staerr1
022400000000     C*
022500000000     C*                  When      Errore        ='2'
022600000000     C*  OF              Except    TESTA
022700000000     C*  OF              Setoff                                       OF
022800000000     C*                  Except    Staerr2
022900000000     C*
023000000000     C*                  EndSl
023100000000     C*
023200000000     C                   EndSr
023300000000     C************************************************************
023400000000     O*QSYSPRT   E            TESTA            02
023500000000     O*                                          35 '***---'
023600000000     O*                                        +  0 '------------------------'
023700000000     O*                                        +  0 '------------------------'
023800000000     O*                                        +  0 '--***'
023900000000     O*         E            TESTA            03
024000000000     O*                                          35 '***---'
024100000000     O*                                        +  0 '              Conti part'
024200000000     O*                                        +  0 'ite verso SAP          -'
024300000000     O*                                        +  0 '--***'
024400000000     O*         E            TESTA            04
024500000000     O*                                          35 '***---'
024600000000     O*                                        +  0 '------------------------'
024700000000     O*                                        +  0 '------------------------'
024800000000     O*                                        +  0 '--***'
024900000000     O*         E            StaErr1     1
025000000000     O*                      CodSoc099           +2
025100000000     O*                      CodKSC099           +2
025200000000     O*                      StatoSogg           +2
025300000000     O*                                          +2 'Stato non in G12        '
025400000000     O*         E            StaErr2     1
025500000000     O*                      CodSoc099           +2
025600000000     O*                      CodKSC099           +2
025700000000     O*                                          +2 'Tipo appoggio'
025800000000     O*                      CodTpA099           +2
025900000000     O*                                          +2 'Non trovata coordinata  '
