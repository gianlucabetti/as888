000100060511     H DFTACTGRP(*NO) ACTGRP('YPNFILMDLL') BNDDIR('PJXBND')
000200060320     H DATEDIT(*YMD) DECEDIT(*JOBRUN)
000300060320
000400060511      //********************************************************************************************
000500060511      //
000600060511      // Definizione costanti.
000700060511      //
000800060511      //********************************************************************************************
000900060210     D LckLvlChg       C                   '1'
001000060210     D LckLvlAll       C                   '2'
001100060210     D CmtScopeActGrp  C                   '1'
001200060213     D F3              C                   X'33'
001300060214     D F6              C                   X'36'
001400060214     D F12             C                   X'3C'
001500060213     D Enter           C                   X'F1'
001600060407
001700060511      //********************************************************************************************
001800060511      //
001900060511      // Definizione delle procedure esterne usate.
002000060511      //
002100060511      //********************************************************************************************
002200060209     D xSoc            PR
002300060209     D                                     EXTPROC('XSOC')
002400060209     D  tipXsc                        6
002500060209     D                                     CONST
002600060209     D  socXsc
002700060209     D                                     LIKE(xscSoc)
002800060209     D  cdsXsc                        9  0
002900060209     D                                     CONST
003000060209     D  modXsc                        3
003100060209     D                                     CONST
003200060209     D  rtnXsc                        1
003300060214     D  xSoc001ds
003400060214     D                                     LIKEDS(xSoc001ds)
003500060209     D  kpjba
003600060209     D                                     LIKEDS(kpjba)
003700060214     D xStrCmt         PR
003800060214     D                                     EXTPROC('XSTRCMT')
003900060214     D  lckLvl                        1                                         Livello vincolo
004000060214     D                                     CONST
004100060214     D  cmtScope                      1                                         Ambito definizione s
004200060214     D                                     CONST
004300060214     D xChkAut         PR
004400060214     D                                     EXTPROC('XCHKAUT')
004500060214     D  xChkAutDS
004600060214     D                                     LIKEDS(xChkAutDS)
004700060214     D tibs34r         PR
004800060214     D                                     EXTPGM('TIBS34R')
004900060214     D  tibs34ds
005000060214     D                                     LIKEDS(tibs34ds)
005100060511     D ycow0410r       PR
005200060511     D                                     EXTPGM('YCOW0410R')
005300060213     D  kpjba
005400060213     D                                     LIKEDS(kpjba)
005500060511     D ycow0420r       PR
005600060511     D                                     EXTPGM('YCOW0420R')
005700060201     D  kpjba
005800060201     D                                     LIKEDS(kpjba)
005900060407
006000060511      //********************************************************************************************
006100060511      //
006200060511      // Definizione strutture dati.
006300060511      //
006400060511      //********************************************************************************************
006500060201     D kpjba         E DS
006600060214     D xSoc001DS     E DS
006700060201     D                                     INZ
006800060214     D xChkAutDS     E DS
006900060214     D                                     INZ
007000060214     D  xcaFnc       E
007100060407     D                                     INZ('YPNFIL')
007200060214     D  xcaVfu       E
007300060511     D                                     INZ('GESTIONEMODELLI')
007400060214     D  xcaTck       E
007500060214     D                                     INZ('CK')
007600060214     D  xcaNau       E
007700060214     D                                     INZ('1')
007800060214     D tibs34ds      E DS
007900060214     D                                     INZ
008000060511     D ycow0400s     E DS
008100060201     D                                     INZ
008200060511     D                                     QUALIFIED
008300060511     D  opCode       E
008400060511     D                                     INZ('GESTIONE')
008500060511     D  setOnLR      E
008600060511     D                                     INZ(*ON)
008700060511     D ycow0410s     E DS
008800060511     D                                     INZ
008900060511     D                                     QUALIFIED
009000060201
009100060511      //********************************************************************************************
009200060511      //
009300060511      // Definizione variabili.
009400060511      //
009500060511      //********************************************************************************************
009600060209     D nullPtr         S               *
009700060209     D esito           S             10I 0
009800060209     D rtnXsc          S              1A
009900060214     D opCode          S             10A
010000060214     D                                     INZ('FILTRO')
010100060407
010200060511      //********************************************************************************************
010300060511      //
010400060511      // Definizione aree dati.
010500060511      //
010600060511      //********************************************************************************************
010700060214     D §azute        E DS
010800060214     D                                     EXTNAME(azute00f)
010900060214     D                                     DTAARA
011000060214     D §DatiUte      E DS
011100060214     D                                     EXTNAME(dDatiUte)
011200060214     D                                     DTAARA
011300060407
011400060511      //********************************************************************************************
011500060511      //
011600060511      // Definizione parametri procedura.
011700060511      //
011800060511      //********************************************************************************************
011900060201     C     *ENTRY        PLIST
012000060201     C                   PARM                    kpjba
012100060201
012200060201      /FREE
012300060209
012400060209       EXSR inzProc;
012500060213
012600060213       DOU opCode = 'END';
012700060213         SELECT;
012800060213           WHEN opCode = 'FILTRO';
012900060511             opCode = 'GESTIONE';
013000060213             EXSR filtro;
013100060511           WHEN opCode = 'GESTIONE';
013200060511             opCode = 'END';
013300060511             EXSR gestione;
013400060511           WHEN opCode = 'END';
013500060511             LEAVE;
013600060213           OTHER;
013700060213             LEAVE;
013800060213         ENDSL;
013900060213       ENDDO;
014000060209
014100060214       EXSR uscita;
014200060407
014300060407       //*******************************************************************************************
014400060407       //
014500060407       // Operazioni iniziali.
014600060407       //
014700060407       //*******************************************************************************************
014800060407       BEGSR *INZSR;
014900060407
015000060511         IN(E) §azute;
015100060511         IF NOT %ERROR;
015200060511           IN(E) §DatiUte;
015300060511         ENDIF;
015400060511         IF %ERROR OR rsut = ' ';
015500060511           tibs34r(tibs34ds);
015600060511           IN §azute;
015700060511           IN §DatiUte;
015800060511         ENDIF;
015900060511
016000060511         xStrCmt(LckLvlChg:CmtScopeActGrp);
016100060407
016200060407       ENDSR;
016300060201
016400060201       //*******************************************************************************************
016500060201       //
016600060201       // Operazioni iniziali.
016700060201       //
016800060201       //*******************************************************************************************
016900060201       BEGSR inzProc;
017000060201
017100060407         RESET opCode;
017200060407
017300060511         EXSR chkParm;
017400060511
017500060314         MONITOR;
017600060407           xSoc('SOC001':xscSoc:0:*BLANK:rtnXsc:xSoc001ds:kpjba);
017700060314           ON-ERROR;
017800060407             opCode = 'END';
017900060407             LEAVESR;
018000060314         ENDMON;
018100060314         IF rtnXsc = *ON;
018200060407           opCode = 'END';
018300060407           LEAVESR;
018400060209         ENDIF;
018500060209
018600060214         RESET xChkAutDS;
018700060214         xcaSoc = xscSoc;
018800060214         xcaGrp = xscGrp;
018900060214         xcaPrf = knmus;
019000060314         MONITOR;
019100060314           xChkAut(xChkAutDS);
019200060314           ON-ERROR;
019300060407             opCode = 'END';
019400060407             LEAVESR;
019500060314         ENDMON;
019600060314         IF xcaRtn = 1;
019700060407           opCode = 'END';
019800060407           LEAVESR;
019900060214         ENDIF;
020000060201
020100060201       ENDSR;
020200060511
020300060511       //*******************************************************************************************
020400060511       //
020500060511       // Controllo parametri ricevuti.
020600060511       //
020700060511       //*******************************************************************************************
020800060511       BEGSR chkParm;
020900060511
021000060511         IF kpjbu <> ' ';
021100060511           ycow0400s = kpjbu;
021200060511         ENDIF;
021300060511
021400060511       ENDSR;
021500060213
021600060213       //*******************************************************************************************
021700060213       //
021800060511       // Emissione finestra di filtro.
021900060213       //
022000060213       //*******************************************************************************************
022100060213       BEGSR filtro;
022200060213       ENDSR;
022300060214
022400060214       //*******************************************************************************************
022500060214       //
022600060511       // Emissione finestra gestione modelli.
022700060214       //
022800060214       //*******************************************************************************************
022900060511       BEGSR gestione;
023000060214
023100060511         kpjbu = ycow0400s + ycow0410s;
023200060511         ycow0420r(kpjba);
023300060511         ycow0400s = kpjbu;
023400060214
023500060214         SELECT;
023600060511           WHEN ycow0400s.rtnCode = 'DONE';
023700060511             SELECT;
023800060511               WHEN ycow0400s.rtnCmd = F3;
023900060511                 opCode = 'END';
024000060511               WHEN ycow0400s.rtnCmd = F6;
024100060511                 opCode = 'END';
024200060511               WHEN ycow0400s.rtnCmd = F12;
024300060511                 opCode = 'END';
024400060511             ENDSL;
024500060214           OTHER;
024600060511             opCode = 'END';
024700060214         ENDSL;
024800060214
024900060214       ENDSR;
025000060214
025100060214       //*******************************************************************************************
025200060214       //
025300060511       // Operazioni finali.
025400060214       //
025500060214       //*******************************************************************************************
025600060214       BEGSR uscita;
025700060214
025800060511         IF ycow0400s.opCode = ' ';
025900060511           ycow0400s.opCode = 'DONE';
026000060511         ENDIF;
026100060511
026200060511         kpjbu = ycow0400s;
026300060214         EVAL *INLR = *ON;
026400060214         RETURN;
026500060214
026600060214       ENDSR;
026700060201
026800060201      /END-FREE
026900060201
