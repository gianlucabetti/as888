000100970526     H*------------------------------------------------------------------------*
000200020809     H* REPERIMENTO DATI UTENTE
000300970526     H*------------------------------------------------------------------------*
000400970526     H DECEDIT('0,') DATEDIT(*DMY.)
000500970526     F*------------------------------------------------------------------------*
000600970526     F* DATA BASE
000700970526     F*------------------------------------------------------------------------*
000800020809     FTIBS671L  UF A E           K DISK
000900970526     D*------------------------------------------------------------------------*
001000970526     D* SCHIERE
001100970526     D*------------------------------------------------------------------------*
001200970526     D*------------
001300020709     D* DS REPERIMENTO DATI UTENTE
001400970526     D*------------
001500020709     D TIBS34DS      E DS
001600020709     D DDATIUTE      E DS
001700020809     D AZUTE00F      E DS
001800970526     C*------------------------------------------------------------------------*
001900970526     C* MAIN LINES
002000970526     C*------------------------------------------------------------------------*
002100020809     C*
002200020809     C* VERIFICO SE X RICHIESTA CORRENTE ESISTE GIA' RECORD SUL FILE
002300020809     C                   EXSR      DELUTE
002400020809     C*
002500020809     C* REPERISCO I DATI UTENTE
002600020809     C                   EXSR      REPDATIUTE
002700020809     C*
002800020809     C* SCRITTURA DEL FILE DI RISULTATO
002900020809     C                   EXSR      WRIUTE
003000970526     C*
003100020809     C                   SETON                                        LR
003200020809     C*------------------------------------------------------------------------*
003300020809     C* DELUTE - CANCELLA RECORD GIA' ESISTENTE X RICHIESTA CORRENTE
003400020809     C*------------------------------------------------------------------------*
003500020809     C     DELUTE        BEGSR
003600020809     C*
003700020809     C                   EVAL      W67USR = PARUSR
003800020809     C                   EVAL      W67UTE = PARUTE
003900020809     C                   EVAL      W67SIF = PARSIF
004000020809     C*
004100020809     C     KEY67L        CHAIN     TIBS671L
004200020809     C                   IF        %found(TIBS671L)
004300020809     C                   DELETE    TIBS671L
004400020809     C                   ENDIF
004500020809     C*
004600020809     C                   ENDSR
004700020809     C*------------------------------------------------------------------------*
004800020809     C* WRIUTE - SCRIVE RECORD DEL RISULTATO
004900020809     C*------------------------------------------------------------------------*
005000020809     C     WRIUTE        BEGSR
005100020809     C*
005200020809     C* IMPOSTO CAMPI DI WRK SUL FILE
005300020809     C                   EVAL      W67USR = PARUSR
005400020809     C                   EVAL      W67UTE = PARUTE
005500020809     C                   EVAL      W67SIF = PARSIF
005600020809     C*
005700020809     C                   WRITE     BS67000
005800020809     C*
005900020809     C                   ENDSR
006000020809     C*------------------------------------------------------------------------*
006100020809     C* REPDATIUTE - ROUTINE DI REPERIMENTO DATI RELATIVI ALL'UTENTE
006200020809     C*------------------------------------------------------------------------*
006300020809     C     REPDATIUTE    BEGSR
006400020809     C*
006500020809     C* INIZIALIZZO IL FORMATO DEL RECORD
006600020809     C                   CLEAR                   AZUTE00F
006700020809     C                   CLEAR                   DDATIUTE
006800020809     C                   CLEAR                   TIBS34DS
006900020809     C                   CLEAR                   BS67000
007000020809     C*
007100020809     C                   IF        PARTLA = 'S'
007200020809     C                   EVAL      I34TLA = 'L'
007300020809     C                   EVAL      I34DTA = PARTLA
007400020809     C                   EVAL      I34UTE = PARUTE
007500020809     C                   CALL      'TIBS34R'
007600020809     C                   PARM                    TIBS34DS
007700020809     C                   EVAL      W67ERR = O34ERR
007800020809     C*
007900020809     C                   ELSE
008000020809     C*
008100020809     C* REPERIMENTO DATI UTENTE
008200020809     C     *DTAARA       DEFINE    §azute        AZUTE00F
008300020809     C     *DTAARA       DEFINE    §datiute      DDATIUTE
008400020809     C                   IN(E)     *DTAARA
008500020809     C                   IF        %Error
008600020809     C                   CALL      'TIBS34R'
008700020809     C                   PARM                    TIBS34DS
008800020809     C                   IN        *DTAARA
008900020809     C                   EVAL      W67ERR = DUTERR
009000020809     C                   ENDIF
009100020809     C                   ENDIF
009200020809     C*
009300020809     C                   ENDSR
009400970526     C*------------------------------------------------------------------------*
009500000307     C* *INZSR - OPERAZIONI INIZIALI
009600970526     C*------------------------------------------------------------------------*
009700970526     C     *INZSR        BEGSR
009800970526     C*---
009900970526     C* RICEVIMENTO PARAMETRI
010000970526     C*---
010100970526     C     *ENTRY        PLIST
010200020809     C                   PARM                    PARTLA            1
010300020809     C                   PARM                    PARUTE           10
010400020809     C                   PARM                    PARSIF           10
010500020809     C                   PARM                    PARUSR           10
010600970526     C*---
010700970526     C* CHIAVI DI LETTURA
010800970526     C*---
010900020809     C* LETTURA TIBS671L
011000020809     C     KEY67L        KLIST
011100020809     C                   KFLD                    W67USR
011200020809     C                   KFLD                    W67UTE
011300020809     C                   KFLD                    W67SIF
011400970526     C*
011500970526     C                   ENDSR
