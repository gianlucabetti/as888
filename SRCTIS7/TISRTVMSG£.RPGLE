000100060515      //********************************************************************************************
000200060515      //
000300060515      // Questo programma restituisce il testo di 1o e 2o livello di un messaggio in lingua.
000400060515      //
000500060515      //********************************************************************************************
000600060515     H DFTACTGRP(*NO) ACTGRP(*CALLER)
000700060515
000800060515      //********************************************************************************************
000900060515      //
001000060515      // Definizione costanti.
001100060515      //
001200060515      //********************************************************************************************
001300060515     D Italiano        C                   'it'
001400060515     D Inglese         C                   'en'
001500060515     D Francese        C                   'fr'
001600060515     D Tedesco         C                   'de'
001700060516     D MsgFileItaliano...
001800060516     D                 C                   'TIS_IT'
001900060516     D MsgFileInglese...
002000060516     D                 C                   'TIS_EN'
002100060516     D MsgFileFrancese...
002200060516     D                 C                   'TIS_FR'
002300060516     D MsgFileTedesco...
002400060516     D                 C                   'TIS_DE'
002500060516     D MsgFileLibItaliano...
002600060516     D                 C                   '*LIBL'
002700060516     D MsgFileLibInglese...
002800060516     D                 C                   '*LIBL'
002900060516     D MsgFileLibFrancese...
003000060516     D                 C                   '*LIBL'
003100060516     D MsgFileLibTedesco...
003200060516     D                 C                   '*LIBL'
003300060516     D FileMessaggiNonTrovato...
003400060516     D                 C                   'CPF2407'
003500060516     D IdMessaggioNonTrovato...
003600060516     D                 C                   'CPF2419'
003700060515
003800060515      //********************************************************************************************
003900060515      //
004000060515      // Definizione procedure usate.
004100060515      //
004200060515      //********************************************************************************************
004300060515     D trulrmsg1...
004400060515     D                 PR                                                       Reperisce la
004500060515     D                                     EXTPGM('TRULRMSG1')                  descrizione di un
004600060515     D                                                                          messaggio
004700060515     D  msgId...
004800060515     D                                7A
004900060515     D  msgFile...
005000060515     D                               10A
005100060515     D  msgFileLib...
005200060515     D                               10A
005300060515     D  msgDta...
005400060515     D                              512A
005500060515     D  msg...
005600060516     D                              644A
005700060515     D  secLvl...
005800060516     D                             3512A
005900060515     D  rtnCode...
006000060515     D                               10A
006100060515     D  esito...
006200060516     D                               15P 0
006300060515
006400060515      //********************************************************************************************
006500060515      //
006600060515      // Definizione variabili.
006700060515      //
006800060515      //********************************************************************************************
006900060515     D linguaISO2...
007000060515     D                 S              2A
007100060515     D msgId...
007200060515     D                 S              7A
007300060515     D msgFile...
007400060515     D                 S             10A
007500060516     D                                     INZ(MsgFileItaliano)
007600060515     D msgFileLib...
007700060515     D                 S             10A
007800060516     D                                     INZ(MsgFileLibItaliano)
007900060515     D msgDta...
008000060515     D                 S            512A
008100060515     D msg...
008200060516     D                 S            644A
008300060515     D secLvl...
008400060516     D                 S           3512A
008500060515     D rtnCode...
008600060515     D                 S             10A
008700060515     D esito...
008800060516     D                 S             15P 0
008900060515
009000060515      //********************************************************************************************
009100060515      //
009200060515      // Definizione parametri.
009300060515      //
009400060515      //********************************************************************************************
009500060515     C     *ENTRY        PLIST
009600060515     C                   PARM                    linguaISO2                     Id lingua ISO 2
009700060515     C                   PARM                    msgId                          Id messaggio
009800060515     C                   PARM                    msgDta                         Valori campi dati me
009900060515     C                   PARM                    msg                            Testo 1o livello
010000060515     C                   PARM                    secLvl                         Testo 2o livello
010100060515     C                   PARM                    rtnCode                        Codice di ritorno
010200060515     C                   PARM                    esito                          Esito
010300060516
010400060515      /FREE
010500060516
010600060515       EXSR chkParm;
010700060516
010800060516       EXSR setMsgFile;
010900060515       EXSR rtvMsg;
011000060516
011100060516       // Se non trovo il messaggio o il file dei messaggi, ritento con lingua italiano.
011200060516       IF (rtnCode = IdMessaggioNonTrovato
011300060516       OR rtnCode = FileMessaggiNonTrovato) AND linguaISO2 <> Italiano;
011400060516         linguaISO2 = Italiano;
011500060516         EXSR setMsgFile;
011600060516         EXSR rtvMsg;
011700060516       ENDIF;
011800060516
011900060515       EXSR uscita;
012000060515
012100060515       //*******************************************************************************************
012200060515       //
012300060515       // Controllo parametri ricevuti.
012400060515       //
012500060515       //*******************************************************************************************
012600060515       BEGSR chkParm;
012700060516
012800060515         RESET msg;
012900060515         RESET secLvl;
013000060515         RESET esito;
013100060515         RESET rtnCode;
013200060516
013300060515         IF msgId = *BLANK;
013400060515           esito = -1;
013500060515           rtnCode = 'ERRORE';
013600060515           EXSR uscita;
013700060515         ENDIF;
013800060516
013900060515       ENDSR;
014000060516
014100060516       //*******************************************************************************************
014200060516       //
014300060516       // Imposto il file messaggi da usare.
014400060516       //
014500060516       //*******************************************************************************************
014600060516       BEGSR setMsgFile;
014700060516
014800060516         SELECT;
014900060516           WHEN linguaISO2 = Italiano;
015000060516             msgFile = MsgFileItaliano;
015100060516             msgFileLib = MsgFileLibItaliano;
015200060516           WHEN linguaISO2 = Inglese;
015300060516             msgFile = MsgFileInglese;
015400060516             msgFileLib = MsgFileLibInglese;
015500060516           WHEN linguaISO2 = Francese;
015600060516             msgFile = MsgFileFrancese;
015700060516             msgFileLib = MsgFileLibFrancese;
015800060516           WHEN linguaISO2 = Tedesco;
015900060516             msgFile = MsgFileTedesco;
016000060516             msgFileLib = MsgFileLibTedesco;
016100060516           OTHER;
016200060516             linguaISO2 = Italiano;
016300060516             msgFile = MsgFileItaliano;
016400060516             msgFileLib = MsgFileLibItaliano;
016500060516         ENDSL;
016600060516
016700060516       ENDSR;
016800060515
016900060515       //*******************************************************************************************
017000060515       //
017100060515       // Reperisco il messaggio.
017200060515       //
017300060515       //*******************************************************************************************
017400060515       BEGSR rtvMsg;
017500060516
017600060516         trulrmsg1(msgId:msgFile:msgFileLib:msgDta:msg:secLvl:rtnCode:esito);
017700060516
017800060515       ENDSR;
017900060515
018000060515       //*******************************************************************************************
018100060515       //
018200060515       // Uscita dal programma.
018300060515       //
018400060515       //*******************************************************************************************
018500060515       BEGSR uscita;
018600060516
018700060516         IF rtnCode = *BLANK;
018800060516           rtnCode = 'DONE';
018900060516         ENDIF;
019000060516
019100060515         RETURN;
019200060516
019300060515       ENDSR;
019400060515
019500060515      /END-FREE
