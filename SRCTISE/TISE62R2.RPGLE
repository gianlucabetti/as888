000100170615       //==============================================================
000200170615       //?TISE62R2 - Conversione campo Packed (parametro in input)     ?
000300170615       //?                    in campo Alfan. (parametro di output)    ?
000400170615       //?            con dentro campo Numerico                        ?
000500170615       //==============================================================
000600170615
000700170615       //--------------------------------------------------------------
000800170615       //?Parametri di compilazione (vedi *cmd UBCRTOBJ).              ?
000900170615       //--------------------------------------------------------------
001000170615
001100170615     /*PRM dbgview(*source)
001200170615     /*END
001300170615
001400170615       //--------------------------------------------------------------
001500170615       //?Specifiche di controllo.                                     ?
001600170615       //--------------------------------------------------------------
001700170615
001800170615     h decedit('0,') datedit(*dmy/) option(*nodebugio)
001900170615     h dftactgrp(*no)
002000170615
002100170615       //--------------------------------------------------------------
002200170615       //?Dichiarazione file.                                          ?
002300170615       //--------------------------------------------------------------
002400170615
002500170615
002600170615       //--------------------------------------------------------------
002700170615       //?Definizione costanti.                                        ?
002800170615       //--------------------------------------------------------------
002900170615
003000170615
003100170615       //--------------------------------------------------------------
003200170615       //?Definizione schiere.                                         ?
003300170615       //--------------------------------------------------------------
003400170615
003500170615
003600170615       //--------------------------------------------------------------
003700170615       //?Definizione aree dati.                                       ?
003800170615       //--------------------------------------------------------------
003900170615
004000170615
004100170615       //--------------------------------------------------------------
004200170615       //?Definizione strutture dati.                                  ?
004300170615       //--------------------------------------------------------------
004400170615
004500170615     d ds_Packed       ds                  qualified
004600170615     d                                     inz
004700170615     d   wPacked                     15p 0 inz
004800170615
004900170615       //--------------------------------------------------------------
005000170615       //?Definizione variabili globali.                               ?
005100170615       //--------------------------------------------------------------
005200170615
005300170615       // -?Parametro con campo Packed?
005400170615     d prm_Input       s              8a
005500170615       // -?Parametro con campo Zoned?
005600170615     d prm_Output      s             15
005700170615
005800170615       // -?Campi numerici di lavoro?
005900170615     d wZoned          s             15s 0 inz
006000170615     d wLen            s              5  0 inz
006100170615
006200170615       //--------------------------------------------------------------
006300170615       //?Definizione prototipi procedure.                             ?
006400170615       //--------------------------------------------------------------
006500170615
006600170615
006700170615       //--------------------------------------------------------------
006800170615       //?Definizione key-list.                                        ?
006900170615       //--------------------------------------------------------------
007000170615
007100170615
007200170615       //--------------------------------------------------------------
007300170615       //?M A I N - L I N E                                            ?
007400170615       //--------------------------------------------------------------
007500170615
007600170615     c     *Entry        plist
007700170615     c                   parm                    prm_Input
007800170615     c                   parm                    prm_Output
007900170615
008000170615      /free
008100170615
008200170615       // -?Operazioni iniziali?
008300170615       exsr  sr_RoutInz;
008400170615
008500170615       // -?Conversione campo numerico Packed in campo numerico Zoned?
008600170615       exsr  sr_Conversione;
008700170615
008800170615       // -?Operazioni finali?
008900170615       exsr sr_RoutEnd;
009000170615
009100170615       //--------------------------------------------------------------
009200170615       //?Operazioni iniziali.                                         ?
009300170615       //--------------------------------------------------------------
009400170615       BEGSR  sr_RoutInz;
009500170615
009600170615         // -?Impostazione chiusura?
009700170615         *inLR = *on;
009800170615
009900170615       ENDSR;
010000170615
010100170615       //--------------------------------------------------------------
010200170615       //?Conversione da campo numerico Packed in campo numerico Zoned.?
010300170615       //--------------------------------------------------------------
010400170615       BEGSR  sr_Conversione;
010500170615
010600170615         clear  prm_Output;
010700170615         clear  wZoned;
010800170615         clear  ds_Packed.wPacked;
010900170615
011000170615         wLen = %len( %trim( prm_Input ) );
011100170615
011200170615         Monitor;
011300170615
011400170615           %subst( ds_Packed : %size( ds_Packed ) - wLen + 1 )
011500170615              = %trim( prm_Input );
011600170615           wZoned    = %int( ds_Packed.wPacked );
011700170615
011800170615         On-Error;
011900170615           clear  wZoned;
012000170615
012100170615         EndMon;
012200170615
012300170615         prm_Output = %trim( %editc( wZoned : '3' ) );
012400170615
012500170615       ENDSR;
012600170615
012700170615       //--------------------------------------------------------------
012800170615       //?Operazioni finali.                                           ?
012900170615       //--------------------------------------------------------------
013000170615       BEGSR  sr_RoutEnd;
013100170615
013200170615         // -?Uscita dal *pgm?
013300170615         return;
013400170615
013500170615       ENDSR;
