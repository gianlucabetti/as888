000100970526     H*------------------------------------------------------------------------*
000200970528     H* CAPPARIO - GESTIONE VERSIONI CAP - SCELTA
000300970526     H*------------------------------------------------------------------------*
000400970526     H              J
000500970526     F*------------------------------------------------------------------------*
000600970526     F* DATA BASE
000700970526     F*------------------------------------------------------------------------*
000800970526     FTISI46D CF  E                    WORKSTN      KINFDS DEVDS1
000900970526     F                                        SFLULTKSFILE SI46D05
001000970526     F                                        MSGULTKSFILE SI46DMS
001100970526     F*------------
001200970526     F* VERSIONI
001300970526     F*------------
001400970526     FAZCPR01LIF  E           K        DISK
001500970526     FAZCPR02LIF  E           K        DISK
001600970526     F            AZCPR000                          KRENAMEAZCPR2
001700970526     E*------------------------------------------------------------------------*
001800970526     E* SCHIERE
001900970526     E*------------------------------------------------------------------------*
002000970526     E*------------
002100970526     E* DECODIFICHE
002200970526     E*------------
002300970526     E                    DEC     1   5 66
002400970526     E*------------
002500970526     E* MESSAGGI
002600970526     E*------------
002700970526     E                    MSG     1  20 78
002800970526     E*------------
002900970526     E* COMANDI
003000970526     E*------------
003100970526     E                    CMD     1   5 80
003200970526     E*------------
003300970526     E* DESCRIZIONI OPZIONI
003400970526     E*------------
003500970526     E                    OPD     1  24 80
003600970526     E*------------
003700970526     E* DESCRIZIONI TASTI FUNZIONALI
003800970526     E*------------
003900970526     E                    FUD     1  24 80
004000970526     E*------------
004100970526     E* OPZIONI DA CARICARE A VIDEO
004200970526     E*------------
004300970526     E                    OPV        24 19
004400970526     E*------------
004500970526     E* FUNZIONI DA CARICARE A VIDEO
004600970526     E*------------
004700970526     E                    FUV        24 19
004800970526     I*------------------------------------------------------------------------*
004900970526     I* INPUT
005000970526     I*------------------------------------------------------------------------*
005100970526     I*------------
005200970526     I* RIDEFINIZIONE OPZIONI VIDEO
005300970526     I*------------
005400970526     IOPDDS       DS
005500970526     I                                        1   2 OPDOPZ
005600970526     I                                        3  19 OPDDE1
005700970526     I                                       21  22 OPDOP1
005800970526     I                                       23  34 OPDFI0
005900970526     I                                       35  35 OPDATT
006000970526     I                                       36  80 OPDFI1
006100970526     I                                        1  19 OPDDES
006200970526     I                                        1  80 OPDRIG
006300970526     I*------------
006400970526     I* RIDEFINIZIONE FUNZIONI VIDEO
006500970526     I*------------
006600970526     IFUDDS       DS
006700970526     I                                        1   1 FUDDE1
006800970526     I                                        2   3 FUDFUN
006900970526     I                                        4  19 FUDDE2
007000970526     I                                       20  34 FUDFI0
007100970526     I                                       35  35 FUDATT
007200970526     I                                       36  80 FUDFI1
007300970526     I                                        1  19 FUDDES
007400970526     I                                        1  80 FUDRIG
007500970526     I*------------
007600970526     I* DS GESTIONE TASTI FUNZIONALI
007700970526     I*------------
007800970526     IDSKEY     E DS
007900970526     IDEVDS1      DS
008000970526     I                                      369 369 KEY
008100970526     I*------------
008200970526     I* DS "XMSG" - GESTIONE MESSAGGI
008300970526     I*------------
008400970526     IDSMSG     E DS
008500970526     I*------------
008600970526     I* DS "XFIL" - REPERIMENTO DATI UTENTE
008700970526     I*------------
008800970526     IDSFIL     E DS
008900970526     I*------------------
009000970526     I* DS "XSRDA8" - CONTROLLA DATA (8)
009100970526     I*------------------
009200970526     IWLBDA8     IDS
009300970526     I                                        1   80G08DAT
009400970526     I                                        9  160G08INV
009500970526     I                                       17  17 G08ERR
009600970526     I                                       18  220G08TGI
009700970526     I*------------
009800970526     I* DS DI PROCEDURA
009900970526     I*------------
010000970526     IDSSI00    E DSTISI00DS
010100970526     I*------------
010200970526     I* ARCHITETTURA
010300970526     I*------------
010400970526     IKPJBA     E DS
010500970715     I                                        1   3 UTENTE
010600970526     C*------------------------------------------------------------------------*
010700970526     C* MAIN LINES
010800970526     C*------------------------------------------------------------------------*
010900970526     C*
011000970526     C* SE NON CI SONO ERRORI, PROSEGUE
011100970526IF  1C           ERRL00    IFNE '1'
011200970526     C*
011300970526     C* CARICA IL SFILE
011400970526     C                     EXSR POSSFL
011500970526     C*
011600970526     C* CICLO FINO A CHE NON VIENE PREMUTO F03 O F12
011700970526DO  2C           F03L00    DOUEQ'1'                        *F03 PREMUTO
011800970526     C           F12L00    OREQ '1'                        *F12 PREMUTO
011900970526     C           FINL00    OREQ '1'                        *FINE PGM
012000970526     C*
012100970526     C* REIMPOSTA ERRORE DI PROCERURA
012200970526     C                     MOVEL'0'       ERRL00
012300970526     C*
012400970526     C* EMETTE IL SFILE
012500970526     C                     EXSR OUTSFL
012600970526     C*
012700970526     C* GESTIONE TASTI FUNZIONALI
012800970526     C                     EXSR FUNCON
012900970526     C*
013000970526E   2C                     ENDDO
013100970526E   1C                     ENDIF
013200970526     C* FINE PGM
013300970526     C                     SETON                     LR
013400970526     C*------------------------------------------------------------------------*
013500970526     C* F03GES - GESTIONE F03 -> FINE PROGRAMMA
013600970526     C*------------------------------------------------------------------------*
013700970526     C           F03GES    BEGSR
013800970526     C*
013900970526     C* IMPOSTA "PREMUTO F03"
014000970526     C                     MOVEL'1'       F03L00           *A PROGRAMMA
014100970526     C                     MOVEL'1'       D00F03           *DI PROCEDURA
014200970526     C*
014300970526     C                     ENDSR
014400970526     C*------------------------------------------------------------------------*
014500970526     C* F05GES - GESTIONE F05 -> RIVISUALIZZA
014600970526     C*------------------------------------------------------------------------*
014700970526     C           F05GES    BEGSR
014800970526     C*
014900970526     C                     EXSR POSSFL                     *RICARICA SFILE
015000970526     C*
015100970526     C                     ENDSR
015200970526     C*------------------------------------------------------------------------*
015300970526     C* F06GES - GESTIONE F06 -> INSERIMENTO
015400970526     C*------------------------------------------------------------------------*
015500970526     C           F06GES    BEGSR
015600970526     C*
015700970526     C* INSERIMENTO CONSENTITO SOLO IN SEDE
015800970526IF  1C           DSFITI    IFNE 'S'
015900970526     C                     MOVEL'1'       ERRL00
016000970526     C                     MOVELMSG,3     DSMSMS
016100970526E   1C                     ENDIF
016200970526     C*
016300970526IF  1C           ERRL00    IFEQ '0'                        *NO ERRORI
016400970602     C                     Z-ADD*ZEROS    DDRI
016500970602     C                     Z-ADD*ZEROS    DVER
016600970529     C                     MOVELDEPOP0    WOP0
016700970529     C                     MOVEL'F06'     WOP1
016800970526     C                     MOVEL'TISI47R' WPGM    8
016900970526     C                     EXSR LANPGM                     *LANCIA PGM
017000970526     C                     EXSR POSSFL                     *RICARICA SFILE
017100970526E   1C                     ENDIF
017200970526     C*
017300970526     C                     ENDSR
017400970528     C*------------------------------------------------------------------------*
017500970528     C* F08GES - GESTIONE F08 -> GESTIONE LOCALITA'
017600970528     C*------------------------------------------------------------------------*
017700970528     C           F08GES    BEGSR
017800970528     C*
017900980225     C                     Z-ADDULTDRI    DDRI
018000980225     C                     Z-ADDULTVER    DVER
018100970528     C                     MOVELDEPOP0    WOP0
018200970528     C                     MOVEL'L'       WOP0
018300970528     C                     MOVEL'F08'     WOP1
018400970528     C                     MOVEL'TISI30R' WPGM    8
018500970528     C                     EXSR LANPGM
018600970528     C*
018700970528     C                     ENDSR
018800970528     C*------------------------------------------------------------------------*
018900970528     C* F09GES - GESTIONE F09 -> ECCEZIONI LINEE/ZONE
019000970528     C*------------------------------------------------------------------------*
019100970528     C           F09GES    BEGSR
019200970528     C*
019300980225     C                     Z-ADDULTDRI    DDRI
019400980225     C                     Z-ADDULTVER    DVER
019500970528     C                     MOVELDEPOP0    WOP0
019600970528     C                     MOVEL'E'       WOP0
019700970528     C                     MOVEL'F09'     WOP1
019800970528     C                     MOVEL'TISI11R' WPGM    8
019900970528     C                     EXSR LANPGM
020000970528     C*
020100970528     C                     ENDSR
020200970528     C*------------------------------------------------------------------------*
020300970528     C* F10GES - GESTIONE F10 -> TEMPI DI CONSEGNA
020400970528     C*------------------------------------------------------------------------*
020500970528     C           F10GES    BEGSR
020600970528     C*
020700980225     C                     Z-ADDULTDRI    DDRI
020800980225     C                     Z-ADDULTVER    DVER
020900970528     C                     MOVELDEPOP0    WOP0
021000970528     C                     MOVEL'T'       WOP0
021100970528     C                     MOVEL'F10'     WOP1
021200970528     C                     MOVEL'TISI41R' WPGM    8
021300970528     C                     EXSR LANPGM
021400970528     C*
021500970528     C                     ENDSR
021600970528     C*------------------------------------------------------------------------*
021700970528     C* F11GES - GESTIONE F11 -> CAP
021800970528     C*------------------------------------------------------------------------*
021900970528     C           F11GES    BEGSR
022000970603     C*
022100980225     C                     Z-ADDULTDRI    DDRI
022200980225     C                     Z-ADDULTVER    DVER
022300970528     C                     MOVELDEPOP0    WOP0
022400970528     C                     MOVEL'C'       WOP0
022500970528     C                     MOVEL'F11'     WOP1
022600970528     C                     MOVEL'TISI02R' WPGM    8
022700970528     C                     EXSR LANPGM
022800970528     C*
022900970528     C                     ENDSR
023000970603     C*------------------------------------------------------------------------*
023100970603     C* F13GES - GESTIONE F13 -> GESTIONE SINONIMI
023200970603     C*------------------------------------------------------------------------*
023300970603     C           F13GES    BEGSR
023400970603     C*
023500980225     C                     Z-ADDULTDRI    DDRI
023600980225     C                     Z-ADDULTVER    DVER
023700970603     C                     MOVELDEPOP0    WOP0
023800970603     C                     MOVEL'S'       WOP0
023900970603     C                     MOVEL'F13'     WOP1
024000970603     C                     MOVEL'TISI35R' WPGM    8
024100970603     C                     EXSR LANPGM
024200970603     C*
024300970603     C                     ENDSR
024400970526     C*------------------------------------------------------------------------*
024500970526     C* F12GES - GESTIONE F12 -> RITORNO
024600970526     C*------------------------------------------------------------------------*
024700970526     C           F12GES    BEGSR
024800970526     C*
024900970526     C* IMPOSTA "PREMUTO F12"
025000970526     C                     MOVEL'1'       F12L00           *A PROGRAMMA
025100970526     C                     MOVEL'1'       D00F12           *DI PROCEDURA
025200970526     C*
025300970526     C                     ENDSR
025400970526     C*------------------------------------------------------------------------*
025500970526     C* F22GES - GESTIONE F22 -> GESTIONE STAMPE
025600970526     C*------------------------------------------------------------------------*
025700970526     C           F22GES    BEGSR
025800970526     C*
025900970526     C                     Z-ADD80        LENGH  155
026000970526     C                     CALL 'QCAEXEC'                  *LANCIA PGM
026100970526     C                     PARM           CMD,1
026200970526     C                     PARM           LENGH
026300970526     C*
026400970526     C                     ENDSR
026500970526     C*------------------------------------------------------------------------*
026600970526     C* F23GES - GESTIONE F23 -> ALTRE OPZIONI
026700970526     C*------------------------------------------------------------------------*
026800970526     C           F23GES    BEGSR
026900970526     C*
027000970526     C                     EXSR OPZGES                     *GESTIONE OPZIONI
027100970526     C*
027200970526     C                     ENDSR
027300970526     C*------------------------------------------------------------------------*
027400970526     C* F24GES - GESTIONE F24 -> ALTRE FUNZIONI
027500970526     C*------------------------------------------------------------------------*
027600970526     C           F24GES    BEGSR
027700970526     C*
027800970526     C                     EXSR FUNGES                     *GESTIONE FUNZIONI
027900970526     C*
028000970526     C                     ENDSR
028100970526     C*------------------------------------------------------------------------*
028200970526     C* RUPGES - GESTIONE RU -> PAGINA SUCCESSIVA
028300970526     C*------------------------------------------------------------------------*
028400970526     C           RUPGES    BEGSR
028500970526     C*
028600970526     C                     EXSR CARSFL                     *LEGGE DATABASE
028700970526     C*
028800970526     C                     ENDSR
028900970526     C*------------------------------------------------------------------------*
029000970526     C* ENTGES - GESTIONE ENTER -> INVIO
029100970526     C*------------------------------------------------------------------------*
029200970526     C           ENTGES    BEGSR
029300970526     C*
029400970526     C* CONTROLLA SE RICHIESTO NUOVO POSIZIONAMENTO
029500970526     C                     EXSR NEWPOS
029600970526     C*
029700970526     C* SWPOSI-> 0=NO NUOVO OSIZIONAMENTO, 1=NUOVO POSIZIONAMENTO
029800970526IF  1C           ERRL00    IFEQ '0'                        *NO ERRORI
029900970526IF  2C           SWPOSI    IFNE 0
030000970526     C                     EXSR POSSFL                     *RICARICA SFILE
030100970526X   2C                     ELSE
030200970526IF  3C           SFLULT    IFNE 0
030300970526     C                     EXSR ENTATT                     *GESTIONE ENTER
030400970526     C*
030500970526     C* SWMODI-> 0=NO RICARICA SFILE, 1=RICARICA SFILE
030600970526IF  4C           SWMODI    IFNE 0
030700970526     C                     EXSR POSSFL
030800970526E   4C                     ENDIF
030900970526E   3C                     ENDIF
031000970526E   2C                     ENDIF
031100970526E   1C                     ENDIF
031200970526     C*
031300970526     C                     ENDSR
031400970526     C*------------------------------------------------------------------------*
031500970526     C* O01GES - GESTIONE OPZIONE 1=SCELTA
031600970526     C*------------------------------------------------------------------------*
031700970526     C           O01GES    BEGSR
031800970526     C*
031900970526     C* RITORNA IL RECORD SELEZIONATO ED ESCE DAL PROGRAMMA
032000970526     C                     Z-ADDVIDVER    D00VER
032100970528     C                     Z-ADDVIHDDE    D00DDE
032200970526     C                     MOVEL'1'       FINL00           *FINE PGM
032300970526     C*
032400970526     C                     ENDSR
032500970526     C*------------------------------------------------------------------------*
032600970526     C* O02GES - GESTIONE OPZIONE 2=MODIFICA
032700970526     C*------------------------------------------------------------------------*
032800970526     C           O02GES    BEGSR
032900970526     C*
033000970526     C* OPERAZIONE NON VALIDA PER RECORD ANNULLATO
033100970526IF  1C           VIDATB    IFEQ 'A'
033200970526     C                     MOVEL'1'       ERRL00
033300970526     C                     MOVELMSG,4     DSMSMS
033400970526E   1C                     ENDIF
033500970526     C* MODIFICA
033600970526IF  1C           ERRL00    IFEQ '0'                        *NO ERRORI
033700970602     C                     Z-ADDVIHDDE    DDRI
033800970602     C                     Z-ADDVIDVER    DVER
033900970529     C                     MOVELDEPOP0    WOP0
034000970526     C                     MOVEL'O02'     WOP1
034100970526     C                     MOVEL'TISI47R' WPGM
034200970526     C                     EXSR LANPGM
034300970528     C*---                 Z-ADD1         SWMODI           *FLAG RICARICA SFL
034400970526E   1C                     ENDIF
034500970526     C*
034600970526     C                     ENDSR
034700970603     C*------------------------------------------------------------------------*
034800970723     C* O03GES - GESTIONE OPZIONE 3=DUPLICA CAPPARIO
034900970603     C*------------------------------------------------------------------------*
035000970603     C           O03GES    BEGSR
035100970603     C*
035200970603     C* OPERAZIONE NON VALIDA PER RECORD ANNULLATO
035300970603IF  1C           VIDATB    IFEQ 'A'
035400970603     C                     MOVEL'1'       ERRL00
035500970603     C                     MOVELMSG,4     DSMSMS
035600970603E   1C                     ENDIF
035700970603     C* DUPLICA
035800970603IF  1C           ERRL00    IFEQ '0'                        *NO ERRORI
035900970603     C                     Z-ADDVIHDDE    DDRI
036000970603     C                     Z-ADDVIDVER    DVER
036100970603     C                     MOVELDEPOP0    WOP0
036200970603     C                     MOVEL'O02'     WOP1
036300970603     C                     MOVEL'TISI48R' WPGM
036400970603     C                     EXSR LANPGM
036500970603     C                     Z-ADD1         SWMODI           *FLAG RICARICA SFL
036600970603E   1C                     ENDIF
036700970603     C*
036800970603     C                     ENDSR
036900970526     C*------------------------------------------------------------------------*
037000970526     C* O04GES - GESTIONE OPZIONE 4=ANNULLAMENTO
037100970526     C*------------------------------------------------------------------------*
037200970526     C           O04GES    BEGSR
037300970526     C*
037400970526     C* OPERAZIONE NON VALIDA PER RECORD ANNULLATO
037500970526IF  1C           VIDATB    IFEQ 'A'
037600970526     C                     MOVEL'1'       ERRL00
037700970526     C                     MOVELMSG,4     DSMSMS
037800970526E   1C                     ENDIF
037900970526     C* ANNULLAMENTO
038000970526IF  1C           ERRL00    IFEQ '0'                        *NO ERRORI
038100970602     C                     Z-ADDVIHDDE    DDRI
038200970602     C                     Z-ADDVIDVER    DVER
038300970529     C                     MOVELDEPOP0    WOP0
038400970526     C                     MOVEL'O04'     WOP1
038500970526     C                     MOVEL'TISI47R' WPGM
038600970526     C                     EXSR LANPGM
038700970528     C*---                 Z-ADD1         SWMODI           *FLAG RICARICA SFL
038800970526E   1C                     ENDIF
038900970526     C*
039000970526     C                     ENDSR
039100970526     C*------------------------------------------------------------------------*
039200970526     C* O05GES - GESTIONE OPZIONE 5=VISUALIZZAZIONE
039300970526     C*------------------------------------------------------------------------*
039400970526     C           O05GES    BEGSR
039500970526     C*
039600970602     C                     Z-ADDVIHDDE    DDRI
039700970602     C                     Z-ADDVIDVER    DVER
039800970529     C                     MOVELDEPOP0    WOP0
039900970526     C                     MOVEL'O05'     WOP1
040000970526     C                     MOVEL'TISI47R' WPGM
040100970526     C                     EXSR LANPGM
040200970526     C*
040300970526     C                     ENDSR
040400970526     C*------------------------------------------------------------------------*
040500970526     C* O07GES - GESTIONE OPZIONE 7=RIPRISTINO
040600970526     C*------------------------------------------------------------------------*
040700970526     C           O07GES    BEGSR
040800970526     C*
040900970526     C* OPERAZIONE NON VALIDA PER RECORD NON ANNULLATO
041000970526IF  1C           VIDATB    IFNE 'A'
041100970526     C                     MOVEL'1'       ERRL00
041200970526     C                     MOVELMSG,5     DSMSMS
041300970526E   1C                     ENDIF
041400970526     C* RIPRISITINO
041500970528IF  1C           ERRL00    IFEQ '0'                        *NO ERRORI
041600970602     C                     Z-ADDVIHDDE    DDRI
041700970602     C                     Z-ADDVIDVER    DVER
041800970529     C                     MOVELDEPOP0    WOP0
041900970526     C                     MOVEL'O07'     WOP1
042000970526     C                     MOVEL'TISI47R' WPGM
042100970526     C                     EXSR LANPGM
042200970526E   1C                     ENDIF
042300970526     C*
042400970526     C                     ENDSR
042500970528     C*------------------------------------------------------------------------*
042600970528     C* O08GES - GESTIONE OPZIONE 8=LOCALITA'
042700970528     C*------------------------------------------------------------------------*
042800970528     C           O08GES    BEGSR
042900970528     C*
043000970602     C                     Z-ADDVIHDDE    DDRI
043100970602     C                     Z-ADDVIDVER    DVER
043200970528     C                     MOVELDEPOP0    WOP0
043300970528     C                     MOVEL'L'       WOP0
043400970528     C                     MOVEL'O08'     WOP1
043500970528     C                     MOVEL'TISI30R' WPGM
043600970528     C                     EXSR LANPGM
043700970528     C*
043800970528     C                     ENDSR
043900970528     C*------------------------------------------------------------------------*
044000970528     C* O09GES - GESTIONE OPZIONE 9=ECCEZIONI
044100970528     C*------------------------------------------------------------------------*
044200970528     C           O09GES    BEGSR
044300970528     C*
044400970602     C                     Z-ADDVIHDDE    DDRI
044500970602     C                     Z-ADDVIDVER    DVER
044600970528     C                     MOVELDEPOP0    WOP0
044700970528     C                     MOVEL'E'       WOP0
044800970528     C                     MOVEL'O09'     WOP1
044900970528     C                     MOVEL'TISI11R' WPGM
045000970528     C                     EXSR LANPGM
045100970528     C*
045200970528     C                     ENDSR
045300970528     C*------------------------------------------------------------------------*
045400970528     C* O10GES - GESTIONE OPZIONE 10=TEMPI DI CONSEGNA
045500970528     C*------------------------------------------------------------------------*
045600970528     C           O10GES    BEGSR
045700970528     C*
045800970602     C                     Z-ADDVIHDDE    DDRI
045900970602     C                     Z-ADDVIDVER    DVER
046000970528     C                     MOVELDEPOP0    WOP0
046100970528     C                     MOVEL'T'       WOP0
046200970528     C                     MOVEL'O10'     WOP1
046300970528     C                     MOVEL'TISI41R' WPGM
046400970528     C                     EXSR LANPGM
046500970528     C*
046600970528     C                     ENDSR
046700970528     C*------------------------------------------------------------------------*
046800970528     C* O11GES - GESTIONE OPZIONE 11=CAP
046900970528     C*------------------------------------------------------------------------*
047000970528     C           O11GES    BEGSR
047100970528     C*
047200970602     C                     Z-ADDVIHDDE    DDRI
047300970602     C                     Z-ADDVIDVER    DVER
047400970528     C                     MOVELDEPOP0    WOP0
047500970528     C                     MOVEL'C'       WOP0
047600970528     C                     MOVEL'O11'     WOP1
047700970528     C                     MOVEL'TISI02R' WPGM
047800970528     C                     EXSR LANPGM
047900970528     C*
048000970528     C                     ENDSR
048100970603     C*------------------------------------------------------------------------*
048200970603     C* O13GES - GESTIONE OPZIONE 13=SINONIMI
048300970603     C*------------------------------------------------------------------------*
048400970603     C           O13GES    BEGSR
048500970603     C*
048600970603     C                     Z-ADDVIHDDE    DDRI
048700970603     C                     Z-ADDVIDVER    DVER
048800970603     C                     MOVELDEPOP0    WOP0
048900970603     C                     MOVEL'S'       WOP0
049000970603     C                     MOVEL'O13'     WOP1
049100970603     C                     MOVEL'TISI35R' WPGM
049200970603     C                     EXSR LANPGM
049300970603     C*
049400970603     C                     ENDSR
049500970526     C*------------------------------------------------------------------------*
049600970526     C* NEWPOS - CONTROLLA RICHIESTA NUOVO POSIZIONAMENTO
049700970526     C*------------------------------------------------------------------------*
049800970526     C           NEWPOS    BEGSR
049900970526     C*
050000970526     C* SWPOSI: 0= NESSUNA RICHIESTA DI POSIZIONAMENTO
050100970526     C*         1= RICHIESTO POSIZIONAMENTO
050200970526     C                     Z-ADD0         SWPOSI  70
050300970526     C*
050400970526     C* SWMODI: 0= NESSUN AGGIORNAMENTO AFFETTUATO SUL FILE DALL'UTENTE
050500970526     C*            CON L'OPZIONE 2, NON OCCORRE RICARICARE IL SUBFILE
050600970526     C*         1= AGGIORNAMENTI EFFETTUATI, OCCORRE RICARICARE
050700970526     C                     Z-ADD0         SWMODI  10
050800970526     C*
050900970526     C* CONTROLLA SE RICHIESTO NUOVO POSIZIONAMENTO
051000970526IF  1C           VIDPVE    IFNE DEPVER
051100970526     C           VIDPDD    ORNE DEPDDE
051200970526     C           VIDPDR    ORNE DEPDRI
051300970526     C                     EXSR CHKPAR                     *CONTROLLA PARAMETRI
051400970526IF  2C           ERRL00    IFEQ '0'                        *NO ERORI
051500970526     C                     Z-ADD1         SWPOSI           *NUOVO POSIZIONAMENTO
051600970526     C                     Z-ADDVIDPVE    DEPVER           *DEPOSITI
051700970526     C                     Z-ADDVIDPDD    DEPDDE
051800970526     C                     Z-ADDVIDPDR    DEPDRI
051900970526E   2C                     ENDIF
052000970526E   1C                     ENDIF
052100970526     C*
052200970526     C                     ENDSR
052300970526     C*------------------------------------------------------------------------*
052400970526     C* SETFIL - POSIZIONAMENTO RECORD
052500970526     C*------------------------------------------------------------------------*
052600970526     C           SETFIL    BEGSR
052700970526     C*
052800970526     C* POSIZIONAMENTO DEL FILE E PRIMA LETTURA IN BASE AL TIPO DI RICERCA
052900970526IF  1C           WTIPRI    IFEQ 'VER'                      *PER VERSIONE
053000970526     C                     Z-ADDVIDPVE    KCRVER
053100970527     C           KEYCPR    SETLLAZCPR01L             99
053200970526E   1C                     ENDIF
053300970526     C*
053400970526IF  1C           WTIPRI    IFEQ 'DEC'                      *PER DECORRENZA
053500970526     C                     Z-ADDPDDVID    KCRDDE
053600970527     C           KE2CPR    SETLLAZCPR02L             99
053700970526E   1C                     ENDIF
053800970526     C* LETTURA RECORD
053900970526IF  1C           *IN99     IFEQ *OFF
054000970526     C                     EXSR LETFIL
054100970526E   1C                     ENDIF
054200970526     C*
054300970526     C* IMPOSTA SWITCH DI FINE CARICAMENTO SFL
054400970526IF  1C           *IN99     IFEQ *ON
054500970526     C                     Z-ADD1         SFLEOF
054600970526E   1C                     ENDIF
054700970526     C*
054800970526     C                     ENDSR
054900970526     C*------------------------------------------------------------------------*
055000970526     C* LETFIL - LETTURA RECORD
055100970526     C*------------------------------------------------------------------------*
055200970526     C           LETFIL    BEGSR
055300970526     C*
055400970526     C* LEGGE FINO A:
055500970526     C*     - FINE FILE
055600970526     C*     - TROVATO RECORD VALIDO
055700970526     C                     MOVEL'N'       WRECOK           *RECORD VALIDO
055800970526DO  1C           *IN99     DOWEQ*OFF
055900970526     C           WRECOK    ANDEQ'N'
056000970526     C*
056100970526     C* LETTURE SUCCESSIVE ALLA PRIMA IN BASE AL TIPO DI RICERCA
056200970526IF  2C           WTIPRI    IFEQ 'VER'                      *PER VERSIONE
056300970526     C                     READ AZCPR01L                 99
056400970526E   2C                     ENDIF
056500970526IF  2C           WTIPRI    IFEQ 'DEC'                      *PER DECORRENZA
056600970526     C                     READ AZCPR02L                 99
056700970526E   2C                     ENDIF
056800970526     C*
056900970526     C* SE FINE FILE, IMPOSTA SWITCH DI FINE CARICAMENTO SFL
057000970526IF  2C           *IN99     IFEQ *ON                        *FINE FILE
057100970526     C                     Z-ADD1         SFLEOF           *FINE LETTURA
057200970530X   2C                     ELSE
057300970526     C                     EXSR CHKREC                     *CONTROLLA RECORD
057400970530E   2C                     ENDIF
057500970526E   1C                     ENDDO
057600970526     C*
057700970526     C                     ENDSR
057800970526     C*------------------------------------------------------------------------*
057900970526     C* CHKREC - CONTROLLA VALIDITA' RECORD
058000970526     C*------------------------------------------------------------------------*
058100970526     C           CHKREC    BEGSR
058200970526     C*
058300970526     C                     MOVEL'S'       WRECOK           *VALIDITA' RECORD
058400970526     C*
058500970526     C* RECORD CON DECORRENZA MINORE DEL GIORNO RICHIESTO, ESCLUDE
058600970526IF  1C           PDRVID    IFGT *ZEROS
058700970526IF  2C           PDRVID    IFGE CPRDDE
058800970526     C           PDRVID    ANDLECPRDSC
058900970526X   2C                     ELSE
059000970526     C                     MOVEL'N'       WRECOK           *RECORD NON VALIDO
059100970526E   2C                     ENDIF
059200970526E   1C                     ENDIF
059300970526     C*
059400970526     C                     ENDSR
059500970526     C*------------------------------------------------------------------------*
059600970526     C* IRESFL - IMPOSTA I CAMPI DEL SFILE DAL FILE DI DATA BASE
059700970526     C*------------------------------------------------------------------------*
059800970526     C           IRESFL    BEGSR
059900970526     C*
060000970526     C                     MOVEL*BLANKS   OPZKEY
060100970528     C                     Z-ADDCPRDDE    VIHDDE
060200970526     C                     MOVELCPRATB    VIDATB
060300970526     C                     Z-ADDCPRVER    VIDVER
060400970526     C                     Z-ADDCPRDDE    G08INV
060500970526     C                     Z-ADD*ZEROS    G08DAT
060600970526     C                     MOVEL'3'       G08ERR
060700970526     C                     CALL 'XSRDA8'
060800970526     C                     PARM           WLBDA8
060900970526     C                     Z-ADDG08DAT    VIDDDE
061000970526     C                     Z-ADDCPRDSC    G08INV
061100970526     C                     Z-ADD*ZEROS    G08DAT
061200970526     C                     MOVEL'3'       G08ERR
061300970526     C                     CALL 'XSRDA8'
061400970526     C                     PARM           WLBDA8
061500970526     C                     Z-ADDG08DAT    VIDDSC
061600970526     C                     MOVELCPRDES    VIDDES
061700970526     C*
061800970526     C                     ENDSR
061900970526     C*------------------------------------------------------------------------*
062000970526     C* CHKPAR - CONTROLLA I PARAMETRI DI INIZIO RICERCA
062100970526     C*------------------------------------------------------------------------*
062200970526     C           CHKPAR    BEGSR
062300970526     C*
062400970526     C* REIMPOSTO FLAG EVIDENZAZIONE ERRORI SUI PARAMETRI
062500970526     C                     SETOF                     808182
062600970526     C*--------------------
062700970526     C* ORDINAMENTO
062800970526     C*--------------------
062900970526     C* DATA DECORRENZA
063000970526     C           *LIKE     DEFN VIDPDD    PDDVID           *DATA IN A/M/G
063100970526     C                     Z-ADD*ZEROS    PDDVID
063200970526IF  1C           ERRL00    IFEQ '0'
063300970526IF  2C           VIDPDD    IFGT *ZEROS
063400970526     C                     Z-ADDVIDPDD    G08DAT
063500970526     C                     Z-ADD*ZEROS    G08INV
063600970526     C                     MOVEL'0'       G08ERR
063700970526     C                     CALL 'XSRDA8'
063800970526     C                     PARM           WLBDA8
063900970526     C                     Z-ADDG08DAT    VIDPDD
064000970526     C                     Z-ADDG08INV    PDDVID
064100970526IF  3C           G08ERR    IFEQ '1'
064200970526     C                     MOVEL'1'       ERRL00
064300970526     C                     MOVELMSG,8     DSMSMS
064400970526     C                     SETON                     81
064500970526E   3C                     ENDIF
064600970526E   2C                     ENDIF
064700970526E   1C                     ENDIF
064800970526     C*--------------------
064900970526     C* SELEZIONI
065000970526     C*--------------------
065100970526     C* DATA RIFERIMENTO
065200970526     C           *LIKE     DEFN VIDPDR    PDRVID           *DATA IN A/M/G
065300970526     C                     Z-ADD*ZEROS    PDRVID
065400970526IF  1C           ERRL00    IFEQ '0'
065500970526IF  2C           VIDPDR    IFGT *ZEROS
065600970526     C                     Z-ADDVIDPDR    G08DAT
065700970526     C                     Z-ADD*ZEROS    G08INV
065800970526     C                     MOVEL'0'       G08ERR
065900970526     C                     CALL 'XSRDA8'
066000970526     C                     PARM           WLBDA8
066100970526     C                     Z-ADDG08DAT    VIDPDR
066200970526     C                     Z-ADDG08INV    PDRVID
066300970526IF  3C           G08ERR    IFEQ '1'
066400970526     C                     MOVEL'1'       ERRL00
066500970526     C                     MOVELMSG,8     DSMSMS
066600970526     C                     SETON                     82
066700970526E   3C                     ENDIF
066800970526E   2C                     ENDIF
066900970526E   1C                     ENDIF
067000970526     C*
067100970526     C* SE NESSUN ORDINAMENTO RICHIESTO, UTILIZZA LA RICERCA PER DECORRENZA
067200970526IF  1C           VIDPVE    IFEQ *ZEROS
067300970526     C           VIDPDD    ANDEQ*ZEROS
067400970526     C                     MOVEL'DEC'     WTIPRI  3
067500970526E   1C                     ENDIF
067600970526     C*
067700970526     C* ACCETTA SOLO UN PARAMETRO DI INIZIO RICERCA
067800970526IF  1C           ERRL00    IFEQ '0'
067900970526IF  2C           VIDPVE    IFGT *ZEROS
068000970526     C           VIDPDD    ANDGT*ZEROS
068100970526     C                     MOVELMSG,6     DSMSMS
068200970526     C                     MOVEL'1'       ERRL00
068300970526     C                     SETON                     8081
068400970526E   2C                     ENDIF
068500970526E   1C                     ENDIF
068600970526     C*
068700970526     C* CONTROLLA IL TIPO RICERCA
068800970526IF  1C           ERRL00    IFEQ '0'
068900970526IF  2C           VIDPVE    IFGT *ZEROS
069000970526     C                     MOVEL'VER'     WTIPRI
069100970526E   2C                     ENDIF
069200970526IF  2C           VIDPDD    IFNE *ZEROS
069300970526     C                     MOVEL'DEC'     WTIPRI
069400970526E   2C                     ENDIF
069500970526E   1C                     ENDIF
069600970526     C*
069700970526     C                     ENDSR
069800970526     C*------------------------------------------------------------------------*
069900970526     C* LANPGM - LANCIA UN PROGRAMMA
070000970526     C*------------------------------------------------------------------------*
070100970526     C           LANPGM    BEGSR
070200970526     C*
070300970526     C* IMPOSTA LA DS DI PROCEDURA
070400970528     C                     MOVELWOP0      D00OP0           *LIVELLO PROCEDURA
070500970528     C                     MOVELWOP1      D00OP1           *LIVELLO PGM
070600970526     C                     MOVEL'0'       D00F03           *PREMUTO F03=FINE
070700970526     C                     MOVEL'0'       D00F12           *PREMUTO F12=RITORNO
070800970526     C                     MOVEL'0'       D00ERR           *'1'=ERRORE
070900970526     C                     MOVEL*BLANKS   D00MSG           *MESSAGGIO DI RITORN0
071000970602     C                     Z-ADDDDRI      D00DRI           *DATA RIFERIMENTO
071100970602     C                     Z-ADDDVER      D00VER           *VERSIONE
071200970530     C                     Z-ADD*ZEROS    D00DDE           *ALTRI CAMPI
071300970530     C                     MOVEL*BLANKS   D00NAR
071400970530     C                     MOVEL*BLANKS   D00CAP
071500970530     C                     Z-ADD*ZEROS    D00TTC
071600970530     C                     MOVEL*BLANKS   D00TSP
071700970530     C                     Z-ADD*ZEROS    D00TFP
071800970530     C                     MOVEL*BLANKS   D00LOC
071900970603     C                     MOVEL*BLANKS   D00SIN
072000970530     C                     MOVEL*BLANKS   D00EPA
072100970530     C                     Z-ADD*ZEROS    D00ETP
072200970530     C                     Z-ADD*ZEROS    D00ETA
072300970530     C                     Z-ADD*ZEROS    D00EDD
072400970530     C                     MOVEL*BLANKS   D00SPT
072500970530     C                     Z-ADD*ZEROS    D00SLP
072600970530     C                     Z-ADD*ZEROS    D00SLA
072700970530     C                     MOVEL*BLANKS   D00STS
072800970530     C                     Z-ADD*ZEROS    D00SDD
072900970526     C*
073000970526     C                     CALL WPGM
073100970612     C                     PARM           KPJBA
073200970612     C                     PARM           DSSI00
073300970526     C*
073400970526     C* SE RITORNA PREMUTO F3, CHIUDE IL PROGRAMMA
073500970526IF  1C           D00F03    IFEQ '1'                        *PREMUTO F03
073600970526     C                     MOVEL'1'       ERRL00           *ERRORE
073700970526     C                     MOVEL'1'       F03L00           *FINE PGM
073800970526X   1C                     ELSE                            *NON PREMUTO F03
073900970526     C                     MOVELD00MSG    DSMSMS           *MESSAGGIO DI RITORNO
074000970526E   1C                     ENDIF
074100970526     C*
074200970526     C                     ENDSR
074300970527     C*------------------------------------------------------------------------*
074400970527     C* CARTAB - CARICA LE TABELLE OCCORRENTI
074500970527     C*------------------------------------------------------------------------*
074600970527     C           CARTAB    BEGSR
074700970527     C*
074800970527     C                     ENDSR
074900970526     C*------------------------------------------------------------------------*
075000970526     C* CHKFOP - CONTROLLA IL TIPO DI GESTIONE E IMPOSTA OPZIONI E FUNZIONI
075100970526     C*------------------------------------------------------------------------*
075200970526     C           CHKFOP    BEGSR
075300970626     C*
075400970626     C* SE L'UTENTE E' IN SCELTA, ABILITA SOLO QUELLA
075500970626IF  1C           DEPOP0    IFEQ 'R01'
075600970626     C                     MOVELOPD,1     OPDRIG           *SCELTA
075700970626     C                     MOVEL'S'       OPDATT
075800970626     C                     MOVELOPDRIG    OPD,1
075900970626X   1C                     ELSE
076000970626     C* OPZIONI
076100970626     C                     MOVELOPD,5     OPDRIG           *INTERROGAZIONE
076200970626     C                     MOVEL'S'       OPDATT
076300970626     C                     MOVELOPDRIG    OPD,5
076400970626     C                     MOVELOPD,8     OPDRIG           *LOCALITA'
076500970626     C                     MOVEL'S'       OPDATT
076600970626     C                     MOVELOPDRIG    OPD,8
076700970626     C                     MOVELOPD,9     OPDRIG           *ECCEZIONI
076800970626     C                     MOVEL'S'       OPDATT
076900970626     C                     MOVELOPDRIG    OPD,9
077000970626     C                     MOVELOPD,10    OPDRIG           *TEMPI CONSEGNA
077100970626     C                     MOVEL'S'       OPDATT
077200970626     C                     MOVELOPDRIG    OPD,10
077300970626     C                     MOVELOPD,11    OPDRIG           *CAP
077400970626     C                     MOVEL'S'       OPDATT
077500970626     C                     MOVELOPDRIG    OPD,11
077600970626     C                     MOVELOPD,13    OPDRIG           *SINONIMI
077700970626     C                     MOVEL'S'       OPDATT
077800970626     C                     MOVELOPDRIG    OPD,13
077900970626     C* FUNZIONI
078000970626     C                     MOVELFUD,8     FUDRIG           *LOCALITA'
078100970626     C                     MOVEL'S'       FUDATT
078200970626     C                     MOVELFUDRIG    FUD,8
078300970626     C                     MOVELFUD,9     FUDRIG           *ECCEZIONI
078400970626     C                     MOVEL'S'       FUDATT
078500970626     C                     MOVELFUDRIG    FUD,9
078600970626     C                     MOVELFUD,10    FUDRIG           *TEMPI CONSEGNA
078700970626     C                     MOVEL'S'       FUDATT
078800970626     C                     MOVELFUDRIG    FUD,10
078900970626     C                     MOVELFUD,11    FUDRIG           *CAP
079000970626     C                     MOVEL'S'       FUDATT
079100970626     C                     MOVELFUDRIG    FUD,11
079200970626     C                     MOVELFUD,13    FUDRIG           *SINONIMI
079300970626     C                     MOVEL'S'       FUDATT
079400970626     C                     MOVELFUDRIG    FUD,13
079500970626E   1C                     ENDIF
079600970626     C*
079700000602     C* SE L'UTENTE E' IN GESTIONE, ABILITA TUTTE LE OPZIONI/FUNZIONI DI MODIFICA
079800970626IF  1C           DEPOP0    IFEQ 'R02'
079900970626     C                     MOVELOPD,2     OPDRIG           *MODIFICA
080000970626     C                     MOVEL'S'       OPDATT
080100970626     C                     MOVELOPDRIG    OPD,2
080200970626     C                     MOVELOPD,4     OPDRIG           *ANNULLAMENTO
080300970626     C                     MOVEL'S'       OPDATT
080400970626     C                     MOVELOPDRIG    OPD,4
080500010702     C*                    MOVELOPD,6     OPDRIG           *ALLINEAMENTO
080600010702     C*                    MOVEL'S'       OPDATT
080700010702     C*                    MOVELOPDRIG    OPD,6
080800970626     C                     MOVELOPD,7     OPDRIG           *RIPRISTINO
080900970626     C                     MOVEL'S'       OPDATT
081000970626     C                     MOVELOPDRIG    OPD,7
081100970715     C*
081200970715     C* SOLO SE EDP ABILITA DUPLICA E INSERIMENTO
081300970715IF  2C           UTENTE    IFEQ 'EDP'
081400970715     C                     MOVELOPD,3     OPDRIG           *DUPLICA
081500970715     C                     MOVEL'S'       OPDATT
081600970715     C                     MOVELOPDRIG    OPD,3
081700970626     C                     MOVELFUD,6     FUDRIG           *INSERIMENTO
081800970626     C                     MOVEL'S'       FUDATT
081900970626     C                     MOVELFUDRIG    FUD,6
082000970715E   2C                     ENDIF
082100970715E   1C                     ENDIF
082200970626     C*
082300000602     C* SE IN FILIALE NON CONCEDE CANCELLAZIONE, INSERIMENTO, RIPRISTINO, ALLINEAMENTO
082400970626IF  1C           DSFITI    IFNE 'S'                        *FILIALE
082500970626     C                     MOVELOPD,4     OPDRIG           *NO CANCELLAZIONE
082600970626     C                     MOVEL'N'       OPDATT
082700970626     C                     MOVELOPDRIG    OPD,4
082800010702     C*                    MOVELOPD,6     OPDRIG           *NO ALLINEAMENTO
082900010702     C*                    MOVEL'N'       OPDATT
083000010702     C*                    MOVELOPDRIG    OPD,6
083100970626     C                     MOVELOPD,7     OPDRIG           *NO RIPRISTINO
083200970626     C                     MOVEL'N'       OPDATT
083300970626     C                     MOVELOPDRIG    OPD,7
083400970626     C                     MOVELFUD,6     FUDRIG           *NO INSERIMENTO
083500970626     C                     MOVEL'N'       FUDATT
083600970626     C                     MOVELFUDRIG    FUD,6
083700970626E   1C                     ENDIF
083800970526     C*
083900970526     C* GESTIONE OPZIONI A VIDEO
084000970526     C                     Z-ADD0         OPZGRU  50       *INDICE X OPZIONI
084100970526     C                     EXSR OPZGES
084200970526     C*
084300970526     C* GESTIONE TASTI FUNZIONALI A VIDEO
084400970526     C                     Z-ADD*ZEROS    FUNGRU  50       *INDICE X FUNZIONI
084500970526     C                     EXSR FUNGES
084600970526     C*
084700970526     C                     ENDSR
084800970526     C*------------------------------------------------------------------------*
084900970526     C* *INZSR - OPERAZIONI INIZIALI
085000970526     C*------------------------------------------------------------------------*
085100970526     C           *INZSR    BEGSR
085200970526     C*---
085300970526     C* RICEVIMENTO PARAMETRI
085400970526     C*---
085500970526     C           *ENTRY    PLIST
085600970612     C                     PARM           KPJBA
085700970612     C                     PARM           DSSI00
085800970526     C*
085900970526     C* DS PARAMETRI PER "XMSG" - MESSAGGI PGM
086000970526     C           XMSGPA    PLIST
086100970526     C                     PARM           DSMSMS
086200970526     C                     PARM           DSMSPG
086300970526     C                     PARM           DSMSKE
086400970526     C                     PARM           DSMSER
086500970526     C*
086600970526     C* IMPOSTA LA DS -TASTI PREMUTI-
086700970526     C                     CALL 'XKEY'
086800970526     C                     PARM           DSKEY
086900970526     C*---
087000970526     C* VARIABILI NON RIFERITE AL DATA BASE
087100970526     C*---
087200970526     C           *LIKE     DEFN SFLNBR    SFLPAG
087300970526     C           *LIKE     DEFN SFLPAG    WFLPAG
087400970526     C           *LIKE     DEFN SFLNBR    SFLEOF
087500970526     C           *LIKE     DEFN SFLNBR    SFLERR
087600970526     C           *LIKE     DEFN SFLNBR    SFLULT
087700970526     C           *LIKE     DEFN SFLNBR    WFLULT
087800970526     C           *LIKE     DEFN SFLNBR    MSGULT
087900970526     C           *LIKE     DEFN SFLNBR    SFLRIG
088000970526     C           *LIKE     DEFN FUDFUN    FUNKEY
088100970602     C           *LIKE     DEFN D00OP0    DEPOP0           *DI DEPOSITO
088200970526     C           *LIKE     DEFN D00OP1    DEPOP1
088300970602     C           *LIKE     DEFN D00OP0    WOP0             *DI LAVORO
088400970529     C           *LIKE     DEFN D00OP1    WOP1
088500970602     C           *LIKE     DEFN D00DRI    DDRI
088600970602     C           *LIKE     DEFN D00VER    DVER
088700970526     C*---
088800970526     C* VARIABILI DI CONTROLLO
088900970526     C*---
089000970526     C                     MOVEL'0'       FINL00  1        *FINE PGM
089100970526     C                     MOVEL'0'       F03L00  1        *PREMUTO F03
089200970526     C                     MOVEL'0'       F12L00  1        *PREMUTO F12
089300970526     C                     MOVEL'0'       ERRL00  1        *ERRORE
089400970526     C                     MOVEL'S'       WRECOK  1        *VALIDITA' RECORD
089500970526     C                     Z-ADD11        SFLPAG           *NRIGHE X PAG
089600970526     C*
089700970526     C* IMPOSTA LA DS -INVIO MESSAGGI-
089800970526     C                     MOVEL'TISI46R' DSMSPG
089900970526     C                     MOVEL'TISI46R' MSGQUE
090000970526     C                     MOVEL*BLANKS   MSGKEY
090100970526     C                     MOVEL*BLANKS   DSMSMS
090200970526     C                     MOVEL*BLANKS   DSMSKE
090300970526     C                     Z-ADD*ZEROS    DSMSER
090400970526     C*---
090500970526     C* VARIABILI RIFERITE AL DATA BASE
090600970526     C*---
090700970526     C           *LIKE     DEFN CPRVER    KCRVER           *AZCPR00F
090800970526     C           *LIKE     DEFN CPRDDE    KCRDDE
090900970526     C           *LIKE     DEFN CPRVER    DEPVER           *DEPOSITI
091000970526     C           *LIKE     DEFN CPRDDE    DEPDDE
091100970526     C           *LIKE     DEFN CPRDDE    DEPDRI
091200970526     C*---
091300970526     C* CHIAVI DI LETTURA
091400970526     C*---
091500970526     C* LETTURA AZCPR01L - COMPLETA
091600970527     C           KEYCPR    KLIST
091700970526     C                     KFLD           KCRVER           *VERSIONE
091800970526     C*
091900970526     C* LETTURA AZCPR02L - PARZIALE
092000970527     C           KE2CPR    KLIST
092100970526     C                     KFLD           KCRDDE           *DECORRENZA
092200970527     C*
092300970527     C* REPERIMENTO DATI UTENTE
092400970527     C                     CALL 'XFIL'
092500970527     C                     PARM           DSFIL
092600970527     C*
092700970527     C* CARICA LE TABELLE OCCORRENTI
092800970527     C                     EXSR CARTAB
092900970526     C*
093000970526     C* DEPOSITA LE OPZIONI DI ENTRATA
093100970526     C                     MOVELD00OP0    DEPOP0           *LIVELLO PROCEDURA
093200970526     C                     MOVELD00OP1    DEPOP1           *LIVELLO PROGRAMMA
093300970526     C*
093400970526     C* CALCOLA LA DATA CORRENTE
093500970526     C                     TIME           WN14   140       *ORA (6)+ DATA (8)
093600970526     C                     MOVE WN14      WN8     80       *DATA (8) IN G/M/AA
093700970526     C                     Z-ADDWN8       G08DAT
093800970526     C                     Z-ADD*ZEROS    G08INV
093900970526     C                     MOVEL'0'       G08ERR
094000970526     C                     CALL 'XSRDA8'
094100970526     C                     PARM           WLBDA8
094200970526     C                     Z-ADDG08INV    DATCOR  80       *DATA CORRENTE AA/M/G
094300970526     C*
094400970526     C* IMPOSTA LE OPZIONI E FUNZIONI A VIDEO
094500970526     C                     EXSR CHKFOP
094600970526     C*
094700970526     C* IMPOSTA I PARAMETRI DI INGRESSO
094800970528     C                     Z-ADD*ZEROS    VIDPDR           *DATA RIFERIMENTO
094900970528IF  1C           D00DRI    IFGT *ZEROS
095000970526     C                     Z-ADDD00DRI    G08INV
095100970526     C                     Z-ADD*ZEROS    G08DAT
095200970526     C                     MOVEL'3'       G08ERR
095300970526     C                     CALL 'XSRDA8'
095400970526     C                     PARM           WLBDA8
095500970528     C                     Z-ADDG08DAT    VIDPDR
095600970528E   1C                     ENDIF
095700970526     C                     EXSR CHKPAR
095800970526IF  1C           ERRL00    IFEQ '1'
095900970526     C                     MOVEL'1'       D00ERR
096000970526     C                     MOVELDSMSMS    D00MSG
096100970526X   1C                     ELSE
096200970526     C                     Z-ADDVIDPDR    DEPDRI           *DEPOSITI
096300970526E   1C                     ENDIF
096400980225     C*
096500980225     C* REPERISCE L'ULTIMA VERSIONE
096600980225IF  1C           D00VER    IFEQ *ZEROS
096700980225     C                     Z-ADDDATCOR    P96DRI  80
096800980225     C                     Z-ADD*ZEROS    P96VER  50
096900980225     C                     CALL 'TISI96R'
097000980225     C                     PARM           P96DRI
097100980225     C                     PARM           P96VER
097200980225     C                     Z-ADDP96DRI    ULTDRI  80
097300980225     C                     Z-ADDP96VER    ULTVER  50
097400980225E   1C                     ENDIF
097500970526     C*
097600970530     C* IMPOSTA IL TIPO DI GESTIONE IN TESTATA
097700970530IF  1C           DEPOP0    IFEQ 'R01'
097800970530     C                     MOVELDEC,3     VIDING
097900970530E   1C                     ENDIF
098000970530IF  1C           DEPOP0    IFEQ 'R02'
098100970530     C                     MOVELDEC,1     VIDING
098200970530E   1C                     ENDIF
098300970530IF  1C           DEPOP0    IFEQ 'R05'
098400970530     C                     MOVELDEC,2     VIDING
098500970530E   1C                     ENDIF
098600970526     C*
098700970526     C                     ENDSR
098800970526     C*------------------------------------------------------------------------*
098900970526     C* 
099000970526     C* 
099100970526     C*  LA PARTE DI SPECIFICHE 'C' SOTTOSTANTE SI RIFA' A PARTICOLARI
099200970526     C*  STANDARDS DI PROGRAMMAZIONE E NELLA MAGGIOR PARTE DEI CASI
099300970526     C*  NON E' NECESSARIO MODIFICARLA, NEL CASO FARE ATTENZIONE.
099400970526     C* 
099500970526     C* 
099600970526     C*------------------------------------------------------------------------*
099700970526     C* POSSFL - RICARICAMENTO SFL DA NUOVO POSIZIONAMENTO FILE DA CARICARE
099800970526     C*------------------------------------------------------------------------*
099900970526     C           POSSFL    BEGSR
100000970526     C*
100100970526     C* CLEAR SFL (ELIMINA CONTENUTO SFL)
100200970526     C                     EXSR CLRSFL
100300970526     C*
100400970526     C* CONTROLLO SE VI SONO REC. CHE SODDISFANO I PARAMETRI IN INPUT
100500970526     C                     EXSR SETFIL
100600970526     C*
100700970526     C* SE ESISTONO RECORD VALIDI CARICO IL SUBFILE
100800970526     C           SFLEOF    IFEQ 0
100900970526     C                     EXSR CARSFL
101000970526     C                     END
101100970526     C*
101200970526     C                     ENDSR
101300970526     C*------------------------------------------------------------------------*
101400970526     C* ENTATT - GESTIONE SFL CON TASTO FUNZIONALE ENTER
101500970526     C*------------------------------------------------------------------------*
101600970526     C           ENTATT    BEGSR
101700970526     C*
101800970526     C* AZZERO SWITCH DI ERRORI IN RECORD SFL (OPZOK: 1=ERRORE 0=OK)
101900970526     C                     Z-ADD0         OPZOK   10
102000970526     C*
102100970526     C* AZZERO CONTATORE DI RIGHE SFL VARIATE
102200970526     C                     Z-ADD0         SFLVAR  50
102300970526     C*
102400970526     C* INIZIALIZZO COMODO CON PRIMO RECORD SFL IN ERRORE
102500970526     C                     Z-ADD0         SFLERR
102600970526     C*
102700970526     C* SALVO ULTIMO RECORD SCRITTO IN SFL IN COMODO
102800970526     C                     Z-ADDSFLULT    WFLULT
102900970526     C*
103000970526     C* SCORRIMENTO DEI SOLI RECORD VARIATI NEL SFL
103100970526     C                     READCSI46D05                  98
103200970526     C           *IN98     DOWEQ'0'
103300970526     C*
103400970526     C* ADD CONTATORE DI RIGHE SFL VARIATE
103500970526     C                     ADD  1         SFLVAR
103600970526     C*
103700970526     C* SE RIGHE PRECEDENTI SENZA ERRORI (OPZOK: 1=ERRORE 0=OK)
103800970526     C           OPZOK     IFEQ 0
103900970526     C*
104000970526     C* CONTROLLO ED ESECUZIONE OPZIONI RICHIESTE (OPZOK: 1=ERRORE 0=OK)
104100970526     C           OPZKEY    IFNE *BLANKS
104200970526     C                     EXSR OPZCON
104300970526     C                     END
104400970526     C*
104500970526     C* SE OK    : 1. AZZERO SFLNXTCHG PER RECORD SFL
104600970526     C*            2. PULIZIA SCELTA IN SFL
104700970526     C           OPZOK     IFEQ 0
104800970526     C                     MOVEL'0'       *IN41
104900970526     C                     MOVEL*BLANKS   OPZKEY
105000970526     C                     ELSE
105100970526     C*
105200970526     C* SE NON OK: 1. ACCENDO SFLNXTCHG COSI' COSTRINGO ALLA CORREZIONE
105300970526     C*            2. IMPOSTO RECORD CON PRIMO ERRORE
105400970526     C                     MOVEL'1'       *IN41
105500970526     C                     Z-ADDSFLULT    SFLERR
105600970526     C                     END
105700970526     C                     ELSE
105800970526     C*
105900970526     C* SE RIGHE PRECEDENTI CON ERRORI (SFLERR DIVERSO DA 0):
106000970526     C*   . ACCENDO SFLNXTCHG COSI' RIPROPONE LA RIGA IL PROSSIMO GIRO
106100970526     C                     MOVEL'1'       *IN41
106200970526     C                     END                             OPZOK=0
106300970526     C*
106400970526     C* IMPOSTO RIGA SFL SUL QUALE POSIZIONARSI:
106500970526     C*   . SE ERRORE        MI POSIZIONO SULLA PRIMA RIGA IN ERRORE
106600970526     C*   . SE NESSUN ERRORE MI POSIZIONO SULL'ULTIMA RIGA VARIATA
106700970526     C           OPZOK     IFNE 0
106800970526     C                     Z-ADDSFLERR    SFLNBR
106900970526     C                     ELSE
107000970526     C                     Z-ADDSFLULT    SFLNBR
107100970526     C                     END
107200970526     C*
107300970526     C* AGGIORNO RECORD SFL
107400970526     C                     UPDATSI46D05
107500970526     C*
107600970526     C                     READCSI46D05                  98
107700970526     C                     END                             DO WHILE
107800970526     C*
107900970526     C* REIMPOSTO ULTIMO RECORD SCRITTO IN SFL DA COMODO
108000970526     C                     Z-ADDWFLULT    SFLULT
108100970526     C*
108200970526     C* SE NESSUNA RIGA VARIATA, CON ENTER SI RITORNA AL PGM CHIAMANTE
108300970526     C           SFLVAR    IFEQ 0
108400970526     C*---                 MOVEL'1'       FINL00
108500970526     C                     END
108600970526     C*
108700970526     C                     ENDSR
108800970526     C*------------------------------------------------------------------------*
108900970526     C* CLRSFL - ELIMINAZIONE CONTENUTO SFL
109000970526     C*------------------------------------------------------------------------*
109100970526     C           CLRSFL    BEGSR
109200970526     C*
109300970526     C* INIZIALIZZO SWITCH DI FINE FILE "FISICO"
109400970526     C* (0=NON FINE FILE  1=FINE FILE)
109500970526     C                     Z-ADD0         SFLEOF
109600970526     C*
109700970526     C* INIZIALIZZO CONTATORI DI ULTIMO RECORD IN SFL
109800970526     C                     Z-ADD0         SFLULT
109900970526     C*
110000970526     C* ACCENSIONE INDICATORE PER CLEAR SFL
110100970526     C                     MOVEL'1'       *IN40
110200970526     C                     WRITESI46D06
110300970526     C                     MOVEL'0'       *IN40
110400970526     C*
110500970526     C                     ENDSR
110600970526     C*------------------------------------------------------------------------*
110700970526     C* CARSFL - CARICAMENTO SFL
110800970526     C*------------------------------------------------------------------------*
110900970526     C           CARSFL    BEGSR
111000970526     C*
111100970526     C* SE IL SFL E' VUOTO INIZIO LETTURA DA POSIZ. RICHIESTA
111200970526     C           SFLULT    IFEQ 0
111300970526     C                     EXSR SETFIL
111400970526     C                     END
111500970526     C*
111600970526     C* SALVO SFLRCDNBR PER CONFRONTI SUCCESSIVI
111700970526     C                     Z-ADDSFLULT    WFLULT
111800970526     C*
111900970526     C* CICLO:
112000970526     C*    -CARICO NUMERO DI RIGHE=SFLPAG
112100970526     C*    -SFLEOF=0 (NON FINE FILE "FISICO")
112200970526     C                     Z-ADD1         SFLRIG
112300970526     C           SFLRIG    DOWLESFLPAG
112400970526     C           SFLEOF    ANDEQ0
112500970526     C*
112600970526     C* IMPOSTO CAMPI DEL RECORD SFL SOLO SE RECORD E' OK CIOE' ...
112700970526     C                     MOVEL*BLANKS   OPZKEY
112800970526     C*
112900970526     C* IMPOSTA I CAMPI DEL RECORD DEL SFL DA FILE DA CARICARE
113000970526     C                     EXSR IRESFL
113100970526     C*
113200970526     C* AGGIORNA CHIAVE PER RECORD SFL E SFLRCDNBR
113300970526     C                     ADD  1         SFLULT
113400970526     C*
113500970526     C* SCRITTURA RECORD SFL
113600970526     C                     WRITESI46D05
113700970526     C                     ADD  1         SFLRIG
113800970526     C*
113900970526     C* LETTURA FILE DA CARICARE
114000970526     C                     EXSR LETFIL
114100970526     C                     END                             DO WHILE
114200970526     C*
114300970526     C* IMPOSTO SFLRCDNBR DELLA SUCCESSIVA PAGINA SE CARICATI ALTRI RECORD
114400970526     C           WFLULT    IFNE SFLULT
114500970526     C                     Z-ADDWFLULT    SFLNBR
114600970526     C                     ADD  1         SFLNBR
114700970526     C                     END
114800970526     C*
114900970526     C                     ENDSR
115000970526     C*------------------------------------------------------------------------*
115100970526     C* OUTSFL - EMISSIONE SUBFILE A VIDEO
115200970526     C*------------------------------------------------------------------------*
115300970526     C           OUTSFL    BEGSR
115400970526     C*
115500970526     C* WRITE RECORD TESTATA VIDEO
115600970526     C                     WRITESI46D01
115700970526     C*
115800970526     C* VISUALIZZAZIONE MESSAGGIO
115900970526     C                     EXSR SNDMSG
116000970526     C*
116100970526     C* WRITE RECORD OPZIONI VIDEO
116200970526     C                     WRITESI46D02
116300970526     C*
116400970526     C* WRITE RECORD PER POSIZIONAMEMTO VIDEO
116500970526     C                     WRITESI46D03
116600970526     C*
116700970526     C* WRITE RECORD CON DESCRIZIONI COLONNE SFL
116800970526     C                     WRITESI46D04
116900970526     C*
117000970526     C* GESTIONE AUTOMATICA SFLEND (+ A VIDEO)
117100970526     C* SFLEOF=0 NON RAGGIUNTO FINE FILE "FISICO"
117200970526     C           SFLEOF    IFEQ 0
117300970526     C                     MOVEL'0'       *IN42
117400970526     C                     ELSE
117500970526     C*
117600970526     C* SFLEOF=1 RAGGIUNTO FINE FILE "FISICO"
117700970526     C                     MOVEL'1'       *IN42
117800970526     C                     END
117900970526     C*
118000970526     C* WRITE RECORD TASTI FUNZIONALI
118100970526     C                     WRITESI46D09
118200970526     C*
118300970526     C* CASO DI SFL VUOTO
118400970526     C           SFLULT    IFLE 0
118500970526     C*
118600970526     C*    - WRITE RECORD VUOTO
118700970526     C                     WRITESI46D0A
118800970526     C                     READ SI46D0A                  99
118900970526     C*
119000970526     C                     ELSE
119100970526     C*
119200970526     C* CASO DI SFL CON RECORDS
119300970526     C*
119400970526     C*    - WRITE RECORD CONTROLLO SFL
119500970526     C                     WRITESI46D06
119600970526     C                     READ SI46D06                  99
119700970526     C                     END
119800970526     C*
119900970526     C* READ RECORD PER POSIZIONAMEMTO VIDEO
120000970526     C                     READ SI46D03                  99
120100970526     C*
120200970526     C                     ENDSR
120300970526     C*------------------------------------------------------------------------*
120400970526     C* SNDMSG - MANDA MESSAGGIO
120500970526     C*------------------------------------------------------------------------*
120600970526     C           SNDMSG    BEGSR
120700970526     C*
120800970526     C* PULIZIA SUBFILE MESSAGGI (WRITE RECORD CONTROLLO SFLMSG)
120900970526     C                     MOVEL'1'       *IN40
121000970526     C                     WRITESI46DMC
121100970526     C                     MOVEL'0'       *IN40
121200970526     C*
121300970526     C* VISUALIZZAZIONE MESSAGGIO
121400970526     C                     Z-ADD0         MSGULT
121500970526     C                     CALL 'XMSG'    XMSGPA
121600970526     C           DSMSER    IFEQ 0
121700970526     C                     MOVELDSMSKE    MSGKEY
121800970526     C                     END
121900970526     C                     Z-ADD1         MSGULT
122000970526     C                     WRITESI46DMS                    SFL MESS
122100970526     C                     WRITESI46DMC                    CONTR MESS
122200970526     C*
122300970526     C* MANDO MESSAGGIO *BLANKS PER PULIRE SFLMSG
122400970526     C                     MOVEL*BLANKS   DSMSMS
122500970526     C*
122600970526     C                     ENDSR
122700970526     C*------------------------------------------------------------------------*
122800970526     C* FUNCON - GESTIONE SCELTE DELL'OPERATORE A VIDEO
122900970526     C*------------------------------------------------------------------------*
123000970526     C           FUNCON    BEGSR
123100970526     C*
123200970526     C* TRADUCE TASTI FUNZIONALI IN VARIABILE -FUNKEY-
123300970526     C                     EXSR FUNVAR
123400970526     C*
123500970526     C* PULISCO CAMPI DI LAVORO
123600970526     C                     Z-ADD0         I       50
123700970526     C                     Z-ADD0         W       50
123800970526     C*
123900970526     C* RICERCA FUNZIONE (DIVERSA DA ENTER) SCELTA IN TABELLA FUNZIONI
124000970526     C           FUNKEY    IFNE *BLANKS
124100970526     C           1         DO   24        I
124200970526     C                     MOVELFUD,I     FUDRIG
124300970526     C*
124400970526     C* SALVO INDICE DI FUNZIONE TROVATA ED ATTIVA (W)
124500970526     C           FUNKEY    IFEQ FUDFUN
124600970526     C           FUDATT    ANDEQ'S'
124700970526     C                     Z-ADDI         W
124800970526     C                     END
124900970526     C                     END                             DO WHILE
125000970526     C*
125100970526     C* FUNZIONE NON ATTIVA (ERRORE)
125200970526     C           W         IFEQ 0
125300970526     C*
125400970526     C* EMISSIONE MESSAGGIO DI ERRORE
125500970526     C                     MOVELMSG,2     DSMSMS
125600970526     C                     END                             W=0
125700970526     C                     END                             FUNKEY NE *BLANKS
125800970526     C*
125900970526     C* FUNZIONE ATTIVA (PROCEDI ...)
126000970526     C           W         IFNE 0
126100970526     C           FUNKEY    OREQ *BLANKS
126200970526     C*
126300970526     C           FUNKEY    IFEQ *BLANKS
126400970526     C                     EXSR ENTGES
126500970526     C                     END
126600970526     C           FUNKEY    IFEQ '03'
126700970526     C                     EXSR F03GES
126800970526     C                     END
126900970526     C           FUNKEY    IFEQ '05'
127000970526     C                     EXSR F05GES
127100970526     C                     END
127200970526     C           FUNKEY    IFEQ '06'
127300970526     C                     EXSR F06GES
127400970526     C                     END
127500970528     C           FUNKEY    IFEQ '08'
127600970528     C                     EXSR F08GES
127700970528     C                     END
127800970528     C           FUNKEY    IFEQ '09'
127900970528     C                     EXSR F09GES
128000970528     C                     END
128100970528     C           FUNKEY    IFEQ '10'
128200970528     C                     EXSR F10GES
128300970528     C                     END
128400970528     C           FUNKEY    IFEQ '11'
128500970528     C                     EXSR F11GES
128600970528     C                     END
128700970526     C           FUNKEY    IFEQ '12'
128800970526     C                     EXSR F12GES
128900970526     C                     END
129000970603     C           FUNKEY    IFEQ '13'
129100970603     C                     EXSR F13GES
129200970603     C                     END
129300970526     C           FUNKEY    IFEQ '22'
129400970526     C                     EXSR F22GES
129500970526     C                     END
129600970526     C           FUNKEY    IFEQ '23'
129700970526     C                     EXSR F23GES
129800970526     C                     END
129900970526     C           FUNKEY    IFEQ '24'
130000970526     C                     EXSR F24GES
130100970526     C                     END
130200970526     C           FUNKEY    IFEQ 'RU'
130300970526     C                     EXSR RUPGES
130400970526     C                     END
130500970526     C*
130600970526     C                     END
130700970526     C*
130800970526     C                     ENDSR
130900970526     C*------------------------------------------------------------------------*
131000970526     C* FUNVAR -TRADUCE INDICATORI DI TASTO FUNZIONALE IN VARIABILE
131100970526     C*------------------------------------------------------------------------*
131200970526     C           FUNVAR    BEGSR
131300970526     C*
131400970526     C* FUNKEY=*BLANKS SIGNIFICA ENTER
131500970526     C           KEY       IFEQ ENTER
131600970526     C                     MOVEL*BLANKS   FUNKEY
131700970526     C                     END
131800970526     C           KEY       IFEQ F1
131900970526     C                     MOVEL'01'      FUNKEY
132000970526     C                     END
132100970526     C           KEY       IFEQ F2
132200970526     C                     MOVEL'02'      FUNKEY
132300970526     C                     END
132400970526     C           KEY       IFEQ F3
132500970526     C                     MOVEL'03'      FUNKEY
132600970526     C                     END
132700970526     C           KEY       IFEQ F4
132800970526     C                     MOVEL'04'      FUNKEY
132900970526     C                     END
133000970526     C           KEY       IFEQ F5
133100970526     C                     MOVEL'05'      FUNKEY
133200970526     C                     END
133300970526     C           KEY       IFEQ F6
133400970526     C                     MOVEL'06'      FUNKEY
133500970526     C                     END
133600970526     C           KEY       IFEQ F7
133700970526     C                     MOVEL'07'      FUNKEY
133800970526     C                     END
133900970526     C           KEY       IFEQ F8
134000970526     C                     MOVEL'08'      FUNKEY
134100970526     C                     END
134200970526     C           KEY       IFEQ F9
134300970526     C                     MOVEL'09'      FUNKEY
134400970526     C                     END
134500970526     C           KEY       IFEQ F10
134600970526     C                     MOVEL'10'      FUNKEY
134700970526     C                     END
134800970526     C           KEY       IFEQ F11
134900970526     C                     MOVEL'11'      FUNKEY
135000970526     C                     END
135100970526     C           KEY       IFEQ F12
135200970526     C                     MOVEL'12'      FUNKEY
135300970526     C                     END
135400970526     C           KEY       IFEQ F13
135500970526     C                     MOVEL'13'      FUNKEY
135600970526     C                     END
135700970526     C           KEY       IFEQ F14
135800970526     C                     MOVEL'14'      FUNKEY
135900970526     C                     END
136000970526     C           KEY       IFEQ F15
136100970526     C                     MOVEL'15'      FUNKEY
136200970526     C                     END
136300970526     C           KEY       IFEQ F16
136400970526     C                     MOVEL'16'      FUNKEY
136500970526     C                     END
136600970526     C           KEY       IFEQ F17
136700970526     C                     MOVEL'17'      FUNKEY
136800970526     C                     END
136900970526     C           KEY       IFEQ F18
137000970526     C                     MOVEL'18'      FUNKEY
137100970526     C                     END
137200970526     C           KEY       IFEQ F19
137300970526     C                     MOVEL'19'      FUNKEY
137400970526     C                     END
137500970526     C           KEY       IFEQ F20
137600970526     C                     MOVEL'20'      FUNKEY
137700970526     C                     END
137800970526     C           KEY       IFEQ F21
137900970526     C                     MOVEL'21'      FUNKEY
138000970526     C                     END
138100970526     C           KEY       IFEQ F22
138200970526     C                     MOVEL'22'      FUNKEY
138300970526     C                     END
138400970526     C           KEY       IFEQ F23
138500970526     C                     MOVEL'23'      FUNKEY
138600970526     C                     END
138700970526     C           KEY       IFEQ F24
138800970526     C                     MOVEL'24'      FUNKEY
138900970526     C                     END
139000970526     C           KEY       IFEQ ROLLUP
139100970526     C                     MOVEL'RU'      FUNKEY
139200970526     C                     END
139300970526     C           KEY       IFEQ HELP
139400970526     C                     MOVEL'HP'      FUNKEY
139500970526     C                     END
139600970526     C*
139700970526     C                     ENDSR
139800970526     C*------------------------------------------------------------------------*
139900970526     C* FUNGES - GESTIONE VISUALIZZAZIONE TASTI FUNZIONALI GESTITI DA PGM
140000970526     C*------------------------------------------------------------------------*
140100970526     C           FUNGES    BEGSR
140200970526     C*
140300970526     C* PULISCO CAMPI DI LAVORO
140400970526     C                     Z-ADD0         W       50
140500970526     C*
140600970526     C* RICERCO QUANTE FUNZIONI SONO ATTIVE
140700970526     C* E CARICO TABELLA FUNZIONI ATTIVE
140800970526     C           1         DO   24        I
140900970526     C                     MOVELFUD,I     FUDRIG
141000970526     C*
141100970526     C* PULIZIA FUNZIONI PRECEDENTI
141200970526     C                     MOVEL*BLANKS   FUV,I
141300970526     C*
141400970526     C* IMPOSTA FUNZIONI ATTIVE IN TABELLA
141500970526     C* (SALTA F23 E F24)
141600970526     C           FUDATT    IFEQ 'S'
141700970526     C           FUDFUN    ANDNE'23'
141800970526     C           FUDFUN    ANDNE'24'
141900970526     C                     ADD  1         W
142000970526     C                     MOVELFUDDES    FUV,W
142100970526     C                     END
142200970526     C                     END                             DO WHILE
142300970526     C*
142400970526     C* SE VI SONO PIU' DI 6 FUNZIONI ATTIVE, ATTIVO FUNZIONE F24
142500970526     C* ALTRIMENTI DISATTIVO F24
142600970526     C           1         DO   24        I
142700970526     C                     MOVELFUD,I     FUDRIG
142800970526     C*
142900970526     C           FUDFUN    IFEQ '24'
143000970526     C           W         IFGT 6
143100970526     C                     MOVEL'S'       FUDATT
143200970526     C                     ELSE
143300970526     C                     MOVEL*BLANKS   FUDATT
143400970526     C                     END                             W GT 8
143500970526     C                     MOVELFUDRIG    FUD,I
143600970526     C                     END
143700970526     C                     END                             DO WHILE
143800970526     C*
143900970526     C* IMPOSTO QUANTI GRUPPI DI 6 FUNZIONI SI POSSONO VISUALIZZARE
144000970526     C           W         DIV  6         I
144100970526     C                     MVR            Z
144200970526     C*
144300970526     C           Z         IFNE 0
144400970526     C           I         ADD  1         Z
144500970526     C                     ELSE
144600970526     C                     Z-ADDI         Z
144700970526     C                     END
144800970526     C*
144900970526     C* IMPOSTO SUCCESSIVE 6 FUNZIONI ATTIVE A VIDEO
145000970526     C                     ADD  1         FUNGRU
145100970526     C           FUNGRU    IFGT Z
145200970526     C           FUNGRU    ORLT 1
145300970526     C                     Z-ADD1         FUNGRU
145400970526     C                     END
145500970526     C*
145600970526     C* PRIMO GRUPPO DI 6 FUNZIONI
145700970526     C           FUNGRU    IFEQ 1
145800970526     C                     MOVELFUV,1     FUN001
145900970526     C                     MOVELFUV,2     FUN002
146000970526     C                     MOVELFUV,3     FUN003
146100970526     C                     MOVELFUV,4     FUN004
146200970526     C                     MOVELFUV,5     FUN005
146300970526     C                     MOVELFUV,6     FUN006
146400970526     C                     END
146500970526     C*
146600970526     C* SECONDO GRUPPO DI 6 FUNZIONI
146700970526     C           FUNGRU    IFEQ 2
146800970526     C                     MOVELFUV,7     FUN001
146900970526     C                     MOVELFUV,8     FUN002
147000970526     C                     MOVELFUV,9     FUN003
147100970526     C                     MOVELFUV,10    FUN004
147200970526     C                     MOVELFUV,11    FUN005
147300970526     C                     MOVELFUV,12    FUN006
147400970526     C                     END
147500970526     C*
147600970526     C* TERZO GRUPPO DI 6 FUNZIONI
147700970526     C           FUNGRU    IFEQ 3
147800970526     C                     MOVELFUV,13    FUN001
147900970526     C                     MOVELFUV,14    FUN002
148000970526     C                     MOVELFUV,15    FUN003
148100970526     C                     MOVELFUV,16    FUN004
148200970526     C                     MOVELFUV,17    FUN005
148300970526     C                     MOVELFUV,18    FUN006
148400970526     C                     END
148500970526     C*
148600970526     C* QUARTO GRUPPO DI 6 FUNZIONI
148700970526     C           FUNGRU    IFEQ 4
148800970526     C                     MOVELFUV,19    FUN001
148900970526     C                     MOVELFUV,20    FUN002
149000970526     C                     MOVELFUV,21    FUN003
149100970526     C                     MOVELFUV,22    FUN004
149200970526     C                     MOVEL*BLANKS   FUN005
149300970526     C                     MOVEL*BLANKS   FUN006
149400970526     C                     END
149500970526     C*
149600970526     C* F24 E F23 SE VI SONO, VENGONO SEMPRE VISUALIZZATI
149700970526     C                     MOVEL*BLANKS   FUN007
149800970526     C                     MOVEL*BLANKS   FUN008
149900970526     C*
150000970526     C           1         DO   24        I
150100970526     C                     MOVELFUD,I     FUDRIG
150200970526     C           FUDFUN    IFEQ '23'
150300970526     C           FUDATT    ANDEQ'S'
150400970526     C                     MOVELFUDDES    FUN007
150500970526     C                     END
150600970526     C           FUDFUN    IFEQ '24'
150700970526     C           FUDATT    ANDEQ'S'
150800970526     C                     MOVELFUDDES    FUN008
150900970526     C                     END
151000970526     C                     END                             DO
151100970526     C*
151200970526     C                     ENDSR
151300970526     C*------------------------------------------------------------------------*
151400970526     C* OPZGES - GESTIONE VISUALIZZAZIONE OPZIONI GESTITE DAL PGM
151500970526     C*------------------------------------------------------------------------*
151600970526     C           OPZGES    BEGSR
151700970526     C*
151800970526     C* PULISCO CAMPI DI LAVORO
151900970526     C                     Z-ADD0         W       50
152000970526     C*
152100970526     C* RICERCO QUANTE OPZIONI SONO ATTIVE
152200970526     C* E CARICO TABELLA OPZIONI ATTIVE
152300970526     C           1         DO   24        I
152400970526     C                     MOVELOPD,I     OPDRIG
152500970526     C*
152600970526     C* PULIZIA OPZIONI PRECEDENTI
152700970526     C                     MOVEL*BLANKS   OPV,I
152800970526     C*
152900970526     C* IMPOSTA OPZIONE ATTIVA IN TABELLA
153000970526     C           OPDATT    IFEQ 'S'
153100970526     C                     ADD  1         W
153200970526     C                     MOVELOPDDES    OPV,W
153300970526     C                     END
153400970526     C                     END                             DO WHILE
153500970526     C*
153600970526     C* SE VI SONO PIU' DI 8 OPZIONI ATTIVE, ATTIVO FUNZIONE F23
153700970526     C* ALTRIMENTI DISATTIVO F23
153800970526     C           1         DO   24        I
153900970526     C                     MOVELFUD,I     FUDRIG
154000970526     C*
154100970526     C           FUDFUN    IFEQ '23'
154200970526     C           W         IFGT 8
154300970526     C                     MOVEL'S'       FUDATT
154400970526     C                     ELSE
154500970526     C                     MOVEL*BLANKS   FUDATT
154600970526     C                     END                             W GT 8
154700970526     C                     MOVELFUDRIG    FUD,I
154800970526     C                     END
154900970526     C                     END                             DO WHILE
155000970526     C*
155100970526     C* IMPOSTO QUANTI GRUPPI DI 8 OPZIONI SI POSSONO VISUALIZZARE
155200970526     C           W         DIV  8         I
155300970526     C                     MVR            Z       50
155400970526     C*
155500970526     C           Z         IFNE 0
155600970526     C           I         ADD  1         Z
155700970526     C                     ELSE
155800970526     C                     Z-ADDI         Z
155900970526     C                     END
156000970526     C*
156100970526     C* IMPOSTO SUCCESSIVE 8 OPZIONI ATTIVE A VIDEO
156200970526     C                     ADD  1         OPZGRU
156300970526     C           OPZGRU    IFGT Z
156400970526     C           OPZGRU    ORLT 1
156500970526     C                     Z-ADD1         OPZGRU
156600970526     C                     END
156700970526     C*
156800970526     C* PRIMO GRUPPO DI 8 OPZIONI
156900970526     C           OPZGRU    IFEQ 1
157000970526     C                     MOVELOPV,1     OPZ001
157100970526     C                     MOVELOPV,2     OPZ002
157200970526     C                     MOVELOPV,3     OPZ003
157300970526     C                     MOVELOPV,4     OPZ004
157400970526     C                     MOVELOPV,5     OPZ005
157500970526     C                     MOVELOPV,6     OPZ006
157600970526     C                     MOVELOPV,7     OPZ007
157700970526     C                     MOVELOPV,8     OPZ008
157800970526     C                     END
157900970526     C*
158000970526     C* SECONDO GRUPPO DI 8 OPZIONI
158100970526     C           OPZGRU    IFEQ 2
158200970526     C                     MOVELOPV,9     OPZ001
158300970526     C                     MOVELOPV,10    OPZ002
158400970526     C                     MOVELOPV,11    OPZ003
158500970526     C                     MOVELOPV,12    OPZ004
158600970526     C                     MOVELOPV,13    OPZ005
158700970526     C                     MOVELOPV,14    OPZ006
158800970526     C                     MOVELOPV,15    OPZ007
158900970526     C                     MOVELOPV,16    OPZ008
159000970526     C                     END
159100970526     C*
159200970526     C* TERZO GRUPPO DI 8 OPZIONI
159300970526     C           OPZGRU    IFEQ 3
159400970526     C                     MOVELOPV,17    OPZ001
159500970526     C                     MOVELOPV,18    OPZ002
159600970526     C                     MOVELOPV,19    OPZ003
159700970526     C                     MOVELOPV,20    OPZ004
159800970526     C                     MOVELOPV,21    OPZ005
159900970526     C                     MOVELOPV,22    OPZ006
160000970526     C                     MOVELOPV,23    OPZ007
160100970526     C                     MOVELOPV,24    OPZ008
160200970526     C                     END
160300970526     C*
160400970526     C                     ENDSR
160500970526     C*------------------------------------------------------------------------*
160600970526     C*  OPZCON - CONTROLLO ED ESECUZIONE OPZIONI SCELTE
160700970526     C*------------------------------------------------------------------------*
160800970526     C           OPZCON    BEGSR
160900970526     C*
161000970526     C* PULISCO CAMPI DI LAVORO
161100970526     C                     Z-ADD0         I       50
161200970526     C                     Z-ADD0         W       50
161300970526     C*
161400970526     C* RICERCA OPZIONE SCELTA IN TABELLA OPZIONI
161500970526     C           1         DO   24        I
161600970526     C                     MOVELOPD,I     OPDRIG
161700970526     C*
161800970526     C* SALVO INDICE DI OPZIONE TROVATA ED ATTIVA (W)
161900970526     C           OPZKEY    IFEQ OPDOPZ
162000970526     C           OPZKEY    OREQ OPDOP1
162100970526     C*
162200970526     C           OPDATT    IFEQ 'S'
162300970526     C                     MOVELOPDOPZ    OPZKEY
162400970526     C                     Z-ADDI         W
162500970526     C                     END
162600970526     C                     END
162700970526     C*
162800970526     C                     END                             DO WHILE
162900970526     C*
163000970526     C* OPZIONE NON ATTIVA (ERRORE)
163100970526     C           W         IFEQ 0
163200970526     C*
163300970526     C* OPZIONE NON OK
163400970526     C                     Z-ADD1         OPZOK
163500970526     C*
163600970526     C* EMISSIONE MESSAGGIO DI ERRORE
163700970526     C                     MOVELMSG,1     DSMSMS
163800970526     C                     ELSE
163900970526     C*
164000970526     C* OPZIONE ATTIVA (PROCEDI ...)
164100970526     C*
164200970526     C           OPZKEY    IFEQ ' 1'
164300970526     C                     EXSR O01GES
164400970526     C                     END
164500970526     C           OPZKEY    IFEQ ' 2'
164600970526     C                     EXSR O02GES
164700970526     C                     END
164800970603     C           OPZKEY    IFEQ ' 3'
164900970603     C                     EXSR O03GES
165000970603     C                     END
165100970526     C           OPZKEY    IFEQ ' 4'
165200970526     C                     EXSR O04GES
165300970526     C                     END
165400970526     C           OPZKEY    IFEQ ' 5'
165500970526     C                     EXSR O05GES
165600970526     C                     END
165700970526     C           OPZKEY    IFEQ ' 7'
165800970526     C                     EXSR O07GES
165900970526     C                     END
166000970528     C           OPZKEY    IFEQ ' 8'
166100970528     C                     EXSR O08GES
166200970528     C                     END
166300970528     C           OPZKEY    IFEQ ' 9'
166400970528     C                     EXSR O09GES
166500970528     C                     END
166600970528     C           OPZKEY    IFEQ '10'
166700970528     C                     EXSR O10GES
166800970528     C                     END
166900970528     C           OPZKEY    IFEQ '11'
167000970528     C                     EXSR O11GES
167100970528     C                     END
167200970603     C           OPZKEY    IFEQ '13'
167300970603     C                     EXSR O13GES
167400970603     C                     END
167500970526     C                     END                             OPZ.NON ATTIVA
167600970526     C*
167700970526     C                     ENDSR
167800970526     C*------------------------------------------------------------------------*
167900970526     C* NOTE COSTRUZIONE SCHIERE
168000970526     C*------------------------------------------------------------------------*
168100970526     C*
168200970526     C* -MSG-MESSAGGI
168300970526     C* INSERIRE I VARI MESSAGGI EMESSI DAL PGM
168400970526     C* (NON TOCCARE MSG,1 E MSG,2)
168500970526     C*
168600970526     C* -CMD-COMANDI
168700970526     C* INSERIRE I VARI COMANDI DI SISTEMA RICHIESTI NEL PGM
168800970526     C*
168900970526     C* -OPD-OPZIONI
169000970526     C* INSERIRE LE VARIE OPZIONI GESTITE DAL PGM
169100970526     C*  . SI PUO' USARE LA OPZIONE ALTERNATIVA PER GESTIRE
169200970526     C*    I CASI DI OPZIONI CON UN SOLO CARATTERE
169300970526     C*  . DEVONO ESSERE IN ORDINE DI PRESENTAZIONE A VIDEO
169400970526     C*  . METTERE S/N (SI/NO) PER INDICARE QUELLE GESTITE A PGM
169500970526     C*  . POSSONO ESSERE IN ORDINE SPARSO
169600970526     C*  . PUO' ESSERE VARIATO IL CONTENUTO NEL PGM
169700970526     C*    VIENE RICARICATA LA VISUALIZZAZIONE OGNI CICLO
169800970526     C*  . SE MESSO S/N=S E NEL PGM NON E' GESTITA ALLORA
169900970526     C*    VIENE VISUALIZZATA A VIDEO MA IL PGM NON FA NULLA
170000970526     C*
170100970526     C* -FUD-FUNZIONI
170200970526     C* INSERIRE LE VARIE FUNZIONI GESTITE DAL PGM
170300970526     C*  . DEVONO ESSERE IN ORDINE DI PRESENTAZIONE A VIDEO
170400970526     C*  . METTERE S/N (SI/NO) PER INDICARE QUELLE GESTITE A PGM
170500970526     C*  . POSSONO ESSERE IN ORDINE SPARSO
170600970526     C*  . PUO' ESSERE VARIATO IL CONTENUTO NEL PGM
170700970526     C*    VIENE RICARICATA LA VISUALIZZAZIONE OGNI CICLO
170800970526     C*  . SE MESSO S/N=S E NEL PGM NON E' GESTITA ALLORA
170900970526     C*    VIENE VISUALIZZATA A VIDEO MA IL PGM DICE "NON GESTITA"
171000970526     C*  . METTERE F23 E F24 CON S/N=S (RICALCOLATE DAL PGM)
171100970526     C*  . SEGUIRE LE NOTE MESSE NELLA SCHIERA
171200970526     O*------------------------------------------------------------------------*
171300970526** DEC - DECODIFICHE
171400970526    GESTIONE                                                     1
171500970526INTERROGAZIONE                                                   2
171600970530     SCELTA                                                      3
1717009705264
1718009705265
171900970526** MSG - MESSAGGI
172000970526TISI46R- Opzione non gestita                                                   1
172100970526TISI46R- Tasto funzionale non gestito                                          2
172200970526TISI46R-
172300970526TISI46R- Record annullato. Consentito solo il ripristino                       4
172400970526TISI46R- Record non annullato. Impossibile ripristinare                        5
172500970526TISI46R- Accettato solo un parametro di inizio lista                           6
172600970526TISI46R- Errori nei parametri di ingresso                                      7
172700970526TISI46R- Data errata                                                           8
172800970526TISI46R- 9                                                                     9
172900970526TISI46R- 10                                                                   10
173000970526TISI46R- 11                                                                   11
173100970526TISI46R- 12                                                                   12
173200970526TISI46R- 13                                                                   13
173300970526TISI46R- 14                                                                   14
173400970526TISI46R- 15                                                                   15
173500970526TISI46R- 16                                                                   16
173600970526TISI46R- 17                                                                   17
173700970526TISI46R- 18                                                                   18
173800970526TISI46R- 19                                                                   19
173900970526TISI46R- 20                                                                   20
174000970526** CMD - COMANDI CL
174100970526WRKSPLF
174200970526
174300970526
174400970526
174500970526
174600970526** OPD - OPZIONI
174700970526 1=Scelta          -1 -     (S/N)=N                        opz. 01
174800970526 2=Modifica        -2 -     (S/N)=N                        opz. 02
174900970723 3=Duplica CAPPARIO 3 -     (S/N)=N                        opz. 03
175000970526 4=Annullamento    -4 -     (S/N)=N                        opz. 04
175100970526 5=Visualizzazione -5 -     (S/N)=N                        opz. 05
175200020409                   -6 -     (S/N)=N                        opz. 06
175300970526 7=Ripristino      -7 -     (S/N)=N                        opz. 07
175400970626 8=Localit        -8 -     (S/N)=N                        opz. 08
175500970626 9=Eccezioni       -9 -     (S/N)=N                        opz. 09
17560097062610=Tempi consegna  -10-     (S/N)=N                        opz. 10
17570097062611=Cap             -11-     (S/N)=N                        opz. 11
175800970526                   -  -     (S/N)=N                        opz. 12
17590097062613=Sinonimi        -13-     (S/N)=N                        opz. 13
176000970526                   -  -     (S/N)=N                        opz. 14
176100970526                   -  -     (S/N)=N                        opz. 15
176200970526                   -  -     (S/N)=N                        opz. 16
176300970526                   -  -     (S/N)=N                        opz. 17
176400970526                   -  -     (S/N)=N                        opz. 18
176500970526                   -  -     (S/N)=N                        opz. 19
176600970526                   -  -     (S/N)=N                        opz. 20
176700970526                   -  -     (S/N)=N                        opz. 21
176800970526                   -  -     (S/N)=N                        opz. 22
176900970526                   -  -     (S/N)=N                        opz. 23
177000970526                   -  -     (S/N)=N                        opz. 24
177100970526** FUD - FUNZIONI
177200970526                   -        (S/N)=N                        funz.01
177300970526                   -        (S/N)=N                        funz.02
177400970526F03=Fine           -        (S/N)=S  <== S-FISSO           funz.03
177500970526                   -        (S/N)=N                        funz.04
177600970526F05=Rivisualizza   -        (S/N)=S  <== S-FISSO           funz.05
177700970526F06=Inserimento    -        (S/N)=N                        funz.06
177800970526                   -        (S/N)=N                        funz.07
177900970626F08=Localit       -        (S/N)=N                        funz.08
178000970626F09=Eccezioni      -        (S/N)=N                        funz.09
178100970626F10=Tempi consegna -        (S/N)=N                        funz.10
178200970626F11=Cap            -        (S/N)=N                        funz.11
178300970704F12=Ritorno        -        (S/N)=S  <== S-FISSO           funz.12
178400970626F13=Sinonimi       -        (S/N)=N                        funz.13
178500970603                   -        (S/N)=S                        funz.14
178600970526                   -        (S/N)=N                        funz.15
178700970526                   -        (S/N)=N                        funz.16
178800970526                   -        (S/N)=N                        funz.17
178900970526                   -        (S/N)=N                        funz.18
179000970627 RU=Pagina su      -        (S/N)=S  <== S-FISSO           funz.19
179100970627 RD=Pagina gi     -        (S/N)=S  <== S-FISSO           funz.20
179200970526                   -        (S/N)=N                        funz.21
179300970626F22=Gestione stampe-        (S/N)=S                        funz.22
179400970526F23=Altre opzioni  -        (S/N)=S  <== S-FISSO           funz.23
179500970526F24=Altri tasti    -        (S/N)=S  <== S-FISSO           funz.24
