000100940304     H DECEDIT('0,') DATEDIT(*DMY.)
000200940304?     *--------------------------------------------------------------*
000300950302      * TNSC64R                                                      *
000400940304      *       *-----------------------------------------*            *
000500940712      *          SCARICO ARCHIVI PULIZIA C/A DI SEDE                *
000600940304      *       *-----------------------------------------*            *
000700940304      *                                                              *
000800940304?     *--------------------------------------------------------------*
000900940304      * KC -Fine Lavoro                                              *
001000940304      * KF -Conferma                                                 *
001100940304?     *--------------------------------------------------------------*
001200950302     FTNSC64D   CF   E             WORKSTN
001300940712?     *--------------------------------------------------------------*
001400940712?     *  SCHIERE                                                     *
001500940712?     *--------------------------------------------------------------*
001600130716     D ERR             S             70    DIM(4) CTDATA PERRCD(1)
001601130716     D cmd1            S              1    DIM(99) CTDATA PERRCD(99)
001602130716     D cmd2            S              1    DIM(99) CTDATA PERRCD(99)
001700940304?     *--------------------------------------------------------------*
001800940304?     *  DS                                                          *
001900940304?     *--------------------------------------------------------------*
002000940304     D KPJBA         E DS
002100940712      *
002200020909     D TIBS55        E DS                  EXTNAME(TIBS55DS)
002300950302     D TNSC64        E DS                  EXTNAME(TNSC64DS)
002400940304      *
002500940712     D UT§DSE        E DS                  EXTNAME(UT§DSE0F)
002600940712     D CNCR80        E DS
002700940712      *
002800940304     D                SDS
002900940304     D  NOMPGM                 1     10
002901130716     d coman           s             99
002902130716     d luncmd          s             15  5
003000940304      *---------------------------------------------------------------*
003100940304      *   C I C L O      P R I N C I P A L E                          *
003200940304      *---------------------------------------------------------------*
003300940304     C*  Inizializzazione videata
003400940304     C                   EXSR      INZVID
003500940304     C*
003600940304     C*  Loop
003700940304     C     £FINE         DOUEQ     'S'
003800940304     C*
003900940304     C     TIPVID        CASEQ     '1'           GESVD1
004000940304     C                   END
004100940304     C*
004200940304     C                   END
004300940304     C*
004400940304     C                   SETON                                        LR
004500940304      *---------------------------------------------------------------*
004600940304      *  INZVID: Inizializzazione parametri video                     *
004700940304      *---------------------------------------------------------------*
004800940304     C     INZVID        BEGSR
004900940304     C*
005000130716     C                   clear                   V1Clib
005001130716     C                   clear                   V1Cnas
005200940712     C                   MOVEL     NOMPGM        §PGM
005300950302     C                   MOVEL     'SI'          V1CPUL
005400940712     C                   MOVEL     *BLANKS       $MSG
005500940304     C*
005600940304     C                   ENDSR
005700940304      *---------------------------------------------------------------*
005800940304      *  GESVD1: Gestione prima videata richiesta parametri           *
005900940304      *---------------------------------------------------------------*
006000940304     C     GESVD1        BEGSR
006100940304     C*
006200950302     C                   WRITE     SC64T01
006300950302     C                   EXFMT     SC64D01
006400130716     C                   SETOFF                                       902123
006500940712     C                   MOVEL     *BLANKS       $MSG
006600940304     C*  Fine elaborazione
006700940304     C     *INKC         IFEQ      '1'
006800950302     C                   CLEAR                   TNSC64
006900940304     C                   MOVEL     'S'           £FINE
007000940304     C                   GOTO      FINVD1
007100940304     C                   END
007200940712     C*  Pe.Batch
007300940712     C     *INKV         IFEQ      '1'
007400940712     C                   CALL      'BCH09'
007500940712     C                   PARM                    KPJBA
007600940712     C                   END
007700940304     C*  Controlli
007800940304     C                   EXSR      CNTVD1
007900940712     C   90              GOTO      FINVD1
008000940304     C*  conferma
008100940304     C     *INKF         IFEQ      '1'
008200940712     C                   MOVEL     'S'           £FINE
008300130716     C                   MOVEL     V1Clib        D64lib
008301130716     C                   MOVEL     V1Cnas        D64nas
008500950302     C                   MOVEL     V1CPUL        D64PUL
008700950302     C                   MOVE      'SC65'        KCOAZ
008800950302     C                   MOVEL     TNSC64        KPJBU
008900940712     C                   CALL      'BCH10'
009000940712     C                   PARM                    KPJBA
009100940304     C                   END
009200940304     C*
009300940304     C     FINVD1        ENDSR
009400940304      *---------------------------------------------------------------*
009500940304      *  CNTVD1: Controlli prima videata                              *
009600940304      *---------------------------------------------------------------*
009700940304     C     CNTVD1        BEGSR
009800940304     C*----------------------------------------------------*
009900130716     C     V1Clib        IFEQ      *BLANKS
010000940712     C                   SETON                                        2190
010100940712     C                   MOVEL     ERR(1)        $MSG
010200940304     C                   GOTO      FINCT1
010201130716     c                   else
010202130716     c                   movea     cmd1          coman
010203130716     c                   eval      %subst(coman:12:10) = v1clib
010204130716     c                   exsr      comandi2
010205130716     c                   if        *in34
010206130716     C                   SETON                                        2190
010207130716     C                   MOVEL     ERR(2)        $MSG
010208130716     C                   GOTO      FINCT1
010209130716     C                   endif
010300940304     C                   END
010400940304     C*----------------------------------------------------*
010401130716     C     V1Cnas        IFEQ      *BLANKS
010402120326     C                   SETON                                        2390
010403120326     C                   MOVEL     ERR(3)        $MSG
010404120326     C                   GOTO      FINCT1
010405130716     c                   else
010406130716     c                   movea     cmd2          coman
010407130716     c                   eval      %subst(coman:12:10) = v1cnas
010408130716     c                   exsr      comandi2
010409130716     c                   if        *in34
010410130716     C                   SETON                                        2390
010411130716     C                   MOVEL     ERR(4)        $MSG
010412130716     C                   GOTO      FINCT1
010413130716     C                   endif
010414120326     C                   END
010900130716     C*-
011000940304     C     FINCT1        ENDSR
011101130716     c*-------------------------------------------------
011102130716     c     comandi2      begsr
011103130716     c*-------------------------------------------------
011104130716      *
011105130716     C                   z-add     99            luncmd
011106130716     C                   CALL      'QCMDEXC'                            34
011107130716     C                   parm                    coman
011108130716     C                   parm                    luncmd
011109130716      *
011110130716     c                   endsr
011200940304      *  *INZSR: OPERAZIONI INIZIALI                                  *
011300940304      *---------------------------------------------------------------*
011400940304     C     *INZSR        BEGSR
011500940304      *---------------------------------------------------------------*
011600940304     C     *ENTRY        PLIST
011700940304     C                   PARM                    KPJBA
011800940712      *---------------------------------------------------------------*
011900940712     C                   Z-ADD     1             CODUT
012000940712     C                   CALL      'X§PARUT'
012100940712     C                   PARM                    UT§DSE
012200940712     C                   MOVEL     RAGUT         RSUT             20
012300940712     C                   MOVEL     REC80         CNCR80
012400940304     C*----------------------------------------------------*
012500940304     C                   MOVEL     'N'           £FINE             1
012600940304     C                   MOVEL     '1'           TIPVID            1
012700971230     C*----------------------------------------------------*
012800020909     C                   CLEAR                   TIBS55
012900971230     C                   MOVEL     'L'           I50TLA
013000020909     C                   MOVE      SIMPOU        I50PPO
013100971230     C                   MOVE      KNSIF         I50PSI
013200020909     C                   CALL      'TIBS55R'
013300020909     C                   PARM                    TIBS55
013400940304     C*----------------------------------------------------*
013500940304     C                   ENDSR
013600940712**
013700130716Immettere nome libreria salvataggio dati
013800130716Libreria inesistente
013900130716Immettere nome unità nastri per salvataggio
014000130716Unità nastri inesistente
014100130716**  CMD1
014200130716CHKOBJ OBJ(SAVCONxxxx) OBJTYPE(*LIB)
014300130716**  CMD2
014400130716CHKOBJ OBJ(TAP01     ) OBJTYPE(*DEVD)
