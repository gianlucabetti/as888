000100940304     H DECEDIT('0,') DATEDIT(*DMY.)
000200940304?     *--------------------------------------------------------------*
000300950302      * TNSC66R                                                      *
000400940304      *       *-----------------------------------------*            *
000500940712      *          SCARICO ARCHIVI PULIZIA C/A DI SEDE                *
000600940304      *       *-----------------------------------------*            *
000700940304      *                                                              *
000800940304?     *--------------------------------------------------------------*
000900940304      * KC -Fine Lavoro                                              *
001000940304      * KF -Conferma                                                 *
001100940304?     *--------------------------------------------------------------*
001200950302     FTNSC66D   CF   E             WORKSTN
001300940712?     *--------------------------------------------------------------*
001400940712?     *  SCHIERE                                                     *
001500940712?     *--------------------------------------------------------------*
001600130716     D ERR             S             70    DIM(6) CTDATA PERRCD(1)
001601130716     D cmd1            S              1    DIM(99) CTDATA PERRCD(99)
001602130716     D cmd2            S              1    DIM(99) CTDATA PERRCD(99)
001700940304?     *--------------------------------------------------------------*
001800940304?     *  DS                                                          *
001900940304?     *--------------------------------------------------------------*
002000940304     D KPJBA         E DS
002100940712      *
002200950302     D TNSC66        E DS                  EXTNAME(TNSC66DS)
002300020909     D TIBS55        E DS                  EXTNAME(TIBS55DS)
002400940304      *
002500940712     D UT§DSE        E DS                  EXTNAME(UT§DSE0F)
002600940712     D CNCR80        E DS
002700940712      *
002800940304     D                SDS
002900940304     D  NOMPGM                 1     10
002901130716     d coman           s             99
002902130716     d luncmd          s             15  5
003000940304      *---------------------------------------------------------------*
003100940304      *   C I C L O      P R I N C I P A L E                          *
003200940304      *---------------------------------------------------------------*
003300940304     C*  Inizializzazione videata
003400940304     C                   EXSR      INZVID
003500940304     C*
003600940304     C*  Loop
003700940304     C     £FINE         DOUEQ     'S'
003800940304     C*
003900940304     C     TIPVID        CASEQ     '1'           GESVD1
004000940304     C                   END
004100940304     C*
004200940304     C                   END
004300940304     C*
004400950302     C                   MOVEL     TNSC66        KPJBU
004500940304     C                   SETON                                        LR
004600940304      *---------------------------------------------------------------*
004700940304      *  INZVID: Inizializzazione parametri video                     *
004800940304      *---------------------------------------------------------------*
004900940304     C     INZVID        BEGSR
005000940304     C*
005100130716     C                   clear                   V1Clib
005101130716     C                   clear                   V1Cnas
005300130716     C                   MOVEL     'GAITRA201'   V1CLIB2
005500940712     C                   MOVEL     NOMPGM        §PGM
005600940712     C                   MOVEL     *BLANKS       $MSG
005700940304     C*
005800940304     C                   ENDSR
005900940304      *---------------------------------------------------------------*
006000940304      *  GESVD1: Gestione prima videata richiesta parametri           *
006100940304      *---------------------------------------------------------------*
006200940304     C     GESVD1        BEGSR
006300940304     C*
006400950302     C                   WRITE     SC66T01
006500950302     C                   EXFMT     SC66D01
006600940712     C                   SETOFF                                       212223
006700940712     C                   SETOFF                                       90
006800940712     C                   MOVEL     *BLANKS       $MSG
006900940304     C*  Fine elaborazione
007000940304     C     *INKC         IFEQ      '1'
007100940304     C                   MOVEL     'S'           £FINE
007200940304     C                   GOTO      FINVD1
007300940304     C                   END
007400940712     C*  Pe.Batch
007500940712     C     *INKV         IFEQ      '1'
007600940712     C                   CALL      'BCH09'
007700940712     C                   PARM                    KPJBA
007800940712     C                   END
007900940304     C*  Controlli
008000940304     C                   EXSR      CNTVD1
008100940712     C   90              GOTO      FINVD1
008200940304     C*  conferma
008300940304     C     *INKF         IFEQ      '1'
008400940712     C                   MOVEL     'S'           £FINE
008500130716     C                   MOVEL     V1Clib        D66lib
008501130716     C                   MOVEL     V1Cnas        D66nas
008700130716     C                   MOVEL     V1CLIB2       D66LIB2
008900950302     C                   MOVE      'SC67'        KCOAZ
009000950302     C                   MOVEL     TNSC66        KPJBU
009100940712     C                   CALL      'BCH10'
009200940712     C                   PARM                    KPJBA
009300940304     C                   END
009400940304     C*
009500940304     C     FINVD1        ENDSR
009600940304      *---------------------------------------------------------------*
009700130716      *  CNTVD1: Controlli prima videata                              *
009800940304      *---------------------------------------------------------------*
009900940304     C     CNTVD1        BEGSR
010000940304     C*----------------------------------------------------*
010001130716     C     V1Clib        IFEQ      *BLANKS
010002130716     C                   SETON                                        2190
010003130716     C                   MOVEL     ERR(1)        $MSG
010004130716     C                   GOTO      FINCT1
010005130716     c                   else
010006130716     c                   movea     cmd1          coman
010007130716     c                   eval      %subst(coman:12:10) = v1clib
010008130716     c                   exsr      comandi2
010009130716     c                   if        *in34
010010130716     C                   SETON                                        2190
010011130716     C                   MOVEL     ERR(2)        $MSG
010012130716     C                   GOTO      FINCT1
010013130716     C                   endif
010014130716     C                   END
010600940304     C*----------------------------------------------------*
010601130716     C     V1Cnas        IFEQ      *BLANKS
010602130716     C                   SETON                                        2390
010603130716     C                   MOVEL     ERR(3)        $MSG
010604130716     C                   GOTO      FINCT1
010605130716     c                   else
010606130716     c                   movea     cmd2          coman
010607130716     c                   eval      %subst(coman:12:10) = v1cnas
010608130716     c                   exsr      comandi2
010609130716     c                   if        *in34
010610130716     C                   SETON                                        2390
010611130716     C                   MOVEL     ERR(4)        $MSG
010612130716     C                   GOTO      FINCT1
010613130716     C                   endif
010614130716     C                   END
010615130716     C     V1Clib2       IFEQ      *BLANKS
010616130716     C                   SETON                                        2290
010617130716     C                   MOVEL     ERR(5)        $MSG
010618130716     C                   GOTO      FINCT1
010619130716     c                   else
010620130716     c                   movea     cmd1          coman
010621130716     c                   eval      %subst(coman:12:10) = v1clib2
010622130716     c                   exsr      comandi2
010623130716     c                   if        *in34
010624130716     C                   SETON                                        2290
010625130716     C                   MOVEL     ERR(6)        $MSG
010626130716     C                   GOTO      FINCT1
010627130716     C                   endif
010628130716     C                   END
010634130716      *-
011800940304     C     FINCT1        ENDSR
011801130716     c*-------------------------------------------------
011802130716     c     comandi2      begsr
011803130716     c*-------------------------------------------------
011804130716      *
011805130716     C                   z-add     99            luncmd
011806130716     C                   CALL      'QCMDEXC'                            34
011807130716     C                   parm                    coman
011808130716     C                   parm                    luncmd
011809130716      *
011810130716     c                   endsr
011900940304      *---------------------------------------------------------------*
012000940304      *  *INZSR: OPERAZIONI INIZIALI                                  *
012100940304      *---------------------------------------------------------------*
012200940304     C     *INZSR        BEGSR
012300940304      *---------------------------------------------------------------*
012400940304     C     *ENTRY        PLIST
012500940304     C                   PARM                    KPJBA
012600940712      *---------------------------------------------------------------*
012700940712     C                   Z-ADD     1             CODUT
012800940712     C                   CALL      'X§PARUT'
012900940712     C                   PARM                    UT§DSE
013000940712     C                   MOVEL     RAGUT         RSUT             20
013100940712     C                   MOVEL     REC80         CNCR80
013200940304     C*----------------------------------------------------*
013300940304     C                   MOVEL     'N'           £FINE             1
013400940304     C                   MOVEL     '1'           TIPVID            1
013500980105     C*----------------------------------------------------*
013600020909     C                   CLEAR                   TIBS55
013700980105     C                   MOVEL     'L'           I50TLA
013800020909     C                   MOVE      SIMPOU        I50PPO
013900980105     C                   MOVE      KNSIF         I50PSI
014000020909     C                   CALL      'TIBS55R'
014100020909     C                   PARM                    TIBS55
014200940304     C*----------------------------------------------------*
014300940304     C                   ENDSR
014400940712**
014401130716Immettere nome libreria salvataggio dati
014402130716Libreria inesistente
014403130716Immettere nome unità nastri per salvataggio
014404130716Unità nastri inesistente
014405130716Immettere nome libreria caricamento valida
014406130716Libreria caricamento inesistente
014500130716**  CMD1
014600130716CHKOBJ OBJ(SAVCONxxxx) OBJTYPE(*LIB)
014700130716**  CMD2
014800130716CHKOBJ OBJ(TAP01     ) OBJTYPE(*DEVD)
