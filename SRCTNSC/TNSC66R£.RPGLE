000100940304     H DECEDIT('0,') DATEDIT(*DMY.)
000200940304?     *--------------------------------------------------------------*
000300950302      * TNSC66R                                                      *
000400940304      *       *-----------------------------------------*            *
000500940712      *          SCARICO ARCHIVI PULIZIA C/A DI SEDE                *
000600940304      *       *-----------------------------------------*            *
000700940304      *                                                              *
000800940304?     *--------------------------------------------------------------*
000900940304      * KC -Fine Lavoro                                              *
001000940304      * KF -Conferma                                                 *
001100940304?     *--------------------------------------------------------------*
001200950302     FTNSC66D   CF   E             WORKSTN
001300940712?     *--------------------------------------------------------------*
001400940712?     *  SCHIERE                                                     *
001500940712?     *--------------------------------------------------------------*
001600120326     D ERR             S             70    DIM(4) CTDATA PERRCD(1)
001700940304?     *--------------------------------------------------------------*
001800940304?     *  DS                                                          *
001900940304?     *--------------------------------------------------------------*
002000940304     D KPJBA         E DS
002100940712      *
002200950302     D TNSC66        E DS                  EXTNAME(TNSC66DS)
002300020909     D TIBS55        E DS                  EXTNAME(TIBS55DS)
002400940304      *
002500940712     D UT§DSE        E DS                  EXTNAME(UT§DSE0F)
002600940712     D CNCR80        E DS
002700940712      *
002800940304     D                SDS
002900940304     D  NOMPGM                 1     10
003000940304      *---------------------------------------------------------------*
003100940304      *   C I C L O      P R I N C I P A L E                          *
003200940304      *---------------------------------------------------------------*
003300940304     C*  Inizializzazione videata
003400940304     C                   EXSR      INZVID
003500940304     C*
003600940304     C*  Loop
003700940304     C     £FINE         DOUEQ     'S'
003800940304     C*
003900940304     C     TIPVID        CASEQ     '1'           GESVD1
004000940304     C                   END
004100940304     C*
004200940304     C                   END
004300940304     C*
004400950302     C                   MOVEL     TNSC66        KPJBU
004500940304     C                   SETON                                        LR
004600940304      *---------------------------------------------------------------*
004700940304      *  INZVID: Inizializzazione parametri video                     *
004800940304      *---------------------------------------------------------------*
004900940304     C     INZVID        BEGSR
005000940304     C*
005100950302     C                   MOVEL     'TNCPB00F'    V1CBOL
005101120326     C                   MOVEL     'TNCPM00F'    V1Cmul
005200950302     C                   MOVEL     'TNCPV00F'    V1CVAR
005300950302     C                   MOVEL     'GAITRA20'    V1CLIB
005400950302     C                   MOVE      '1 '          V1CLIB
005500940712     C                   MOVEL     NOMPGM        §PGM
005600940712     C                   MOVEL     *BLANKS       $MSG
005700940304     C*
005800940304     C                   ENDSR
005900940304      *---------------------------------------------------------------*
006000940304      *  GESVD1: Gestione prima videata richiesta parametri           *
006100940304      *---------------------------------------------------------------*
006200940304     C     GESVD1        BEGSR
006300940304     C*
006400950302     C                   WRITE     SC66T01
006500950302     C                   EXFMT     SC66D01
006600940712     C                   SETOFF                                       212223
006700940712     C                   SETOFF                                       90
006800940712     C                   MOVEL     *BLANKS       $MSG
006900940304     C*  Fine elaborazione
007000940304     C     *INKC         IFEQ      '1'
007100940304     C                   MOVEL     'S'           £FINE
007200940304     C                   GOTO      FINVD1
007300940304     C                   END
007400940712     C*  Pe.Batch
007500940712     C     *INKV         IFEQ      '1'
007600940712     C                   CALL      'BCH09'
007700940712     C                   PARM                    KPJBA
007800940712     C                   END
007900940304     C*  Controlli
008000940304     C                   EXSR      CNTVD1
008100940712     C   90              GOTO      FINVD1
008200940304     C*  conferma
008300940304     C     *INKF         IFEQ      '1'
008400940712     C                   MOVEL     'S'           £FINE
008500950302     C                   MOVEL     V1CBOL        D66BOL
008501120326     C                   MOVEL     V1Cmul        D66mul
008600950302     C                   MOVEL     V1CVAR        D66VAR
008700950302     C                   MOVEL     V1CLIB        D66LIB
008800980105     C                   MOVEL     O50PLG        D66LBR
008900950302     C                   MOVE      'SC67'        KCOAZ
009000950302     C                   MOVEL     TNSC66        KPJBU
009100940712     C                   CALL      'BCH10'
009200940712     C                   PARM                    KPJBA
009300940304     C                   END
009400940304     C*
009500940304     C     FINVD1        ENDSR
009600940304      *---------------------------------------------------------------*
009700940304      *  CNTVD1: Controlli prima videata                              *
009800940304      *---------------------------------------------------------------*
009900940304     C     CNTVD1        BEGSR
010000940304     C*----------------------------------------------------*
010100950302     C     V1CBOL        IFEQ      *BLANKS
010200940712     C                   SETON                                        2190
010300940712     C                   MOVEL     ERR(1)        $MSG
010400940304     C                   GOTO      FINCT1
010500940304     C                   END
010600940304     C*----------------------------------------------------*
010601120326     C     V1Cmul        IFEQ      *BLANKS
010602120326     C                   SETON                                        2390
010603120326     C                   MOVEL     ERR(4)        $MSG
010604120326     C                   GOTO      FINCT1
010605120326     C                   END
010606120326     C*----------------------------------------------------*
010700950302     C     V1CVAR        IFEQ      *BLANKS
010800940712     C                   SETON                                        2290
010900940712     C                   MOVEL     ERR(2)        $MSG
011000940712     C                   END
011100940712     C*----------------------------------------------------*
011200950302     C     V1CLIB        IFEQ      *BLANKS
011300940712     C                   SETON                                        2390
011400940712     C                   MOVEL     ERR(3)        $MSG
011500940712     C                   GOTO      FINCT1
011600940712     C                   END
011700940304     C*----------------------------------------------------*
011800940304     C     FINCT1        ENDSR
011900940304      *---------------------------------------------------------------*
012000940304      *  *INZSR: OPERAZIONI INIZIALI                                  *
012100940304      *---------------------------------------------------------------*
012200940304     C     *INZSR        BEGSR
012300940304      *---------------------------------------------------------------*
012400940304     C     *ENTRY        PLIST
012500940304     C                   PARM                    KPJBA
012600940712      *---------------------------------------------------------------*
012700940712     C                   Z-ADD     1             CODUT
012800940712     C                   CALL      'X§PARUT'
012900940712     C                   PARM                    UT§DSE
013000940712     C                   MOVEL     RAGUT         RSUT             20
013100940712     C                   MOVEL     REC80         CNCR80
013200940304     C*----------------------------------------------------*
013300940304     C                   MOVEL     'N'           £FINE             1
013400940304     C                   MOVEL     '1'           TIPVID            1
013500980105     C*----------------------------------------------------*
013600020909     C                   CLEAR                   TIBS55
013700980105     C                   MOVEL     'L'           I50TLA
013800020909     C                   MOVE      SIMPOU        I50PPO
013900980105     C                   MOVE      KNSIF         I50PSI
014000020909     C                   CALL      'TIBS55R'
014100020909     C                   PARM                    TIBS55
014200940304     C*----------------------------------------------------*
014300940304     C                   ENDSR
014400940712**
014500940712Immettere nome archivio salvataggio dati bolle
014600940712Immettere nome archivio salvataggio dati variazioni C/A
014700940712Immettere nome Libreria caricamento dati C/A
014800120326Immettere nome archivio salvataggio multiassegni
