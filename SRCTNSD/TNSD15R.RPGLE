000100080225      * TNSD15R *-----------------------------------------------------*
000200080225      *?MANUTENZIONE ORGANIGRAMMA                                    ?*
000300080225      *---------------------------------------------------------------*
000400080225      *
000500080225     h decedit('0,') datedit(*ymd/) option(*nodebugio)
000600080225      *
000700080225      *?  A R C H I V I  ?--------------------------------------------*
000800080225      *
000900080225     fTABEL00F  if   e           k disk
001000080225     fAZORG01L  Uf A e           k disk
001100080225     fAZOSE01L  Uf A e           k disk    rename(AZORG:AZOSE)
001200080225     fAZOSE10F  Uf A e           k disk
001300080225      *
001400080225     fTNSD15D   cf   e             workstn
001500080225     f                                     sfile(SD15DSF:NRR)
001600080225      *
001700080225      *?  C O S T A N T I  ?------------------------------------------*
001800080225      *
001900080225      * - Codice Utente
002000080225     d C_CodUt         c                   const(1)
002100080225      *
002200080225      * - Indicazioni a video
002300080225     d C_Ln_x_Tar      c                   const('LINEA PER TARIFFE')
002400080225     d C_NotOpe        c                   const('NON OPERAT.')
002500080225     d C_1_Liv         c                   const('1° LIVELLO ')
002600080225     d C_2_liv         c                   const('2° LIVELLO ')
002700130423
002800130423     d Digits          c                   const('0123456789')
002900080225      *
003000080225      *?  S C H I E R E  ?--------------------------------------------*
003100080225      *
003200080225      * - Messaggi di errore
003300150430     d Msg             s             78    dim(23)  ctdata  perrcd(1)
003400080225      *
003500080225      *?  S T R U T T U R E   D A T I  ?------------------------------*
003600080225      *
003700080225      * Parametri ricevuti
003800080225     d KPJBA         e ds
003900080225      *
004000080225      * - Parametri x Controllo profilo utenti
004100080225     d TIBS34ds      e ds                  inz
004200080225      * - Ds di riferimento al file esterno AZUTE00F
004300080225     d AZUTEds       e ds                  extname(AZUTE00F)
004400080225      * - Ds per dati organigramma
004500080225     d dDatiUte      e ds
004600080225      * - Abilitazioni utenti aziendali
004700080225     d dUte01        e ds
004800080225      *
004900080225     d dsOG          e ds                  inz
005000080225     d dsOR          e ds                  inz
005100080225     d FNLV55ds      e ds                  inz
005200120712
005300120712     d TRTB09DS      e ds
005400130828     d
005500130828     d tisio0ds      e ds
005600080225      *
005700131108     d Og129         e ds                  inz
005800130422     d Og130         e ds                  inz
005900080225     d Og140         e ds                  inz
006000080225     d Og141         e ds                  inz
006100080225     d Og142         e ds                  inz
006200080225     d Og143         e ds                  inz
006300150430     d w_Og143       e ds                  inz  EXTNAME(OG143) prefix(w_)
006400080225     d Og144         e ds                  inz
006500080225     d Og146         e ds                  inz
006600080225     d Og147         e ds                  inz
006700080225     d Og148         e ds                  inz
006800080225     d Og149         e ds                  inz
006900080225     d Og150         e ds                  inz
007000080225      *
007100080225      * - DS PER TRTB69R - TRTB70R - TRTB72R - TRTB73R - INT/GEST PARTIC.
007200080225     d TIBS02ds      e ds                  inz
007300130422
007400130422      * - Controllo indirizzo mail
007500130422     d dsemail       e ds
007600080225      *
007700080225      * - Controllo/Inversione date
007800080225     d WLBdat          ds                  inz
007900080225     d  G02dat                 1      8  0 inz
008000080225     d  G02inv                 9     16  0 inz
008100080225     d  G02err                17     17    inz('3')
008200080225     d  G02tgi                18     22  0 inz
008300080225      *
008400080225     d DE_ds           ds                  inz
008500080225     d  ORGd01                                                                     1     25
008600080225     d  ORGd02                                                                    26     50
008700080225     d  ORGd03                                                                    51     75
008800080225     d  ORGd04                                                                    76    100
008900080225     d  ORGd05                                                                   101    125
009000080225     d  ORGd06                                                                   126    150
009100080225     d  ORGd07                                                                   151    175
009200080225     d  ORGd08                                                                   176    200
009300080225     d  ORGd09                                                                   201    225
009400080225     d  ORGd10                                                                   226    250
009500080225     d  ORGd11                                                                   251    275
009600080225     d  ORGd12                                                                   276    300
009700080225     d  ORGd13                                                                   301    325
009800080225     d  ORGd14                                                                   326    350
009900080225     d  ORGd15                                                                   351    375
010000080225     d  ORGd16                                                                   376    400
010100080225     d  ORGd17                                                                   401    425
010200080225     d  ORGd18                                                                   426    450
010300080225     d  ORGd19                                                                   451    475
010400080225     d  ORGd20                                                                   476    500
010500080225     d  ORGd21                                                                   501    525
010600080225     d  ORGd22                                                                   526    550
010700080225     d  ORGd23                                                                   551    575
010800080225     d  ORGd24                                                                   576    600
010900080225     d  ORGd25                                                                   601    625
011000080225     d  ORGd26                                                                   626    650
011100080225     d  ORGd27                                                                   651    675
011200080225     d  ORGd28                                                                   676    700
011300080225     d  ORGd29                                                                   701    725
011400080225     d  ORGd30                                                                   726    750
011500080225     d  ORGd31                                                                   751    775
011600080225     d  ORGd32                                                                   776    800
011700080225     d  ORGd33                                                                   801    825
011800080225     d  ORGd34                                                                   826    850
011900080225     d  ORGd35                                                                   851    875
012000080225     d  ORGd36                                                                   876    900
012100080225     d  ORGd37                                                                   901    925
012200080225     d  ORGd38                                                                   926    950
012300080225     d  ORGd39                                                                   951    975
012400080225     d  ORGd40                                                                   976   1000
012500080225     d  ORGd41                                                                  1001   1025
012600080225     d  ORGd42                                                                  1026   1050
012700080225     d  ORGd43                                                                  1051   1075
012800080225     d  ORGd44                                                                  1076   1100
012900080225     d  ORGd45                                                                  1101   1125
013000080225     d  ORGd46                                                                  1126   1150
013100080225     d  ORGd47                                                                  1151   1175
013200080225     d  ORGd48                                                                  1176   1200
013300080225     d  ORGd49                                                                  1201   1225
013400080225     d  ORGd50                                                                  1226   1250
013500080225     d  ORGd51                                                                  1251   1275
013600080225     d  ORGd52                                                                  1276   1300
013700080225     d  ORGd53                                                                  1301   1325
013800080225     d  ORGd54                                                                  1326   1350
013900080225     d  ORGd55                                                                  1351   1375
014000080225     d  ORGd56                                                                  1376   1400
014100080225     d  ORGd57                                                                  1401   1425
014200080225     d  ORGd58                                                                  1426   1450
014300080225     d  ORGd59                                                                  1451   1475
014400080225     d  ORGd60                                                                  1476   1500
014500080225     d  ORGd61                                                                  1501   1525
014600080225     d  ORGd62                                                                  1526   1550
014700080225     d  ORGd63                                                                  1551   1575
014800080225     d  ORGd64                                                                  1576   1600
014900080225     d  ORGd65                                                                  1601   1625
015000080225     d  ORGd66                                                                  1626   1650
015100080225     d  ORGd67                                                                  1651   1675
015200080225     d  ORGd68                                                                  1676   1700
015300080225     d  ORGd69                                                                  1701   1725
015400080225     d  ORGd70                                                                  1726   1750
015500080225     d  ORGd71                                                                  1751   1775
015600080225     d  ORGd72                                                                  1776   1800
015700080225     d  ORGd73                                                                  1801   1825
015800080225     d  ORGd74                                                                  1826   1850
015900080225     d  ORGd75                                                                  1851   1875
016000080225     d  ORGd76                                                                  1876   1900
016100080225     d  ORGd77                                                                  1901   1925
016200080225     d  ORGd78                                                                  1926   1950
016300080225     d  ORGd79                                                                  1951   1975
016400080225     d  ORGd80                                                                  1976   2000
016500080225     d  ORGd81                                                                  2001   2025
016600080225     d  ORGd82                                                                  2026   2050
016700080225     d  ORGd83                                                                  2051   2075
016800080225     d  ORGd84                                                                  2076   2100
016900080225     d  ORGd85                                                                  2101   2125
017000080225     d  ORGd86                                                                  2126   2150
017100080225     d  ORGd87                                                                  2151   2175
017200080225     d  ORGd88                                                                  2176   2200
017300080225     d  ORGd89                                                                  2201   2225
017400080225     d  ORGd90                                                                  2226   2250
017500080225     d  ORGd91                                                                  2251   2275
017600080225     d  ORGd92                                                                  2276   2300
017700080225     d  ORGd93                                                                  2301   2325
017800080225     d  ORGd94                                                                  2326   2350
017900080225     d  ORGd95                                                                  2351   2375
018000080225     d  ORGd96                                                                  2376   2400
018100080225     d  ORGd97                                                                  2401   2425
018200080225     d  ORGd98                                                                  2426   2450
018300080225     d  ORGd99                                                                  2451   2475
018400080225     d  ORGdA0                                                                  2476   2500
018500080225     d  ORGdA1                                                                  2501   2525
018600080225     d  ORGdA2                                                                  2526   2550
018700080225     d  ORGdA3                                                                  2551   2575
018800080225     d  ORGdA4                                                                  2576   2600
018900080225     d  ORGdA5                                                                  2601   2625
019000080225     d  ORGdA6                                                                  2626   2650
019100080225     d  ORGdA7                                                                  2651   2675
019200080225     d  ORGdA8                                                                  2676   2700
019300080225     d  ORGdA9                                                                  2701   2725
019400080225     d  ORGdB0                                                                  2726   2750
019500080225     d  ORGdB1                                                                  2751   2775
019600080225     d  ORGdB2                                                                  2776   2800
019700080225     d  ORGdB3                                                                  2801   2825
019800080225     d  ORGdB4                                                                  2826   2850
019900080225     d  ORGdB5                                                                  2851   2875
020000080225     d  ORGdB6                                                                  2876   2900
020100080225     d  ORGdB7                                                                  2901   2925
020200080225     d  ORGdB8                                                                  2926   2950
020300080225     d  ORGdB9                                                                  2951   2975
020400080225     d  ORGdC0                                                                  2976   3000
020500080225     d  ORGdC1                                                                  3001   3025
020600080225     d  ORGdC2                                                                  3026   3050
020700080225     d  ORGdC3                                                                  3051   3075
020800080225     d  ORGdC4                                                                  3076   3100
020900080225     d  ORGdC5                                                                  3101   3125
021000080225     d  ORGdC6                                                                  3126   3150
021100080225     d  ORGdC7                                                                  3151   3175
021200080225     d  ORGdC8                                                                  3176   3200
021300080225     d  ORGdC9                                                                  3201   3225
021400080225     d  ORGdD0                                                                  3226   3250
021500080225     d  ORGdD1                                                                  3251   3275
021600080225     d  ORGdD2                                                                  3276   3300
021700080225     d  ORGdD3                                                                  3301   3325
021800080225     d  ORGdD4                                                                  3326   3350
021900080225     d  ORGdD5                                                                  3351   3375
022000080225     d  ORGdD6                                                                  3376   3400
022100080225     d  ORGdD7                                                                  3401   3425
022200080225     d  ORGdD8                                                                  3426   3450
022300080225     d  ORGdD9                                                                  3451   3475
022400080225     d  ORGdE0                                                                  3476   3500
022500080225     d  ORGdE1                                                                  3501   3525
022600080225     d  ORGdE2                                                                  3526   3550
022700080225     d  ORGdE3                                                                  3551   3575
022800080225     d  ORGdE4                                                                  3576   3600
022900080225     d  ORGdE5                                                                  3601   3625
023000080225     d  ORGdE6                                                                  3626   3650
023100080225     d  ORGdE7                                                                  3651   3675
023200080225     d  ORGdE8                                                                  3676   3700
023300080225     d  ORGdE9                                                                  3701   3725
023400080225     d  ORGdF0                                                                  3726   3750
023500080225     d   $DE                   1   3750    dim(150)
023600080225      *
023700080225     d CF_ds           ds                  inz
023800080225     d  ORGf01                                                                     1      3  0
023900080225     d  ORGf02                                                                     4      6  0
024000080225     d  ORGf03                                                                     7      9  0
024100080225     d  ORGf04                                                                    10     12  0
024200080225     d  ORGf05                                                                    13     15  0
024300080225     d  ORGf06                                                                    16     18  0
024400080225     d  ORGf07                                                                    19     21  0
024500080225     d  ORGf08                                                                    22     24  0
024600080225     d  ORGf09                                                                    25     27  0
024700080225     d  ORGf10                                                                    28     30  0
024800080225     d  ORGf11                                                                    31     33  0
024900080225     d  ORGf12                                                                    34     36  0
025000080225     d  ORGf13                                                                    37     39  0
025100080225     d  ORGf14                                                                    40     42  0
025200080225     d  ORGf15                                                                    43     45  0
025300080225     d  ORGf16                                                                    46     48  0
025400080225     d  ORGf17                                                                    49     51  0
025500080225     d  ORGf18                                                                    52     54  0
025600080225     d  ORGf19                                                                    55     57  0
025700080225     d  ORGf20                                                                    58     60  0
025800080225     d  ORGf21                                                                    61     63  0
025900080225     d  ORGf22                                                                    64     66  0
026000080225     d  ORGf23                                                                    67     69  0
026100080225     d  ORGf24                                                                    70     72  0
026200080225     d  ORGf25                                                                    73     75  0
026300080225     d  ORGf26                                                                    76     78  0
026400080225     d  ORGf27                                                                    79     81  0
026500080225     d  ORGf28                                                                    82     84  0
026600080225     d  ORGf29                                                                    85     87  0
026700080225     d  ORGf30                                                                    88     90  0
026800080225     d  ORGf31                                                                    91     93  0
026900080225     d  ORGf32                                                                    94     96  0
027000080225     d  ORGf33                                                                    97     99  0
027100080225     d  ORGf34                                                                   100    102  0
027200080225     d  ORGf35                                                                   103    105  0
027300080225     d  ORGf36                                                                   106    108  0
027400080225     d  ORGf37                                                                   109    111  0
027500080225     d  ORGf38                                                                   112    114  0
027600080225     d  ORGf39                                                                   115    117  0
027700080225     d  ORGf40                                                                   118    120  0
027800080225     d  ORGf41                                                                   121    123  0
027900080225     d  ORGf42                                                                   124    126  0
028000080225     d  ORGf43                                                                   127    129  0
028100080225     d  ORGf44                                                                   130    132  0
028200080225     d  ORGf45                                                                   133    135  0
028300080225     d  ORGf46                                                                   136    138  0
028400080225     d  ORGf47                                                                   139    141  0
028500080225     d  ORGf48                                                                   142    144  0
028600080225     d  ORGf49                                                                   145    147  0
028700080225     d  ORGf50                                                                   148    150  0
028800080225     d  ORGf51                                                                   151    153  0
028900080225     d  ORGf52                                                                   154    156  0
029000080225     d  ORGf53                                                                   157    159  0
029100080225     d  ORGf54                                                                   160    162  0
029200080225     d  ORGf55                                                                   163    165  0
029300080225     d  ORGf56                                                                   166    168  0
029400080225     d  ORGf57                                                                   169    171  0
029500080225     d  ORGf58                                                                   172    174  0
029600080225     d  ORGf59                                                                   175    177  0
029700080225     d  ORGf60                                                                   178    180  0
029800080225     d  ORGf61                                                                   181    183  0
029900080225     d  ORGf62                                                                   184    186  0
030000080225     d  ORGf63                                                                   187    189  0
030100080225     d  ORGf64                                                                   190    192  0
030200080225     d  ORGf65                                                                   193    195  0
030300080225     d  ORGf66                                                                   196    198  0
030400080225     d  ORGf67                                                                   199    201  0
030500080225     d  ORGf68                                                                   202    204  0
030600080225     d  ORGf69                                                                   205    207  0
030700080225     d  ORGf70                                                                   208    210  0
030800080225     d  ORGf71                                                                   211    213  0
030900080225     d  ORGf72                                                                   214    216  0
031000080225     d  ORGf73                                                                   217    219  0
031100080225     d  ORGf74                                                                   220    222  0
031200080225     d  ORGf75                                                                   223    225  0
031300080225     d  ORGf76                                                                   226    228  0
031400080225     d  ORGf77                                                                   229    231  0
031500080225     d  ORGf78                                                                   232    234  0
031600080225     d  ORGf79                                                                   235    237  0
031700080225     d  ORGf80                                                                   238    240  0
031800080225     d  ORGf81                                                                   241    243  0
031900080225     d  ORGf82                                                                   244    246  0
032000080225     d  ORGf83                                                                   247    249  0
032100080225     d  ORGf84                                                                   250    252  0
032200080225     d  ORGf85                                                                   253    255  0
032300080225     d  ORGf86                                                                   256    258  0
032400080225     d  ORGf87                                                                   259    261  0
032500080225     d  ORGf88                                                                   262    264  0
032600080225     d  ORGf89                                                                   265    267  0
032700080225     d  ORGf90                                                                   268    270  0
032800080225     d  ORGf91                                                                   271    273  0
032900080225     d  ORGf92                                                                   274    276  0
033000080225     d  ORGf93                                                                   277    279  0
033100080225     d  ORGf94                                                                   280    282  0
033200080225     d  ORGf95                                                                   283    285  0
033300080225     d  ORGf96                                                                   286    288  0
033400080225     d  ORGf97                                                                   289    291  0
033500080225     d  ORGf98                                                                   292    294  0
033600080225     d  ORGf99                                                                   295    297  0
033700080225     d  ORGfA0                                                                   298    300  0
033800080225     d  ORGfA1                                                                   301    303  0
033900080225     d  ORGfA2                                                                   304    306  0
034000080225     d  ORGfA3                                                                   307    309  0
034100080225     d  ORGfA4                                                                   310    312  0
034200080225     d  ORGfA5                                                                   313    315  0
034300080225     d  ORGfA6                                                                   316    318  0
034400080225     d  ORGfA7                                                                   319    321  0
034500080225     d  ORGfA8                                                                   322    324  0
034600080225     d  ORGfA9                                                                   325    327  0
034700080225     d  ORGfB0                                                                   328    330  0
034800080225     d  ORGfB1                                                                   331    333  0
034900080225     d  ORGfB2                                                                   334    336  0
035000080225     d  ORGfB3                                                                   337    339  0
035100080225     d  ORGfB4                                                                   340    342  0
035200080225     d  ORGfB5                                                                   343    345  0
035300080225     d  ORGfB6                                                                   346    348  0
035400080225     d  ORGfB7                                                                   349    351  0
035500080225     d  ORGfB8                                                                   352    354  0
035600080225     d  ORGfB9                                                                   355    357  0
035700080225     d  ORGfC0                                                                   358    360  0
035800080225     d  ORGfC1                                                                   361    363  0
035900080225     d  ORGfC2                                                                   364    366  0
036000080225     d  ORGfC3                                                                   367    369  0
036100080225     d  ORGfC4                                                                   370    372  0
036200080225     d  ORGfC5                                                                   373    375  0
036300080225     d  ORGfC6                                                                   376    378  0
036400080225     d  ORGfC7                                                                   379    381  0
036500080225     d  ORGfC8                                                                   382    384  0
036600080225     d  ORGfC9                                                                   385    387  0
036700080225     d  ORGfD0                                                                   388    390  0
036800080225     d  ORGfD1                                                                   391    393  0
036900080225     d  ORGfD2                                                                   394    396  0
037000080225     d  ORGfD3                                                                   397    399  0
037100080225     d  ORGfD4                                                                   400    402  0
037200080225     d  ORGfD5                                                                   403    405  0
037300080225     d  ORGfD6                                                                   406    408  0
037400080225     d  ORGfD7                                                                   409    411  0
037500080225     d  ORGfD8                                                                   412    414  0
037600080225     d  ORGfD9                                                                   415    417  0
037700080225     d  ORGfE0                                                                   418    420  0
037800080225     d  ORGfE1                                                                   421    423  0
037900080225     d  ORGfE2                                                                   424    426  0
038000080225     d  ORGfE3                                                                   427    429  0
038100080225     d  ORGfE4                                                                   430    432  0
038200080225     d  ORGfE5                                                                   433    435  0
038300080225     d  ORGfE6                                                                   436    438  0
038400080225     d  ORGfE7                                                                   439    441  0
038500080225     d  ORGfE8                                                                   442    444  0
038600080225     d  ORGfE9                                                                   445    447  0
038700080225     d  ORGfF0                                                                   448    450  0
038800080225     d   $CF                   1    450  0 dim(150)
038900080311      *
039000080311      * - Descrizioni a video
039100080311     d VDE_ds          ds                  inz
039200080311     D  VD01                   1     25
039300080311     D  VD02                  26     50
039400080311     D  VD03                  51     75
039500080311     D  VD04                  76    100
039600080311     D  VD05                 101    125
039700080311     D  VD06                 126    150
039800080311     D  VD07                 151    175
039900080311     D  VD08                 176    200
040000080311     D  VD09                 201    225
040100080311     D  VD10                 226    250
040200080311     D  VD11                 251    275
040300080311     D  VD12                 276    300
040400080311     D  VD13                 301    325
040500080311     D  VD14                 326    350
040600080311     D  VD15                 351    375
040700080311     D  VD16                 376    400
040800080311     D  VD17                 401    425
040900080311     D  VD18                 426    450
041000080311     D  VD19                 451    475
041100080311     D  VD20                 476    500
041200080311     D  VD21                 501    525
041300080311     D  VD22                 526    550
041400080311     D  VD23                 551    575
041500080311     D  VD24                 576    600
041600080311     D  VD25                 601    625
041700080311     D  VD26                 626    650
041800080311     D  VD27                 651    675
041900080311     D  VD28                 676    700
042000080311     D  VD29                 701    725
042100080311     D  VD30                 726    750
042200080311     D  VD31                 751    775
042300080311     D  VD32                 776    800
042400080311     D  VD33                 801    825
042500080311     D  VD34                 826    850
042600080311     D  VD35                 851    875
042700080311     D  VD36                 876    900
042800080311     D  VD37                 901    925
042900080311     D  VD38                 926    950
043000080311     D  VD39                 951    975
043100080311     D  VD40                 976   1000
043200080311     D  VD41                1001   1025
043300080311     D  VD42                1026   1050
043400080311     D  VD43                1051   1075
043500080311     D  VD44                1076   1100
043600080311     D  VD45                1101   1125
043700080311     D  VD46                1126   1150
043800080311     D  VD47                1151   1175
043900080311     D  VD48                1176   1200
044000080311     D  VD49                1201   1225
044100080311     D  VD50                1226   1250
044200080311     D  VD51                1251   1275
044300080311     D  VD52                1276   1300
044400080311     D  VD53                1301   1325
044500080311     D  VD54                1326   1350
044600080311     D  VD55                1351   1375
044700080311     D  VD56                1376   1400
044800080311     D  VD57                1401   1425
044900080311     D  VD58                1426   1450
045000080311     D  VD59                1451   1475
045100080311     D  VD60                1476   1500
045200080311     D  VD61                1501   1525
045300080311     D  VD62                1526   1550
045400080311     D  VD63                1551   1575
045500080311     D  VD64                1576   1600
045600080311     D  VD65                1601   1625
045700080311     D  VD66                1626   1650
045800080311     D  VD67                1651   1675
045900080311     D  VD68                1676   1700
046000080311     D  VD69                1701   1725
046100080311     D  VD70                1726   1750
046200080311     D  VD71                1751   1775
046300080311     D  VD72                1776   1800
046400080311     D  VD73                1801   1825
046500080311     D  VD74                1826   1850
046600080311     D  VD75                1851   1875
046700080311     D  VD76                1876   1900
046800080311     D  VD77                1901   1925
046900080311     D  VD78                1926   1950
047000080311     D  VD79                1951   1975
047100080311     D  VD80                1976   2000
047200080311     D  VD81                2001   2025
047300080311     D  VD82                2026   2050
047400080311     D  VD83                2051   2075
047500080311     D  VD84                2076   2100
047600080311     D  VD85                2101   2125
047700080311     D  VD86                2126   2150
047800080311     D  VD87                2151   2175
047900080311     D  VD88                2176   2200
048000080311     D  VD89                2201   2225
048100080311     D  VD90                2226   2250
048200080311     D  VD91                2251   2275
048300080311     D  VD92                2276   2300
048400080311     D  VD93                2301   2325
048500080311     D  VD94                2326   2350
048600080311     D  VD95                2351   2375
048700080311     D  VD96                2376   2400
048800080311     D  VD97                2401   2425
048900080311     D  VD98                2426   2450
049000080311     D  VD99                2451   2475
049100080311     D  VDA0                2476   2500
049200080311     D  VDA1                2501   2525
049300080311     D  VDA2                2526   2550
049400080311     D  VDA3                2551   2575
049500080311     D  VDA4                2576   2600
049600080311     D  VDA5                2601   2625
049700080311     D  VDA6                2626   2650
049800080311     D  VDA7                2651   2675
049900080311     D  VDA8                2676   2700
050000080311     D  VDA9                2701   2725
050100080311     D  VDB0                2726   2750
050200080311     D  VDB1                2751   2775
050300080311     D  VDB2                2776   2800
050400080311     D  VDB3                2801   2825
050500080311     D  VDB4                2826   2850
050600080311     D  VDB5                2851   2875
050700080311     D  VDB6                2876   2900
050800080311     D  VDB7                2901   2925
050900080311     D  VDB8                2926   2950
051000080311     D  VDB9                2951   2975
051100080311     D  VDC0                2976   3000
051200080311     D  VDC1                3001   3025
051300080311     D  VDC2                3026   3050
051400080311     D  VDC3                3051   3075
051500080311     D  VDC4                3076   3100
051600080311     D  VDC5                3101   3125
051700080311     D  VDC6                3126   3150
051800080311     D  VDC7                3151   3175
051900080311     D  VDC8                3176   3200
052000080311     D  VDC9                3201   3225
052100080311     D  VDD0                3226   3250
052200080311     D  VDD1                3251   3275
052300080311     D  VDD2                3276   3300
052400080311     D  VDD3                3301   3325
052500080311     D  VDD4                3326   3350
052600080311     D  VDD5                3351   3375
052700080311     D  VDD6                3376   3400
052800080311     D  VDD7                3401   3425
052900080311     D  VDD8                3426   3450
053000080311     D  VDD9                3451   3475
053100080311     D  VDE0                3476   3500
053200080311     D  VDE1                3501   3525
053300080311     D  VDE2                3526   3550
053400080311     D  VDE3                3551   3575
053500080311     D  VDE4                3576   3600
053600080311     D  VDE5                3601   3625
053700080311     D  VDE6                3626   3650
053800080311     D  VDE7                3651   3675
053900080311     D  VDE8                3676   3700
054000080311     D  VDE9                3701   3725
054100080311     D  VDF0                3726   3750
054200080311     d   VDE                   1   3750    dim(150) inz
054300080311      * - Filiali appartenenza a video
054400080311     d VCF_ds          ds                  inz
054500080311     D  VF01                   1      3  0
054600080311     D  VF02                   4      6  0
054700080311     D  VF03                   7      9  0
054800080311     D  VF04                  10     12  0
054900080311     D  VF05                  13     15  0
055000080311     D  VF06                  16     18  0
055100080311     D  VF07                  19     21  0
055200080311     D  VF08                  22     24  0
055300080311     D  VF09                  25     27  0
055400080311     D  VF10                  28     30  0
055500080311     D  VF11                  31     33  0
055600080311     D  VF12                  34     36  0
055700080311     D  VF13                  37     39  0
055800080311     D  VF14                  40     42  0
055900080311     D  VF15                  43     45  0
056000080311     D  VF16                  46     48  0
056100080311     D  VF17                  49     51  0
056200080311     D  VF18                  52     54  0
056300080311     D  VF19                  55     57  0
056400080311     D  VF20                  58     60  0
056500080311     D  VF21                  61     63  0
056600080311     D  VF22                  64     66  0
056700080311     D  VF23                  67     69  0
056800080311     D  VF24                  70     72  0
056900080311     D  VF25                  73     75  0
057000080311     D  VF26                  76     78  0
057100080311     D  VF27                  79     81  0
057200080311     D  VF28                  82     84  0
057300080311     D  VF29                  85     87  0
057400080311     D  VF30                  88     90  0
057500080311     D  VF31                  91     93  0
057600080311     D  VF32                  94     96  0
057700080311     D  VF33                  97     99  0
057800080311     D  VF34                 100    102  0
057900080311     D  VF35                 103    105  0
058000080311     D  VF36                 106    108  0
058100080311     D  VF37                 109    111  0
058200080311     D  VF38                 112    114  0
058300080311     D  VF39                 115    117  0
058400080311     D  VF40                 118    120  0
058500080311     D  VF41                 121    123  0
058600080311     D  VF42                 124    126  0
058700080311     D  VF43                 127    129  0
058800080311     D  VF44                 130    132  0
058900080311     D  VF45                 133    135  0
059000080311     D  VF46                 136    138  0
059100080311     D  VF47                 139    141  0
059200080311     D  VF48                 142    144  0
059300080311     D  VF49                 145    147  0
059400080311     D  VF50                 148    150  0
059500080311     D  VF51                 151    153  0
059600080311     D  VF52                 154    156  0
059700080311     D  VF53                 157    159  0
059800080311     D  VF54                 160    162  0
059900080311     D  VF55                 163    165  0
060000080311     D  VF56                 166    168  0
060100080311     D  VF57                 169    171  0
060200080311     D  VF58                 172    174  0
060300080311     D  VF59                 175    177  0
060400080311     D  VF60                 178    180  0
060500080311     D  VF61                 181    183  0
060600080311     D  VF62                 184    186  0
060700080311     D  VF63                 187    189  0
060800080311     D  VF64                 190    192  0
060900080311     D  VF65                 193    195  0
061000080311     D  VF66                 196    198  0
061100080311     D  VF67                 199    201  0
061200080311     D  VF68                 202    204  0
061300080311     D  VF69                 205    207  0
061400080311     D  VF70                 208    210  0
061500080311     D  VF71                 211    213  0
061600080311     D  VF72                 214    216  0
061700080311     D  VF73                 217    219  0
061800080311     D  VF74                 220    222  0
061900080311     D  VF75                 223    225  0
062000080311     D  VF76                 226    228  0
062100080311     D  VF77                 229    231  0
062200080311     D  VF78                 232    234  0
062300080311     D  VF79                 235    237  0
062400080311     D  VF80                 238    240  0
062500080311     D  VF81                 241    243  0
062600080311     D  VF82                 244    246  0
062700080311     D  VF83                 247    249  0
062800080311     D  VF84                 250    252  0
062900080311     D  VF85                 253    255  0
063000080311     D  VF86                 256    258  0
063100080311     D  VF87                 259    261  0
063200080311     D  VF88                 262    264  0
063300080311     D  VF89                 265    267  0
063400080311     D  VF90                 268    270  0
063500080311     D  VF91                 271    273  0
063600080311     D  VF92                 274    276  0
063700080311     D  VF93                 277    279  0
063800080311     D  VF94                 280    282  0
063900080311     D  VF95                 283    285  0
064000080311     D  VF96                 286    288  0
064100080311     D  VF97                 289    291  0
064200080311     D  VF98                 292    294  0
064300080311     D  VF99                 295    297  0
064400080311     D  VFA0                 298    300  0
064500080311     D  VFA1                 301    303  0
064600080311     D  VFA2                 304    306  0
064700080311     D  VFA3                 307    309  0
064800080311     D  VFA4                 310    312  0
064900080311     D  VFA5                 313    315  0
065000080311     D  VFA6                 316    318  0
065100080311     D  VFA7                 319    321  0
065200080311     D  VFA8                 322    324  0
065300080311     D  VFA9                 325    327  0
065400080311     D  VFB0                 328    330  0
065500080311     D  VFB1                 331    333  0
065600080311     D  VFB2                 334    336  0
065700080311     D  VFB3                 337    339  0
065800080311     D  VFB4                 340    342  0
065900080311     D  VFB5                 343    345  0
066000080311     D  VFB6                 346    348  0
066100080311     D  VFB7                 349    351  0
066200080311     D  VFB8                 352    354  0
066300080311     D  VFB9                 355    357  0
066400080311     D  VFC0                 358    360  0
066500080311     D  VFC1                 361    363  0
066600080311     D  VFC2                 364    366  0
066700080311     D  VFC3                 367    369  0
066800080311     D  VFC4                 370    372  0
066900080311     D  VFC5                 373    375  0
067000080311     D  VFC6                 376    378  0
067100080311     D  VFC7                 379    381  0
067200080311     D  VFC8                 382    384  0
067300080311     D  VFC9                 385    387  0
067400080311     D  VFD0                 388    390  0
067500080311     D  VFD1                 391    393  0
067600080311     D  VFD2                 394    396  0
067700080311     D  VFD3                 397    399  0
067800080311     D  VFD4                 400    402  0
067900080311     D  VFD5                 403    405  0
068000080311     D  VFD6                 406    408  0
068100080311     D  VFD7                 409    411  0
068200080311     D  VFD8                 412    414  0
068300080311     D  VFD9                 415    417  0
068400080311     D  VFE0                 418    420  0
068500080311     D  VFE1                 421    423  0
068600080311     D  VFE2                 424    426  0
068700080311     D  VFE3                 427    429  0
068800080311     D  VFE4                 430    432  0
068900080311     D  VFE5                 433    435  0
069000080311     D  VFE6                 436    438  0
069100080311     D  VFE7                 439    441  0
069200080311     D  VFE8                 442    444  0
069300080311     D  VFE9                 445    447  0
069400080311     D  VFF0                 448    450  0
069500080311     d   VCF                   1    450  0 dim(150) inz
069600080225      *
069700080225      *?  V A R I A B I L I  ?----------------------------------------*
069800080225      *
069900080225      * - Flag booleani
070000080225      *
070100080225      * - Indici di schiera
070200080225     d xa              s              3  0 inz
070300080225     d xb              s              3  0 inz
070400080225     d xx              s              3  0 inz
070500080225      *
070600080225      * - Parametri per X§TABER
070700080225     d §Kut            s              1  0 inz
070800080225     d §Cod            s              2    inz
070900080225     d §Key            s              8    inz
071000080225     d §Des            s             30    inz
071100080225      * - Parametri per TNSD24R
071200080225     d §§Cod           s              3    inz
071300080225     d §§Tip           s                   like(ORGfag)  inz
071400080225     d §§Des           s             25    inz
071500080225     d §§Pra           s              3    inz
071600080225      *
071700080225      *  - Comodo
071800080225     d wdsd            s                   like(G02dat)  inz
071900080225     d wdse            s                   like(G02dat)  inz
072000080225     d wdda            s                   like(G02dat)  inz
072100080225     d wddao           s                   like(G02dat)  inz
072200080225     d §Fil            s                   like(ORGfil)  inz
072300080225     d wFil            s                   like(ORGfil)  inz
072400130828     d klna            s              3  0 inz
072500080225     D wAggSfl         s              1
072600130828     d Datasys         s               d   datfmt(*iso) inz(*sys)
072700150430     d wtfp_lnpb       s                   like(d55tfp)
072800080225      *
072900080225      *?  K E Y - L I S T  ?------------------------------------------*
073000080225      *
073100080225     c     k02tabel      klist
073200080225     c                   kfld                    TBLkut
073300080225     c                   kfld                    TBLcod
073400080225     c     k03tabel      klist
073500080225     c                   kfld                    TBLkut
073600080225     c                   kfld                    TBLcod
073700080225     c                   kfld                    TBLkey
073800080225      *
073900080225      *?  I N D I C A T O R I   U T I L I Z Z A T I  ?----------------*
074000080225      *
074100080225      *  01        IMMISSIONE
074200080225      *  02        VARIAZIONE
074300080225      *  03        ANNULLATO
074400080225      *  10        comodo
074500080225      *  11        Emissione messaggio di errore
074600100929      *  19        tipo filiale "V-vari"
074700130423      *  28        Filiale NON di primo livello non visualizzo alcuni campi
074800080225      *  29        Errore su indirizzo IP
074900080225      *  30        INDICATORE GENERICO DI ERRORE CONTROLLI VIDEO D05
075000080225      *  32        errore data inizio distinte ORM automatiche
075100080225      *  33        errore data inizio distinte automatiche
075200080225      *  34        p.o. contabilità
075300080225      *  35        errore su tellus
075400080225      *  36        CHAIN GENERICO
075500080225      *  37        data scannerizzazione euroexpress
075600080225      *  38        data scannerizzazione dpd
075700080225      *  39        LINEA PARALLELA PER TASSAZIONE NON VALIDA
075800080225      *  40        OFF --> PROFILE EDP
075900080225      *  41        Errore su tipo P.O. 1 o 2 livello
076000080225      *  42        Errore coda  FAX INPUT
076100151028      ****  43        OBBLIGATORIO INSERIRE TELEFONO DIRETTO P.O
076200151028      *  43        Errore su raggruppamento area centralino
076300080225      *  44        PER CAMBIO TIPO P.O. INDICARE E P.O. E NUOVO TIPO
076400080225      *  45        Errore su raggruppamento area
076500080225      *  46        Errore su ambiente di appartenenza
076600080225      *  47        P.O CHE GESTISCE TARIFFE DEVE ESSERE TERMINAL DI PARTENZA
076700080225      *  48        Errore su P.O. elaboratore
076800080225      *  49        FILIALE ANNULLATA
076900080225      *  50        Errore:   p.o. inserito
077000080225      *  51        Errore:   tipo p.o. inserito
077100080225      *  52/56     Errori su campi indirizzo filiale
077200080225      *  57/62     Errori su campi indirizzo agenzia
077300080225      *  63        Errore su cod.Tassazione
077400100125      *  64        Errore su cod.direzione comm.le
077500080225      *  65/66     Errore su NTW
077600080225      *  67        Errore suy cod HUB
077700080225      *  68        Errore su cod.deposito
077800080225      *  69        Errore su  TIPO DI AUTOGENERAZIONE SPUNTE
077900080225      *  70        Errore su descrizione SFL
078000080225      *  71        FLAG protezione su sfl
078100080225      *  72        errore su CODICE FIL.APPARTENENZA
078200080225      *  73        flag non visualizzazione su sfl
078300080225      *  74        Errore su P.O. gestione Tariffe
078400080225      *  75        PULIZIA SUBFILE
078500080225      *  76        Errore su Regione ai fini tariffari
078600080225      *  77        Errore su telefono direeto filiale
078700080225      *  78        Errore su provincia filiale
078800080225      *  79        Errore su provincia agenzia
078900080225      *  80        Il p.o. immesso non è una agenzia
079000080225      *  81        OFF --> MANUTENZIONE   ON --> INTERROGAZIONE
079100080225      *  82        errore su linea parallela per tassazione
079200080225      *  83        errore su coda stampa sede per p.o.
079300080225      *  84        Errore su cod.Area
079400080225      *  85        Errore su cod.Regione
079500080225      *  86        errore su DATA UTILIZZO MACCHINONE PER VOLUME
079600080225      *  87        errore su DATA UTILIZZO MACCHINONE PER PESO
079700080225      *  88        ORGANIGRAMMA DI SEDE
079800080225      *  89        Errore su CODa FAX OUTPUT
079900080225      *  90        errore su coda stampa sede per commerciale p.o.
080000080225      *  91        Errore su area POC
080100080225      *  92        Errore su AREA EX AS400
080200080225      *  93        INDICARE CODA OUTPUT RICEZIONE STAMPE DA ALTRO AS
080300080225      *  94        INDICATORE GENERICO DI ERRORE CONTROLLI VIDEO D04
080400080225      *  95        di comodo per scrittura azose10
080500080225      *  96        per lettura AZOSE10
080600080225      *  97        INDICATORE GENERICO DI ERRORE CONTROLLI VIDEO D03
080700080225      *  98        INDICATORE GENERICO DI ERRORE CONTROLLI VIDEO D02
080800080225      *  99        INDICATORE GENERICO DI ERRORE CONTROLLI SUBFILE
080900080225      *
081000080225      *?  M A I N - L I N E  ?----------------------------------------*
081100080225      *
081200080225     c     *Entry        plist
081300080225     c                   parm                    KPJBA
081400080225      *
081500131016      *  Controlla se si tratta di UTENTE EDP* 24=*ON
081600131016     c                   clear                   utente_EDP        1
081700131016     c                   setoff                                       24
081800131016     c                   if        %subst(knmus:1:3) = 'EDP'
081900131016     c                   eval           utente_EDP ='S'
082000131016     c                   setoN                                        24
082100131016     c                   end
082200131016      *
082300080225      * Reperisco dati job
082400080225     c                   exsr      DatiJob
082500021029      *
082600900329     C                   SETOFF                                       8140
082700080225      *
082800080225      * Verifica autorizzazioni utente
082900080225     c                   eval      *in40 = (§UTEgorg = 'P')
083000080225      *
083100080225      * 88 on - organigramma di sede
083200080225     c                   eval      *in88 = (%subst(KPJBU : 1 : 4) = 'SEDE')
083300080225      *
083400021029      *---------------------------------------------------------------------
083500021029      *
083600080225     c                   eval      TBLkut = 1
083700900328     C     INIZIO        TAG
083800021029     C                   eval      *in80=*off
083900021029     C                   eval      *in01=*off
084000021029     C                   eval      *in02=*off
084100021029     C                   eval      *in03=*off
084200080225     C                   movel     *blanks       $De
084300021029     C                   movel     *blanks       VDe
084400080225     C                   z-add     0             $Cf
084500021029     C                   z-add     0             Vcf
084600021029     C                   movel     *blanks       VFil
084700021029     C                   movel     '?'           VFil
084800021029     C                   movel     *blanks       VTip
084900080225     c                   if        §UTEgorg = *blanks
085000080225     c                   eval      *in11  = *on
085100080225     c                   eval      V1Dmsg = Msg(18)
085200080225     c                   endif
085300021029      *
085400080225     c                   write     SD15T01
085500090709     C     VID1          TAG
085600941115     C                   EXFMT     SD15D01
085700080225     c                   if        §UTEgorg = *blanks
085800080225     c                   goto      Fine
085900080225     c                   endif
086000130828     c* F03 - fine
086100910306     C   KC              GOTO      FINE
086200130828      *
086300130828      * F07 - Orari servizi standard
086400130828      *
086500130828     c                   if        *inkg=*on
086600131021     c                             and  utente_EDP ='S'
086700130828     c                   eval      klna=999
086800130828     c                   exsr      Ges_serv
086900130828     C                   GOTO      inizio
087000130828     c                   endif
087100021029      *
087200021029      *  Video 1
087300021029     C     VFil          IFEQ      *zeros
087400080225     C                   eval      *in50=*on
087500900328     C                   GOTO      VID1
087600900418     C                   END
087700021029      *
087800040923      * Ricerca  con '?'
087900030527     C                   IF        *inkr = *off
088000040924     C     '?'           scan      VFil                                   21
088100900515     C   21              DO
088200080225     C   88              move      '§'           §§Tip
088300080225     C  N88              move      VTip          §§Tip
088400971203     C                   CALL      'TNSD24R'
088500080225     C                   PARM                    §§Cod             3
088600080225     C                   PARM                    §§Tip
088700021029     C                   PARM                    §§Des            25
088800021029     C                   PARM                    §§Pra             3
088900080225     C                   movel     §§Cod         VFil
089000090709     c
089100090709     c                   write     SD15T01
089200021029     C                   GOTO      VID1
089300080226     C                   ENDdo
089400030527     C                   ENDIF
089500040923     c*
089600030403      * Controllo che il codice filiale immesso sia numerico
089700040923     C                   TESTN                   VFil                 36
089800040923     c                   move      vfil          w001a             1
089900040923     c*
090000040923     c                   if        not *in36 or w001a<*zeros
090100021029     C                   eval      *in50=*on
090200900418     C                   GOTO      VID1
090300900418     C                   END
090400900418     C*
090500080225     C                   movel     VFil          §Fil
090600080225     C  N88§Fil          CHAIN     AzOrg                              36
090700080225     C   88§FIL          CHAIN     AzOse                              36
090800021029      *
090900040923      * 01 on - Immissione
091000080226if  1C                   IF        *in36= '1'
091100021029     C                   eval      *in01=*on                                    *IMMISSIONE
091200021029      *
091300080226x   1C                   ELSE
091400030526     C                   eval      *in01=*off                                   *IMMISSIONE
091500021029     C                   movel     OrgFag        ComTip            1
091600030403     C                   move      OrgFl2        TipFl2            1
091700040923     c* Annullato
091800080226if  2C                   IF        OrgFva = '*'
091900021029      *
092000040923      * non gestisco per profilo non EDP
092100080226if  3C                   IF        *in40 = *on
092200021029     C                   eval      *in49=*on
092300021029     C                   GOTO      INIZIO
092400080226x   3C                   ELSE
092500040923      *
092600021029     C                   eval      *in03=*on                                    *ANNULLATO
092700080226e   3C                   ENDIF
092800080226x   2C                   ELSE
092900040923      * 02 on - Modifica
093000021029     C                   eval      *in02=*on                                    *VARIAZIONE
093100080226e   2C                   ENDIF
093200080226e   1C                   ENDIF
093300030527      *
093400040923      * F17 - Cambio tipo P.O.
093500040923      *       sono obbligatori p.o valido e tipo  P.O-
093600030527     C                   IF        *inkr = *on
093700030527     C                   if        *in02 = *off or VTip = *blanks
093800030527     C                   eval      *in44= *on
093900030527     C                   GOTO      VID1
094000030527     C                   endif
094100030527     C                   ENDIF
094200021029      *
094300030527      * Per immissione il tipo P.O è obbligatorio
094400080226if  1C                   IF        VTip = *blanks
094500080226if  2C                   IF        *in01 = *ON
094600040928     C  n88              eval      *in52= *on
094700040928     C   88              eval      *in53= *on
094800980226     C                   GOTO      VID1
094900080226e   2C                   ENDIF
095000080226x   1C                   ELSE
095100040923     c* Se immesso tipo e non premuto f!7 di cambio, deve essere =
095200040923     c*  a quello del p.o. immesso
095300080226if  2C                   IF        *inkr = *OFF
095400980420     C   02
095500080226if  3COR 03VTIP          IFNE      COMTIP
095600030403     C     VTIP          ANDNE     'T'
095700980420     C                   SETON                                        51
095800980420     C                   GOTO      VID1
095900080226x   3C                   ELSE
096000080226if  4C     VTIP          IFEQ      'T'
096100030403     C     TipFl2        ANDNE     'S'
096200030403     C                   SETON                                        51
096300030403     C                   GOTO      VID1
096400080226e   4C                   ENDIF
096500080226e   3C                   ENDIF
096600080226e   2C                   ENDIF
096700080226e   1C                   ENDif
096800040924     c
096900040924     c* Pulisco videate e carico e dati
097000021029     C                   EXSR      PulVid2
097100130422     C                   EXSR      PulVid21
097200040302     C                   EXSR      PulVid3
097300040517     C                   EXSR      PulVid4
097400070828     C                   EXSR      PulVid5
097500040302     c
097600040302     C                   EXSR      AggVid2
097700130422     C                   EXSR      AggVid21
097800040924     c
097900040928     C* Le nuove videate da fare solo per ORG. di filiale e per EDP
098000040924     c                   if        not *in88  and not *in40 and not *in01
098100080226      *
098200040302     C                   EXSR      AggVid3
098300040517     C                   EXSR      AggVid4
098400070828     C                   EXSR      AggVid5
098500080226      *
098600040302     c                   endif
098700040924      *
098800040924      * Gestione 2° video
098900040924      *
099000090709      * per emissione testata
099100090709     c                   seton                                        09
099200090709
099300090709     C     VID2          TAG
099400080226     c                   clear                   VDFil
099500090709     c                   if        *in09
099600080225     c                   write     SD15T01
099700080225     c                   write     SD15T02
099800090709     c                   setoff                                       09
099900090709     c                   endif
100000090709
100100941115     C                   EXFMT     SD15D02
100200090709
100300090709     C                   eval      *in98 = *off
100400021029      * Fine lavoro
100500910306     C   KC              GOTO      INIZIO
100600040517     c
100700040924      * F5-Ripristino  / F16-Annullamento
100800040517     c   KE
100900040517     Cor KQ              DO
101000900330     C                   EXSR      AGGFIL
101100900329     C                   GOTO      INIZIO
101200900329     C                   END
101300040517     c
101400021029      * Controlli seconda videata
101500021029     C                   EXSR      CtrVid2
101600021029      * Per errori o decodifiche
101700020625     C   98
101800020625     COR KD              GOTO      VID2
101900130422      *
102000130422      * Descrizione p.o.
102100130422     c                   eval      VDFil = VDesF
102200130422      *
102300130422      * Gestione video 2a
102400130422      *
102500130527      * per emissione testata
102600130527     c                   seton                                        09
102700130527      *
102800130422     c     VID21         TAG
102900130422     c                   IF        *in09
103000130422     c                   write     SD15T01
103100130422     c                   write     SD15T02
103200130422     c                   setoff                                       09
103300130422     c                   endif
103400130422     C                   EXFMT     SD15D021
103500130422
103600130422     C                   eval      *in11 = *off
103700130422      * Fine lavoro
103800130422     C   KC              GOTO      INIZIO
103900130423      * Video precedente
104000130423     C   KL              GOTO      VID2
104100130828      *  F7 - servizi orari
104200130828     c                   if        *inkg = *on
104300131021     c                             and  utente_EDP ='S'
104400130828     c                   eval      klna=§fil
104500130828     c                   exsr      Ges_serv
104600130828     c                   seton                                        09
104700130828     C                   GOTO      VID21
104800130828     c                   endif
104900130423
105000130422      * Controlli seconda videata
105100130422     C                   EXSR      CtrVid21
105200130422      * Per errori o decodifiche
105300130422     C   11              goto      vid21
105400080226      * F6 = conferma per utenti con abilitazione parziale
105500040928     c                   if        *inkf
105600040928     c                   eval      waggsfl='N'
105700040928     C                   EXSR      WrtFil
105800040928     C                   GOTO      INIZIO
105900040928     c                   endif
106000080226      *
106100080226      * Descrizione p.o.
106200130422     c***************    eval      VDFil = VDesF
106300030429      *
106400030430      * LE VIDEATE SUCCESSIVE VENGONO GESTITE SOLO PER UTENTE
106500030429      * EDP E NON STO GESTENDO L'ORGANIGRAMMA DI SEDE
106600030430      *
106700080226if  1C                   IF        *in88= *off and *in40 =*off
106800090709     c                   seton                                        09
106900040302      *
107000040302      * Gestione video 3
107100040302      *
107200021029     C     VID3          TAG
107300090709     c                   if        *in09
107400080225     c                   write     SD15T01
107500080225     c                   write     SD15T02
107600090709     c                   setoff                                       09
107700090709     c                   endif
107800021029     C                   EXFMT     SD15D03
107900090709     c
108000040302     c* spengo indicatori di posizionamento cursore
108100040302     c                   exsr      offd03
108200021029      * Fine lavoro
108300020614     C   KC              GOTO      INIZIO
108400021029      * Video precedente
108500130423     C***KL              GOTO      VID2
108600130423     C   KL              GOTO      VID21
108700021029      *
108800021029      * Controlli video 3
108900021029     C                   EXSR      CtrVid3
109000021029      * per errori e decodifiche
109100030429     C   97
109200021029     COR KD              GOTO      VID3
109300030429      *
109400030429      * Gestione video 4
109500170227     c                   setoff                                       9445
109600030429      *
109700030429     C     VID4          TAG
109800030429     C                   eval      *in94 = *off
109900090709     c                   if        *in09
110000080225     c                   write     SD15T01
110100080225     c                   write     SD15T02
110200090709     c                   setoff                                       09
110300090709     c                   endif
110400030429     C                   EXFMT     SD15D04
110500170227     c                   setoff                                       45
110600030429      * Fine lavoro
110700030429     C   KC              GOTO      INIZIO
110800030429      * Video precedente
110900030429     C   KL              GOTO      VID3
111000030429      *
111100040517      * Controlli video 4
111200030429     C                   EXSR      CtrVid4
111300030429      * per errori e decodifiche
111400030429     C   94
111500030429     COR KD              GOTO      VID4
111600070828      * Gestione video 5
111700070828     c                   setoff                                       30
111800070828     C     VID5          TAG
111900070828     C                   eval      *in30 = *off
112000090709     c                   if        *in09
112100080225     c                   write     SD15T01
112200080225     c                   write     SD15T02
112300090709     c                   setoff                                       09
112400090709     c                   endif
112500070828     C                   EXFMT     SD15D05
112600070828      * Fine lavoro
112700070828     C   KC              GOTO      INIZIO
112800070828      * Video precedente
112900070828     C   KL              GOTO      VID4
113000070828      *
113100070828      * Controlli video 5
113200070828     C                   EXSR      CtrVid5
113300070828      * per errori e decodifiche
113400070828     C   30
113500070828     COR KD              GOTO      VID5
113600070828      * Conferma
113700070828     c                   if        *inkf=*on
113800070828     c                   eval      waggsfl='N'
113900070828     C                   EXSR      WrtFil
114000070828     C                   GOTO      INIZIO
114100070828     c                   endif
114200030429      *
114300080226e   1C                   ENDIF
114400020625      *
114500040928      * pulizia subfile
114600021029     C                   EXSR      PulSfl
114700900402     C** CARICAMENTO SUBFILE
114800021029     C                   EXSR      CarSfl
114900040928     c
115000040928     c* Se ho caricato almeno un record
115100080226if  1c                   if        nrr>0
115200040928     C                   Z-ADD     1             NRR
115300890524     C     C1TAG         TAG
115400900328     C                   SETOFF                                       99
115500080225     c                   write     SD15T01
115600080225     c                   if        NOT *in88
115700080225     c                   write     SD15T02
115800080225     c                   endif
115900090709     C                   WRITE     SD15Z02
116000941115     C                   EXFMT     SD15DCT
116100021029      *
116200910306     C   KC              GOTO      INIZIO
116300030430      *
116400070828      * Video precedente: carico il video 5 se sono EDP e se non
116500030430      * sto leggendo AzOse
116600080226if  2C                   IF        *inKL = *on and *in40 = *off
116700030430     C                             and *in88 = *off
116800030430     C
116900070828     C                   GOTO      VID5
117000080226e   2C                   ENDIF
117100030430     C
117200130423     C***KL              GOTO      VID2
117300130423     C   KL              GOTO      VID21
117400040928     c
117500021029     C                   EXSR      CtrSfl
117600020625     C   99
117700020625     CORNKF              GOTO      C1TAG
117800040928     c
117900080226x   1c                   else
118000040928     c
118100040928     c* Se nessun record di sfl caricato, emetto videata precedente
118200080226if  2c                   if        *in40 =*off and *in88 =*off
118300070828     c                   goto      vid5
118400080226x   2c                   else
118500130423     c****               goto      vid2
118600130423     c                   goto      vid21
118700080226e   2c                   endif
118800080226e   1c                   endif
118900040928      * F6 - Conferma
119000040928     c                   eval      waggsfl='S'
119100040928     C                   EXSR      WrtFil
119200890525     C                   GOTO      INIZIO
119300890525     C     FINE          TAG
119400021029      *
119500080225     C                   CLEAR                   FNLV55ds
119600980204     C                   MOVEL     'C'           D55TLA
119700980204     C                   CALL      'FNLV55R'
119800080225     C                   PARM                    FNLV55ds
119900021029      *
120000890525     C                   SETON                                        LR
120100021029      *
120200021029      **----------------------------------------------------
120300030430      ** PULIZIA subfile
120400021029      **----------------------------------------------------
120500021029     C     PULSFL        BEGSR
120600900328     C                   SETON                                        75
120700941115     C                   WRITE     SD15DCT
120800900328     C                   SETOFF                                       75
120900890524     C                   ENDSR
121000130828      **----------------------------------------------------
121100130828      ** Gestione orari servizi
121200130828      **----------------------------------------------------
121300130828     C     Ges_serv      BEGSR
121400130828     c                   clear                   tisio0ds
121500130904     c* se non sono EDP solo in interrogazione
121600130904     C  n40              MOVEL     'G'           do0tric
121700130904     C   40              MOVEL     'I'           do0tric
121800130828     c                   movel     DATASYS       do0dri
121900130828     C                   MOVEL     klna          DO0LNA
122000130828
122100130828     C                   call      'TISIO2R'
122200130828     C                   PARM                    KPJBA
122300130828     C                   PARM                    tisio0ds
122400130828     C*
122500130828     C                   ENDSR
122600080225      *
122700080225      *---------------------------------------------------------------*
122800080225      * Reperimento Dati del job (Utente/Operativi)                   *
122900080225      *---------------------------------------------------------------*
123000080225     c     DatiJob       BEGSR
123100080225      *
123200080225     c     *dtaara       define    §azute        azuteds
123300080225     c     *dtaara       define    §datiute      ddatiute
123400080225      *
123500080225     c                   in(E)     *dtaara
123600080225     c                   IF        %ERROR or RSUT = *blanks
123700080225     c                   clear                   Tibs34Ds
123800080225     c                   call      'TIBS34R'
123900080225     c                   parm                    Tibs34Ds
124000080225     c                   in        *dtaara
124100080225     c                   ENDIF
124200080225      *
124300080225     c                   eval      dUTE01 = UTEfaf
124400080225      *
124500080225     c                   ENDSR
124600021029      **----------------------------------------------------
124700030430      ** Caricamento subfile
124800021029      **----------------------------------------------------
124900021029     C     CARSFL        BEGSR
125000040302      *
125100890525     C                   Z-ADD     0             NRR               4 0
125200080225     C                   Z-ADD     0             xa
125300080225     C                   MOVEL     VFIL          §FIL
125400080225     C  N88§FIL          CHAIN     AZORG                              36
125500080225     C   88§FIL          CHAIN     AZOSE                              36
125600080225      *
125700910220     C* CARICO TUTTA LA TABELLA 'OG/OR'
125800080225     C  n88              MOVEL     'OG'          TBLcod
125900080225     C   88              MOVEL     'OR'          TBLcod
126000080225     C     k02tabel      SETLL     TABEL
126100080225     C     k02tabel      READE     TABEL                                  22
126200080225do  1C     *IN22         DOWEQ     '0'
126300920413     C                   SETOFF                                       7173
126400080225if  2c                   if        tblkey<>*blanks and tblflg=*blanks
126500030521     C  n88              MOVEL     TBLUNI        DSOG
126600030521     C   88              MOVEL     TBLUNI        DSOR
126700030521      *
126800030521      * CONTROLLO FLAGS DSOG
126900030521      *
127000080225do  3C  n88              DO
127100021029      *
127200030521      * Vedo i vari casi protezione/visibilità distinti per F/A o V/T
127300030521      * in cui distinguo i casi EDP/non EDP
127400021029      * Caso F/A
127500080225if  4C                   IF        VTip = 'F' or VTip = 'A'
127600020626     C                   SELECT
127700040928     c* Protetto non per EDP
127800020626     C     §OGFRI        WHENEQ    'S'                                          PROTETTO
127900900330     C   40              SETON                                        71
128000021029      *
128100021029      * Protetto per tutti
128200020626     C     §OGFRI        WHENEQ    'T'
128300020626     C                   SETON                                        71
128400021029      *
128500040928      * Non visibile per tutti a parte per EDP che ha la gestione
128600020626     C     §OGFRI        WHENEQ    'Z'
128700020626     C   40              SETON                                        73        NON VISIBILE
128800040928      *
128900040928      * Non visibile per tutti a parte per EDP er il quale è protetto
129000040928     C     §OGFRI        WHENEQ    'W'
129100040928     C   40              SETON                                        73        NON VISIBILE
129200040928     C  n40              SETON                                        71        NON VISIBILE
129300021029      *
129400020626      * Non visibile in generale,oppure per 1° o 2° livello (in questi
129500021029      * due casi si fa riferimento al campo in prima videata)
129600020626     C     §OGFRI        WHENEQ    'Y'                                          NON VISIBILE
129700040928     c
129800970514     C     §OGFRI        OREQ      '1'                                          NON VISIB. 1°LIV.
129900021029     C     VLPO          ANDEQ     '1'
130000040928     c
130100970514     C     §OGFRI        OREQ      '2'                                          NON VISIB. 1°LIV.
130200021029     C     VLPO          ANDEQ     '2'
130300030519     C                   SETON                                        73
130400020626     C                   ENDSL
130500020626      *
130600020626      * Caso T/V
130700080225x   4C                   ELSE
130800020626     C                   SELECT
130900040928     c* Protetto ma non per EDP
131000020626     C     §OGFRV        WHENEQ    'S'                                          PROTETTO
131100020626     C   40              SETON                                        71
131200021029      *
131300021029      * Protetto per tutti
131400020626     C     §OGFRV        WHENEQ    'T'
131500020626     C                   SETON                                        71
131600021029      *
131700021029      * Non visibile per tutti a parte per EDP per il quale
131800021029      * è comunque protetto
131900040928     C     §OGFRV        WHENEQ    'W'
132000020626     C   40              SETON                                        73        NON VISIBILE
132100020626     C  N40              SETON                                        71        PROTETTO
132200040928     c
132300050503     c* In gestione a EDPO non visibile per gli altri
132400040928     C     §OGFRV        WHENEQ    'Z'
132500040928     C   40              SETON                                        73        NON VISIBILE
132600021029      *
132700021029      * Non visibile
132800020626     C     §OGFRV        WHENEQ    'Y'                                          NON VISIBILE
132900030519     C                   SETON                                        73
133000050503      * visibile solo per il network LOG
133100050503     C     §OGFRV        WHENEQ    'L'                                          NON VISIBILE
133200050503     c                   if        vntw<>'LOG'
133300050503     C                   SETON                                        73
133400050503     c                   endif
133500050503     c
133600020626     C                   ENDSL
133700080225e   4C                   ENDIF
133800080225e   3C                   ENDDO
133900030521      *
134000030521      * CONTROLLO FLAGS DSOR
134100030521      * voce protetta
134200040928     C                   IF        *in88 and §ORFRI = 'S'
134300030521     C                   SETON                                        71
134400030521     C                   ENDIF
134500021029      *
134600080225if  3c                   if        not *in73
134700900329     C                   MOVEL     *BLANKS       SFRAG
134800900329     C                   MOVEL     *BLANKS       SFDES
134900900329     C                   Z-ADD     0             SFFIA
135000890525     C                   MOVEL     TBLKEY        SFCOD
135100080225     C                   Z-ADD     SFCOD         xa
135200040928     C                   MOVEL     tbluni        SFTAB
135300030521     C  n88              MOVEL     §OGSIG        SFSIG
135400090710     c* se 120, imposto il p.o. contabilità
135500090803     c  n40              if        xa=120
135600090710     c                   movel     vfcont        vcf(xa)
135700090710     c                   movel     vdfcont       vde(xa)
135800090710     c                   endif
135900080225     C                   MOVEL     VDE(xa)       SFRAG
136000080225     C                   MOVEL     VCF(xa)       SFFIA
136100900402     C   02
136200080225do  4COR 03              DO
136300040928     C                   Z-ADD     SFFIA         wFIL
136400040928     C     wfil          CHAIN(N)  AZORG                              36
136500900328     C  N36              MOVEL     ORGDES        SFDES
136600080225e   4C                   END
136700040928     c*
136800890525     C                   ADD       1             NRR
136900131017      * ind.71 memorizzato x il PROTECT
137000131017     c                   eval        HSF_IND71 = *in71
137100941115     C                   WRITE     SD15DSF
137200080225e   3C                   endif
137300080225e   2C                   endif
137400040928     c
137500080225     C     k02tabel      READE     TABEL                                  22
137600080225e   1C                   ENDdo
137700890525     C                   ENDSR
137800021029      **---------------------------------------------------
137900030430      ** Controlli Subfile
138000021029      **---------------------------------------------------
138100021029     C     CtrSfl        BEGSR
138200030430      *
138300080225     C  N88              MOVEL     'OG'          TBLcod
138400080225     C   88              MOVEL     'OR'          TBLcod
138500891124     C                   DO        *HIVAL        NRR
138600900330     C                   SETOFF                                       71
138700941115     C     NRR           CHAIN     SD15DSF                            06
138800900328     C   06              GOTO      ENDSF
138900080225     C                   MOVEL     *BLANKS       TBLkey
139000080225     C                   MOVEL     SFCOD         TBLkey
139100080225     C     k03tabel      CHAIN     TABEL                              23
139200030521     C  N23              DO
139300030521     C  N88              MOVEL     TBLUNI        DSOG
139400030521     C   88              MOVEL     TBLUNI        DSOR
139500030521     C                   ENDDO
139600021029      *
139700030521      * CONTROLLO FLAGS OBBLIGATORIETA'
139800021029      * Se la descrizione viene impostata uguale alla decodifica
139900021029      * salto i controlli di obbligatorietà
140000030521      *
140100030521      * CASO DSOG
140200030521      *
140300030521     C  n88              DO
140400020626     C     §OGFFI        IFNE      'S'
140500021029      * Caso F/A
140600020626     C                   IF        VTip = 'F' or VTip = 'A'
140700970514     C     §OGFOB        IFEQ      'S'                                          SEMPRE OBBL.
140800891120     C     SFRAG         ANDEQ     *BLANKS
140900970514     C     §OGFOB        OREQ      '1'
141000970514     C     SFRAG         ANDEQ     *BLANKS                                      OBBL.1°LIV.
141100021029     C     VLPO          ANDEQ     '1'
141200970514     C     §OGFOB        OREQ      '2'
141300970514     C     SFRAG         ANDEQ     *BLANKS                                      OBBL.1°LIV.
141400021029     C     VLPO          ANDEQ     '2'
141500900328     C                   SETON                                        7099
141600131017     c                   eval        *in71 = HSF_IND71
141700941115     C                   UPDATE    SD15DSF
141800900328     C                   GOTO      ENDSF
141900040928     c                   else
142000040928     c                   setoff                                       70
142100131017     c                   eval        *in71 = HSF_IND71
142200040928     C                   UPDATE    SD15DSF
142300970514     C                   ENDIF
142400020626      *
142500020626      * Caso T/V
142600020626     C                   ELSE
142700020626     C     §OGFOV        IFEQ      'S'                                          SEMPRE OBBL.
142800020626     C     SFRAG         ANDEQ     *BLANKS
142900050503     c* L-obbligatorio solo per network LOG
143000050503     C     §OGFOV        orEQ      'L'                                          SEMPRE OBBL.
143100050503     C     SFRAG         ANDEQ     *BLANKS
143200050503     c     vntw          andeq     'LOG'
143300020626     C                   SETON                                        7099
143400131017     c                   eval        *in71 = HSF_IND71
143500020626     C                   UPDATE    SD15DSF
143600020626     C                   GOTO      ENDSF
143700040928     c                   else
143800040928     c                   setoff                                       70
143900131017     c                   eval        *in71 = HSF_IND71
144000040928     C                   UPDATE    SD15DSF
144100020626     C                   ENDIF
144200020626     C                   ENDIF
144300020626     C                   ENDIF
144400030521     C                   ENDDO
144500030521      *
144600030521      * CASO DSOR
144700030521      *
144800030521     C   88              DO
144900030521     C     §ORFFI        IFNE      'S'
145000030521      *
145100030521     C                   IF        §ORFOB = 'S'  and SFRAG = *blanks            SEMPRE OBBL.
145200030521     C                   SETON                                        7099
145300131017     c                   eval        *in71 = HSF_IND71
145400030521     C                   UPDATE    SD15DSF
145500030521     C                   GOTO      ENDSF
145600030521     C                   ENDIF
145700030521     C                   ENDIF
145800030521     C                   ENDDO
145900020626      *
146000900329     C     SFFIA         IFNE      0
146100040928     C                   Z-ADD     SFFIA         wFIL
146200040928     C     wfil          CHAIN(N)  AZORG                              72
146300900402     C  N72              MOVEL     ORGDES        SFDES
146400040525     c* errore
146500900402     C   72              DO
146600900402     C                   SETON                                        99
146700131017     c                   eval        *in71 = HSF_IND71
146800941115     C                   UPDATE    SD15DSF
146900900402     C                   GOTO      ENDSF
147000900402     C                   END
147100890921     C                   END
147200900328     C                   END
147300030521      *
147400021105     C     ENDSF         TAG
147500021107     C  N99              Z-ADD     1             NRR
147600040928     c* Mi riposiziono sul mio azorg
147700040928     c                   if        not *in01
147800080225     c                   movel     vfil          §fil
147900080225     C     §fil          chain     AzOrg                              36
148000040928     C                   ENDIF
148100020625     C                   ENDSR
148200021029      *--------------------------------------------------
148300030430      * Aggiornamento/Scrittura AzOrg00f
148400021029      *--------------------------------------------------
148500021029     C     WRTFIL        BEGSR
148600040302      *
148700040302      * Riaggancio azorg con corretto P.O
148800080225     C                   MOVEL     VFIL          §FIL
148900080225     C  N88§FIL          CHAIN     AZORG                              36
149000080225     C   88§FIL          CHAIN     AZOSE                              36
149100040302     c**
149200040928    1c                   if        waggsfl='S'
149300080225     C                   Z-ADD     0             XB
149400080225     C  N88              MOVEL     'OG'          TBLcod
149500080225     C   88              MOVEL     'OR'          TBLcod
149600040928     c
149700040928    2C                   IF        NRR >0
149800080225    3C                   DO        *HIVAL        xa
149900080225     C     xa            CHAIN     SD15DSF                            06
150000890525     C   06              GOTO      ENDAGG
150100040928     c
150200080225     C                   MOVEL     *BLANKS       TBLkey
150300080225     C                   MOVEL     SFCOD         TBLkey
150400080225     C     k03tabel      CHAIN     TABEL                              36
150500040928    4C  N36              if        not *in36
150600030521     C  N88              MOVEL     TBLUNI        DSOG
150700030521     C   88              MOVEL     TBLUNI        DSOR
150800040928     c                   else
150900040928     c                   clear                   dsog
151000040928     c                   clear                   dsor
151100040928    4C                   endif
151200040928     c
151300030521     C  N88§OGFFI        COMP      'S'                                    10
151400030521     C   88§ORFFI        COMP      'S'                                    10
151500080225     C                   Z-ADD     SFCOD         XB
151600040928    4C     SFRAG         IFEQ      *BLANKS
151700080225     C                   MOVEL     SFRAG         VDE(xb)
151800080225     C                   Z-ADD     0             VCF(xb)
151900040928   x4C                   else
152000040928     c*
152100040928    5C   88SFFIA         IFEQ      0
152200040525     C                   Z-ADD     046           SFFIA
152300040928    5C                   END
152400040525     c
152500040928    5C     SFFIA         IFEQ      0
152600080225     C   10              MOVEL     VDESF         VDE(xb)
152700080225     C  N10              MOVEL     SFRAG         VDE(xb)
152800080225     C                   MOVEL     VFIL          VCF(xb)
152900900329     C                   ELSE
153000040928     C   10              Z-ADD     SFFIA         wfil
153100040928     C   10wfil          CHAIN(N)  AZORG                              36
153200080225     C   10              MOVEL     ORGDES        VDE(xb)
153300080225     C  N10              MOVEL     SFRAG         VDE(xb)
153400080225     C                   Z-ADD     SFFIA         VCF(xb)
153500040928    5C                   END
153600040928    4C                   END
153700040928    3C                   END
153800040928    2C                   ENDIF
153900040928     c
154000900328     C     ENDAGG        TAG
154100040525     c
154200040525      * Riaggancio azorg con corretto P.O
154300080225     C                   MOVEL     VFIL          §FIL
154400080225     C  N88§FIL          CHAIN     AZORG                              36
154500080225     C   88§FIL          CHAIN     AZOSE                              36
154600040928     c* Imposto i campi delle filiali e delle descrizioni
154700080225     C                   MOVEL     VDE           $DE
154800080225     C                   Z-ADD     VCF           $CF
154900040928    1c                   endif
155000040928     c
155100040928     c                   if        *in01
155200040928     c  n88              clear                   azorg
155300040928     c   88              clear                   azose
155400090709     c* Reiposto i campi delle filiali e delle descrizioni
155500090709    1c                   if        waggsfl='S'
155600090709     C                   MOVEL     VDE           $DE
155700090709     C                   Z-ADD     VCF           $CF
155800090709     c                   endif
155900130422     c                   clear                   og130
156000040928     c                   clear                   og140
156100040928     c                   clear                   og142
156200040928     c                   clear                   og143
156300040928     c                   clear                   og144
156400040928     c                   clear                   og146
156500040928     c                   clear                   og147
156600040928     c                   clear                   og148
156700040928     c                   clear                   og149
156800040928     c                   clear                   og150
156900040928     c                   endif
157000040928     c
157100900418     C                   MOVEL     VFIL          ORGFIL
157200900330     C                   MOVEL     *BLANKS       ORGFVA
157300021029      *
157400040928     C                   if        VTIP <>'T'
157500020724     C                   MOVEL     VTIP          ORGFAG
157600020724     C                   MOVEL     *blanks       ORGFL2
157700020724      *
157800040928     c                   else
157900020724     C                   MOVEL     'V'           ORGFAG
158000020724     C                   MOVEL     'S'           ORGFL2
158100040928     C                   endif
158200020724      *
158300900330     C                   MOVEL     VCTS          ORGCTS
158400900330     C                   MOVEL     VCAA          ORGCAA
158500910122     C                   MOVE      VCAR          ORGCAR
158600910122     C                   MOVE      VCRE          ORGCRE
158700900521     C                   MOVEL     VFLE          ORGFEL
158800090803     C  n40              MOVEL     VFcont        ORGFC0
158900090803     C  n40              MOVEL     Vdfcont       ORGdC0
159000971112     C                   MOVEL     VDIT          ORGDIT
159100900330     C                   MOVEL     VFL1          ORGFL1
159200900330     C                   MOVEL     VFL3          ORGFL3
159300900330     C                   MOVEL     VDESF         ORGDES
159400900330     C                   MOVEL     VINDF         ORGIND
159500900405     C                   Z-ADD     VCAPF         ORGCPF
159600900330     C                   MOVEL     VLOCF         ORGLOC
159700900330     C                   MOVEL     VPROF         ORGPRO
159800900330     C                   MOVEL     VTELF         ORGTEL
159900900330     C                   MOVEL     VFAXF         ORGFAX
160000900330     C                   MOVEL     VTLXF         ORGTLX
160100040928     c* no agenzia
160200040928     c                   if        *in80
160300900402     C                   MOVEL     *BLANKS       ORGDEA
160400900402     C                   MOVEL     *BLANKS       ORGINA
160500900402     C                   Z-ADD     0             ORGCPA
160600900402     C                   MOVEL     *BLANKS       ORGLOA
160700900402     C                   MOVEL     *BLANKS       ORGPRA
160800900402     C                   MOVEL     *BLANKS       ORGTEA
160900900402     C                   MOVEL     *BLANKS       ORGFAA
161000900402     C                   MOVEL     *BLANKS       ORGTLA
161100040928     C                   else
161200040928     c* si agenzia
161300900330     C                   MOVEL     VDESA         ORGDEA
161400900330     C                   MOVEL     VINDA         ORGINA
161500900405     C                   Z-ADD     VCAPA         ORGCPA
161600900330     C                   MOVEL     VLOCA         ORGLOA
161700900330     C                   MOVEL     VPROA         ORGPRA
161800900330     C                   MOVEL     VTELA         ORGTEA
161900900330     C                   MOVEL     VFAXA         ORGFAA
162000900330     C                   MOVEL     VTLXA         ORGTLA
162100900330     C                   END
162200900409     C                   MOVEL     *BLANKS       ORGFTR
162300020617     C                   Z-ADD     0             ORGNTR
162400040525     C
162500040525      * NON PER LA SEDE
162600040525     C                   IF        NOT *IN88
162700040525      * VALORIZZO LA 149° DESCRIZIONE
162800040525      * telefono diretto p.o.
162900040525     C                   MOVEL     VTELD         §OGTLD
163000040525     C                   MOVEL     OG149         ORGDE9
163100090709     c                   movel     orgfil        $cf(149)
163200040525      *
163300040525      * VALORIZZO LA 143° DESCRIZIONE
163400040525      * Dpd
163500040525     C                   MOVEL     VDPD          §OGDPD
163600040525      * NetWork
163700040525     C                   MOVEL     VNTW          §OGNTW
163800040525      * Poste
163900040525     C                   MOVEL     VPOS          §OGPT
164000040928     C* solo per EDP
164100040525     C                   IF        NOT *IN40
164200040525      * Hub
164300060426     c                   movel     vhub          §oghb1
164400040525      * Deposito
164500060426     c                   movel     vdpt          §ogdp1
164600131016      * Linea x Forzatura RESI
164700131017     c                   if        VLresi > *zeros
164800131016     c                   movel     VLresi        §OGLNARES
164900131017     c                   else
165000131017     c                   clear                   §OGLNARES
165100131017     c                   end
165200150430      * Filiale valida per linea di partenza bolla
165300150430     c                   if        VFlnpb > *zeros
165400150430     c                   movel     VFlnpb        §OGLNpb
165500150430     c                   else
165600150430     c                   clear                   §OGLNpb
165700150430     c                   end
165800040525      * Ambiente appartenenza
165900040525     C                   MOVE      VOGAS         §OGAS
166000071012     c* Cod. indirizzo IP
166100071012     c                   movel     vindip        §ogiip
166200040525     C                   ENDIF
166300040525     C
166400040525     C                   MOVEL     OG143         ORGDE3
166500080225     c                   movel     orgfil        $cf(143)
166600040526      *
166700040526      * VALORIZZO LA 148° DESCRIZIONE
166800040526     C                   MOVE      VLPO          §OGLPO
166900040928     C* Solo per EDP
167000040526     C                   IF        NOT *IN40
167100040526     C                   MOVEL     BARFD1        §OGBD1
167200040526     C                   MOVE      BARFD2        §OGBD2
167300100930     c* Linea per gestione materiale EDP
167400100929     C                   MOVE      Vlue          §OGlue
167500100930     c                   if        vfiue>*zeros
167600100930     c                   movel     vfiue         §OGfiue
167700110110     c                   else
167800110110     c                   clear                   §ogfiue
167900100930     c                   endif
168000100930      * Linea bollettazione
168100040526     C                   MOVE      VLBL          §OGLBL
168200040526      * Linea nei fogli viaggio
168300040526     C                   MOVE      VLFV          §OGLFV
168400040526      * Linea parallela
168500040526     C                   MOVE      VLPR          §OGLPR
168600040526      * P.O non esegue IDD
168700040526     C                   MOVE      VNID          §OGNID
168800040526      * P.O esegue IDD giorno dopo
168900040526     C                   MOVE      VEID          §OGEID
169000040526      * ORM avviata
169100040526     C                   MOVE      VORM          §OGORM
169200061227      * PDA ORM avviata
169300061227     c                   move      vpdaorm       §OGpdaorm
169400080206      * PDA CONSEGNE avviata
169500080206     c                   move      vpdacon       §OGpdacon
169600060828      * TELLUS attivata
169700060828     C                   MOVE      Vtlls         §OGTLLS
169800070301      * Flag avviamento gestione telefonate legate a GEO
169900070301     C                   MOVEL     VGEOT         §OGGEOT
170000040526      * Autogenerazione spunte
170100040526     C                   MOVE      *BLANKS       §OGAGP
170200040526     C                   MOVE      *BLANKS       §OGAGS
170300040526     C                   SELECT
170400040526      *  partenza con pistola 88
170500170608     C**                 WHEN      VASP = 'S'
170600170608     C**                 MOVE      *BLANKS       §OGAGP
170700170608     C**                 MOVE      *BLANKS       §OGAGS
170800170608      *  spu. partenza da spubnta entrata del terminal
170900040526     C                   WHEN      VASPCV = 'S'
171000170608     C***                   MOVE      *BLANKS       §OGAGP
171100170608     C                   MOVE      'E'           §OGAGS
171200170608      *  spu.partenza da qualsiasi spunta entrata
171300040526     C                   WHEN      VASE = 'S'
171400170608     C***                   MOVE      'P'           §OGAGP
171500170608     C                   MOVE      'S'           §OGAGS
171600040526     C                   ENDSL
171700040526     C                   ENDIF
171800040526     C
171900040526     C                   MOVEL     OG148         ORGDE8
172000080225     c                   movel     orgfil        $cf(148)
172100131108      * VALORIZZO LA 129° DESCRIZIONE
172200131108     c                   clear                   OG129
172300131108      * Orari filiale
172400131108     c                   eval      §OGorfmd = %editc(V02orfmd:'X')
172500131108     c                   eval      §OGorfma = %editc(V02orfma:'X')
172600131108     c                   eval      §OGorfpd = %editc(V02orfpd:'X')
172700131108     c                   eval      §OGorfpa = %editc(V02orfpa:'X')
172800131108     c                   eval      ORGdc9 = OG129
172900131108     c                   eval      $cf(129) = ORGfil
173000130422
173100130422      * VALORIZZO LA 130° DESCRIZIONE
173200130422     c                   clear                   OG130
173300130422      * Orari filiale
173400130423     c                   eval      §OGoramd = %editc(V02oramd:'X')
173500130423     c                   eval      §OGorama = %editc(V02orama:'X')
173600130423     c                   eval      §OGorapd = %editc(V02orapd:'X')
173700130423     c                   eval      §OGorapa = %editc(V02orapa:'X')
173800130422     c                   eval      ORGdd0 = OG130
173900130422     c                   eval      $cf(130) = ORGfil
174000130422
174100130514      * VALORIZZO LA 132° DESCRIZIONE
174200130422      * Assistenza Clienti
174300130422     c                   eval      ORGdd2 = V02ascm
174400130422     c                   eval      $cf(132) = ORGfil
174500130422
174600130422      * VALORIZZO LA 133° e 134° DESCRIZIONE
174700130422      * Assistenza Commerciale
174800130422     c                   eval      ORGdd3 = V02comt
174900130422     c                   eval      ORGdd4 = V02comm
175000130422     c                   eval      $cf(133) = ORGfil
175100130422     c                   eval      $cf(134) = ORGfil
175200040525     C
175300040525     C* LE DS LE VALORIZZO DAI CAMPI VIDEO SOLTANTO SE NON SONO EDP
175400040525     C                   IF        NOT *IN40
175500021106      *
175600021106      * VALORIZZO 140° DESCRIZIONE
175700021106      * Raggruppamento area
175800030521     C                   IF        VAra = *blanks
175900030521     C                   MOVE      *zeros        §OGARA
176000030521     C                   ELSE
176100021106     C                   MOVE      VARA          §OGARA
176200030521     C                   ENDIF
176300021106      * Ex area As/400
176400030521     C                   if        VAex = *blanks
176500030521     C                   MOVE      *zeros        §OGAEX
176600021107     C                   else
176700030521     C                   MOVE      VAex          §OGAEX
176800021107     C                   endif
176900021106      * Area POC
177000030521     C                   if        VApo = *blanks
177100030521     C                   MOVE      *zeros        §OGAPO
177200021107     C                   else
177300030521     C                   MOVE      VApo          §OGAPO
177400021107     C                   endif
177500151028      * Raggruppamento area centralino
177600151028     C                   IF        VArc = *blanks
177700151028     C                   MOVE      *zeros        §OGARC
177800151028     C                   ELSE
177900151028     C                   MOVE      VARC          §OGARC
178000151028     C                   ENDIF
178100021106     C                   MOVEL     OG140         ORGDE0
178200080225     c                   movel     orgfil        $cf(140)
178300050708      * VALORIZZO LA 141° DESCRIZIONE
178400050708     C                   CLEAR                   OG141
178500050708      * Code Faxin/Faxout
178600050708     C                   MOVE      VSSC          §OGSSC
178700050708     C                   MOVEL     OG141         ORGDE1
178800080225     c                   movel     orgfil        $cf(141)
178900021028      *
179000021029      * VALORIZZO LA 142° DESCRIZIONE
179100021028     C                   CLEAR                   OG142
179200021028      * Code Faxin/Faxout
179300021028     C                   MOVE      VFXI          §OGFXI
179400021028     C                   MOVE      VFXO          §OGFXO
179500021028     C                   MOVEL     OG142         ORGDE2
179600080225     c                   movel     orgfil        $cf(142)
179700020731      *
179800021029      * VALORIZZO LA 144° DESCRIZIONE
179900020731     C                   CLEAR                   OG144
180000020731      * Coda stampa da sede per P.O
180100020731     C                   MOVEL     VSSP          §OGSSP
180200020731     C                   MOVEL     OG144         ORGDE4
180300080225     c                   movel     orgfil        $cf(144)
180400020618      *
180500021029      * VALORIZZO LA 146° DESCRIZIONE
180600020618     C                   CLEAR                   OG146
180700040301     c* Date scanerizzazione
180800040301     c                   if        wdsd>0
180900040301     c                   move      wdsd          §ogdsd
181000040301     c                   endif
181100040301     c                   if        wdse>0
181200040301     c                   move      wdse          §ogdse
181300040301     c                   endif
181400070227     c* data inizio distinte automatiche
181500070227     c                   if        wdda>0
181600070227     c                   move      wdda          §ogdda
181700070227     c                   endif
181800020618     C                   MOVEL     OG146         ORGDE6
181900080225     c                   movel     orgfil        $cf(146)
182000020618      *
182100021029      * VALORIZZO LA 147° DESCRIZIONE
182200020618     C                   CLEAR                   OG147
182300030429      * Regione
182400030429     C                   MOVE      VRET          §OGRET
182500020618      * Creazione bolle in sede per posta
182600020618     C                   MOVEL     VNOC          §OGNOC
182700070828      * Flag attivazione richiesta data e ora limite abbinam. distinte autom
182800070828     c                   move      vdoada        §ogdoada
182900070828      * Flag attivazione richiesta tipo uscita distinte autom
183000070828     c                   move      vfppda        §ogfppda
183100070828      * Flag attivazione procedura Giri su ORM
183200070828     c                   move      vcgio         §ogcgio
183300070704      * Data inizio ditinte ORM automatiche
183400070704     c                   if        wddao > *zeros
183500070704     c                   move      wddao         §ogddao
183600070704     c                   endif
183700070926      * Flag attivazione richiesta tipo uscita distinte autom ORM
183800070926     c                   move      vfrtuo        §ogfrtuo
183900070926
184000021106     C                   MOVEL     OG147         ORGDE7
184100080225     c                   movel     orgfil        $cf(147)
184200020618      *
184300021029      * VALORIZZO LA 150° DESCRIZIONE
184400020618     C                   CLEAR                   OG150
184500021029      * Data utilizzo macchinone per volume
184600030521     C                   MOVEL     VVol          §OGVOL
184700021029      * Data utilizzo macchinone per peso
184800020618     C                   move      VPES          §OGPES
184900020618      * disk C
185000020618     C                   MOVE      Vdkc          §OGDKC
185100170227     C                   MOVE      Vdirdkc       §OGdkcdir
185200031016      * picking
185300031016     C                   MOVE      Vpck          §OGPCK
185400050509     C                   MOVE      Vpkm          §OGPkm
185500160506     C                   MOVE      Vturno        §OGturno
185600041213     C                   MOVE      Vtis          §OGtis
185700160531      * autogenerazione spunte uscita (per fil. con Picking NO VdL)
185800160531     C                   MOVE      Vagspus       §OGagspus
185900101215     c* IMA colli spuntati lna finale
186000101215     c                   move      Vimaa         §OGimaa
186100040301     c*
186200120924     C****               MOVE      Vspv          §OGspv
186300120924     C****               MOVE      Vspp          §OGspp
186400040517     C                   MOVE      Vsea          §OGsea
186500170321      * - Flag "Esente Blocco Dirottamento"
186600170321     C                   movel     vEsBlDi       §ogEsBlDi
186700020618     C                   MOVEL     OG150         ORGDF0
186800080225     c                   movel     orgfil        $cf(150)
186900020618      *
187000040301      * Des. linea arrivo per stampa segnacollo
187100020618     C                   MOVEL     VASS          ORGDE5
187200040928     c
187300040928     c                   else
187400040928     c* per immissione imposto lo stesso del descrizioni vuote
187500040928     c                   if        *in01
187600040928     C                   MOVEL     OG140         ORGDE0
187700080225     c                   movel     orgfil        $cf(140)
187800060301     C                   MOVEL     OG141         ORGDE1
187900080225     c                   movel     orgfil        $cf(141)
188000040928     C                   MOVEL     OG142         ORGDE2
188100080225     c                   movel     orgfil        $cf(142)
188200040928     C                   MOVEL     OG143         ORGDE3
188300080225     c                   movel     orgfil        $cf(143)
188400040928     C                   MOVEL     OG144         ORGDE4
188500080225     c                   movel     orgfil        $cf(144)
188600040928     C                   MOVEL     OG146         ORGDE6
188700080225     c                   movel     orgfil        $cf(146)
188800040928     C                   MOVEL     OG147         ORGDE7
188900080225     c                   movel     orgfil        $cf(147)
189000040928     C                   MOVEL     OG148         ORGDE8
189100080225     c                   movel     orgfil        $cf(148)
189200040928     C                   MOVEL     OG149         ORGDE9
189300080225     c                   movel     orgfil        $cf(149)
189400040928     C                   MOVEL     OG150         ORGDF0
189500080225     c                   movel     orgfil        $cf(150)
189600040928     c                   endif
189700040928     c
189800040525     C                   ENDIF
189900040525     C                   ENDIF
190000020614     C
190100021029      *
190200920317     C   01
190300920317     CANN88              WRITE     AZORG
190400920317     C   02
190500920317     CANN88              UPDATE    AZORG
190600920317     C   01
190700920317     CAN 88              WRITE     AZOSE
190800920317     C   02
190900920317     CAN 88              UPDATE    AZOSE
191000920317     C   88              EXSR      AGGSED
191100900328     C                   ENDSR
191200021029      *------------------------------------------------------
191300030430      * Pulizia VIDEO 2
191400021029      *------------------------------------------------------
191500021029     C     PULVID2       BEGSR
191600030430      *
191700040924     C                   movel     *blanks       vfag
191800040924     C                   movel     *blanks       vdesf
191900030430     C                   movel     *blanks       vindf
192000030430     C                   z-add     0             vcapf
192100030430     C                   movel     *blanks       vlocf
192200030430     C                   movel     *blanks       vprof
192300030430     C                   movel     *blanks       vtlxf
192400030430     C                   movel     *blanks       vfaxf
192500030430     C                   movel     *BLANKS       VCAA
192600030430     C                   movel     *BLANKS       VTELF
192700030430     C                   movel     *BLANKS       VDESA
192800030430     C                   z-add     0             VCAPA
192900030430     C                   movel     *BLANKS       VLOCA
193000030430     C                   movel     *BLANKS       VPROA
193100030430     C                   movel     *BLANKS       VINDA
193200030430     C                   movel     *BLANKS       VTELA
193300030430     C                   movel     *BLANKS       VFAXA
193400030430     C                   movel     *blanks       vtlxa
193500040518     C                   movel     *blanks       vteld
193600030430     C                   movel     *blanks       vcts
193700030430     C                   move      *zeros        vcar
193800030430     C                   move      *zeros        vcre
193900030430     C                   movel     *blanks       vdcts
194000030430     C                   movel     *blanks       vdfl3
194100030430     C                   movel     *blanks       vdcar
194200030430     C                   movel     *blanks       vdcre
194300030430     C                   movel     *blanks       vlpo
194400030430     C                   movel     *blanks       vdlpo
194500030430     C                   movel     *blanks       vntw
194600100930     C                   movel     *blanks       vdntw
194700100929     C                   movel     *blanks       vlue
194800100930     C                   movel     *blanks       vfiue
194900100930     C                   movel     *blanks       vdfiue
195000030430     C                   movel     *blanks       vdit
195100030430     C                   movel     *blanks       vfl1
195200030430     C                   movel     *blanks       vfl3
195300030430     C                   movel     'N'           vdpd
195400030430     C                   movel     *blanks       vpos
195500040924     C                   movel     *blanks       vtfp
195600040924     C                   movel     *blanks       vdtfp
195700040924     C                   movel     *blanks       vtfa
195800040924     C                   movel     *blanks       vdtfa
195900071012     c                   clear                   vindip
196000030430      *
196100020614     C                   ENDSR
196200021029      *-----------------------------------------------------
196300030430      * Riempimento VIDEO 2
196400021029      *-----------------------------------------------------
196500040517     C     AGGVID2       BEGSR
196600100929     c                   setoff                                       19
196700040924     c
196800040924     c* Organigramma di sede
196900040924    1c                   if        *in88
197000040924     c                   eval      vfild=vfil
197100040924     C                   move      'F'           VTip
197200040928     c                   seton                                        80
197300040924    1c                   endif
197400040924     c
197500040924     c* Imposto e decodifico tipo p.o.
197600040924    1c                   if        not *in88
197700040924     c
197800040924    2C                   IF        VTip = *blanks
197900040924     C                   eval      VTip = OrgFag
198000040924     c* linea per tariffe
198100040924    3c                   if        orgfl2='S' and orgfag='V'
198200040924     c                   eval      vtip='T'
198300040924    3C                   ENDIF
198400040924    2C                   ENDIF
198500040924      * 80 off - agenzia
198600040924    2C                   IF        Vtip = 'F'or VTip = 'V' OR VTIP = 'T'
198700040924     C                   Eval      *in80 = *on
198800040924    2C                   ENDIF
198900100929     c* 19 on - se tipo "V" devo emettere scritta se linea per gestione unità EDP
199000100929    2C                   IF        Vtip = 'V'
199100100929     C                   Eval      *in19 = *on
199200100929    2C                   ENDIF
199300040924     c*
199400040924     C                   SELECT
199500040924     C     VTIP          WHENEQ    'F'
199600040924     C                   MOVEL     'FILIALE'     VFAG
199700040924     C     VTIP          WHENEQ    'A'
199800040924     C                   MOVEL     'AGENZIA'     VFAG
199900040924     C     VTIP          WHENEQ    'V'
200000040924     C                   MOVEL     'VARIE'       VFAG
200100040924     C     VTIP          WHENEQ    'T'
200200080225     C                   MOVEL     C_Ln_x_Tar    VFAG
200300040924     C                   ENDSL
200400040924    1c                   endif
200500040924     c* Se variazione, riempo tutti gli altri campi
200600040924     c
200700040924    1c                   if        not *in01
200800040924     c*
200900080225     C                   MOVEL     $DE           VDE
201000080225     C                   Z-ADD     $CF           VCF
201100030430      * Dati descrittivi
201200900328     C                   MOVEL     ORGDES        VDESF
201300900328     C                   MOVEL     ORGIND        VINDF
201400900328     C                   Z-ADD     ORGCPF        VCAPF
201500900328     C                   MOVEL     ORGLOC        VLOCF
201600900328     C                   MOVEL     ORGPRO        VPROF
201700900328     C                   MOVEL     ORGTEL        VTELF
201800900328     C                   MOVEL     ORGFAX        VFAXF
201900900328     C                   MOVEL     ORGTLX        VTLXF
202000030430      * telefono diretto P.O
202100040928     C                   movel     ORGDE9        Og149
202200040518     C                   movel     §OgTld        VTELD
202300030430      * Dati descrittivi per tipo <> 'F'
202400040924    2C  N80              DO
202500030430     C                   MOVEL     ORGDEA        VDESA
202600030430     C                   MOVEL     ORGINA        VINDA
202700030430     C                   Z-ADD     ORGCPA        VCAPA
202800030430     C                   MOVEL     ORGLOA        VLOCA
202900030430     C                   MOVEL     ORGPRA        VPROA
203000030430     C                   MOVEL     ORGTEA        VTELA
203100030430     C                   MOVEL     ORGFAA        VFAXA
203200030430     C                   MOVEL     ORGTLA        VTLXA
203300040924    2C                   END
203400040924     c* solo per organigramma di filiale
203500040924    2c                   if        not *in88
203600040924     c* Imposto tutte le ds "OGxxx"
203700040924     C                   MOVEL     ORGDE0        OG140
203800050708     C                   MOVEL     ORGDE1        OG141
203900040924     C                   MOVEL     ORGDE2        OG142
204000040924     C                   MOVEL     ORGDE3        OG143
204100040924     C                   MOVEL     ORGDE4        og144
204200040924     C                   MOVEL     ORGDE6        og146
204300040924     C                   MOVEL     ORGDE7        OG147
204400040924     C                   MOVEL     ORGDE8        OG148
204500040924     C                   MOVEL     ORGDF0        og150
204600030430      * tassazione
204700900328     C                   MOVEL     ORGCTS        VCTS
204800100125      * direzione commerciale
204900030430     C                   MOVEL     ORGFL3        VFL3
205000030430      * regione
205100910122     C                   MOVE      ORGCRE        VCRE
205200030430      * area
205300030430     C                   MOVE      ORGCAR        VCAR
205400021106      *
205500030430      * Livello P.O
205600021029     C                   MOVE      §OGLPO        VLPO
205700030430      * aspettativa aziendale
205800030430     C                   MOVEL     ORGCAA        VCAA
205900021028      * NetWork
206000020617     C                   MOVEL     §OGNTW        VNTW
206100100929     C                   MOVEL     §OGlue        Vlue
206200030430      * ramo aziendale
206300030430     C                   MOVEL     ORGDIT        VDIT
206400030430      * p.o italia/estero
206500030430     C                   MOVEL     ORGFL1        VFL1
206600020617      * Dpd
206700020617     C                   MOVEL     §OGDPD        VDPD
206800020617      * Poste
206900020617     C                   MOVEL     §OGPT         VPOS
207000071012      * Indirizzo IP
207100071012     c                   movel     §ogiip        vindip
207200040924     c
207300040924     c* Da fare solo per AZORG e non per AZOSE
207400040924     c* (della 2° videata c'e' soltanto l'indirizzo dell'azienda)
207500040924    2C                   EXSR      DecVid2
207600040924    1c                   endif
207700040924     c                   endif
207800030430      *
207900900328     C                   ENDSR
208000030430      *------------------------------------------------------
208100030430      * Decodifiche VIDEO 2
208200030430      *------------------------------------------------------
208300030430     C     DECVID2       BEGSR
208400030430      *
208500030430      * tassazione
208600080225     C                   movel     'CT'          TBLcod
208700080225     C                   movel     *blanks       TBLkey
208800080225     C                   movel     vcts          TBLkey
208900080225     C     k03tabel      chain     tabel                              36
209000030430     C  n36              movel     tbluni        vdcts
209100030430      *
209200100125      * direzione commerciale
209300080225     C                   movel     '17'          TBLcod
209400080225     C                   movel     *blanks       TBLkey
209500080225     C                   movel     vfl3          TBLkey
209600080225     C     k03tabel      chain     tabel                              36
209700030430     C  n36              movel     tbluni        vdfl3
209800030430      *
209900030430      * Regione
210000080225     C                   movel     '14'          TBLcod
210100080225     C                   movel     *blanks       TBLkey
210200080225     C                   movel     vcre          TBLkey
210300080225     C     k03tabel      chain     tabel                              36
210400030430     C  n36              movel     tbluni        vdcre
210500030430      *
210600030430      * area
210700080225     C                   movel     '05'          TBLcod
210800080225     C                   movel     *blanks       TBLkey
210900080225     C                   movel     vcar          TBLkey
211000080225     C     k03tabel      chain     tabel                              36
211100030430     C  n36              movel     tbluni        vdcar
211200030430      * Livello p.o
211300030430     C                   move      *blanks       vdlpo
211400030430     C                   SELECT
211500030430     C     vlpo          WHENEQ    *blanks
211600080225     C                   movel     C_NotOpe      vdlpo
211700030430     C     vlpo          WHENEQ    '1'
211800080225     C                   movel     C_1_Liv       vdlpo
211900030430     C     vlpo          WHENEQ    '2'
212000080225     C                   movel     C_2_liv       vdlpo
212100030430     C                   ENDSL
212200030430      * Network
212300030527     C                   IF        vntw <> *blanks
212400080225     C                   clear                   TIBS02ds
212500030430     C                   movel     'C'           T02mod
212600030430     C                   movel     knsif         T02sif
212700030430     C                   movel     'NTW'         T02cod
212800030430     C                   movel     *blanks       T02ke1
212900030505     C                   movel     vntw          T02ke1
213000030430     C                   CALL      'TIBS02R'
213100030430     C                   parm                    kpjba
213200080225     C                   parm                    TIBS02ds
213300030430      *
213400030430     C                   IF        t02err = *blanks
213500030430     C                   movel     t02uni        vdntw
213600030430     C                   ENDIF
213700030430     C                   ENDIF
213800030430      *
213900030430     C                   ENDSR
214000021029      *-----------------------------------------------------
214100030430      * Controlli VIDEO 2
214200021029      *-----------------------------------------------------
214300040518     C     CTRVID2       BEGSR
214400021029      *
214500021029      * descrizione filiale
214600030430     C                   IF        VDesF = *blanks
214700900328     C                   SETON                                        5298
214800030429     C                   GOTO      END2
214900900328     C                   END
215000021029      *
215100021029      * Per i tipo "V" e "T" non è obbligatorio indicare l'indirizzo
215200021029      * se però è stato immesso un solo campo l'ind. deve essere completo
215300020626     C                   move      *on           $CtrIndF          1
215400040924     C                   IF        Vtip='V' or  Vtip='T'
215500040924     C                   IF        VIndF=*blanks and VCapF=*zeros
215600020626     C                             and VlocF= *blanks and VProF= *blanks
215700020626     C                             and  VTelF =*blanks
215800020626     C                   move      *off          $CtrIndF          1
215900020625     C                   ENDIF
216000040924     C                   ENDIF
216100021029      * indirizzo filiale
216200020625     c                   IF        $CtrIndF =*on
216300030430     C                   IF        vindf = *blanks
216400900328     C                   SETON                                        5398
216500030429     C                   GOTO      END2
216600900328     C                   END
216700021029      * cap filiale
216800030430     C                   IF        vcapf = *zeros
216900900328     C                   SETON                                        5498
217000030429     C                   GOTO      END2
217100900328     C                   END
217200021029      * località filiale
217300030430     C                   IF        vlocf = *blanks
217400900328     C                   SETON                                        5598
217500030429     C                   GOTO      END2
217600900328     C                   END
217700021029      * provincia filaile
217800030430     C                   IF        vprof = *blanks
217900900329     C                   SETON                                        7898
218000030429     C                   GOTO      END2
218100900329     C                   END
218200090709      * telefono filiale
218300030430     C                   IF        vtelf = *blanks
218400900328     C                   SETON                                        5698
218500030429     C                   GOTO      END2
218600900328     C                   END
218700020625     C                   ENDIF
218800040924      * telefono diretto filiale
218900040518     C  n88              IF        vteld = *blanks
219000040518     C                   IF        vtip = 'F' or vtip='A'
219100040518     C                   SETON                                        7798
219200040518     C                   GOTO      END2
219300040518     C                   END
219400040518     C                   ENDIF
219500020625      *
219600020626     C  N80              DO
219700040924      * descrizione agenzia
219800030430     C                   IF        vdesa = *blanks
219900900330     C                   SETON                                        5898
220000030429     C                   GOTO      END2
220100900328     C                   END
220200030430     C                   IF        vdesa = vdesf
220300900330     C                   SETON                                        5798
220400030429     C                   GOTO      END2
220500900328     C                   END
220600021029      *
220700021029      * indirizzo agenzia
220800030430     C                   IF        vinda = *blanks
220900900328     C                   SETON                                        6198
221000030429     C                   GOTO      END2
221100900328     C                   END
221200021029      * cap agenzia
221300030430     C                   IF        vcapa = *zeros
221400900328     C                   SETON                                        5998
221500030429     C                   GOTO      END2
221600900328     C                   END
221700021029      * località agenzia
221800030430     C                   IF        Vloca = *blanks
221900900328     C                   SETON                                        6098
222000030429     C                   GOTO      END2
222100900328     C                   END
222200021029      * provincia agenzia
222300030430     C                   IF        vproa = *blanks
222400900329     C                   SETON                                        7998
222500030429     C                   GOTO      END2
222600900329     C                   END
222700021029      * telefono agenzia
222800030430     C                   IF        vtela = *blanks
222900900328     C                   SETON                                        6298
223000030429     C                   GOTO      END2
223100900328     C                   END
223200910220     C                   END                                                       N80
223300020801      *
223400021029      * Controlli e decodifiche da farsi se non elaboro azose
223500020801     C  N88              DO
223600020801      *
223700021029      * Codice di tassazione
223800020801     C                   MOVEL     *blanks       VDCTS
223900900328     C     VCTS          IFEQ      *BLANKS
224000900328     C                   SETON                                        6398
224100030429     C                   GOTO      END2
224200020801      *
224300020801     C                   ELSE
224400040924     C     '?'           scan      vcts                                   31
224500910122     C   31              DO
224600020801     C                   MOVE      *BLANKS       VCTS
224700120712     c                   clear                   TRTB09DS
224800120712     c                   eval      TB09fun = '1'
224900120712     c                   eval      TB09ord = '1'
225000120712     c                   eval      kpjbu = TRTB09DS
225100120712     c                   call      'TRTB09R'
225200120712     c                   parm                    kpjba
225300120712     c                   eval      TRTB09DS = kpjbu
225400120712     C                   if        TB09cod <> *blanks
225500120712     c                   eval      vcts  = TB09cod
225600120712     c                   eval      vdcts = TB09des
225700020801     C                   endif
225800090709     C                   SETON                                          9809
225900030429     C                   GOTO      END2
226000910306     C                   END
226100020801      *
226200020801      * decodifica piu' controllo
226300080225     C                   MOVEL     'CT'          TBLcod
226400080225     C                   MOVEL     *BLANKS       TBLkey
226500080225     C                   MOVEL     VCTS          TBLkey
226600080225     C     k03tabel      CHAIN     TABEL                              36
226700900402     C  N36              MOVEL     TBLUNI        VDCTS
226800900328     C   36              SETON                                        6398
226900030429     C   98              GOTO      END2
227000900328     C                   END
227100020801      *
227200100125      * codice direzione commerciale
227300020801     C                   MOVEL     *blanks       VDFL3
227400910306     C     VFL3          IFEQ      *BLANKS
227500910306     C                   SETON                                        6498
227600030429     C                   GOTO      END2
227700020801      *
227800910306     C                   ELSE
227900910306     C     VFL3          IFEQ      '?'
228000080225     C                   MOVEL     C_CodUt       §KUT
228100080225     C                   MOVEL     '17'          §COD
228200020801     C                   MOVE      *BLANKS       §key
228300020801     C                   MOVEL     *blanks       VFL3
228400910306     C                   CALL      'X§TABER'
228500910306     C                   PARM                    §KUT
228600080225     C                   PARM                    §COD
228700080225     C                   PARM                    §KEY
228800080225     C                   PARM                    §DES
228900020801     C                   if        §key <> *blanks
229000910306     C                   MOVEL     §KEY          VFL3
229100040526     C                   MOVEL     §DES          VDFL3
229200020801     C                   endif
229300090709     C                   SETON                                          9809
229400030429     C                   GOTO      END2
229500910306     C                   END
229600020801      * decodifiche piu' controlli
229700080225     C                   MOVEL     '17'          TBLcod
229800080225     C                   MOVEL     *BLANKS       TBLkey
229900080225     C                   MOVEL     VFL3          TBLkey
230000080225     C     k03tabel      CHAIN     TABEL                              36
230100910306     C  N36              MOVEL     TBLUNI        VDFL3
230200910306     C   36              SETON                                        6498
230300030429     C   98              GOTO      END2
230400910306     C                   END
230500030403      *
230600030403      * codice regione
230700030403     C                   MOVEL     *blanks       VDCRE
230800030403     C     VCRE          IFEQ      *BLANKS
230900030403     C                   SETON                                        8598
231000030429     C                   GOTO      END2
231100030403      *
231200030403     C                   ELSE
231300040924     C     '?'           scan      Vcre                                   31
231400030403     C   31              DO
231500080225     C                   MOVEL     C_CodUt       §KUT
231600080225     C                   MOVEL     '14'          §COD
231700030403     C                   MOVE      *BLANKS       §key
231800030403     C                   MOVE      *BLANKS       VCRE
231900030403     C                   CALL      'X§TABER'
232000030403     C                   PARM                    §KUT
232100080225     C                   PARM                    §COD
232200080225     C                   PARM                    §KEY
232300080225     C                   PARM                    §DES
232400030403     C                   if        §key <> *blanks
232500030403     C                   MOVEL     §KEY          VCRE
232600040526     C                   MOVEL     §DES          VDCRE
232700030403     C                   endif
232800090709     C                   SETON                                          9809
232900030429     C                   GOTO      END2
233000030403     C                   END
233100030403      *decodifica e controllo
233200080225     C                   MOVEL     '14'          TBLcod
233300080225     C                   MOVEL     *BLANKS       TBLkey
233400080225     C                   MOVEL     VCRE          TBLkey
233500080225     C     k03tabel      CHAIN     TABEL                              36
233600030403     C  N36              MOVEL     TBLUNI        VDCRE
233700030403     C   36              SETON                                        8598
233800030429     C   98              GOTO      END2
233900030403     C                   END
234000020801      *
234100021029      * codice area
234200020801     C                   MOVEL     *blanks       VDCAR
234300910122     C     VCAR          IFEQ      *BLANKS
234400900405     C                   SETON                                        8498
234500030429     C                   GOTO      END2
234600020801      *
234700900405     C                   ELSE
234800040924     C     '?'           scan      Vcar                                   31
234900910122     C   31              DO
235000080225     C                   MOVEL     C_CodUt       §KUT
235100080225     C                   MOVEL     '05'          §COD
235200020801     C                   MOVE      *BLANKS       §key
235300020801     C                   MOVEL     *blanks       VCAR
235400910122     C                   CALL      'X§TABER'
235500910122     C                   PARM                    §KUT
235600080225     C                   PARM                    §COD
235700080225     C                   PARM                    §KEY
235800080225     C                   PARM                    §DES
235900020801     C                   if        §key <> *blanks
236000910122     C                   MOVEL     §KEY          VCAR
236100040526     C                   MOVEL     §DES          VDCAR
236200020801     C                   endif
236300090709     C                   SETON                                          9809
236400030429     C                   GOTO      END2
236500021029     C                   END
236600020801      * decodifica e controllo
236700080225     C                   MOVEL     '05'          TBLcod
236800080225     C                   MOVEL     *BLANKS       TBLkey
236900080225     C                   MOVEL     VCAR          TBLkey
237000080225     C     k03tabel      CHAIN     TABEL                              36
237100900405     C  N36              MOVEL     TBLUNI        VDCAR
237200900405     C   36              SETON                                        8498
237300030429     C   98              GOTO      END2
237400910220     C                   END
237500071012      * indirizzo IP
237600071012     c                   if        vindip<>*blanks
237700071015     c                             and vindip<=*zeros or vindip>'254'
237800071015     C                   SETON                                        2998
237900071012     c                   goto      end2
238000071012     c                   endif
238100040924      *
238200040924      * Tipo P.O per V/T puo' solo essere a *blanks
238300040924     C                   IF        Vtip = 'V' and VLpo <> ' ' or
238400040924     C                             Vtip = 'T' and VLpo <> ' '
238500040924     C                   SETON                                        4198
238600040924     C                   GOTO      END2
238700040924     C                   ENDIF
238800021029      *
238900040924      * Decodifica Tipo P.O
239000030404     C                   MOVE      *BLANKS       VDLpo
239100030404     C                   SELECT
239200030404     C     VLPO          WHENEQ    *blanks
239300080225     C                   MOVEL     C_NotOpe      VDLpo
239400030404     C     VLPO          WHENEQ    '1'
239500080225     C                   MOVEL     C_1_Liv       VDLpo
239600030404     C     VLPO          WHENEQ    '2'
239700080225     C                   MOVEL     C_2_liv       VDLpo
239800030404     C                   ENDSL
239900021029      *
240000021029      * Network
240100020617     C                   MOVEL     *blanks       VDNTW
240200020617     C     VNTW          IFEQ      *BLANKS
240300020617     C                   SETON                                        6598
240400030429     C                   GOTO      END2
240500020617     C                   ELSE
240600020617     C     '?'           SCAN      VNTW                                   31
240700020617     C   31              DO
240800020617      * PER RIEMETTERE IL VIDEO ALMENO UNA VOLTA DOPO LE RICERCHE
240900090709     C                   SETON                                        9809
241000080225     C                   CLEAR                   TIBS02ds
241100020617     C                   MOVEL     'R'           T02MOD
241200020617     C                   MOVEL     KNSIF         T02SIF
241300020617     C                   MOVEL     'NTW'         T02COD
241400020617     C                   CALL      'TIBS02R'
241500020617     C                   PARM                    KPJBA
241600080225     C                   PARM                    TIBS02ds
241700020617     C     T02ERR        IFEQ      *BLANKS
241800020617     C                   MOVEL     T02KE1        VNTW
241900020617     C                   ENDIF
242000090709     c
242100090709     C                   GOTO      END2
242200020617     C                   ENDDO
242300020617     C                   ENDIF
242400021029      *
242500021029      * controllo validità network
242600030526     C                   MOVEL     *blanks       vdntw
242700030527     C                   IF        vntw <> *blanks
242800080225     C                   CLEAR                   TIBS02ds
242900020617     C                   MOVEL     'C'           T02MOD
243000020617     C                   MOVEL     KNSIF         T02SIF
243100020617     C                   MOVEL     'NTW'         T02COD
243200020617     C                   MOVEL     *BLANKS       T02KE1
243300020617     C                   MOVEL     VNTW          T02KE1
243400020617     C                   CALL      'TIBS02R'
243500020617     C                   PARM                    KPJBA
243600080225     C                   PARM                    TIBS02ds
243700020617      *
243800020617     C     T02ERR        IFNE      *BLANKS
243900020617     C                   SETON                                        6698
244000030429     C                   GOTO      END2
244100020617     C                   ELSE
244200020617     C                   MOVEL     T02UNI        VDNTW
244300020617     C                   ENDIF
244400020617     C                   ENDIF
244500040518     c
244600040518     C                   END
244700020625      *
244800040924     C     end2          ENDSR
244900130422      *------------------------------------------------------
245000130422      * Pulizia VIDEO 2a
245100130422      *------------------------------------------------------
245200130422     C     PULVID21      BEGSR
245300130422
245400130422     c                   clear                   H2riga
245500130422     c                   clear                   H2colo
245600130422     c                   clear                   V02oramd
245700130422     c                   clear                   V02orama
245800130422     c                   clear                   V02orapd
245900130422     c                   clear                   V02orapa
246000130422     c                   clear                   V02ascm
246100130422     c                   clear                   V02comt
246200130422     c                   clear                   V02comm
246300131108     c                   clear                   V02orfmd
246400131108     c                   clear                   V02orfma
246500131108     c                   clear                   V02orfpd
246600131108     c                   clear                   V02orfpa
246700130422
246800130422     C                   ENDSR
246900130422      *-----------------------------------------------------
247000130422      * Riempimento VIDEO 2a
247100130422      *-----------------------------------------------------
247200130422     C     AGGVID21      BEGSR
247300130423
247400130423      * Non visualizzo alcuni dati per filiali di secondo livello
247500130423     c                   eval      *in28 = (vlpo <> '1')
247600130422
247700130422      * Se variazione imposto i campi
247800130422     c                   IF        not *in01
247900130422     c                   eval      OG130 = ORGdd0
248000130423     c                   IF        §OGoramd <> *blanks
248100130423     c                   eval      V02oramd = %int(§OGoramd)
248200130423     c                   ELSE
248300130423     c                   clear                   V02oramd
248400130423     c                   ENDIF
248500130423     c                   IF        §OGorama <> *blanks
248600130423     c                   eval      V02orama = %int(§OGorama)
248700130423     c                   ELSE
248800130423     c                   clear                   V02orama
248900130423     c                   ENDIF
249000130423     c                   IF        §OGorapd <> *blanks
249100130423     c                   eval      V02orapd = %int(§OGorapd)
249200130423     c                   ELSE
249300130423     c                   clear                   V02orapd
249400130423     c                   ENDIF
249500130423     c                   IF        §OGorapa <> *blanks
249600130423     c                   eval      V02orapa = %int(§OGorapa)
249700130423     c                   ELSE
249800130423     c                   clear                   V02orapa
249900130423     c                   ENDIF
250000130422     c                   eval      V02ascm = ORGdd2
250100130422     c                   eval      V02comt = ORGdd3
250200130422     c                   eval      V02comm = ORGdd4
250300131108     c                   eval      OG129 = ORGdc9
250400131108     c                   IF        §OGorfmd <> *blanks
250500131108     c                   eval      V02orfmd = %int(§OGorfmd)
250600131108     c                   ELSE
250700131108     c                   clear                   V02orfmd
250800131108     c                   ENDIF
250900131108     c                   IF        §OGorfma <> *blanks
251000131108     c                   eval      V02orfma = %int(§OGorfma)
251100131108     c                   ELSE
251200131108     c                   clear                   V02orfma
251300131108     c                   ENDIF
251400131108     c                   IF        §OGorfpd <> *blanks
251500131108     c                   eval      V02orfpd = %int(§OGorfpd)
251600131108     c                   ELSE
251700131108     c                   clear                   V02orfpd
251800131108     c                   ENDIF
251900131108     c                   IF        §OGorfpa <> *blanks
252000131108     c                   eval      V02orfpa = %int(§OGorfpa)
252100131108     c                   ELSE
252200131108     c                   clear                   V02orfpa
252300131108     c                   ENDIF
252400130422     c                   ENDIF
252500130422
252600130422     C                   ENDSR
252700130422      *-----------------------------------------------------
252800130422      * Controlli VIDEO 2a
252900130422      *-----------------------------------------------------
253000130422     C     CTRVID21      BEGSR
253100130423
253200131108     c                   clear                   H2riga
253300131108     c                   clear                   H2colo
253400130423      * controllo solo per primo e secondo livello
253500131113     c***                IF        vlpo = *blanks
253600131113     c***                leavesr
253700131113     c***                ENDIF
253800130422
253900130422      * Controllo che gli orari immessi siano validi
254000131113     c                   IF        (V02oramd<1 and vlpo<>*blanks)
254100131113     c                             or V02oramd>2359
254200130423     c                   eval      *in11 = *on
254300131113     c                   eval      H2riga = 10
254400130527     c                   eval      H2colo = 08
254500130423     c                   eval      V02msg = 'Orario errato'
254600130423     c                   leavesr
254700130423     c                   ENDIF
254800130423
254900131113     c                   IF        (V02orama < 1 and vlpo<>*blanks)
255000131113     c                             or V02orama > 2359
255100130423     c                   eval      *in11 = *on
255200131113     c                   eval      H2riga = 10
255300130527     c                   eval      H2colo = 19
255400130423     c                   eval      V02msg = 'Orario errato'
255500130423     c                   leavesr
255600130423     c                   ENDIF
255700131113      * l'ora dalle del mattino non può essere superiore dell'ora alle del mattino
255800131113     c                   if        v02oramd>v02orama
255900131113     c                   eval      *in11 = *on
256000131113     c                   eval      H2riga = 10
256100131113     c                   eval      H2colo = 19
256200131113     c                   if        v02orama=0
256300131113     c                   eval      V02msg = 'Orario errato'
256400131113     c                   else
256500131113     c                   eval      V02msg = 'Orario "dalle" non congruente con +
256600131113     c                             orario "alle"'
256700131113     c                   endif
256800131113     c                   leavesr
256900131113     c                   endif
257000130423
257100130524      * l'ora dalle del pomeriggio non può essere minore dell'ora alle del mattino
257200130524     c                   IF        V02orapd > 0 and V02orapd < V02orama
257300130524     c                   eval      *in11 = *on
257400131113     c                   eval      H2riga = 10
257500130524     c                   eval      H2colo = 35
257600131113     c                   eval      V02msg = 'Orario non congruente con quello +
257700131113     c                             del mattino'
257800130524     c                   leavesr
257900130524     c                   ENDIF
258000130524
258100130524     c                   IF        V02orapd > 0
258200130423     c                   IF        V02orapd < 1 or V02orapd > 2359
258300130423     c                   eval      *in11 = *on
258400131113     c                   eval      H2riga = 10
258500130423     c                   eval      H2colo = 35
258600130423     c                   eval      V02msg = 'Orario errato'
258700130423     c                   leavesr
258800130423     c                   ENDIF
258900130524     c                   ENDIF
259000130423
259100130527     c                   IF        V02orapd > 0 and V02orapa = 0
259200130527     c                   eval      *in11 = *on
259300131113     c                   eval      H2riga = 10
259400130527     c                   eval      H2colo = 46
259500130527     c                   eval      V02msg = 'Orario errato'
259600130527     c                   leavesr
259700130527     c                   ENDIF
259800130524     c                   IF        V02orapa > 0
259900130423     c                   IF        V02orapa < 1 or V02orapa > 2359
260000130423     c                   eval      *in11 = *on
260100131113     c                   eval      H2riga = 10
260200130423     c                   eval      H2colo = 46
260300130423     c                   eval      V02msg = 'Orario errato'
260400130423     c                   leavesr
260500130423     c                   ENDIF
260600130524     c                   ENDIF
260700131113      * l'ora dalle del pomeriggio non può essere superiore dell'ora alle del pom
260800131113     c                   if        v02orapd>v02orapa
260900131113     c                   eval      *in11 = *on
261000131113     c                   eval      H2riga = 10
261100131113     c                   eval      H2colo = 46
261200131113     c                   if        v02orapa=0
261300131113     c                   eval      V02msg = 'Orario errato'
261400131113     c                   else
261500131113     c                   eval      V02msg = 'Orario "dalle" non congruente con +
261600131113     c                             orario "alle"'
261700131113     c                   endif
261800131113     c                   leavesr
261900131113     c                   endif
262000130422
262100130422      * Controllo gli indirizzi e-mail
262200130422     c                   IF        V02ascm <> *blanks
262300130422     c                   clear                   dsemail
262400130422     c                   eval      §emlindi = %trim(V02ascm) + %trim('@brt.it')
262500130422     c                   call      'XEMAIL'
262600130422     c                   parm                    dsemail
262700130422if  3c                   IF        §emlerro <> '0'
262800130422     c                   eval      *in11 = *on
262900130422     c                   eval      H2riga = 11
263000130422     c                   eval      H2colo = 29
263100130422     c                   Eval      V02msg = §emlmsgo
263200130422     c                   leavesr
263300130422     c                   ENDIF
263400130422     c                   ENDIF
263500130422
263600130422     c                   IF        V02comm <> *blanks
263700130422     c                   clear                   dsemail
263800130422     c                   eval      §emlindi = %trim(V02comm) + %trim('@brt.it')
263900130422     c                   call      'XEMAIL'
264000130422     c                   parm                    dsemail
264100130422if  3c                   IF        §emlerro <> '0'
264200130422     c                   eval      *in11 = *on
264300130422     c                   eval      H2riga = 15
264400130422     c                   eval      H2colo = 29
264500130422     c                   Eval      V02msg = §emlmsgo
264600130422     c                   leavesr
264700130422     c                   ENDIF
264800130422     c                   ENDIF
264900131108      * ORARIO DI FILIALE
265000131108      * Controllo che gli orari immessi siano validi
265100131120     c                   IF        (V02orfmd<1 and vlpo<>*blanks
265200131120     c                             and vlpo=*blanks)
265300131113     c                             or V02orfmd > 2359
265400131108     c                   eval      *in11 = *on
265500131113     c                   eval      H2riga = 07
265600131108     c                   eval      H2colo = 08
265700131108     c                   eval      V02msg = 'Orario errato'
265800131108     c                   leavesr
265900131108     c                   ENDIF
266000131108
266100131120     c                   IF        (V02orfma < 1 and vlpo<>*blanks
266200131120     c                             and vlpo=*blanks)
266300131113     c                             or V02orfma > 2359
266400131108     c                   eval      *in11 = *on
266500131113     c                   eval      H2riga = 07
266600131108     c                   eval      H2colo = 19
266700131108     c                   eval      V02msg = 'Orario errato'
266800131108     c                   leavesr
266900131108     c                   ENDIF
267000131113      * l'ora dalle non può essere superiore dell'ora alle
267100131113     c                   if        v02orfmd>v02orfma
267200131113     c                   eval      *in11 = *on
267300131113     c                   eval      H2riga = 07
267400131113     c                   eval      H2colo = 19
267500131113     c                   if        v02orfma=0
267600131113     c                   eval      V02msg = 'Orario errato'
267700131113     c                   else
267800131113     c                   eval      V02msg = 'Orario "dalle" non congruente con +
267900131113     c                             orario "alle"'
268000131113     c                   endif
268100131113     c                   leavesr
268200131113     c                   endif
268300131108
268400131108      * l'ora dalle del pomeriggio non può essere minore dell'ora alle del mattino
268500131108     c                   IF        V02orfpd > 0 and V02orfpd < V02orfma
268600131108     c                   eval      *in11 = *on
268700131113     c                   eval      H2riga = 07
268800131108     c                   eval      H2colo = 35
268900131113     c                   eval      V02msg = 'Orario non congruente con quello +
269000131113     c                             del mattino'
269100131108     c                   leavesr
269200131108     c                   ENDIF
269300131108
269400131108     c                   IF        V02orfpd > 0
269500131108     c                   IF        V02orfpd < 1 or V02orfpd > 2359
269600131108     c                   eval      *in11 = *on
269700131113     c                   eval      H2riga = 07
269800131108     c                   eval      H2colo = 35
269900131108     c                   eval      V02msg = 'Orario errato'
270000131108     c                   leavesr
270100131108     c                   ENDIF
270200131108     c                   ENDIF
270300131108
270400131108     c                   IF        V02orfpd > 0 and V02orfpa = 0
270500131108     c                   eval      *in11 = *on
270600131113     c                   eval      H2riga = 07
270700131108     c                   eval      H2colo = 46
270800131108     c                   eval      V02msg = 'Orario errato'
270900131108     c                   leavesr
271000131108     c                   ENDIF
271100131108     c                   IF        V02orfpa > 0
271200131108     c                   IF        V02orfpa < 1 or V02orfpa > 2359
271300131108     c                   eval      *in11 = *on
271400131113     c                   eval      H2riga = 07
271500131108     c                   eval      H2colo = 46
271600131108     c                   eval      V02msg = 'Orario errato'
271700131108     c                   leavesr
271800131108     c                   ENDIF
271900131108     c                   ENDIF
272000131113      * l'ora dalle non può essere superiore dell'ora alle
272100131113     c                   if        v02orfpd>v02orfpa
272200131113     c                   eval      *in11 = *on
272300131113     c                   eval      H2riga = 07
272400131113     c                   eval      H2colo = 46
272500131113     c                   if        v02orfpa=0
272600131113     c                   eval      V02msg = 'Orario errato'
272700131113     c                   else
272800131113     c                   eval      V02msg = 'Orario "dalle" non congruente con +
272900131113     c                             orario "alle"'
273000131113     c                   endif
273100131113     c                   leavesr
273200131113     c                   endif
273300130422
273400130422     C                   ENDSR
273500021029      *----------------------------------------------------
273600030430      * Puliza  VIDEO 3
273700021029      *----------------------------------------------------
273800021029     C     PULVID3       BEGSR
273900040302     c                   exsr      offd03
274000040924      *
274100040924     C                   movel     *blanks       vdfle
274200040928     C                   z-add     046           vfle
274300030430     C                   move      *blanks       vara
274400040302     C                   move      *blanks       vdara
274500030430     C                   MOVE      *blanks       vapo
274600030430     C                   MOVEL     *blanks       vdapo
274700030430     C                   MOVE      *blanks       vaex
274800030430     C                   MOVEL     *blanks       vdaex
274900151028     C                   clear                   vARC
275000151028     C                   clear                   vdARC
275100040302     C                   MOVEL     *blanks       vdogas
275200060828     C                   movel     *blanks       Vfxi
275300060828     C                   movel     *blanks       Vfxo
275400060828     C                   movel     *blanks       Vssp
275500060828     C                   movel     *blanks       Vssc
275600100930     C                   movel     *blanks       Vfiue
275700100930     C                   movel     *blanks       Vdfiue
275800030429      * per i tipi V propongo 046
275900040928     C                   IF        VTip <> 'V' and vtip<>'T'
276000040928     C                   move      946           vogas
276100030429     C                   ELSE
276200030430     C                   z-add     046           vogas
276300030429     C                   ENDIF
276400030430     C                   movel     *blanks       vhub
276500030430     C                   movel     *blanks       vdpt
276600131016     C                   movel     *zeros        vlRESI
276700131016     C                   movel     *blanks       vlRESId
276800150430     C                   movel     *zeros        vflnpb
276900150430     C                   movel     *blanks       vdlnpb
277000090709     C                   z-add     046           vfcont
277100090709     C                   movel     *blanks       vdfcont
277200030429      *
277300030429      * Dati per tariffe
277400030430     C                   movel     *blanks       barfd1
277500030430     C                   movel     *blanks       barfd2
277600030430     C                   move      *zeros        vret
277700030430     C                   movel     *blanks       vdret
277800030430      *
277900020614     C                   ENDSR
278000021029      *------------------------
278100030430      * Riempimento VIDEO 3
278200021029      *------------------------
278300021029     C     AGGVID3       BEGSR
278400040924     c* descrizione p.o.
278500040924     C                   EVAL      VDFil = VDesF
278600040924      * p.o elaboratore
278700040924     C                   MOVEL     ORGFEL        VFLE
278800100930     c* filiale invio materiale EDP
278900100930     C                   MOVEL     §OGfiue       Vfiue
279000030429      *
279100030429      * Raggruppamento area/area ex as400/area POC
279200030521      *
279300030521     C                   if        §OGARA <> *zeros
279400030430     C                   MOVE      §OGARA        VARA
279500030521     C                   endif
279600030521      *
279700030521     C                   if        §OGAEX <> *zeros
279800030521     C                   MOVE      §OGAEX        VAEX
279900030521     C                   endif
280000030521      *
280100030521     C                   if        §OGAPO <> *zeros
280200030521     C                   MOVE      §OGAPO        VAPO
280300030521     C                   endif
280400151028      *
280500151028     C                   if        §ogARC <> *zeros
280600151028     C                   move      §ogARC        vARC
280700151028     C                   endif
280800030429      * Hub
280900060426     C***                if        §OGHUB <> *blanks and §oghub<>*zeros
281000060426     C***                MOVE      §OGHUB        VHUB
281100060426     C***                endif
281200060426     C                   if        §OGHb1 <> *blanks
281300060426     C                   MOVE      §OGHb1        VHUB
281400060426     C                   endif
281500030429      * Deposito
281600060426     C***                if        §OGDPT <> *blanks and §ogdpt<>*zeros
281700060426     C***                MOVE      §OGDPT        VDPT
281800060426     C***                endif
281900060426     C                   if        §OGDP1 <> *blanks
282000060426     C                   MOVE      §OGDP1        VDPT
282100060426     C                   endif
282200131016      * Linea x Forzare i RESI
282300131016     C                   if        §OGLNARES  <> *blanks
282400131016     C                   MOVE      §OGLNARES     VLRESI
282500131016     C                   endif
282600150430      * Filiale valida per linea di partenza bolla
282700150430     C                   if        §OGLNPB    <> *blanks
282800150430     C                   MOVE      §OGLNPB       VFlnpb
282900150430     C                   endif
283000070226      * p.o contabilità
283100090709     C                   MOVEL     ORGFC0        VFcont
283200030429      * Ambiente appartenenza
283300030430     C                   MOVEL     §OGAS         VOGAS
283400030429      * Regione
283500030429     C                   MOVE      §ogret        Vret
283600030429      * Stampa P.O nei terminals
283700030429     C                   MOVE      §OGBD1        BARFD1
283800030429     C                   MOVE      §OGBD2        BARFD2
283900060828      * Code Faxin/Faxout
284000060828     C                   MOVE      §OGFXI        VFXI
284100060828     C                   MOVE      §OGFXO        VFXO
284200060828      * Code stampa sede per P.O
284300060828     C                   MOVE      §ogssp        Vssp
284400060828      * Code stampa sede per Commerciale P.O
284500060828     C                   MOVE      §ogssc        Vssc
284600040924     c* Decodifiche
284700040924     C                   EXSR      DecVid3
284800020614     C                   ENDSR
284900020618     C**------------------------
285000021029     C** DECODIFICHE VIDEO 3
285100020618     C**------------------------
285200021029     C     DECVID3       BEGSR
285300040924      *
285400040924      * p.o elaboratore
285500040924     C                   IF        vfle > *ZERO
285600040924     C     vfle          chain(N)  azorg                              36
285700040924     C  n36              movel     orgdes        vdfle
285800040924     C                   END
285900131016      *
286000131016      * p.o LINEA Forzatura RESI
286100131016     C                   IF        vlRESI > *ZERO
286200131016     C     vlRESI        chain(N)  azorg                              36
286300131016     C  n36              movel     orgdes        vlRESId
286400131016     C                   END
286500150430      * filiale valida come linea di partenza bolla
286600150430     C                   IF        vflnpb > *ZERO
286700150430     C     vflnpb        chain(N)  azorg                              36
286800150430     C  n36              movel     orgdes        vdlnpb
286900150430     C                   END
287000030430      *
287100070226      * p.o contabilità
287200090709     C                   IF        vfcont > *ZERO
287300090709     C     vfcont        chain(N)  azorg                              36
287400090709     C  n36              movel     orgdes        vdfcont
287500070226     C                   END
287600100930      * fil invio materiale EDP
287700100930     C                   IF        vfiue> *ZERO
287800100930     C                   move      vfiue         wfil
287900100930     C     wfil          chain(N)  azorg                              36
288000100930     C  n36              movel     orgdes        vdfiue
288100100930     C                   END
288200030430      * Area ex As400
288300030430     C                   IF        vaex > *zeros
288400080225     C                   move      vaex          wfil
288500040924     C     wfil          chain(N)  AzOrg                              36
288600040924     C  N36              movel     orgdes        vdaex
288700030430     C                   ENDIF
288800030430      *
288900030430      * area POC
289000030430     C                   IF        vapo > *zeros
289100080225     C                   move      vapo          wfil
289200040924     C     wfil          chain(N)  AzOrg                              36
289300040924     C  N36              movel     orgdes        vdapo
289400030430     C                   ENDIF
289500020619      *
289600030430      * Regione ai fini tariffari
289700040302     C                   IF        vret > *zeros
289800040924     C                   move      vret          wfil
289900040924     C     wfil          chain(N)  AzOrg                              36
290000040924     C  n36              movel     OrgDes        vdret
290100040302     c                   endif
290200040302      *
290300040302      * ambiente appartenenza
290400040302     C                   IF        vogas> *zeros
290500080225     C                   move      vogas         wfil
290600040924     C     wfil          chain(N)  AzOrg                              36
290700040924     C  N36              movel     orgdes        vdogas
290800040302     C                   ENDIF
290900040302     c* Raggruppamento area
291000040302     c                   if        vara<>*blanks
291100080225     C                   MOVEL     '05'          TBLcod
291200080225     C                   MOVEL     *BLANKS       TBLkey
291300080225     C                   MOVEL     VARA          TBLkey
291400080225     C     k03tabel      CHAIN     TABEL                              36
291500040302     c  n36              movel     tbluni        vdara
291600040302     c                   endif
291700151028     c* Raggruppamento area centralino
291800151028     c                   if        vARC<>*blanks
291900151028     C                   MOVEL     '05'          TBLcod
292000151028     C                   MOVEL     *BLANKS       TBLkey
292100151028     C                   MOVEL     VARC          TBLkey
292200151028     C     k03tabel      CHAIN     TABEL                              36
292300151028     c  n36              movel     tbluni        vdArc
292400151028     c                   endif
292500040525     c
292600040517     c* Mi riposiziono sul mio azorg
292700040928     c                   if        not *in01
292800080225     c                   movel     vfil          §fil
292900080225     C     §fil          chain     AzOrg                              36
293000040928     c                   endif
293100030430      *
293200020618     C                   ENDSR
293300020614     C**------------------------
293400030430     C** Controlli VIDEO 3
293500020614     C**------------------------
293600021029     C     CTRVID3       BEGSR
293700040924     c
293800030430      * raggruppamento area ex as400
293900030430     C                   MOVEL     *blanks       VDAEX
294000030526     C                   IF        vaex <> *blanks and vaex <> *zeros
294100030430      * controllo che il campo contenga solo numeri
294200030430     C                   IF        %subst(vaex:1:1)<'0' or %subst(vaex:2:1)<'0'
294300030430     C                             or %subst(vaex:3:1)<'0'
294400040302     c                   eval      v3cmsg=msg(1)
294500040302     C                   SETON                                        929711
294600030430     C                   GOTO      END3
294700030430     C                   ELSE
294800080225     C                   move      vaex          wfil
294900040525     C     wfil          CHAIN(N)  AZORG                              36
295000030430     C                   If        *in36 = *off and
295100030430     C                             OrgFag='F' and OrgFva=' ' or *in36=*off
295200030527     C                             and OrgFag='A' and  OrgFva=' ' or
295300030527     C                             wfil = 046
295400030430     C                   MOVEL     ORGDES        VDAEX
295500030430     C                   else
295600040302     c                   eval      v3cmsg=msg(1)
295700040302     C                   SETON                                        929711
295800030430     C                   GOTO      END3
295900030430     C                   endif
296000030430     C                   ENDIF
296100030430     C                   ENDIF
296200040302     c* Area Ex AS400 obbligatoria per tipi F o A
296300040302     c                   if        vtip='F' or vtip='A'
296400040302     c                   if        vaex=*blanks or vaex=*zeros
296500040302     c                   eval      v3cmsg=msg(3)
296600040302     C                   SETON                                        929711
296700040302     C                   GOTO      END3
296800040302     C                   endif
296900040302     C                   endif
297000040302     c
297100030430      *
297200030430      * raggruppamento area POC
297300030430     C                   MOVEL     *blanks       VDAPO
297400040302     c* obbligatoria per tipi F o A
297500040302     c                   if        vtip='F' or vtip='A'
297600040302     c                   if        vapo=*blanks or vapo=*zeros
297700040302     c                   eval      v3cmsg=msg(4)
297800040302     C                   SETON                                        919711
297900040302     C                   GOTO      END3
298000040302     C                   endif
298100040302     C                   endif
298200040302     c
298300030430      * controllo che il campo contenga solo numeri
298400030526     C                   IF        vapo <> *zeros and vapo <> *blanks
298500030430     C                   IF        %subst(vapo:1:1)<'0' or %subst(vapo:2:1)<'0'
298600030430     C                             or %subst(vapo:3:1)<'0'
298700040302     c                   eval      v3cmsg=msg(2)
298800040302     C                   SETON                                        919711
298900030430     C                   GOTO      END3
299000030430     C                   ELSE
299100080225     C                   move      vapo          wfil
299200040525     C     wfil          CHAIN(N)  AZORG                              36
299300030430     C                   If        OrgFag='F' and OrgFva=' ' and *in36=*off
299400030430     C                             or OrgFag='A' and  OrgFva=' ' and *in36 =*off
299500030527     C                             or wfil = 046
299600030430     C                   MOVEL     ORGDES        VDAPO
299700030430     C                   else
299800040302     c                   eval      v3cmsg=msg(2)
299900040302     C                   SETON                                        919711
300000030430     C                   GOTO      END3
300100030430     C                   endif
300200030430     C                   ENDIF
300300030430     C                   ENDIF
300400030430      *
300500030429      * Raggruppamento area
300600040302     c                   clear                   vdara
300700030429     C     VARA          IFNE      *ZERO
300800030429     C     VARA          ANDNE     *BLANKS
300900030429     C     '?'           SCAN      VARA                                   31
301000030429     C   31              DO
301100080225     C                   MOVEL     C_CodUt       §KUT
301200080225     C                   MOVEL     '05'          §COD
301300030429     C                   MOVE      *BLANKS       §key
301400030429     C                   MOVE      *BLANKS       VARA
301500030429     C                   CALL      'X§TABER'
301600030429     C                   PARM                    §KUT
301700080225     C                   PARM                    §COD
301800080225     C                   PARM                    §KEY
301900080225     C                   PARM                    §DES
302000030429     C                   if        §key <> *blanks
302100030429     C                   MOVEL     §KEY          VARA
302200030429     C                   endif
302300090709     C                   SETON                                        459709
302400030429     C                   GOTO      END3
302500030429     C                   END
302600030429      * controllo
302700080225     C                   MOVEL     '05'          TBLcod
302800080225     C                   MOVEL     *BLANKS       TBLkey
302900080225     C                   MOVEL     VARA          TBLkey
303000080225     C     k03tabel      CHAIN     TABEL                              36
303100040302     c                   if        *in36 or  tblflg<>*blanks
303200040302     c                   eval      v3cmsg=msg(5)
303300040302     C                   SETON                                        459711
303400040302     C                   GOTO      END3
303500040302     c                   else
303600040302     c                   movel     tbluni        vdara
303700040302     c                   endif
303800040302     c
303900030429     C                   ELSE
304000040302      * campo obbligatorio per F/A
304100030429     C                   IF        Vtip = 'F' or Vtip = 'A'
304200040302     c                   eval      v3cmsg=msg(6)
304300040302     C                   SETON                                        459711
304400040517     C                   GOTO      END3
304500030429     C                   ENDIF
304600030429     C                   END
304700151028      *
304800151028      * Raggruppamento area CENTRALINO
304900151028     c                   clear                   vdArc
305000151028if  1C     VARC          IFNE      *ZERO
305100151028     C     VARC          ANDNE     *BLANKS
305200151028     C     '?'           SCAN      VARC                                   31
305300151028do  2C   31              DO
305400151028     C                   MOVEL     C_CodUt       §KUT
305500151028     C                   MOVEL     '05'          §COD
305600151028     C                   MOVE      *BLANKS       §key
305700151028     C                   MOVE      *BLANKS       VARC
305800151028     C                   CALL      'X§TABER'
305900151028     C                   PARM                    §KUT
306000151028     C                   PARM                    §COD
306100151028     C                   PARM                    §KEY
306200151028     C                   PARM                    §DES
306300151028if  3C                   if        §key <> *blanks
306400151028     C                   MOVEL     §KEY          VARC
306500151028e   3C                   endif
306600151028     C                   SETON                                        439709
306700151028     C                   GOTO      END3
306800151028e   2C                   ENDDO
306900151028      * controllo
307000151028     C                   MOVEL     '05'          TBLcod
307100151028     C                   MOVEL     *BLANKS       TBLkey
307200151028     C                   MOVEL     VARC          TBLkey
307300151028     C     k03tabel      CHAIN     TABEL                              36
307400151028if  2c                   if        *in36 or  tblflg<>*blanks
307500151028     c                   eval      v3cmsg=msg(5)
307600151028     C                   SETON                                        439711
307700151028     C                   GOTO      END3
307800151028x   2c                   else
307900151028     c                   movel     tbluni        vdArc
308000151028e   2c                   endif
308100151028     c
308200151028x   1C                   ELSE
308300151028      * campo obbligatorio per F/A
308400151028if  2C                   IF        Vtip = 'F' or Vtip = 'A'
308500151028     c                   eval      v3cmsg=msg(6)
308600151028     C                   SETON                                        439711
308700151028     C                   GOTO      END3
308800151028e   2C                   ENDIF
308900151028e   1C                   ENDIF
309000151028      *
309100040924      * P.O. elaboratore
309200151028     c                   clear                   vdfle
309300040924     C     VFLE          IFGT      *ZERO
309400040924     C     VFLE          CHAIN(N)  AZORG                              48
309500040924     C  N48              MOVEL     ORGDES        VDFLE
309600040924     c   48              eval      v3cmsg=msg(16)
309700040924     C   48              SETON                                          9711
309800070226     C   98              GOTO      END3
309900040924     C                   END
310000150430
310100150430      * Filiale valida come linea di partenza bolla
310200150430     C                   MOVEL     *blanks       Vdlnpb
310300150430    1C     Vflnpb        IFne      *ZERO
310400150430     C     Vflnpb        CHAIN(N)  AZORG                              27
310500150430    2c                   if        *in27
310600150430     c                   eval      v3cmsg=msg(21)
310700150430     C                   SETON                                          9711
310800150430     C                   GOTO      END3
310900150430   x2c                   else
311000150430     C                   MOVEL     ORGDES        Vdlnpb
311100150430     c* deve essere una fil dpd appartenente alla stessa area di partenza
311200150430     c                   movel     orgde3        w_og143
311300150430    3c                   if        w_§ogntw<>'DPD'
311400150430     c                   eval      v3cmsg=msg(22)
311500150430     C                   SETON                                        279711
311600150430     C                   GOTO      END3
311700150430   x3c                   else
311800150430     c* deve appartenere alla stessa area di partenza della filiale in manutenzione
311900150430     C                   CLEAR                   FNLV55ds
312000150430     C                   MOVEL     'P'           D55TPT
312100150430     C                   MOVEL     vflnpb        D55LIN
312200150430     C                   MOVEL     *date         D55DRF
312300150430     C                   CALL      'FNLV55R'
312400150430     C                   PARM                    FNLV55ds
312500150430     c                   eval      wtfp_lnpb=d55tfp
312600150430     C                   CLEAR                   FNLV55ds
312700150430     C                   MOVEL     'P'           D55TPT
312800150430     C                   MOVE      vfil          D55LIN
312900150430     C                   MOVEL     *date         D55DRF
313000150430     C                   CALL      'FNLV55R'
313100150430     C                   PARM                    FNLV55ds
313200150430    4c                   if        wtfp_lnpb<>d55tfp
313300150430     c                   eval      v3cmsg=msg(23)
313400150430     C                   SETON                                        279711
313500150430     C                   GOTO      END3
313600150430    4c                   endif
313700150430     c
313800150430    3c                   endif
313900150430     c
314000150430     c
314100150430    2C                   END
314200150430    1C                   END
314300131016      *
314400131016      * P.O. Forzare i Resi
314500131016     C                   MOVEL     *blanks       VlRESId
314600131016     C     VLresi        IFne      *ZERO
314700131016     C     VLresi        CHAIN(N)  AZORG                              35
314800131017     c                   if        *in35
314900131017     c                   eval      v3cmsg=msg(20)
315000131017     C                   SETON                                          9711
315100131017     C                   GOTO      END3
315200131017     c                   else
315300131017     C                   MOVEL     ORGDES        VlRESId
315400131016     C                   END
315500131016     C                   END
315600131016     c*
315700070226      * P.O. contabilità
315800090709     C                   MOVEL     *blanks       VDFcont
315900090709     C     VFcont        IFeq      *ZERO
316000070226     c                   seton                                        34
316100070226     c                   else
316200090709     C     VFcont        CHAIN(N)  AZORG                              34
316300090709     C  N34              MOVEL     ORGDES        VDFcont
316400070226     C                   END
316500090709     c* im immissione può essere uguale alla filiale da immettere
316600090709     c                   if        *in34 and *in01
316700090709     C                   movel     VFil          §Fil
316800090709     c                   if        vfcont=§fil
316900090709     c                   setoff                                       34
317000090709     c                   eval      vdfcont=vdfil
317100090709     c                   endif
317200090709     c                   endif
317300090709     c
317400070226     c                   if        *in34
317500070226     c                   eval      v3cmsg=msg(17)
317600070226     C                   SETON                                          9711
317700070226     C                   GOTO      END3
317800070226     C                   END
317900040302     c*
318000040302      * Ambiente di appartenenza obbligatorio se Filiale o Agenzia
318100040302     c                   clear                   vdogas
318200040302    1C                   IF        VOgas = *zeros  and VTip = 'F'  or
318300040302     C                             VOgAs = *zeros  and VTip = 'A'
318400040302     c                   eval      v3cmsg=msg(7)
318500040302     C                   SETON                                        469711
318600040302     C                   GOTO      END3
318700040302    1C                   ENDIF
318800040302      * può essere 946 oppure il terminal di partenza
318900040302    1c                   if        vogas>*zeros and vogas<>946  and vogas<>46
319000040302    2c                   if        vtip='V' or vtip='T'
319100040302     c                   eval      v3cmsg=msg(8)
319200040302     C                   SETON                                        469711
319300040302     C                   GOTO      END3
319400040302    2c                   endif
319500040302    1c                   endif
319600040302     c
319700040302    1c                   if        vogas>*zeros
319800040302     C                   MOVE      Vogas         wfil
319900040525     C     wfil          CHAIN(N)  AZORG                              46
320000040302    2c                   if        *in46 or orgfva<>*blanks
320100040302     c                   eval      v3cmsg=msg(8)
320200040302     C                   SETON                                        469711
320300040302     C                   GOTO      END3
320400040302    2c                   endif
320500040302     c
320600040302     c                   movel     orgdes        vdogas
320700040302     c
320800040302    2c                   if        vogas<>946 and vogas<>46
320900040518     c* questo controllo non lo faccio in immissione perchè il terminal
321000040518     c*  di partenza del p.o. non può essere ancora stato inserito
321100040518     c                   if        not *in01
321200080225     C                   CLEAR                   FNLV55ds
321300040302     C                   MOVEL     'P'           D55TPT
321400080225     C                   MOVEL     §fil          D55LIN
321500040927     C                   MOVEL     *date         D55DRF
321600040302     C                   CALL      'FNLV55R'
321700080225     C                   PARM                    FNLV55ds
321800040302     c*
321900040302    3c                   if        vogas<>d55tfp
322000040302     c                   eval      v3cmsg=msg(8)
322100040302     C                   SETON                                        469711
322200040302     C                   GOTO      END3
322300040302    3C                   ENDIF
322400040518    3C                   ENDIF
322500040302     C* DEVE ESSERE UGUALE A p.o. elaboratore
322600040518     c                   if        vogas<>vfle
322700040302     c                   eval      v3cmsg=msg(15)
322800040302     C                   SETON                                        469711
322900040302     C                   GOTO      END3
323000040302     c                   endif
323100040302     c
323200040302   x2c                   else
323300040302     c* P.O. elaboratore = 46
323400040518     c                   if        vfle<>46    and vtip<>'T' and vtip<>'V'
323500040302     c                   eval      v3cmsg=msg(14)
323600040302     C                   SETON                                        469711
323700040302     C                   GOTO      END3
323800040302    2C                   ENDIF
323900040302    2C                   ENDIF
324000040302    1C                   ENDIF
324100100930
324200100930      * Fil  invio materiale EDP
324300100930     C                   MOVEL     *blanks       VDfiue
324400100930    1C                   If        vfiue<>*blanks and vfiue<>*zeros
324500100930    2C                   IF        %subst(vfiue:1:1)<'0' or %subst(vfiue:2:1)<
324600100930     C                             '0' or %subst(vfiue:3:1)<'0'
324700100930     c                   eval      v3cmsg=msg(19)
324800100930     C                   SETON                                        209711
324900100930     C                   GOTO      END3
325000100930   x2C                   ELSE
325100100930     C                   move      vfiue         wfil
325200100930     C     wfil          CHAIN(N)  AZORG                              36
325300100930    3C                   If        OrgFag='F' and OrgFva=' ' and *in36=*off
325400100930     C                             or OrgFag='A' and  OrgFva=' ' and *in36 =*off
325500100930     C                   MOVEL     ORGDES        VDfiue
325600100930     C                   else
325700100930     c                   eval      v3cmsg=msg(19)
325800100930     C                   SETON                                        209711
325900100930     C                   GOTO      END3
326000100930     C                   endif
326100100930     C                   ENDIF
326200100930     C                   ENDIF
326300040302     c
326400040302     c*
326500030429      * Dpd codice Hub, obbligatorio per dpd
326600030429     C     VHUB          IFEQ      *BLANKS
326700030429     C     VNTW          ANDEQ     'DPD'
326800030429     C                   SETON                                        6797
326900030429     C                   GOTO      END3
327000030429     C                   ENDIF
327100030429      *
327200030429      * codice deposito
327300030429     C     VDPT          IFEQ      *BLANKS
327400030429     C     VTIP          ANDEQ     'F'
327500030429     C     VDPT          OREQ      *BLANKS
327600030429     C     VTIP          ANDEQ     'A'
327700030429     C                   SETON                                        6897
327800030429     C                   GOTO      END3
327900030429     C                   ENDIF
328000030429      *
328100030429      * DATI PER TARIFFE
328200021029      *
328300021029      * Regione ai fini tariffari
328400020619     C                   MOVEL     *BLANKS       VDRET
328500040302    1C     VRET          IFNE      *ZERO
328600020712     C     VRET          ANDNE     *BLANKS
328700020619     C     '?'           SCAN      VRET                                   31
328800040302    2C                   IF        *in31=*on
328900040302     C                   MOVE      *blanks       §des
329000040302     c                   movel     '.'           §§des
329100020619     C                   CALL      'TNSD24R'
329200080225     C                   PARM                    §§COD             3
329300080225     C                   PARM      'T'           §§TIP
329400020619     C                   PARM                    §§DES            25
329500020619     C                   PARM                    §§PRA             3
329600080225     C                   MOVEL     §§COD         VRET
329700040302      *
329800090709     C                   SETON                                        977609
329900021029     C                   GOTO      END3
330000040302    2C                   endif
330100040928     c
330200040928     C                   MOVE      VRET          wfil
330300040928     C     wfil          CHAIN(N)  AZORG                              36
330400021107      *
330500040928    2C                   IF        *in36 = *off and OrgFva = ' '
330600021107     C                             and orgfl2='S'   or
330700040928     C                             *in36 = *off and OrgFva = ' '
330800021107     C                             and orgfl2= 'S'
330900020619     C                   MOVEL     ORGDES        VDRET
331000020619     C                   ELSE
331100040302     c                   eval      v3cmsg=msg(12)
331200040302     C                   SETON                                        769711
331300021029     C                   GOTO      END3
331400040302    2C                   ENDIF
331500020619     C                   ELSE
331600021107      * campo obbligatorio COR/MES
331700030404     C                   IF        VNtw = 'COR' or
331800030404     C                             VNtw = 'MES'
331900040302     c                   eval      v3cmsg=msg(13)
332000040302     C                   SETON                                        769711
332100021029     C                   GOTO      END3
332200020619     C                   ENDIF
332300020619     C                   ENDIF
332400060828      * Coda faxin/faxout obbligatorie per 1°livello
332500060828     C                   IF        VFxi=*blanks and Vtip='F' and vlpo='1' or
332600060828     C                             VFxi=*blanks and Vtip='A' and vlpo='1'
332700060828     C                   seton                                        4297
332800060828     C                   GOTO      END3
332900060828     C                   ENDIF
333000060828     C                   IF        VFxo=*blanks and Vtip='F' and vlpo='1' or
333100060828     C                             VFxo=*blanks and Vtip='A' and vlpo='1'
333200060828     C                   seton                                        8997
333300060828     C                   GOTO      END3
333400060828     C                   ENDIF
333500060828     c* coda stampa sede per p.o. obbligatoria per F o A
333600060828     c                   if        vssp=*blanks
333700060828     c                   if        vtip='F' or vtip='A'
333800060828     C                   seton                                        8397
333900060828     C                   GOTO      END3
334000060828     C                   ENDIF
334100060828     C                   ENDIF
334200060828     c* coda stampa sede per Commerciale p.o. obbligatoria per F o A
334300060828     c                   if        vssc=*blanks
334400060828     c                   if        vtip='F' or vtip='A'
334500060828     C                   seton                                        9097
334600060828     C                   GOTO      END3
334700060828     C                   ENDIF
334800060828     C                   ENDIF
334900060828     c
335000040525     c     end3          tag
335100040525     c* Mi riposiziono sul mio azorg
335200040928     c                   if        not *in01
335300080225     c                   movel     vfil          §fil
335400080225     C     §fil          chain     AzOrg                              36
335500040928     c                   endif
335600030429      *
335700040525     C                   ENDSR
335800030429      *------------------------------------------------------
335900030430      * Pulizia VIDEO 4
336000030429      *------------------------------------------------------
336100030429     C     PULVID4       BEGSR
336200030430      *
336300040517     C                   movel     *blanks       Vlfv
336400030430     C                   movel     *blanks       Vlbl
336500170608     C****               movel     *blanks       Vasp
336600040518     C                   movel     *blanks       VaspCV
336700030430     C                   movel     *blanks       Vase
336800030430     C                   movel     *blanks       Vdkc
336900170227     C                   movel     *blanks       Vdirdkc
337000031016     C                   movel     *blanks       Vpck
337100050509     C                   movel     *blanks       Vpkm
337200160506     C                   movel     *blanks       Vturno
337300041213     C                   movel     *blanks       Vtis
337400160531     C                   movel     *blanks       Vagspus
337500030430     C                   movel     *blanks       Vnoc
337600030430     C                   movel     *blanks       Vnid
337700030430     C                   movel     *blanks       Veid
337800040518     C                   movel     *blanks       Vorm
337900070228     C*                  movel     *blanks       Vfrr
338000040517     C                   z-add     0             Vdsd
338100040517     C                   z-add     0             Vdse
338200040927     c                   z-add     0             Vvol
338300030430     C                   z-add     0             Vpes
338400120924     C****               movel     *blanks       Vspv
338500120924     C****               movel     *blanks       Vspp
338600040301     C                   movel     *blanks       Vass
338700030430     C                   movel     *blanks       Vlpr
338800040517     C                   movel     *blanks       Vsea
338900101215     C                   movel     *blanks       Vimaa
339000170321     C                   clear                   vEsBlDi
339100040518     c* in immissione, propongo S aolo per azorg e non tipi V o T
339200040924     c                   if        *in01  and not *in88  and
339300040924     c                             vtip<>'V' and vtip<>'T'
339400040518     C                   movel     'S'           VaspCV
339500040518     C                   movel     'S'           Vorm
339600040518     c                   endif
339700030430      *
339800030429     C                   ENDSR
339900030429      *-----------------------------------------------------
340000030430      * Riempimento  video 4
340100030429      *-----------------------------------------------------
340200030429     C     AGGVID4       BEGSR
340300030429      *
340400030429      * L.arrivo stampa segnacollo
340500030429     C                   MOVEL     ORGDE5        Vass
340600030429      * Frame relay
340700070228     C*                  MOVE      §ogfrr        Vfrr
340800040301     c* date scannerizazione
340900040301     c                   if        §ogdsd<>*blanks
341000040301     C                   CLEAR                   WLBDAT
341100040301     C                   MOVEL     '3'           G02ERR
341200040301     C                   move      §ogdsd        G02INV
341300040301     C                   CALL      'XSRDA8'
341400040301     C                   PARM                    WLBDAT
341500040301     C                   Z-ADD     G02DAT        Vdsd
341600040301     c                   endif
341700040301     c*
341800040301     c                   if        §ogdse<>*blanks
341900040301     C                   CLEAR                   WLBDAT
342000040301     C                   MOVEL     '3'           G02ERR
342100040301     C                   move      §ogdse        G02INV
342200040301     C                   CALL      'XSRDA8'
342300040301     C                   PARM                    WLBDAT
342400040301     C                   Z-ADD     G02DAT        Vdse
342500040301     c                   endif
342600030429      * Bolle sede per posta
342700030429     C                   MOVE      §ognoc        Vnoc
342800030429      * Linea  bollettazione
342900030429     C                   MOVE      §oglbl        Vlbl
343000030429      * Linea  gestita da fogli viaggio
343100030429     C                   MOVE      §oglfv        Vlfv
343200030429      * P.O non esegue IDD
343300030429     C                   MOVE      §ognid        Vnid
343400040924      * P.O esegue IDD giorno dopo
343500030429     C                   MOVE      §ogeid        Veid
343600030429      * ORM
343700030429     C                   MOVE      §ogorm        Vorm
343800030429      * Linea da proporre in tassazione P.A
343900030429     C                   MOVE      §oglpr        Vlpr
344000040517     c
344100040518      * Autogenerazione spunte solo per F o A
344200030429     C                   SELECT
344300170608     C**   §ogags        WHENEQ    ' '
344400170608     c**                 if        vtip='A' or vtip='F'
344500170608     C**                 move      'S'           VAsp
344600170608     c**                 endif
344700030429      *
344800170608     C***  §ogagp        WHENne    'P'
344900170608     C     §ogags        WHENEQ    'E'
345000030429     C                   move      'S'           VAspCV
345100030429      *
345200170608     C***  §ogagp        WHENEQ    'P'
345300170608     C     §ogags        WHENEQ    'S'
345400030429     C                   move      'S'           VAse
345500030429     C                   ENDSL
345600170620
345700170620     c* In variazione se entrambi vuoti, idem
345800170620     c                   if        *in02  and not *in88  and
345900170620     c                             vtip<>'V' and vtip<>'T'
346000170620     c                             and vaspcv=' ' and vase=' '
346100170620     C                   movel     'S'           VaspCV
346200170620     c                   endif
346300030429      *
346400030429      * Data utilizzo macchinone per peso/volume
346500030429     C                   MOVE      §ogvol        Vvol
346600030429     C                   MOVE      §ogpes        Vpes
346700120924     C****               MOVE      §ogspv        Vspv
346800120924     C****               MOVE      §ogspp        Vspp
346900030429     C                   MOVE      §ogdkc        Vdkc
347000170227     C                   MOVE      §ogdkcdir     Vdirdkc
347100031016     C                   MOVE      §ogpck        Vpck
347200050509     C                   MOVE      §ogpkm        Vpkm
347300160506     C                   MOVE      §ogturno      Vturno
347400041213     C                   MOVE      §ogtis        Vtis
347500160531     C                   MOVE      §OGagspus     Vagspus
347600040517     C                   MOVE      §ogsea        Vsea
347700101215     C                   MOVE      §ogimaa       Vimaa
347800170321      *
347900170321      * - Flag "Esente Blocco Dirottamento"
348000170321     C                   movel     §ogEsBlDi     vEsBlDi
348100170321      *
348200030429     C                   ENDSR
348300030429      *-----------------------------------------------------
348400030430      * Controlli VIDEO 4
348500030429      *-----------------------------------------------------
348600030429     C     CTRVID4       BEGSR
348700030429      *
348800030429      * Autogenerazione spunte
348900030429     C                   z-add     0             $Spunte           1 0
349000170608     C**                 IF        VASP = 'S'
349100170608     C**                 add       1             $Spunte
349200170608     C**                 ENDIF
349300030429     C                   IF        VASPCV = 'S'
349400030429     C                   add       1             $Spunte
349500030429     C                   ENDIF
349600030429     C                   IF        VASE = 'S'
349700030429     C                   add       1             $Spunte
349800030429     C                   ENDIF
349900040518     C                   IF        $SPUNTE>1
350000030429     C                   seton                                        6994
350100030429     C                   GOTO      END4
350200030429     C                   ENDIF
350300040518     C                   IF        $SPUNTE=0  and vtip<>'V' and vtip<>'T'
350400040518     C                   seton                                        6994
350500040518     C                   GOTO      END4
350600040518     C                   ENDIF
350700041214     c* stampa ddt si in arrivo
350800120612     c**                 if        vpck = 'S' and vsda = 'S'
350900120612     c**                 seton                                        4394
351000120612     c**                 goto      end4
351100120612     c**                 endif
351200170227     c* Dirottamento/resi ckome disk "C" solo se filiale abilitata la disk "C"
351300170227     c                   if        vdirdkc= 'S' and vdkc<>'S'
351400170227     c                   seton                                        4594
351500170227     c                   goto      end4
351600170227     c                   endif
351700040301      * Controllo campi data scannerizzazione
351800040301     c                   clear                   wdsd
351900040301     C     Vdsd          IFNE      *ZEROS
352000040301     C                   clear                   WLBDAT
352100040301     C                   z-add     Vdsd          G02Dat
352200040301     C                   CALL      'XSRDA8'
352300040301     C                   PARM                    WLBDAT
352400040301     C     G02Err        ifne      '0'
352500040301     C                   seton                                        3894
352600040301     C                   GOTO      END4
352700040301     c                   else
352800040301     c                   z-add     g02inv        wdsd
352900040517     c                   z-add     g02dat        vdsd
353000040301     C                   ENDIF
353100040301     C                   ENDIF
353200040301     c***
353300040301     c                   clear                   wdse
353400040301     C     Vdse          IFNE      *ZEROS
353500040301     C                   clear                   WLBDAT
353600040301     C                   z-add     Vdse          G02Dat
353700040301     C                   CALL      'XSRDA8'
353800040301     C                   PARM                    WLBDAT
353900040301     C     G02Err        ifne      '0'
354000040525     C                   seton                                        3794
354100040301     C                   GOTO      END4
354200040301     c                   else
354300040301     c                   z-add     g02inv        wdse
354400040517     c                   z-add     g02dat        vdse
354500040301     C                   ENDIF
354600040301     C                   ENDIF
354700030429      *
354800040301      * Controllo data utilizzo macchinone peso e volume
354900030429     C     VVOL          IFNE      *ZEROS
355000040301     C                   clear                   WLBDAT
355100040301     C                   z-add     VVol          G02Dat
355200040301     C                   CALL      'XSRDA8'
355300030429     C                   PARM                    WLBDAT
355400030429     C     G02Err        ifne      '0'
355500030429     C                   seton                                        8694
355600030429     C                   GOTO      END4
355700030429     C                   ENDIF
355800030429     C                   ENDIF
355900030429      *
356000030429     C     VPES          IFNE      *ZEROS
356100040301     C                   clear                   WLBDAT
356200040301     C                   z-add     VPes          G02Dat
356300040301     C                   CALL      'XSRDA8'
356400030429     C                   PARM                    WLBDAT
356500030429     C     G02Err        ifne      '0'
356600030429     C                   seton                                        8794
356700030429     C                   GOTO      END4
356800030429     C                   ENDIF
356900030429     C                   ENDIF
357000030429      *
357100030429      * Ricerca e controllo linea parallela da proporre in tass.ne
357200040928     C                   IF        Vlpr <> *blanks and Vlpr<>*zeros
357300030429     C     '?'           SCAN      Vlpr                                   31
357400030429     C                   IF        *in31=*on
357500080225     C                   MOVE      'E'           §§TIP
357600030429     C                   CALL      'TNSD24R'
357700080225     C                   PARM                    §§COD             3
357800080225     C                   PARM                    §§TIP
357900030429     C                   PARM                    §§DES            25
358000030429     C                   PARM                    §§PRA             3
358100080225     C                   MOVEL     §§COD         Vlpr
358200030429      * per riemettere il video almeno una volta dopo le ricerche
358300090709     C                   SETON                                        9409
358400030429     C                   GOTO      END4
358500030429     C                   ENDIF
358600040928      *
358700040928     C                   TESTN                   Vlpr                 36
358800040928     c                   move      vlpr          w001a             1
358900040928     c*
359000040928     c                   if        not *in36 or w001a<*zeros
359100040928     c                   seton                                        3994
359200040928     c                   else
359300040928     c
359400040928     C                   move      VLpr          wfil
359500040928     C     wfil          CHAIN(N)  AZORG                              36
359600030429     C   36              seton                                        3994
359700030429     C                   endif
359800030429     C                   ENDIF
359900030429      *
360000030430      *
360100040525     c     end4          tag
360200040525      *
360300040525      * Riaggancio azorg con corretto P.O
360400040928     c                   if        not *in01
360500080225     C                   movel     VFil          §Fil
360600080225     C     §FIL          CHAIN     AZORG                              36
360700040928     c                   endif
360800030429      *
360900040525     C                   ENDSR
361000070828      *------------------------------------------------------
361100070828      * Pulizia VIDEO 5
361200070828      *------------------------------------------------------
361300070828     C     PULVID5       BEGSR
361400070828      *
361500070828     c                   clear                   vtlls
361600080206     c                   movel     *blanks       vpdaorm
361700080206     c                   movel     *blanks       vpdacon
361800070828     c                   movel     *blank        Vgeot
361900070828     C                   z-add     0             Vdda
362000070828     c                   movel     *blank        Vdoada
362100070828     c                   movel     *blank        Vfppda
362200070926     c                   movel     *blank        Vfrtuo
362300070828     c                   clear                   vcgio
362400070828     c                   z-add     0             vddao
362500070828      *
362600070828     C                   ENDSR
362700070828      *-----------------------------------------------------
362800070828      * Riempimento  video 5
362900070828      *-----------------------------------------------------
363000070828     C     AGGVID5       BEGSR
363100070828      * TELLUS
363200070828     C                   MOVE      §ogTLLS       Vtlls
363300070828      * flag avviamento gestione telefonate per GEO
363400070828     c                   movel     §oggeot       vgeot
363500070828     c* data inizio distinte consegna automatiche
363600070828     c                   if        §ogdda<>*blanks
363700070828     C                   CLEAR                   WLBDAT
363800070828     C                   MOVEL     '3'           G02ERR
363900070828     C                   move      §ogdda        G02INV
364000070828     C                   CALL      'XSRDA8'
364100070828     C                   PARM                    WLBDAT
364200070828     C                   Z-ADD     G02DAT        Vdda
364300070828     c                   endif
364400080206      * PDA ORM
364500080206     c                   move      §ogpdaorm     vpdaorm
364600080206      * PDA consegne
364700080206     c                   move      §ogpdacon     vpdacon
364800070828      * Abilitazione richiesta data e ora limite abbinamento
364900070828     c                   move      §ogdoada      vdoada
365000070828      * Abilitazione richiesta tipo ditinta mattino/pomeriggio
365100070828     c                   move      §ogfppda      vfppda
365200070828      * Procedura GIRI su ORM
365300070828     c                   move      §ogcgio       vcgio
365400070828      * Data inizio distinte ORM automatiche
365500070828     c                   if        §ogddao <> *blanks
365600070828     c                   clear                   wlbdat
365700070828     c                   eval      g02err = '3'
365800070828     c                   move      §ogddao       g02inv
365900070828     c                   call      'XSRDA8'
366000070828     c                   parm                    wlbdat
366100070828     c                   z-add     g02dat        vddao
366200070828     c                   endif
366300070926      * Abilitazione richiesta tipo ditinta mattino/pomeriggio  ORM
366400070926     c                   move      §ogfrtuo      vfrtuo
366500070828     C                   ENDSR
366600070828      *-----------------------------------------------------
366700070828      * Controlli VIDEO 5
366800070828      *-----------------------------------------------------
366900070828     C     CTRVID5       BEGSR
367000070828      *
367100070828     c* controllo data inizio distinte automatiche
367200070828     c                   clear                   wdda
367300070828     C     Vdda          IFNE      *ZEROS
367400070828     C                   clear                   WLBDAT
367500070828     C                   z-add     Vdda          G02Dat
367600070828     C                   CALL      'XSRDA8'
367700070828     C                   PARM                    WLBDAT
367800070828     C     G02Err        ifne      '0'
367900070828     C                   seton                                        3330
368000070828     C                   GOTO      END5
368100070828     c                   else
368200070828     c                   z-add     g02inv        wdda
368300070828     c                   z-add     g02dat        vdda
368400070828     C                   ENDIF
368500070828     C                   ENDIF
368600070828
368700070828      * Controllo data inizio distinte ORM automatiche
368800070828     c                   clear                   wddao
368900070828     c                   if        vddao <> *zeros
369000070828     c                   clear                   wlbdat
369100070828     c                   z-add     vddao         g02dat
369200070828     c                   call      'XSRDA8'
369300070828     c                   parm                    wlbdat
369400070828     c                   if        g02err <> '0'
369500070828     c                   seton                                        3230
369600070828     c                   goto      end5
369700070828     c                   endif
369800070828     c                   z-add     g02inv        wddao
369900070828     c                   z-add     g02dat        vddao
370000070828     c                   endif
370100091109      *
370200091109
370300070828     c     end5          tag
370400070828      *
370500070828      * Riaggancio azorg con corretto P.O
370600070828     c                   if        not *in01
370700080225     C                   movel     VFil          §Fil
370800080225     C     §FIL          CHAIN     AZORG                              36
370900070828     c                   endif
371000070828      *
371100070828     C                   ENDSR
371200030430      *-------------------------------------------
371300030430      * Annullamento/Ripristino AzOrg00f/AzOse00f
371400030430      *-------------------------------------------
371500920317     C     AGGFIL        BEGSR
371600080225     C                   movel     vfil          §FIL
371700030430      *
371800080225     C  N88§FIL          CHAIN     AZORG                              36
371900080225     C   88§FIL          CHAIN     AZOSE                              36
372000900330     C   KE              MOVEL     *BLANKS       ORGFVA
372100900330     C   KQ              MOVEL     '*'           ORGFVA
372200900409     C                   MOVEL     *BLANKS       ORGFTR
372300900409     C                   Z-ADD     0             ORGNTR
372400920317     C  N88              UPDATE    AZORG
372500920317     C   88              UPDATE    AZOSE
372600900329     C                   ENDSR
372700030430      *-------------------------------------------------
372800030430      * Aggiornamento/ripristino AzOse10f
372900030430      *-------------------------------------------------
373000920317     C     AGGSED        BEGSR
373100080225     C                   MOVEL     'OR'          TBLcod
373200080225     C                   MOVEL     *BLANKS       TBLkey
373300920317     C                   MOVEL     ORGDES        OR1DES
373400920317     C                   MOVEL     ORGFIL        OR1FIL
373500030430      * CANCELLA I RECORDS ESISTENTI
373600920317     C     OR1FIL        SETLL     AZOSE10
373700920317     C                   DO        *HIVAL
373800920317     C     OR1FIL        READE     AZOSE10                                96
373900920317     C  N96              DELETE    AZOSE10
374000920317     C  N96              END
374100030430      *
374200030430      *          SCRIVO PER OGNI VOCE PIENA
374300030430      *
374400080225     C                   DO        150           xx
374500080225     C     VCF(xx)       IFGT      *ZERO
374600080225     C                   Z-ADD     xx            OR1CVO
374700080225     C                   MOVEL     OR1CVO        TBLkey
374800080225     C     k03tabel      CHAIN     TABEL                              95
374900920317     C  N95              MOVEL     TBLUNI        OR1DCO
375000080225     C                   MOVEL     VCF(xx)       OR1CFI
375100080225     C                   MOVEL     VDE(xx)       OR1DVO
375200080225     C     VCF(xx)       CHAIN(N)  AZORG                              95
375300920317     C  N95              MOVEL     ORGDES        OR1DFI
375400920317     C                   WRITE     AZOSE10
375500920317     C                   END
375600920317     C                   END
375700920317     C                   ENDSR
375800040302      *-------------------------------------------------
375900040302      * Spengo indicatori di posizionamento cursore
376000040302      *-------------------------------------------------
376100040924     c     offd03        begsr
376200040302     c                   setoff                                       929145
376300040302     c                   setoff                                       467447
376400040302     c                   setoff                                       769711
376500150430     c                   setoff                                       27
376600040302     c                   endsr
376700040302**
376800040302Area  EX AS400  errata                                                        01
376900040302Area  POC  errata                                                             02
377000040302Area  EX AS400 obbligatoria per Filiali o Agenzie                             03
377100040302Area  POC  obbligatoria per Filiali o Agenzie                                 04
377200040302Raggruppamento Area  errato                                                   05
377300040302Raggruppamento Area  obbligatorio per Filiali o Agenzie                       06
377400040302Ambiente di Appartenenza  obbligatorio per Filiali o Agenzie                  07
377500080225Ambiente di Appartenenza  errato: 946 o 46 o terminal di partenza della fil.  08
377600080225Filiale gestione tariffe obbligatorio per Filiali o agenzie                   09
377700080225Filiale gestione tariffe errato                                               10
377800080225TIPO filale gestione tariffe obbligatorio per Filiali o Agenzie               11
377900040302Regione ai fini tariffari errata                                              12
378000040518Regione ai fini tariffari obbligatoria per il network indicato                13
378100080225Per ambiente di appartenenza 946 o 46, FIL. ELABORATORE deve essere 46        14
378200080225Ambiente di appartenenza deve essere uguale a Fil. Elaboratore se non è SEDE  15
378300080225Filiale elaboratore inesistente                                               16
378400080226Filiale contabilità errata                                                    17
378500080225Utente NON abilitato - Premere "Invio" per tornare a menù                     18
378600100930filiale invio materiale EDP errata                                            19
378700131016filiale sui cui Forzare Invio dei RESI errata                                 20
378800150504Filiale errata                                                                21
378900150504Immettere una Filiale DPD                                                     22
379000150430Filiale appartenente ad altra area di partenza                                23
