000100080225      * TNSD15R *-----------------------------------------------------*
000200080225      *?MANUTENZIONE ORGANIGRAMMA                                    ?*
000300080225      *---------------------------------------------------------------*
000400080225      *
000500080225     h decedit('0,') datedit(*ymd/) option(*nodebugio)
000600080225      *
000700080225      *?  A R C H I V I  ?--------------------------------------------*
000800080225      *
000900080225     fTABEL00F  if   e           k disk
001000080225     fAZORG01L  Uf A e           k disk
001100080225     fAZOSE01L  Uf A e           k disk    rename(AZORG:AZOSE)
001200080225     fAZOSE10F  Uf A e           k disk
001300080225      *
001400080225     fTNSD15D   cf   e             workstn
001500080225     f                                     sfile(SD15DSF:NRR)
001600080225      *
001700080225      *?  C O S T A N T I  ?------------------------------------------*
001800080225      *
001900080225      * - Codice Utente
002000080225     d C_CodUt         c                   const(1)
002100080225      *
002200080225      * - Indicazioni a video
002300080225     d C_Ln_x_Tar      c                   const('LINEA PER TARIFFE')
002400080225     d C_NotOpe        c                   const('NON OPERAT.')
002500080225     d C_1_Liv         c                   const('1° LIVELLO ')
002600080225     d C_2_liv         c                   const('2° LIVELLO ')
002700130423
002800130423     d Digits          c                   const('0123456789')
002900080225      *
003000080225      *?  S C H I E R E  ?--------------------------------------------*
003100080225      *
003200080225      * - Messaggi di errore
003300150430     d Msg             s             78    dim(23)  ctdata  perrcd(1)
003400080225      *
003500080225      *?  S T R U T T U R E   D A T I  ?------------------------------*
003600080225      *
003700080225      * Parametri ricevuti
003800080225     d KPJBA         e ds
003900080225      *
004000080225      * - Parametri x Controllo profilo utenti
004100080225     d TIBS34ds      e ds                  inz
004200080225      * - Ds di riferimento al file esterno AZUTE00F
004300080225     d AZUTEds       e ds                  extname(AZUTE00F)
004400080225      * - Ds per dati organigramma
004500080225     d dDatiUte      e ds
004600080225      * - Abilitazioni utenti aziendali
004700080225     d dUte01        e ds
004800080225      *
004900080225     d dsOG          e ds                  inz
005000080225     d dsOR          e ds                  inz
005100080225     d FNLV55ds      e ds                  inz
005200120712
005300120712     d TRTB09DS      e ds
005400130828     d
005500130828     d tisio0ds      e ds
005600080225      *
005700131108     d Og129         e ds                  inz
005800130422     d Og130         e ds                  inz
005900080225     d Og140         e ds                  inz
006000080225     d Og141         e ds                  inz
006100080225     d Og142         e ds                  inz
006200080225     d Og143         e ds                  inz
006300150430     d w_Og143       e ds                  inz  EXTNAME(OG143) prefix(w_)
006400080225     d Og144         e ds                  inz
006500080225     d Og146         e ds                  inz
006600080225     d Og147         e ds                  inz
006700080225     d Og148         e ds                  inz
006800080225     d Og149         e ds                  inz
006900080225     d Og150         e ds                  inz
007000080225      *
007100080225      * - DS PER TRTB69R - TRTB70R - TRTB72R - TRTB73R - INT/GEST PARTIC.
007200080225     d TIBS02ds      e ds                  inz
007300130422
007400130422      * - Controllo indirizzo mail
007500130422     d dsemail       e ds
007600080225      *
007700080225      * - Controllo/Inversione date
007800080225     d WLBdat          ds                  inz
007900080225     d  G02dat                 1      8  0 inz
008000080225     d  G02inv                 9     16  0 inz
008100080225     d  G02err                17     17    inz('3')
008200080225     d  G02tgi                18     22  0 inz
008300080225      *
008400080225     d DE_ds           ds                  inz
008500080225     d  ORGd01                                                                     1     25
008600080225     d  ORGd02                                                                    26     50
008700080225     d  ORGd03                                                                    51     75
008800080225     d  ORGd04                                                                    76    100
008900080225     d  ORGd05                                                                   101    125
009000080225     d  ORGd06                                                                   126    150
009100080225     d  ORGd07                                                                   151    175
009200080225     d  ORGd08                                                                   176    200
009300080225     d  ORGd09                                                                   201    225
009400080225     d  ORGd10                                                                   226    250
009500080225     d  ORGd11                                                                   251    275
009600080225     d  ORGd12                                                                   276    300
009700080225     d  ORGd13                                                                   301    325
009800080225     d  ORGd14                                                                   326    350
009900080225     d  ORGd15                                                                   351    375
010000080225     d  ORGd16                                                                   376    400
010100080225     d  ORGd17                                                                   401    425
010200080225     d  ORGd18                                                                   426    450
010300080225     d  ORGd19                                                                   451    475
010400080225     d  ORGd20                                                                   476    500
010500080225     d  ORGd21                                                                   501    525
010600080225     d  ORGd22                                                                   526    550
010700080225     d  ORGd23                                                                   551    575
010800080225     d  ORGd24                                                                   576    600
010900080225     d  ORGd25                                                                   601    625
011000080225     d  ORGd26                                                                   626    650
011100080225     d  ORGd27                                                                   651    675
011200080225     d  ORGd28                                                                   676    700
011300080225     d  ORGd29                                                                   701    725
011400080225     d  ORGd30                                                                   726    750
011500080225     d  ORGd31                                                                   751    775
011600080225     d  ORGd32                                                                   776    800
011700080225     d  ORGd33                                                                   801    825
011800080225     d  ORGd34                                                                   826    850
011900080225     d  ORGd35                                                                   851    875
012000080225     d  ORGd36                                                                   876    900
012100080225     d  ORGd37                                                                   901    925
012200080225     d  ORGd38                                                                   926    950
012300080225     d  ORGd39                                                                   951    975
012400080225     d  ORGd40                                                                   976   1000
012500080225     d  ORGd41                                                                  1001   1025
012600080225     d  ORGd42                                                                  1026   1050
012700080225     d  ORGd43                                                                  1051   1075
012800080225     d  ORGd44                                                                  1076   1100
012900080225     d  ORGd45                                                                  1101   1125
013000080225     d  ORGd46                                                                  1126   1150
013100080225     d  ORGd47                                                                  1151   1175
013200080225     d  ORGd48                                                                  1176   1200
013300080225     d  ORGd49                                                                  1201   1225
013400080225     d  ORGd50                                                                  1226   1250
013500080225     d  ORGd51                                                                  1251   1275
013600080225     d  ORGd52                                                                  1276   1300
013700080225     d  ORGd53                                                                  1301   1325
013800080225     d  ORGd54                                                                  1326   1350
013900080225     d  ORGd55                                                                  1351   1375
014000080225     d  ORGd56                                                                  1376   1400
014100080225     d  ORGd57                                                                  1401   1425
014200080225     d  ORGd58                                                                  1426   1450
014300080225     d  ORGd59                                                                  1451   1475
014400080225     d  ORGd60                                                                  1476   1500
014500080225     d  ORGd61                                                                  1501   1525
014600080225     d  ORGd62                                                                  1526   1550
014700080225     d  ORGd63                                                                  1551   1575
014800080225     d  ORGd64                                                                  1576   1600
014900080225     d  ORGd65                                                                  1601   1625
015000080225     d  ORGd66                                                                  1626   1650
015100080225     d  ORGd67                                                                  1651   1675
015200080225     d  ORGd68                                                                  1676   1700
015300080225     d  ORGd69                                                                  1701   1725
015400080225     d  ORGd70                                                                  1726   1750
015500080225     d  ORGd71                                                                  1751   1775
015600080225     d  ORGd72                                                                  1776   1800
015700080225     d  ORGd73                                                                  1801   1825
015800080225     d  ORGd74                                                                  1826   1850
015900080225     d  ORGd75                                                                  1851   1875
016000080225     d  ORGd76                                                                  1876   1900
016100080225     d  ORGd77                                                                  1901   1925
016200080225     d  ORGd78                                                                  1926   1950
016300080225     d  ORGd79                                                                  1951   1975
016400080225     d  ORGd80                                                                  1976   2000
016500080225     d  ORGd81                                                                  2001   2025
016600080225     d  ORGd82                                                                  2026   2050
016700080225     d  ORGd83                                                                  2051   2075
016800080225     d  ORGd84                                                                  2076   2100
016900080225     d  ORGd85                                                                  2101   2125
017000080225     d  ORGd86                                                                  2126   2150
017100080225     d  ORGd87                                                                  2151   2175
017200080225     d  ORGd88                                                                  2176   2200
017300080225     d  ORGd89                                                                  2201   2225
017400080225     d  ORGd90                                                                  2226   2250
017500080225     d  ORGd91                                                                  2251   2275
017600080225     d  ORGd92                                                                  2276   2300
017700080225     d  ORGd93                                                                  2301   2325
017800080225     d  ORGd94                                                                  2326   2350
017900080225     d  ORGd95                                                                  2351   2375
018000080225     d  ORGd96                                                                  2376   2400
018100080225     d  ORGd97                                                                  2401   2425
018200080225     d  ORGd98                                                                  2426   2450
018300080225     d  ORGd99                                                                  2451   2475
018400080225     d  ORGdA0                                                                  2476   2500
018500080225     d  ORGdA1                                                                  2501   2525
018600080225     d  ORGdA2                                                                  2526   2550
018700080225     d  ORGdA3                                                                  2551   2575
018800080225     d  ORGdA4                                                                  2576   2600
018900080225     d  ORGdA5                                                                  2601   2625
019000080225     d  ORGdA6                                                                  2626   2650
019100080225     d  ORGdA7                                                                  2651   2675
019200080225     d  ORGdA8                                                                  2676   2700
019300080225     d  ORGdA9                                                                  2701   2725
019400080225     d  ORGdB0                                                                  2726   2750
019500080225     d  ORGdB1                                                                  2751   2775
019600080225     d  ORGdB2                                                                  2776   2800
019700080225     d  ORGdB3                                                                  2801   2825
019800080225     d  ORGdB4                                                                  2826   2850
019900080225     d  ORGdB5                                                                  2851   2875
020000080225     d  ORGdB6                                                                  2876   2900
020100080225     d  ORGdB7                                                                  2901   2925
020200080225     d  ORGdB8                                                                  2926   2950
020300080225     d  ORGdB9                                                                  2951   2975
020400080225     d  ORGdC0                                                                  2976   3000
020500080225     d  ORGdC1                                                                  3001   3025
020600080225     d  ORGdC2                                                                  3026   3050
020700080225     d  ORGdC3                                                                  3051   3075
020800080225     d  ORGdC4                                                                  3076   3100
020900080225     d  ORGdC5                                                                  3101   3125
021000080225     d  ORGdC6                                                                  3126   3150
021100080225     d  ORGdC7                                                                  3151   3175
021200080225     d  ORGdC8                                                                  3176   3200
021300080225     d  ORGdC9                                                                  3201   3225
021400080225     d  ORGdD0                                                                  3226   3250
021500080225     d  ORGdD1                                                                  3251   3275
021600080225     d  ORGdD2                                                                  3276   3300
021700080225     d  ORGdD3                                                                  3301   3325
021800080225     d  ORGdD4                                                                  3326   3350
021900080225     d  ORGdD5                                                                  3351   3375
022000080225     d  ORGdD6                                                                  3376   3400
022100080225     d  ORGdD7                                                                  3401   3425
022200080225     d  ORGdD8                                                                  3426   3450
022300080225     d  ORGdD9                                                                  3451   3475
022400080225     d  ORGdE0                                                                  3476   3500
022500080225     d  ORGdE1                                                                  3501   3525
022600080225     d  ORGdE2                                                                  3526   3550
022700080225     d  ORGdE3                                                                  3551   3575
022800080225     d  ORGdE4                                                                  3576   3600
022900080225     d  ORGdE5                                                                  3601   3625
023000080225     d  ORGdE6                                                                  3626   3650
023100080225     d  ORGdE7                                                                  3651   3675
023200080225     d  ORGdE8                                                                  3676   3700
023300080225     d  ORGdE9                                                                  3701   3725
023400080225     d  ORGdF0                                                                  3726   3750
023500080225     d   $DE                   1   3750    dim(150)
023600080225      *
023700080225     d CF_ds           ds                  inz
023800080225     d  ORGf01                                                                     1      3  0
023900080225     d  ORGf02                                                                     4      6  0
024000080225     d  ORGf03                                                                     7      9  0
024100080225     d  ORGf04                                                                    10     12  0
024200080225     d  ORGf05                                                                    13     15  0
024300080225     d  ORGf06                                                                    16     18  0
024400080225     d  ORGf07                                                                    19     21  0
024500080225     d  ORGf08                                                                    22     24  0
024600080225     d  ORGf09                                                                    25     27  0
024700080225     d  ORGf10                                                                    28     30  0
024800080225     d  ORGf11                                                                    31     33  0
024900080225     d  ORGf12                                                                    34     36  0
025000080225     d  ORGf13                                                                    37     39  0
025100080225     d  ORGf14                                                                    40     42  0
025200080225     d  ORGf15                                                                    43     45  0
025300080225     d  ORGf16                                                                    46     48  0
025400080225     d  ORGf17                                                                    49     51  0
025500080225     d  ORGf18                                                                    52     54  0
025600080225     d  ORGf19                                                                    55     57  0
025700080225     d  ORGf20                                                                    58     60  0
025800080225     d  ORGf21                                                                    61     63  0
025900080225     d  ORGf22                                                                    64     66  0
026000080225     d  ORGf23                                                                    67     69  0
026100080225     d  ORGf24                                                                    70     72  0
026200080225     d  ORGf25                                                                    73     75  0
026300080225     d  ORGf26                                                                    76     78  0
026400080225     d  ORGf27                                                                    79     81  0
026500080225     d  ORGf28                                                                    82     84  0
026600080225     d  ORGf29                                                                    85     87  0
026700080225     d  ORGf30                                                                    88     90  0
026800080225     d  ORGf31                                                                    91     93  0
026900080225     d  ORGf32                                                                    94     96  0
027000080225     d  ORGf33                                                                    97     99  0
027100080225     d  ORGf34                                                                   100    102  0
027200080225     d  ORGf35                                                                   103    105  0
027300080225     d  ORGf36                                                                   106    108  0
027400080225     d  ORGf37                                                                   109    111  0
027500080225     d  ORGf38                                                                   112    114  0
027600080225     d  ORGf39                                                                   115    117  0
027700080225     d  ORGf40                                                                   118    120  0
027800080225     d  ORGf41                                                                   121    123  0
027900080225     d  ORGf42                                                                   124    126  0
028000080225     d  ORGf43                                                                   127    129  0
028100080225     d  ORGf44                                                                   130    132  0
028200080225     d  ORGf45                                                                   133    135  0
028300080225     d  ORGf46                                                                   136    138  0
028400080225     d  ORGf47                                                                   139    141  0
028500080225     d  ORGf48                                                                   142    144  0
028600080225     d  ORGf49                                                                   145    147  0
028700080225     d  ORGf50                                                                   148    150  0
028800080225     d  ORGf51                                                                   151    153  0
028900080225     d  ORGf52                                                                   154    156  0
029000080225     d  ORGf53                                                                   157    159  0
029100080225     d  ORGf54                                                                   160    162  0
029200080225     d  ORGf55                                                                   163    165  0
029300080225     d  ORGf56                                                                   166    168  0
029400080225     d  ORGf57                                                                   169    171  0
029500080225     d  ORGf58                                                                   172    174  0
029600080225     d  ORGf59                                                                   175    177  0
029700080225     d  ORGf60                                                                   178    180  0
029800080225     d  ORGf61                                                                   181    183  0
029900080225     d  ORGf62                                                                   184    186  0
030000080225     d  ORGf63                                                                   187    189  0
030100080225     d  ORGf64                                                                   190    192  0
030200080225     d  ORGf65                                                                   193    195  0
030300080225     d  ORGf66                                                                   196    198  0
030400080225     d  ORGf67                                                                   199    201  0
030500080225     d  ORGf68                                                                   202    204  0
030600080225     d  ORGf69                                                                   205    207  0
030700080225     d  ORGf70                                                                   208    210  0
030800080225     d  ORGf71                                                                   211    213  0
030900080225     d  ORGf72                                                                   214    216  0
031000080225     d  ORGf73                                                                   217    219  0
031100080225     d  ORGf74                                                                   220    222  0
031200080225     d  ORGf75                                                                   223    225  0
031300080225     d  ORGf76                                                                   226    228  0
031400080225     d  ORGf77                                                                   229    231  0
031500080225     d  ORGf78                                                                   232    234  0
031600080225     d  ORGf79                                                                   235    237  0
031700080225     d  ORGf80                                                                   238    240  0
031800080225     d  ORGf81                                                                   241    243  0
031900080225     d  ORGf82                                                                   244    246  0
032000080225     d  ORGf83                                                                   247    249  0
032100080225     d  ORGf84                                                                   250    252  0
032200080225     d  ORGf85                                                                   253    255  0
032300080225     d  ORGf86                                                                   256    258  0
032400080225     d  ORGf87                                                                   259    261  0
032500080225     d  ORGf88                                                                   262    264  0
032600080225     d  ORGf89                                                                   265    267  0
032700080225     d  ORGf90                                                                   268    270  0
032800080225     d  ORGf91                                                                   271    273  0
032900080225     d  ORGf92                                                                   274    276  0
033000080225     d  ORGf93                                                                   277    279  0
033100080225     d  ORGf94                                                                   280    282  0
033200080225     d  ORGf95                                                                   283    285  0
033300080225     d  ORGf96                                                                   286    288  0
033400080225     d  ORGf97                                                                   289    291  0
033500080225     d  ORGf98                                                                   292    294  0
033600080225     d  ORGf99                                                                   295    297  0
033700080225     d  ORGfA0                                                                   298    300  0
033800080225     d  ORGfA1                                                                   301    303  0
033900080225     d  ORGfA2                                                                   304    306  0
034000080225     d  ORGfA3                                                                   307    309  0
034100080225     d  ORGfA4                                                                   310    312  0
034200080225     d  ORGfA5                                                                   313    315  0
034300080225     d  ORGfA6                                                                   316    318  0
034400080225     d  ORGfA7                                                                   319    321  0
034500080225     d  ORGfA8                                                                   322    324  0
034600080225     d  ORGfA9                                                                   325    327  0
034700080225     d  ORGfB0                                                                   328    330  0
034800080225     d  ORGfB1                                                                   331    333  0
034900080225     d  ORGfB2                                                                   334    336  0
035000080225     d  ORGfB3                                                                   337    339  0
035100080225     d  ORGfB4                                                                   340    342  0
035200080225     d  ORGfB5                                                                   343    345  0
035300080225     d  ORGfB6                                                                   346    348  0
035400080225     d  ORGfB7                                                                   349    351  0
035500080225     d  ORGfB8                                                                   352    354  0
035600080225     d  ORGfB9                                                                   355    357  0
035700080225     d  ORGfC0                                                                   358    360  0
035800080225     d  ORGfC1                                                                   361    363  0
035900080225     d  ORGfC2                                                                   364    366  0
036000080225     d  ORGfC3                                                                   367    369  0
036100080225     d  ORGfC4                                                                   370    372  0
036200080225     d  ORGfC5                                                                   373    375  0
036300080225     d  ORGfC6                                                                   376    378  0
036400080225     d  ORGfC7                                                                   379    381  0
036500080225     d  ORGfC8                                                                   382    384  0
036600080225     d  ORGfC9                                                                   385    387  0
036700080225     d  ORGfD0                                                                   388    390  0
036800080225     d  ORGfD1                                                                   391    393  0
036900080225     d  ORGfD2                                                                   394    396  0
037000080225     d  ORGfD3                                                                   397    399  0
037100080225     d  ORGfD4                                                                   400    402  0
037200080225     d  ORGfD5                                                                   403    405  0
037300080225     d  ORGfD6                                                                   406    408  0
037400080225     d  ORGfD7                                                                   409    411  0
037500080225     d  ORGfD8                                                                   412    414  0
037600080225     d  ORGfD9                                                                   415    417  0
037700080225     d  ORGfE0                                                                   418    420  0
037800080225     d  ORGfE1                                                                   421    423  0
037900080225     d  ORGfE2                                                                   424    426  0
038000080225     d  ORGfE3                                                                   427    429  0
038100080225     d  ORGfE4                                                                   430    432  0
038200080225     d  ORGfE5                                                                   433    435  0
038300080225     d  ORGfE6                                                                   436    438  0
038400080225     d  ORGfE7                                                                   439    441  0
038500080225     d  ORGfE8                                                                   442    444  0
038600080225     d  ORGfE9                                                                   445    447  0
038700080225     d  ORGfF0                                                                   448    450  0
038800080225     d   $CF                   1    450  0 dim(150)
038900080311      *
039000080311      * - Descrizioni a video
039100080311     d VDE_ds          ds                  inz
039200080311     D  VD01                   1     25
039300080311     D  VD02                  26     50
039400080311     D  VD03                  51     75
039500080311     D  VD04                  76    100
039600080311     D  VD05                 101    125
039700080311     D  VD06                 126    150
039800080311     D  VD07                 151    175
039900080311     D  VD08                 176    200
040000080311     D  VD09                 201    225
040100080311     D  VD10                 226    250
040200080311     D  VD11                 251    275
040300080311     D  VD12                 276    300
040400080311     D  VD13                 301    325
040500080311     D  VD14                 326    350
040600080311     D  VD15                 351    375
040700080311     D  VD16                 376    400
040800080311     D  VD17                 401    425
040900080311     D  VD18                 426    450
041000080311     D  VD19                 451    475
041100080311     D  VD20                 476    500
041200080311     D  VD21                 501    525
041300080311     D  VD22                 526    550
041400080311     D  VD23                 551    575
041500080311     D  VD24                 576    600
041600080311     D  VD25                 601    625
041700080311     D  VD26                 626    650
041800080311     D  VD27                 651    675
041900080311     D  VD28                 676    700
042000080311     D  VD29                 701    725
042100080311     D  VD30                 726    750
042200080311     D  VD31                 751    775
042300080311     D  VD32                 776    800
042400080311     D  VD33                 801    825
042500080311     D  VD34                 826    850
042600080311     D  VD35                 851    875
042700080311     D  VD36                 876    900
042800080311     D  VD37                 901    925
042900080311     D  VD38                 926    950
043000080311     D  VD39                 951    975
043100080311     D  VD40                 976   1000
043200080311     D  VD41                1001   1025
043300080311     D  VD42                1026   1050
043400080311     D  VD43                1051   1075
043500080311     D  VD44                1076   1100
043600080311     D  VD45                1101   1125
043700080311     D  VD46                1126   1150
043800080311     D  VD47                1151   1175
043900080311     D  VD48                1176   1200
044000080311     D  VD49                1201   1225
044100080311     D  VD50                1226   1250
044200080311     D  VD51                1251   1275
044300080311     D  VD52                1276   1300
044400080311     D  VD53                1301   1325
044500080311     D  VD54                1326   1350
044600080311     D  VD55                1351   1375
044700080311     D  VD56                1376   1400
044800080311     D  VD57                1401   1425
044900080311     D  VD58                1426   1450
045000080311     D  VD59                1451   1475
045100080311     D  VD60                1476   1500
045200080311     D  VD61                1501   1525
045300080311     D  VD62                1526   1550
045400080311     D  VD63                1551   1575
045500080311     D  VD64                1576   1600
045600080311     D  VD65                1601   1625
045700080311     D  VD66                1626   1650
045800080311     D  VD67                1651   1675
045900080311     D  VD68                1676   1700
046000080311     D  VD69                1701   1725
046100080311     D  VD70                1726   1750
046200080311     D  VD71                1751   1775
046300080311     D  VD72                1776   1800
046400080311     D  VD73                1801   1825
046500080311     D  VD74                1826   1850
046600080311     D  VD75                1851   1875
046700080311     D  VD76                1876   1900
046800080311     D  VD77                1901   1925
046900080311     D  VD78                1926   1950
047000080311     D  VD79                1951   1975
047100080311     D  VD80                1976   2000
047200080311     D  VD81                2001   2025
047300080311     D  VD82                2026   2050
047400080311     D  VD83                2051   2075
047500080311     D  VD84                2076   2100
047600080311     D  VD85                2101   2125
047700080311     D  VD86                2126   2150
047800080311     D  VD87                2151   2175
047900080311     D  VD88                2176   2200
048000080311     D  VD89                2201   2225
048100080311     D  VD90                2226   2250
048200080311     D  VD91                2251   2275
048300080311     D  VD92                2276   2300
048400080311     D  VD93                2301   2325
048500080311     D  VD94                2326   2350
048600080311     D  VD95                2351   2375
048700080311     D  VD96                2376   2400
048800080311     D  VD97                2401   2425
048900080311     D  VD98                2426   2450
049000080311     D  VD99                2451   2475
049100080311     D  VDA0                2476   2500
049200080311     D  VDA1                2501   2525
049300080311     D  VDA2                2526   2550
049400080311     D  VDA3                2551   2575
049500080311     D  VDA4                2576   2600
049600080311     D  VDA5                2601   2625
049700080311     D  VDA6                2626   2650
049800080311     D  VDA7                2651   2675
049900080311     D  VDA8                2676   2700
050000080311     D  VDA9                2701   2725
050100080311     D  VDB0                2726   2750
050200080311     D  VDB1                2751   2775
050300080311     D  VDB2                2776   2800
050400080311     D  VDB3                2801   2825
050500080311     D  VDB4                2826   2850
050600080311     D  VDB5                2851   2875
050700080311     D  VDB6                2876   2900
050800080311     D  VDB7                2901   2925
050900080311     D  VDB8                2926   2950
051000080311     D  VDB9                2951   2975
051100080311     D  VDC0                2976   3000
051200080311     D  VDC1                3001   3025
051300080311     D  VDC2                3026   3050
051400080311     D  VDC3                3051   3075
051500080311     D  VDC4                3076   3100
051600080311     D  VDC5                3101   3125
051700080311     D  VDC6                3126   3150
051800080311     D  VDC7                3151   3175
051900080311     D  VDC8                3176   3200
052000080311     D  VDC9                3201   3225
052100080311     D  VDD0                3226   3250
052200080311     D  VDD1                3251   3275
052300080311     D  VDD2                3276   3300
052400080311     D  VDD3                3301   3325
052500080311     D  VDD4                3326   3350
052600080311     D  VDD5                3351   3375
052700080311     D  VDD6                3376   3400
052800080311     D  VDD7                3401   3425
052900080311     D  VDD8                3426   3450
053000080311     D  VDD9                3451   3475
053100080311     D  VDE0                3476   3500
053200080311     D  VDE1                3501   3525
053300080311     D  VDE2                3526   3550
053400080311     D  VDE3                3551   3575
053500080311     D  VDE4                3576   3600
053600080311     D  VDE5                3601   3625
053700080311     D  VDE6                3626   3650
053800080311     D  VDE7                3651   3675
053900080311     D  VDE8                3676   3700
054000080311     D  VDE9                3701   3725
054100080311     D  VDF0                3726   3750
054200080311     d   VDE                   1   3750    dim(150) inz
054300080311      * - Filiali appartenenza a video
054400080311     d VCF_ds          ds                  inz
054500080311     D  VF01                   1      3  0
054600080311     D  VF02                   4      6  0
054700080311     D  VF03                   7      9  0
054800080311     D  VF04                  10     12  0
054900080311     D  VF05                  13     15  0
055000080311     D  VF06                  16     18  0
055100080311     D  VF07                  19     21  0
055200080311     D  VF08                  22     24  0
055300080311     D  VF09                  25     27  0
055400080311     D  VF10                  28     30  0
055500080311     D  VF11                  31     33  0
055600080311     D  VF12                  34     36  0
055700080311     D  VF13                  37     39  0
055800080311     D  VF14                  40     42  0
055900080311     D  VF15                  43     45  0
056000080311     D  VF16                  46     48  0
056100080311     D  VF17                  49     51  0
056200080311     D  VF18                  52     54  0
056300080311     D  VF19                  55     57  0
056400080311     D  VF20                  58     60  0
056500080311     D  VF21                  61     63  0
056600080311     D  VF22                  64     66  0
056700080311     D  VF23                  67     69  0
056800080311     D  VF24                  70     72  0
056900080311     D  VF25                  73     75  0
057000080311     D  VF26                  76     78  0
057100080311     D  VF27                  79     81  0
057200080311     D  VF28                  82     84  0
057300080311     D  VF29                  85     87  0
057400080311     D  VF30                  88     90  0
057500080311     D  VF31                  91     93  0
057600080311     D  VF32                  94     96  0
057700080311     D  VF33                  97     99  0
057800080311     D  VF34                 100    102  0
057900080311     D  VF35                 103    105  0
058000080311     D  VF36                 106    108  0
058100080311     D  VF37                 109    111  0
058200080311     D  VF38                 112    114  0
058300080311     D  VF39                 115    117  0
058400080311     D  VF40                 118    120  0
058500080311     D  VF41                 121    123  0
058600080311     D  VF42                 124    126  0
058700080311     D  VF43                 127    129  0
058800080311     D  VF44                 130    132  0
058900080311     D  VF45                 133    135  0
059000080311     D  VF46                 136    138  0
059100080311     D  VF47                 139    141  0
059200080311     D  VF48                 142    144  0
059300080311     D  VF49                 145    147  0
059400080311     D  VF50                 148    150  0
059500080311     D  VF51                 151    153  0
059600080311     D  VF52                 154    156  0
059700080311     D  VF53                 157    159  0
059800080311     D  VF54                 160    162  0
059900080311     D  VF55                 163    165  0
060000080311     D  VF56                 166    168  0
060100080311     D  VF57                 169    171  0
060200080311     D  VF58                 172    174  0
060300080311     D  VF59                 175    177  0
060400080311     D  VF60                 178    180  0
060500080311     D  VF61                 181    183  0
060600080311     D  VF62                 184    186  0
060700080311     D  VF63                 187    189  0
060800080311     D  VF64                 190    192  0
060900080311     D  VF65                 193    195  0
061000080311     D  VF66                 196    198  0
061100080311     D  VF67                 199    201  0
061200080311     D  VF68                 202    204  0
061300080311     D  VF69                 205    207  0
061400080311     D  VF70                 208    210  0
061500080311     D  VF71                 211    213  0
061600080311     D  VF72                 214    216  0
061700080311     D  VF73                 217    219  0
061800080311     D  VF74                 220    222  0
061900080311     D  VF75                 223    225  0
062000080311     D  VF76                 226    228  0
062100080311     D  VF77                 229    231  0
062200080311     D  VF78                 232    234  0
062300080311     D  VF79                 235    237  0
062400080311     D  VF80                 238    240  0
062500080311     D  VF81                 241    243  0
062600080311     D  VF82                 244    246  0
062700080311     D  VF83                 247    249  0
062800080311     D  VF84                 250    252  0
062900080311     D  VF85                 253    255  0
063000080311     D  VF86                 256    258  0
063100080311     D  VF87                 259    261  0
063200080311     D  VF88                 262    264  0
063300080311     D  VF89                 265    267  0
063400080311     D  VF90                 268    270  0
063500080311     D  VF91                 271    273  0
063600080311     D  VF92                 274    276  0
063700080311     D  VF93                 277    279  0
063800080311     D  VF94                 280    282  0
063900080311     D  VF95                 283    285  0
064000080311     D  VF96                 286    288  0
064100080311     D  VF97                 289    291  0
064200080311     D  VF98                 292    294  0
064300080311     D  VF99                 295    297  0
064400080311     D  VFA0                 298    300  0
064500080311     D  VFA1                 301    303  0
064600080311     D  VFA2                 304    306  0
064700080311     D  VFA3                 307    309  0
064800080311     D  VFA4                 310    312  0
064900080311     D  VFA5                 313    315  0
065000080311     D  VFA6                 316    318  0
065100080311     D  VFA7                 319    321  0
065200080311     D  VFA8                 322    324  0
065300080311     D  VFA9                 325    327  0
065400080311     D  VFB0                 328    330  0
065500080311     D  VFB1                 331    333  0
065600080311     D  VFB2                 334    336  0
065700080311     D  VFB3                 337    339  0
065800080311     D  VFB4                 340    342  0
065900080311     D  VFB5                 343    345  0
066000080311     D  VFB6                 346    348  0
066100080311     D  VFB7                 349    351  0
066200080311     D  VFB8                 352    354  0
066300080311     D  VFB9                 355    357  0
066400080311     D  VFC0                 358    360  0
066500080311     D  VFC1                 361    363  0
066600080311     D  VFC2                 364    366  0
066700080311     D  VFC3                 367    369  0
066800080311     D  VFC4                 370    372  0
066900080311     D  VFC5                 373    375  0
067000080311     D  VFC6                 376    378  0
067100080311     D  VFC7                 379    381  0
067200080311     D  VFC8                 382    384  0
067300080311     D  VFC9                 385    387  0
067400080311     D  VFD0                 388    390  0
067500080311     D  VFD1                 391    393  0
067600080311     D  VFD2                 394    396  0
067700080311     D  VFD3                 397    399  0
067800080311     D  VFD4                 400    402  0
067900080311     D  VFD5                 403    405  0
068000080311     D  VFD6                 406    408  0
068100080311     D  VFD7                 409    411  0
068200080311     D  VFD8                 412    414  0
068300080311     D  VFD9                 415    417  0
068400080311     D  VFE0                 418    420  0
068500080311     D  VFE1                 421    423  0
068600080311     D  VFE2                 424    426  0
068700080311     D  VFE3                 427    429  0
068800080311     D  VFE4                 430    432  0
068900080311     D  VFE5                 433    435  0
069000080311     D  VFE6                 436    438  0
069100080311     D  VFE7                 439    441  0
069200080311     D  VFE8                 442    444  0
069300080311     D  VFE9                 445    447  0
069400080311     D  VFF0                 448    450  0
069500080311     d   VCF                   1    450  0 dim(150) inz
069600080225      *
069700080225      *?  V A R I A B I L I  ?----------------------------------------*
069800080225      *
069900080225      * - Flag booleani
070000080225      *
070100080225      * - Indici di schiera
070200080225     d xa              s              3  0 inz
070300080225     d xb              s              3  0 inz
070400080225     d xx              s              3  0 inz
070500080225      *
070600080225      * - Parametri per X§TABER
070700080225     d §Kut            s              1  0 inz
070800080225     d §Cod            s              2    inz
070900080225     d §Key            s              8    inz
071000080225     d §Des            s             30    inz
071100080225      * - Parametri per TNSD24R
071200080225     d §§Cod           s              3    inz
071300080225     d §§Tip           s                   like(ORGfag)  inz
071400080225     d §§Des           s             25    inz
071500080225     d §§Pra           s              3    inz
071600080225      *
071700080225      *  - Comodo
071800080225     d wdsd            s                   like(G02dat)  inz
071900080225     d wdse            s                   like(G02dat)  inz
072000080225     d wdda            s                   like(G02dat)  inz
072100080225     d wddao           s                   like(G02dat)  inz
072200080225     d §Fil            s                   like(ORGfil)  inz
072300080225     d wFil            s                   like(ORGfil)  inz
072400130828     d klna            s              3  0 inz
072500080225     D wAggSfl         s              1
072600130828     d Datasys         s               d   datfmt(*iso) inz(*sys)
072700150430     d wtfp_lnpb       s                   like(d55tfp)
072800080225      *
072900080225      *?  K E Y - L I S T  ?------------------------------------------*
073000080225      *
073100080225     c     k02tabel      klist
073200080225     c                   kfld                    TBLkut
073300080225     c                   kfld                    TBLcod
073400080225     c     k03tabel      klist
073500080225     c                   kfld                    TBLkut
073600080225     c                   kfld                    TBLcod
073700080225     c                   kfld                    TBLkey
073800080225      *
073900080225      *?  I N D I C A T O R I   U T I L I Z Z A T I  ?----------------*
074000080225      *
074100080225      *  01        IMMISSIONE
074200080225      *  02        VARIAZIONE
074300080225      *  03        ANNULLATO
074400080225      *  10        comodo
074500080225      *  11        Emissione messaggio di errore
074600100929      *  19        tipo filiale "V-vari"
074700130423      *  28        Filiale NON di primo livello non visualizzo alcuni campi
074800080225      *  29        Errore su indirizzo IP
074900080225      *  30        INDICATORE GENERICO DI ERRORE CONTROLLI VIDEO D05
075000080225      *  32        errore data inizio distinte ORM automatiche
075100080225      *  33        errore data inizio distinte automatiche
075200080225      *  34        p.o. contabilità
075300080225      *  35        errore su tellus
075400080225      *  36        CHAIN GENERICO
075500080225      *  37        data scannerizzazione euroexpress
075600080225      *  38        data scannerizzazione dpd
075700080225      *  39        LINEA PARALLELA PER TASSAZIONE NON VALIDA
075800080225      *  40        OFF --> PROFILE EDP
075900080225      *  41        Errore su tipo P.O. 1 o 2 livello
076000080225      *  42        Errore coda  FAX INPUT
076100151028      ****  43        OBBLIGATORIO INSERIRE TELEFONO DIRETTO P.O
076200151028      *  43        Errore su raggruppamento area centralino
076300080225      *  44        PER CAMBIO TIPO P.O. INDICARE E P.O. E NUOVO TIPO
076400080225      *  45        Errore su raggruppamento area
076500080225      *  46        Errore su ambiente di appartenenza
076600080225      *  47        P.O CHE GESTISCE TARIFFE DEVE ESSERE TERMINAL DI PARTENZA
076700080225      *  48        Errore su P.O. elaboratore
076800080225      *  49        FILIALE ANNULLATA
076900080225      *  50        Errore:   p.o. inserito
077000080225      *  51        Errore:   tipo p.o. inserito
077100080225      *  52/56     Errori su campi indirizzo filiale
077200080225      *  57/62     Errori su campi indirizzo agenzia
077300080225      *  63        Errore su cod.Tassazione
077400100125      *  64        Errore su cod.direzione comm.le
077500080225      *  65/66     Errore su NTW
077600080225      *  67        Errore suy cod HUB
077700080225      *  68        Errore su cod.deposito
077800080225      *  69        Errore su  TIPO DI AUTOGENERAZIONE SPUNTE
077900080225      *  70        Errore su descrizione SFL
078000080225      *  71        FLAG protezione su sfl
078100080225      *  72        errore su CODICE FIL.APPARTENENZA
078200080225      *  73        flag non visualizzazione su sfl
078300080225      *  74        Errore su P.O. gestione Tariffe
078400080225      *  75        PULIZIA SUBFILE
078500080225      *  76        Errore su Regione ai fini tariffari
078600080225      *  77        Errore su telefono direeto filiale
078700080225      *  78        Errore su provincia filiale
078800080225      *  79        Errore su provincia agenzia
078900080225      *  80        Il p.o. immesso non è una agenzia
079000080225      *  81        OFF --> MANUTENZIONE   ON --> INTERROGAZIONE
079100080225      *  82        errore su linea parallela per tassazione
079200080225      *  83        errore su coda stampa sede per p.o.
079300080225      *  84        Errore su cod.Area
079400080225      *  85        Errore su cod.Regione
079500080225      *  86        errore su DATA UTILIZZO MACCHINONE PER VOLUME
079600080225      *  87        errore su DATA UTILIZZO MACCHINONE PER PESO
079700080225      *  88        ORGANIGRAMMA DI SEDE
079800080225      *  89        Errore su CODa FAX OUTPUT
079900080225      *  90        errore su coda stampa sede per commerciale p.o.
080000080225      *  91        Errore su area POC
080100080225      *  92        Errore su AREA EX AS400
080200080225      *  93        INDICARE CODA OUTPUT RICEZIONE STAMPE DA ALTRO AS
080300080225      *  94        INDICATORE GENERICO DI ERRORE CONTROLLI VIDEO D04
080400080225      *  95        di comodo per scrittura azose10
080500080225      *  96        per lettura AZOSE10
080600080225      *  97        INDICATORE GENERICO DI ERRORE CONTROLLI VIDEO D03
080700080225      *  98        INDICATORE GENERICO DI ERRORE CONTROLLI VIDEO D02
080800080225      *  99        INDICATORE GENERICO DI ERRORE CONTROLLI SUBFILE
080900080225      *
081000080225      *?  M A I N - L I N E  ?----------------------------------------*
081100080225      *
081200080225     c     *Entry        plist
081300080225     c                   parm                    KPJBA
081400080225      *
081500131016      *  Controlla se si tratta di UTENTE EDP* 24=*ON
081600131016     c                   clear                   utente_EDP        1
081700131016     c                   setoff                                       24
081800131016     c                   if        %subst(knmus:1:3) = 'EDP'
081900131016     c                   eval           utente_EDP ='S'
082000131016     c                   setoN                                        24
082100131016     c                   end
082200131016      *
082300080225      * Reperisco dati job
082400080225     c                   exsr      DatiJob
082500021029      *
082600900329     C                   SETOFF                                       8140
082700080225      *
082800080225      * Verifica autorizzazioni utente
082900080225     c                   eval      *in40 = (§UTEgorg = 'P')
083000080225      *
083100080225      * 88 on - organigramma di sede
083200080225     c                   eval      *in88 = (%subst(KPJBU : 1 : 4) = 'SEDE')
083300080225      *
083400021029      *---------------------------------------------------------------------
083500021029      *
083600080225     c                   eval      TBLkut = 1
083700900328     C     INIZIO        TAG
083800021029     C                   eval      *in80=*off
083900021029     C                   eval      *in01=*off
084000021029     C                   eval      *in02=*off
084100021029     C                   eval      *in03=*off
084200080225     C                   movel     *blanks       $De
084300021029     C                   movel     *blanks       VDe
084400080225     C                   z-add     0             $Cf
084500021029     C                   z-add     0             Vcf
084600021029     C                   movel     *blanks       VFil
084700021029     C                   movel     '?'           VFil
084800021029     C                   movel     *blanks       VTip
084900080225     c                   if        §UTEgorg = *blanks
085000080225     c                   eval      *in11  = *on
085100080225     c                   eval      V1Dmsg = Msg(18)
085200080225     c                   endif
085300021029      *
085400080225     c                   write     SD15T01
085500090709     C     VID1          TAG
085600941115     C                   EXFMT     SD15D01
085700080225     c                   if        §UTEgorg = *blanks
085800080225     c                   goto      Fine
085900080225     c                   endif
086000130828     c* F03 - fine
086100910306     C   KC              GOTO      FINE
086200130828      *
086300130828      * F07 - Orari servizi standard
086400130828      *
086500130828     c                   if        *inkg=*on
086600131021     c                             and  utente_EDP ='S'
086700130828     c                   eval      klna=999
086800130828     c                   exsr      Ges_serv
086900130828     C                   GOTO      inizio
087000130828     c                   endif
087100021029      *
087200021029      *  Video 1
087300021029     C     VFil          IFEQ      *zeros
087400080225     C                   eval      *in50=*on
087500900328     C                   GOTO      VID1
087600900418     C                   END
087700021029      *
087800040923      * Ricerca  con '?'
087900030527     C                   IF        *inkr = *off
088000040924     C     '?'           scan      VFil                                   21
088100900515     C   21              DO
088200080225     C   88              move      '§'           §§Tip
088300080225     C  N88              move      VTip          §§Tip
088400971203     C                   CALL      'TNSD24R'
088500080225     C                   PARM                    §§Cod             3
088600080225     C                   PARM                    §§Tip
088700021029     C                   PARM                    §§Des            25
088800021029     C                   PARM                    §§Pra             3
088900080225     C                   movel     §§Cod         VFil
089000090709     c
089100090709     c                   write     SD15T01
089200021029     C                   GOTO      VID1
089300080226     C                   ENDdo
089400030527     C                   ENDIF
089500040923     c*
089600030403      * Controllo che il codice filiale immesso sia numerico
089700040923     C                   TESTN                   VFil                 36
089800040923     c                   move      vfil          w001a             1
089900040923     c*
090000040923     c                   if        not *in36 or w001a<*zeros
090100021029     C                   eval      *in50=*on
090200900418     C                   GOTO      VID1
090300900418     C                   END
090400900418     C*
090500080225     C                   movel     VFil          §Fil
090600080225     C  N88§Fil          CHAIN     AzOrg                              36
090700080225     C   88§FIL          CHAIN     AzOse                              36
090800021029      *
090900040923      * 01 on - Immissione
091000080226if  1C                   IF        *in36= '1'
091100021029     C                   eval      *in01=*on                                    *IMMISSIONE
091200021029      *
091300080226x   1C                   ELSE
091400030526     C                   eval      *in01=*off                                   *IMMISSIONE
091500021029     C                   movel     OrgFag        ComTip            1
091600030403     C                   move      OrgFl2        TipFl2            1
091700040923     c* Annullato
091800080226if  2C                   IF        OrgFva = '*'
091900021029      *
092000040923      * non gestisco per profilo non EDP
092100080226if  3C                   IF        *in40 = *on
092200021029     C                   eval      *in49=*on
092300021029     C                   GOTO      INIZIO
092400080226x   3C                   ELSE
092500040923      *
092600021029     C                   eval      *in03=*on                                    *ANNULLATO
092700080226e   3C                   ENDIF
092800080226x   2C                   ELSE
092900040923      * 02 on - Modifica
093000021029     C                   eval      *in02=*on                                    *VARIAZIONE
093100080226e   2C                   ENDIF
093200080226e   1C                   ENDIF
093300030527      *
093400040923      * F17 - Cambio tipo P.O.
093500040923      *       sono obbligatori p.o valido e tipo  P.O-
093600030527     C                   IF        *inkr = *on
093700030527     C                   if        *in02 = *off or VTip = *blanks
093800030527     C                   eval      *in44= *on
093900030527     C                   GOTO      VID1
094000030527     C                   endif
094100030527     C                   ENDIF
094200021029      *
094300030527      * Per immissione il tipo P.O è obbligatorio
094400080226if  1C                   IF        VTip = *blanks
094500080226if  2C                   IF        *in01 = *ON
094600040928     C  n88              eval      *in52= *on
094700040928     C   88              eval      *in53= *on
094800980226     C                   GOTO      VID1
094900080226e   2C                   ENDIF
095000080226x   1C                   ELSE
095100040923     c* Se immesso tipo e non premuto f!7 di cambio, deve essere =
095200040923     c*  a quello del p.o. immesso
095300080226if  2C                   IF        *inkr = *OFF
095400980420     C   02
095500080226if  3COR 03VTIP          IFNE      COMTIP
095600030403     C     VTIP          ANDNE     'T'
095700980420     C                   SETON                                        51
095800980420     C                   GOTO      VID1
095900080226x   3C                   ELSE
096000080226if  4C     VTIP          IFEQ      'T'
096100030403     C     TipFl2        ANDNE     'S'
096200030403     C                   SETON                                        51
096300030403     C                   GOTO      VID1
096400080226e   4C                   ENDIF
096500080226e   3C                   ENDIF
096600080226e   2C                   ENDIF
096700080226e   1C                   ENDif
096800040924     c
096900040924     c* Pulisco videate e carico e dati
097000021029     C                   EXSR      PulVid2
097100130422     C                   EXSR      PulVid21
097200040302     C                   EXSR      PulVid3
097300040517     C                   EXSR      PulVid4
097400070828     C                   EXSR      PulVid5
097500040302     c
097600040302     C                   EXSR      AggVid2
097700130422     C                   EXSR      AggVid21
097800040924     c
097900040928     C* Le nuove videate da fare solo per ORG. di filiale e per EDP
098000040924     c                   if        not *in88  and not *in40 and not *in01
098100080226      *
098200040302     C                   EXSR      AggVid3
098300040517     C                   EXSR      AggVid4
098400070828     C                   EXSR      AggVid5
098500080226      *
098600040302     c                   endif
098700040924      *
098800040924      * Gestione 2° video
098900040924      *
099000090709      * per emissione testata
099100090709     c                   seton                                        09
099200090709
099300090709     C     VID2          TAG
099400080226     c                   clear                   VDFil
099500090709     c                   if        *in09
099600080225     c                   write     SD15T01
099700080225     c                   write     SD15T02
099800090709     c                   setoff                                       09
099900090709     c                   endif
100000090709
100100941115     C                   EXFMT     SD15D02
100200090709
100300090709     C                   eval      *in98 = *off
100400021029      * Fine lavoro
100500910306     C   KC              GOTO      INIZIO
100600040517     c
100700040924      * F5-Ripristino  / F16-Annullamento
100800040517     c   KE
100900040517     Cor KQ              DO
101000900330     C                   EXSR      AGGFIL
101100900329     C                   GOTO      INIZIO
101200900329     C                   END
101300040517     c
101400021029      * Controlli seconda videata
101500021029     C                   EXSR      CtrVid2
101600021029      * Per errori o decodifiche
101700020625     C   98
101800020625     COR KD              GOTO      VID2
101900130422      *
102000130422      * Descrizione p.o.
102100130422     c                   eval      VDFil = VDesF
102200130422      *
102300130422      * Gestione video 2a
102400130422      *
102500130527      * per emissione testata
102600130527     c                   seton                                        09
102700130527      *
102800130422     c     VID21         TAG
102900130422     c                   IF        *in09
103000130422     c                   write     SD15T01
103100130422     c                   write     SD15T02
103200130422     c                   setoff                                       09
103300130422     c                   endif
103400130422     C                   EXFMT     SD15D021
103500130422
103600130422     C                   eval      *in11 = *off
103700130422      * Fine lavoro
103800130422     C   KC              GOTO      INIZIO
103900130423      * Video precedente
104000130423     C   KL              GOTO      VID2
104100130828      *  F7 - servizi orari
104200130828     c                   if        *inkg = *on
104300131021     c                             and  utente_EDP ='S'
104400130828     c                   eval      klna=§fil
104500130828     c                   exsr      Ges_serv
104600130828     c                   seton                                        09
104700130828     C                   GOTO      VID21
104800130828     c                   endif
104900130423
105000130422      * Controlli seconda videata
105100130422     C                   EXSR      CtrVid21
105200130422      * Per errori o decodifiche
105300130422     C   11              goto      vid21
105400080226      * F6 = conferma per utenti con abilitazione parziale
105500040928     c                   if        *inkf
105600040928     c                   eval      waggsfl='N'
105700040928     C                   EXSR      WrtFil
105800040928     C                   GOTO      INIZIO
105900040928     c                   endif
106000080226      *
106100080226      * Descrizione p.o.
106200130422     c***************    eval      VDFil = VDesF
106300030429      *
106400030430      * LE VIDEATE SUCCESSIVE VENGONO GESTITE SOLO PER UTENTE
106500030429      * EDP E NON STO GESTENDO L'ORGANIGRAMMA DI SEDE
106600030430      *
106700080226if  1C                   IF        *in88= *off and *in40 =*off
106800090709     c                   seton                                        09
106900040302      *
107000040302      * Gestione video 3
107100040302      *
107200021029     C     VID3          TAG
107300090709     c                   if        *in09
107400080225     c                   write     SD15T01
107500080225     c                   write     SD15T02
107600090709     c                   setoff                                       09
107700090709     c                   endif
107800021029     C                   EXFMT     SD15D03
107900090709     c
108000040302     c* spengo indicatori di posizionamento cursore
108100040302     c                   exsr      offd03
108200021029      * Fine lavoro
108300020614     C   KC              GOTO      INIZIO
108400021029      * Video precedente
108500130423     C***KL              GOTO      VID2
108600130423     C   KL              GOTO      VID21
108700021029      *
108800021029      * Controlli video 3
108900021029     C                   EXSR      CtrVid3
109000021029      * per errori e decodifiche
109100030429     C   97
109200021029     COR KD              GOTO      VID3
109300030429      *
109400030429      * Gestione video 4
109500170227     c                   setoff                                       9445
109600030429      *
109700030429     C     VID4          TAG
109800030429     C                   eval      *in94 = *off
109900090709     c                   if        *in09
110000080225     c                   write     SD15T01
110100080225     c                   write     SD15T02
110200090709     c                   setoff                                       09
110300090709     c                   endif
110400030429     C                   EXFMT     SD15D04
110401170227     c                   setoff                                       45
110500030429      * Fine lavoro
110600030429     C   KC              GOTO      INIZIO
110700030429      * Video precedente
110800030429     C   KL              GOTO      VID3
110900030429      *
111000040517      * Controlli video 4
111100030429     C                   EXSR      CtrVid4
111200030429      * per errori e decodifiche
111300030429     C   94
111400030429     COR KD              GOTO      VID4
111500070828      * Gestione video 5
111600070828     c                   setoff                                       30
111700070828     C     VID5          TAG
111800070828     C                   eval      *in30 = *off
111900090709     c                   if        *in09
112000080225     c                   write     SD15T01
112100080225     c                   write     SD15T02
112200090709     c                   setoff                                       09
112300090709     c                   endif
112400070828     C                   EXFMT     SD15D05
112500070828      * Fine lavoro
112600070828     C   KC              GOTO      INIZIO
112700070828      * Video precedente
112800070828     C   KL              GOTO      VID4
112900070828      *
113000070828      * Controlli video 5
113100070828     C                   EXSR      CtrVid5
113200070828      * per errori e decodifiche
113300070828     C   30
113400070828     COR KD              GOTO      VID5
113500070828      * Conferma
113600070828     c                   if        *inkf=*on
113700070828     c                   eval      waggsfl='N'
113800070828     C                   EXSR      WrtFil
113900070828     C                   GOTO      INIZIO
114000070828     c                   endif
114100030429      *
114200080226e   1C                   ENDIF
114300020625      *
114400040928      * pulizia subfile
114500021029     C                   EXSR      PulSfl
114600900402     C** CARICAMENTO SUBFILE
114700021029     C                   EXSR      CarSfl
114800040928     c
114900040928     c* Se ho caricato almeno un record
115000080226if  1c                   if        nrr>0
115100040928     C                   Z-ADD     1             NRR
115200890524     C     C1TAG         TAG
115300900328     C                   SETOFF                                       99
115400080225     c                   write     SD15T01
115500080225     c                   if        NOT *in88
115600080225     c                   write     SD15T02
115700080225     c                   endif
115800090709     C                   WRITE     SD15Z02
115900941115     C                   EXFMT     SD15DCT
116000021029      *
116100910306     C   KC              GOTO      INIZIO
116200030430      *
116300070828      * Video precedente: carico il video 5 se sono EDP e se non
116400030430      * sto leggendo AzOse
116500080226if  2C                   IF        *inKL = *on and *in40 = *off
116600030430     C                             and *in88 = *off
116700030430     C
116800070828     C                   GOTO      VID5
116900080226e   2C                   ENDIF
117000030430     C
117100130423     C***KL              GOTO      VID2
117200130423     C   KL              GOTO      VID21
117300040928     c
117400021029     C                   EXSR      CtrSfl
117500020625     C   99
117600020625     CORNKF              GOTO      C1TAG
117700040928     c
117800080226x   1c                   else
117900040928     c
118000040928     c* Se nessun record di sfl caricato, emetto videata precedente
118100080226if  2c                   if        *in40 =*off and *in88 =*off
118200070828     c                   goto      vid5
118300080226x   2c                   else
118400130423     c****               goto      vid2
118500130423     c                   goto      vid21
118600080226e   2c                   endif
118700080226e   1c                   endif
118800040928      * F6 - Conferma
118900040928     c                   eval      waggsfl='S'
119000040928     C                   EXSR      WrtFil
119100890525     C                   GOTO      INIZIO
119200890525     C     FINE          TAG
119300021029      *
119400080225     C                   CLEAR                   FNLV55ds
119500980204     C                   MOVEL     'C'           D55TLA
119600980204     C                   CALL      'FNLV55R'
119700080225     C                   PARM                    FNLV55ds
119800021029      *
119900890525     C                   SETON                                        LR
120000021029      *
120100021029      **----------------------------------------------------
120200030430      ** PULIZIA subfile
120300021029      **----------------------------------------------------
120400021029     C     PULSFL        BEGSR
120500900328     C                   SETON                                        75
120600941115     C                   WRITE     SD15DCT
120700900328     C                   SETOFF                                       75
120800890524     C                   ENDSR
120900130828      **----------------------------------------------------
121000130828      ** Gestione orari servizi
121100130828      **----------------------------------------------------
121200130828     C     Ges_serv      BEGSR
121300130828     c                   clear                   tisio0ds
121400130904     c* se non sono EDP solo in interrogazione
121500130904     C  n40              MOVEL     'G'           do0tric
121600130904     C   40              MOVEL     'I'           do0tric
121700130828     c                   movel     DATASYS       do0dri
121800130828     C                   MOVEL     klna          DO0LNA
121900130828
122000130828     C                   call      'TISIO2R'
122100130828     C                   PARM                    KPJBA
122200130828     C                   PARM                    tisio0ds
122300130828     C*
122400130828     C                   ENDSR
122500080225      *
122600080225      *---------------------------------------------------------------*
122700080225      * Reperimento Dati del job (Utente/Operativi)                   *
122800080225      *---------------------------------------------------------------*
122900080225     c     DatiJob       BEGSR
123000080225      *
123100080225     c     *dtaara       define    §azute        azuteds
123200080225     c     *dtaara       define    §datiute      ddatiute
123300080225      *
123400080225     c                   in(E)     *dtaara
123500080225     c                   IF        %ERROR or RSUT = *blanks
123600080225     c                   clear                   Tibs34Ds
123700080225     c                   call      'TIBS34R'
123800080225     c                   parm                    Tibs34Ds
123900080225     c                   in        *dtaara
124000080225     c                   ENDIF
124100080225      *
124200080225     c                   eval      dUTE01 = UTEfaf
124300080225      *
124400080225     c                   ENDSR
124500021029      **----------------------------------------------------
124600030430      ** Caricamento subfile
124700021029      **----------------------------------------------------
124800021029     C     CARSFL        BEGSR
124900040302      *
125000890525     C                   Z-ADD     0             NRR               4 0
125100080225     C                   Z-ADD     0             xa
125200080225     C                   MOVEL     VFIL          §FIL
125300080225     C  N88§FIL          CHAIN     AZORG                              36
125400080225     C   88§FIL          CHAIN     AZOSE                              36
125500080225      *
125600910220     C* CARICO TUTTA LA TABELLA 'OG/OR'
125700080225     C  n88              MOVEL     'OG'          TBLcod
125800080225     C   88              MOVEL     'OR'          TBLcod
125900080225     C     k02tabel      SETLL     TABEL
126000080225     C     k02tabel      READE     TABEL                                  22
126100080225do  1C     *IN22         DOWEQ     '0'
126200920413     C                   SETOFF                                       7173
126300080225if  2c                   if        tblkey<>*blanks and tblflg=*blanks
126400030521     C  n88              MOVEL     TBLUNI        DSOG
126500030521     C   88              MOVEL     TBLUNI        DSOR
126600030521      *
126700030521      * CONTROLLO FLAGS DSOG
126800030521      *
126900080225do  3C  n88              DO
127000021029      *
127100030521      * Vedo i vari casi protezione/visibilità distinti per F/A o V/T
127200030521      * in cui distinguo i casi EDP/non EDP
127300021029      * Caso F/A
127400080225if  4C                   IF        VTip = 'F' or VTip = 'A'
127500020626     C                   SELECT
127600040928     c* Protetto non per EDP
127700020626     C     §OGFRI        WHENEQ    'S'                                          PROTETTO
127800900330     C   40              SETON                                        71
127900021029      *
128000021029      * Protetto per tutti
128100020626     C     §OGFRI        WHENEQ    'T'
128200020626     C                   SETON                                        71
128300021029      *
128400040928      * Non visibile per tutti a parte per EDP che ha la gestione
128500020626     C     §OGFRI        WHENEQ    'Z'
128600020626     C   40              SETON                                        73        NON VISIBILE
128700040928      *
128800040928      * Non visibile per tutti a parte per EDP er il quale è protetto
128900040928     C     §OGFRI        WHENEQ    'W'
129000040928     C   40              SETON                                        73        NON VISIBILE
129100040928     C  n40              SETON                                        71        NON VISIBILE
129200021029      *
129300020626      * Non visibile in generale,oppure per 1° o 2° livello (in questi
129400021029      * due casi si fa riferimento al campo in prima videata)
129500020626     C     §OGFRI        WHENEQ    'Y'                                          NON VISIBILE
129600040928     c
129700970514     C     §OGFRI        OREQ      '1'                                          NON VISIB. 1°LIV.
129800021029     C     VLPO          ANDEQ     '1'
129900040928     c
130000970514     C     §OGFRI        OREQ      '2'                                          NON VISIB. 1°LIV.
130100021029     C     VLPO          ANDEQ     '2'
130200030519     C                   SETON                                        73
130300020626     C                   ENDSL
130400020626      *
130500020626      * Caso T/V
130600080225x   4C                   ELSE
130700020626     C                   SELECT
130800040928     c* Protetto ma non per EDP
130900020626     C     §OGFRV        WHENEQ    'S'                                          PROTETTO
131000020626     C   40              SETON                                        71
131100021029      *
131200021029      * Protetto per tutti
131300020626     C     §OGFRV        WHENEQ    'T'
131400020626     C                   SETON                                        71
131500021029      *
131600021029      * Non visibile per tutti a parte per EDP per il quale
131700021029      * è comunque protetto
131800040928     C     §OGFRV        WHENEQ    'W'
131900020626     C   40              SETON                                        73        NON VISIBILE
132000020626     C  N40              SETON                                        71        PROTETTO
132100040928     c
132200050503     c* In gestione a EDPO non visibile per gli altri
132300040928     C     §OGFRV        WHENEQ    'Z'
132400040928     C   40              SETON                                        73        NON VISIBILE
132500021029      *
132600021029      * Non visibile
132700020626     C     §OGFRV        WHENEQ    'Y'                                          NON VISIBILE
132800030519     C                   SETON                                        73
132900050503      * visibile solo per il network LOG
133000050503     C     §OGFRV        WHENEQ    'L'                                          NON VISIBILE
133100050503     c                   if        vntw<>'LOG'
133200050503     C                   SETON                                        73
133300050503     c                   endif
133400050503     c
133500020626     C                   ENDSL
133600080225e   4C                   ENDIF
133700080225e   3C                   ENDDO
133800030521      *
133900030521      * CONTROLLO FLAGS DSOR
134000030521      * voce protetta
134100040928     C                   IF        *in88 and §ORFRI = 'S'
134200030521     C                   SETON                                        71
134300030521     C                   ENDIF
134400021029      *
134500080225if  3c                   if        not *in73
134600900329     C                   MOVEL     *BLANKS       SFRAG
134700900329     C                   MOVEL     *BLANKS       SFDES
134800900329     C                   Z-ADD     0             SFFIA
134900890525     C                   MOVEL     TBLKEY        SFCOD
135000080225     C                   Z-ADD     SFCOD         xa
135100040928     C                   MOVEL     tbluni        SFTAB
135200030521     C  n88              MOVEL     §OGSIG        SFSIG
135300090710     c* se 120, imposto il p.o. contabilità
135400090803     c  n40              if        xa=120
135500090710     c                   movel     vfcont        vcf(xa)
135600090710     c                   movel     vdfcont       vde(xa)
135700090710     c                   endif
135800080225     C                   MOVEL     VDE(xa)       SFRAG
135900080225     C                   MOVEL     VCF(xa)       SFFIA
136000900402     C   02
136100080225do  4COR 03              DO
136200040928     C                   Z-ADD     SFFIA         wFIL
136300040928     C     wfil          CHAIN(N)  AZORG                              36
136400900328     C  N36              MOVEL     ORGDES        SFDES
136500080225e   4C                   END
136600040928     c*
136700890525     C                   ADD       1             NRR
136800131017      * ind.71 memorizzato x il PROTECT
136900131017     c                   eval        HSF_IND71 = *in71
137000941115     C                   WRITE     SD15DSF
137100080225e   3C                   endif
137200080225e   2C                   endif
137300040928     c
137400080225     C     k02tabel      READE     TABEL                                  22
137500080225e   1C                   ENDdo
137600890525     C                   ENDSR
137700021029      **---------------------------------------------------
137800030430      ** Controlli Subfile
137900021029      **---------------------------------------------------
138000021029     C     CtrSfl        BEGSR
138100030430      *
138200080225     C  N88              MOVEL     'OG'          TBLcod
138300080225     C   88              MOVEL     'OR'          TBLcod
138400891124     C                   DO        *HIVAL        NRR
138500900330     C                   SETOFF                                       71
138600941115     C     NRR           CHAIN     SD15DSF                            06
138700900328     C   06              GOTO      ENDSF
138800080225     C                   MOVEL     *BLANKS       TBLkey
138900080225     C                   MOVEL     SFCOD         TBLkey
139000080225     C     k03tabel      CHAIN     TABEL                              23
139100030521     C  N23              DO
139200030521     C  N88              MOVEL     TBLUNI        DSOG
139300030521     C   88              MOVEL     TBLUNI        DSOR
139400030521     C                   ENDDO
139500021029      *
139600030521      * CONTROLLO FLAGS OBBLIGATORIETA'
139700021029      * Se la descrizione viene impostata uguale alla decodifica
139800021029      * salto i controlli di obbligatorietà
139900030521      *
140000030521      * CASO DSOG
140100030521      *
140200030521     C  n88              DO
140300020626     C     §OGFFI        IFNE      'S'
140400021029      * Caso F/A
140500020626     C                   IF        VTip = 'F' or VTip = 'A'
140600970514     C     §OGFOB        IFEQ      'S'                                          SEMPRE OBBL.
140700891120     C     SFRAG         ANDEQ     *BLANKS
140800970514     C     §OGFOB        OREQ      '1'
140900970514     C     SFRAG         ANDEQ     *BLANKS                                      OBBL.1°LIV.
141000021029     C     VLPO          ANDEQ     '1'
141100970514     C     §OGFOB        OREQ      '2'
141200970514     C     SFRAG         ANDEQ     *BLANKS                                      OBBL.1°LIV.
141300021029     C     VLPO          ANDEQ     '2'
141400900328     C                   SETON                                        7099
141500131017     c                   eval        *in71 = HSF_IND71
141600941115     C                   UPDATE    SD15DSF
141700900328     C                   GOTO      ENDSF
141800040928     c                   else
141900040928     c                   setoff                                       70
142000131017     c                   eval        *in71 = HSF_IND71
142100040928     C                   UPDATE    SD15DSF
142200970514     C                   ENDIF
142300020626      *
142400020626      * Caso T/V
142500020626     C                   ELSE
142600020626     C     §OGFOV        IFEQ      'S'                                          SEMPRE OBBL.
142700020626     C     SFRAG         ANDEQ     *BLANKS
142800050503     c* L-obbligatorio solo per network LOG
142900050503     C     §OGFOV        orEQ      'L'                                          SEMPRE OBBL.
143000050503     C     SFRAG         ANDEQ     *BLANKS
143100050503     c     vntw          andeq     'LOG'
143200020626     C                   SETON                                        7099
143300131017     c                   eval        *in71 = HSF_IND71
143400020626     C                   UPDATE    SD15DSF
143500020626     C                   GOTO      ENDSF
143600040928     c                   else
143700040928     c                   setoff                                       70
143800131017     c                   eval        *in71 = HSF_IND71
143900040928     C                   UPDATE    SD15DSF
144000020626     C                   ENDIF
144100020626     C                   ENDIF
144200020626     C                   ENDIF
144300030521     C                   ENDDO
144400030521      *
144500030521      * CASO DSOR
144600030521      *
144700030521     C   88              DO
144800030521     C     §ORFFI        IFNE      'S'
144900030521      *
145000030521     C                   IF        §ORFOB = 'S'  and SFRAG = *blanks            SEMPRE OBBL.
145100030521     C                   SETON                                        7099
145200131017     c                   eval        *in71 = HSF_IND71
145300030521     C                   UPDATE    SD15DSF
145400030521     C                   GOTO      ENDSF
145500030521     C                   ENDIF
145600030521     C                   ENDIF
145700030521     C                   ENDDO
145800020626      *
145900900329     C     SFFIA         IFNE      0
146000040928     C                   Z-ADD     SFFIA         wFIL
146100040928     C     wfil          CHAIN(N)  AZORG                              72
146200900402     C  N72              MOVEL     ORGDES        SFDES
146300040525     c* errore
146400900402     C   72              DO
146500900402     C                   SETON                                        99
146600131017     c                   eval        *in71 = HSF_IND71
146700941115     C                   UPDATE    SD15DSF
146800900402     C                   GOTO      ENDSF
146900900402     C                   END
147000890921     C                   END
147100900328     C                   END
147200030521      *
147300021105     C     ENDSF         TAG
147400021107     C  N99              Z-ADD     1             NRR
147500040928     c* Mi riposiziono sul mio azorg
147600040928     c                   if        not *in01
147700080225     c                   movel     vfil          §fil
147800080225     C     §fil          chain     AzOrg                              36
147900040928     C                   ENDIF
148000020625     C                   ENDSR
148100021029      *--------------------------------------------------
148200030430      * Aggiornamento/Scrittura AzOrg00f
148300021029      *--------------------------------------------------
148400021029     C     WRTFIL        BEGSR
148500040302      *
148600040302      * Riaggancio azorg con corretto P.O
148700080225     C                   MOVEL     VFIL          §FIL
148800080225     C  N88§FIL          CHAIN     AZORG                              36
148900080225     C   88§FIL          CHAIN     AZOSE                              36
149000040302     c**
149100040928    1c                   if        waggsfl='S'
149200080225     C                   Z-ADD     0             XB
149300080225     C  N88              MOVEL     'OG'          TBLcod
149400080225     C   88              MOVEL     'OR'          TBLcod
149500040928     c
149600040928    2C                   IF        NRR >0
149700080225    3C                   DO        *HIVAL        xa
149800080225     C     xa            CHAIN     SD15DSF                            06
149900890525     C   06              GOTO      ENDAGG
150000040928     c
150100080225     C                   MOVEL     *BLANKS       TBLkey
150200080225     C                   MOVEL     SFCOD         TBLkey
150300080225     C     k03tabel      CHAIN     TABEL                              36
150400040928    4C  N36              if        not *in36
150500030521     C  N88              MOVEL     TBLUNI        DSOG
150600030521     C   88              MOVEL     TBLUNI        DSOR
150700040928     c                   else
150800040928     c                   clear                   dsog
150900040928     c                   clear                   dsor
151000040928    4C                   endif
151100040928     c
151200030521     C  N88§OGFFI        COMP      'S'                                    10
151300030521     C   88§ORFFI        COMP      'S'                                    10
151400080225     C                   Z-ADD     SFCOD         XB
151500040928    4C     SFRAG         IFEQ      *BLANKS
151600080225     C                   MOVEL     SFRAG         VDE(xb)
151700080225     C                   Z-ADD     0             VCF(xb)
151800040928   x4C                   else
151900040928     c*
152000040928    5C   88SFFIA         IFEQ      0
152100040525     C                   Z-ADD     046           SFFIA
152200040928    5C                   END
152300040525     c
152400040928    5C     SFFIA         IFEQ      0
152500080225     C   10              MOVEL     VDESF         VDE(xb)
152600080225     C  N10              MOVEL     SFRAG         VDE(xb)
152700080225     C                   MOVEL     VFIL          VCF(xb)
152800900329     C                   ELSE
152900040928     C   10              Z-ADD     SFFIA         wfil
153000040928     C   10wfil          CHAIN(N)  AZORG                              36
153100080225     C   10              MOVEL     ORGDES        VDE(xb)
153200080225     C  N10              MOVEL     SFRAG         VDE(xb)
153300080225     C                   Z-ADD     SFFIA         VCF(xb)
153400040928    5C                   END
153500040928    4C                   END
153600040928    3C                   END
153700040928    2C                   ENDIF
153800040928     c
153900900328     C     ENDAGG        TAG
154000040525     c
154100040525      * Riaggancio azorg con corretto P.O
154200080225     C                   MOVEL     VFIL          §FIL
154300080225     C  N88§FIL          CHAIN     AZORG                              36
154400080225     C   88§FIL          CHAIN     AZOSE                              36
154500040928     c* Imposto i campi delle filiali e delle descrizioni
154600080225     C                   MOVEL     VDE           $DE
154700080225     C                   Z-ADD     VCF           $CF
154800040928    1c                   endif
154900040928     c
155000040928     c                   if        *in01
155100040928     c  n88              clear                   azorg
155200040928     c   88              clear                   azose
155300090709     c* Reiposto i campi delle filiali e delle descrizioni
155400090709    1c                   if        waggsfl='S'
155500090709     C                   MOVEL     VDE           $DE
155600090709     C                   Z-ADD     VCF           $CF
155700090709     c                   endif
155800130422     c                   clear                   og130
155900040928     c                   clear                   og140
156000040928     c                   clear                   og142
156100040928     c                   clear                   og143
156200040928     c                   clear                   og144
156300040928     c                   clear                   og146
156400040928     c                   clear                   og147
156500040928     c                   clear                   og148
156600040928     c                   clear                   og149
156700040928     c                   clear                   og150
156800040928     c                   endif
156900040928     c
157000900418     C                   MOVEL     VFIL          ORGFIL
157100900330     C                   MOVEL     *BLANKS       ORGFVA
157200021029      *
157300040928     C                   if        VTIP <>'T'
157400020724     C                   MOVEL     VTIP          ORGFAG
157500020724     C                   MOVEL     *blanks       ORGFL2
157600020724      *
157700040928     c                   else
157800020724     C                   MOVEL     'V'           ORGFAG
157900020724     C                   MOVEL     'S'           ORGFL2
158000040928     C                   endif
158100020724      *
158200900330     C                   MOVEL     VCTS          ORGCTS
158300900330     C                   MOVEL     VCAA          ORGCAA
158400910122     C                   MOVE      VCAR          ORGCAR
158500910122     C                   MOVE      VCRE          ORGCRE
158600900521     C                   MOVEL     VFLE          ORGFEL
158700090803     C  n40              MOVEL     VFcont        ORGFC0
158800090803     C  n40              MOVEL     Vdfcont       ORGdC0
158900971112     C                   MOVEL     VDIT          ORGDIT
159000900330     C                   MOVEL     VFL1          ORGFL1
159100900330     C                   MOVEL     VFL3          ORGFL3
159200900330     C                   MOVEL     VDESF         ORGDES
159300900330     C                   MOVEL     VINDF         ORGIND
159400900405     C                   Z-ADD     VCAPF         ORGCPF
159500900330     C                   MOVEL     VLOCF         ORGLOC
159600900330     C                   MOVEL     VPROF         ORGPRO
159700900330     C                   MOVEL     VTELF         ORGTEL
159800900330     C                   MOVEL     VFAXF         ORGFAX
159900900330     C                   MOVEL     VTLXF         ORGTLX
160000040928     c* no agenzia
160100040928     c                   if        *in80
160200900402     C                   MOVEL     *BLANKS       ORGDEA
160300900402     C                   MOVEL     *BLANKS       ORGINA
160400900402     C                   Z-ADD     0             ORGCPA
160500900402     C                   MOVEL     *BLANKS       ORGLOA
160600900402     C                   MOVEL     *BLANKS       ORGPRA
160700900402     C                   MOVEL     *BLANKS       ORGTEA
160800900402     C                   MOVEL     *BLANKS       ORGFAA
160900900402     C                   MOVEL     *BLANKS       ORGTLA
161000040928     C                   else
161100040928     c* si agenzia
161200900330     C                   MOVEL     VDESA         ORGDEA
161300900330     C                   MOVEL     VINDA         ORGINA
161400900405     C                   Z-ADD     VCAPA         ORGCPA
161500900330     C                   MOVEL     VLOCA         ORGLOA
161600900330     C                   MOVEL     VPROA         ORGPRA
161700900330     C                   MOVEL     VTELA         ORGTEA
161800900330     C                   MOVEL     VFAXA         ORGFAA
161900900330     C                   MOVEL     VTLXA         ORGTLA
162000900330     C                   END
162100900409     C                   MOVEL     *BLANKS       ORGFTR
162200020617     C                   Z-ADD     0             ORGNTR
162300040525     C
162400040525      * NON PER LA SEDE
162500040525     C                   IF        NOT *IN88
162600040525      * VALORIZZO LA 149° DESCRIZIONE
162700040525      * telefono diretto p.o.
162800040525     C                   MOVEL     VTELD         §OGTLD
162900040525     C                   MOVEL     OG149         ORGDE9
163000090709     c                   movel     orgfil        $cf(149)
163100040525      *
163200040525      * VALORIZZO LA 143° DESCRIZIONE
163300040525      * Dpd
163400040525     C                   MOVEL     VDPD          §OGDPD
163500040525      * NetWork
163600040525     C                   MOVEL     VNTW          §OGNTW
163700040525      * Poste
163800040525     C                   MOVEL     VPOS          §OGPT
163900040928     C* solo per EDP
164000040525     C                   IF        NOT *IN40
164100040525      * Hub
164200060426     c                   movel     vhub          §oghb1
164300040525      * Deposito
164400060426     c                   movel     vdpt          §ogdp1
164500131016      * Linea x Forzatura RESI
164600131017     c                   if        VLresi > *zeros
164700131016     c                   movel     VLresi        §OGLNARES
164800131017     c                   else
164900131017     c                   clear                   §OGLNARES
165000131017     c                   end
165100150430      * Filiale valida per linea di partenza bolla
165200150430     c                   if        VFlnpb > *zeros
165300150430     c                   movel     VFlnpb        §OGLNpb
165400150430     c                   else
165500150430     c                   clear                   §OGLNpb
165600150430     c                   end
165700040525      * Ambiente appartenenza
165800040525     C                   MOVE      VOGAS         §OGAS
165900071012     c* Cod. indirizzo IP
166000071012     c                   movel     vindip        §ogiip
166100040525     C                   ENDIF
166200040525     C
166300040525     C                   MOVEL     OG143         ORGDE3
166400080225     c                   movel     orgfil        $cf(143)
166500040526      *
166600040526      * VALORIZZO LA 148° DESCRIZIONE
166700040526     C                   MOVE      VLPO          §OGLPO
166800040928     C* Solo per EDP
166900040526     C                   IF        NOT *IN40
167000040526     C                   MOVEL     BARFD1        §OGBD1
167100040526     C                   MOVE      BARFD2        §OGBD2
167200100930     c* Linea per gestione materiale EDP
167300100929     C                   MOVE      Vlue          §OGlue
167400100930     c                   if        vfiue>*zeros
167500100930     c                   movel     vfiue         §OGfiue
167600110110     c                   else
167700110110     c                   clear                   §ogfiue
167800100930     c                   endif
167900100930      * Linea bollettazione
168000040526     C                   MOVE      VLBL          §OGLBL
168100040526      * Linea nei fogli viaggio
168200040526     C                   MOVE      VLFV          §OGLFV
168300040526      * Linea parallela
168400040526     C                   MOVE      VLPR          §OGLPR
168500040526      * P.O non esegue IDD
168600040526     C                   MOVE      VNID          §OGNID
168700040526      * P.O esegue IDD giorno dopo
168800040526     C                   MOVE      VEID          §OGEID
168900040526      * ORM avviata
169000040526     C                   MOVE      VORM          §OGORM
169100061227      * PDA ORM avviata
169200061227     c                   move      vpdaorm       §OGpdaorm
169300080206      * PDA CONSEGNE avviata
169400080206     c                   move      vpdacon       §OGpdacon
169500060828      * TELLUS attivata
169600060828     C                   MOVE      Vtlls         §OGTLLS
169700070301      * Flag avviamento gestione telefonate legate a GEO
169800070301     C                   MOVEL     VGEOT         §OGGEOT
169900040526      * Autogenerazione spunte
170000040526     C                   MOVE      *BLANKS       §OGAGP
170100040526     C                   MOVE      *BLANKS       §OGAGS
170200040526     C                   SELECT
170300040526      *  partenza con pistola 88
170400040526     C                   WHEN      VASP = 'S'
170500040526     C                   MOVE      *BLANKS       §OGAGP
170600040526     C                   MOVE      *BLANKS       §OGAGS
170700040526      *  partenza solo se Vdl/Cml
170800040526     C                   WHEN      VASPCV = 'S'
170900040526     C                   MOVE      *BLANKS       §OGAGP
171000040526     C                   MOVE      'E'           §OGAGS
171100040526      *  qualsiasi spunta entrata
171200040526     C                   WHEN      VASE = 'S'
171300040526     C                   MOVE      'P'           §OGAGP
171400040526     C                   MOVE      'E'           §OGAGS
171500040526     C                   ENDSL
171600040526     C                   ENDIF
171700040526     C
171800040526     C                   MOVEL     OG148         ORGDE8
171900080225     c                   movel     orgfil        $cf(148)
172000131108      * VALORIZZO LA 129° DESCRIZIONE
172100131108     c                   clear                   OG129
172200131108      * Orari filiale
172300131108     c                   eval      §OGorfmd = %editc(V02orfmd:'X')
172400131108     c                   eval      §OGorfma = %editc(V02orfma:'X')
172500131108     c                   eval      §OGorfpd = %editc(V02orfpd:'X')
172600131108     c                   eval      §OGorfpa = %editc(V02orfpa:'X')
172700131108     c                   eval      ORGdc9 = OG129
172800131108     c                   eval      $cf(129) = ORGfil
172900130422
173000130422      * VALORIZZO LA 130° DESCRIZIONE
173100130422     c                   clear                   OG130
173200130422      * Orari filiale
173300130423     c                   eval      §OGoramd = %editc(V02oramd:'X')
173400130423     c                   eval      §OGorama = %editc(V02orama:'X')
173500130423     c                   eval      §OGorapd = %editc(V02orapd:'X')
173600130423     c                   eval      §OGorapa = %editc(V02orapa:'X')
173700130422     c                   eval      ORGdd0 = OG130
173800130422     c                   eval      $cf(130) = ORGfil
173900130422
174000130514      * VALORIZZO LA 132° DESCRIZIONE
174100130422      * Assistenza Clienti
174200130422     c                   eval      ORGdd2 = V02ascm
174300130422     c                   eval      $cf(132) = ORGfil
174400130422
174500130422      * VALORIZZO LA 133° e 134° DESCRIZIONE
174600130422      * Assistenza Commerciale
174700130422     c                   eval      ORGdd3 = V02comt
174800130422     c                   eval      ORGdd4 = V02comm
174900130422     c                   eval      $cf(133) = ORGfil
175000130422     c                   eval      $cf(134) = ORGfil
175100040525     C
175200040525     C* LE DS LE VALORIZZO DAI CAMPI VIDEO SOLTANTO SE NON SONO EDP
175300040525     C                   IF        NOT *IN40
175400021106      *
175500021106      * VALORIZZO 140° DESCRIZIONE
175600021106      * Raggruppamento area
175700030521     C                   IF        VAra = *blanks
175800030521     C                   MOVE      *zeros        §OGARA
175900030521     C                   ELSE
176000021106     C                   MOVE      VARA          §OGARA
176100030521     C                   ENDIF
176200021106      * Ex area As/400
176300030521     C                   if        VAex = *blanks
176400030521     C                   MOVE      *zeros        §OGAEX
176500021107     C                   else
176600030521     C                   MOVE      VAex          §OGAEX
176700021107     C                   endif
176800021106      * Area POC
176900030521     C                   if        VApo = *blanks
177000030521     C                   MOVE      *zeros        §OGAPO
177100021107     C                   else
177200030521     C                   MOVE      VApo          §OGAPO
177300021107     C                   endif
177400151028      * Raggruppamento area centralino
177500151028     C                   IF        VArc = *blanks
177600151028     C                   MOVE      *zeros        §OGARC
177700151028     C                   ELSE
177800151028     C                   MOVE      VARC          §OGARC
177900151028     C                   ENDIF
178000021106     C                   MOVEL     OG140         ORGDE0
178100080225     c                   movel     orgfil        $cf(140)
178200050708      * VALORIZZO LA 141° DESCRIZIONE
178300050708     C                   CLEAR                   OG141
178400050708      * Code Faxin/Faxout
178500050708     C                   MOVE      VSSC          §OGSSC
178600050708     C                   MOVEL     OG141         ORGDE1
178700080225     c                   movel     orgfil        $cf(141)
178800021028      *
178900021029      * VALORIZZO LA 142° DESCRIZIONE
179000021028     C                   CLEAR                   OG142
179100021028      * Code Faxin/Faxout
179200021028     C                   MOVE      VFXI          §OGFXI
179300021028     C                   MOVE      VFXO          §OGFXO
179400021028     C                   MOVEL     OG142         ORGDE2
179500080225     c                   movel     orgfil        $cf(142)
179600020731      *
179700021029      * VALORIZZO LA 144° DESCRIZIONE
179800020731     C                   CLEAR                   OG144
179900020731      * Coda stampa da sede per P.O
180000020731     C                   MOVEL     VSSP          §OGSSP
180100020731     C                   MOVEL     OG144         ORGDE4
180200080225     c                   movel     orgfil        $cf(144)
180300020618      *
180400021029      * VALORIZZO LA 146° DESCRIZIONE
180500020618     C                   CLEAR                   OG146
180600040301     c* Date scanerizzazione
180700040301     c                   if        wdsd>0
180800040301     c                   move      wdsd          §ogdsd
180900040301     c                   endif
181000040301     c                   if        wdse>0
181100040301     c                   move      wdse          §ogdse
181200040301     c                   endif
181300070227     c* data inizio distinte automatiche
181400070227     c                   if        wdda>0
181500070227     c                   move      wdda          §ogdda
181600070227     c                   endif
181700020618     C                   MOVEL     OG146         ORGDE6
181800080225     c                   movel     orgfil        $cf(146)
181900020618      *
182000021029      * VALORIZZO LA 147° DESCRIZIONE
182100020618     C                   CLEAR                   OG147
182200030429      * Regione
182300030429     C                   MOVE      VRET          §OGRET
182400020618      * Creazione bolle in sede per posta
182500020618     C                   MOVEL     VNOC          §OGNOC
182600070828      * Flag attivazione richiesta data e ora limite abbinam. distinte autom
182700070828     c                   move      vdoada        §ogdoada
182800070828      * Flag attivazione richiesta tipo uscita distinte autom
182900070828     c                   move      vfppda        §ogfppda
183000070828      * Flag attivazione procedura Giri su ORM
183100070828     c                   move      vcgio         §ogcgio
183200070704      * Data inizio ditinte ORM automatiche
183300070704     c                   if        wddao > *zeros
183400070704     c                   move      wddao         §ogddao
183500070704     c                   endif
183600070926      * Flag attivazione richiesta tipo uscita distinte autom ORM
183700070926     c                   move      vfrtuo        §ogfrtuo
183800070926
183900021106     C                   MOVEL     OG147         ORGDE7
184000080225     c                   movel     orgfil        $cf(147)
184100020618      *
184200021029      * VALORIZZO LA 150° DESCRIZIONE
184300020618     C                   CLEAR                   OG150
184400021029      * Data utilizzo macchinone per volume
184500030521     C                   MOVEL     VVol          §OGVOL
184600021029      * Data utilizzo macchinone per peso
184700020618     C                   move      VPES          §OGPES
184800020618      * disk C
184900020618     C                   MOVE      Vdkc          §OGDKC
184901170227     C                   MOVE      Vdirdkc       §OGdkcdir
185000031016      * picking
185100031016     C                   MOVE      Vpck          §OGPCK
185200050509     C                   MOVE      Vpkm          §OGPkm
185300160506     C                   MOVE      Vturno        §OGturno
185400041213     C                   MOVE      Vtis          §OGtis
185500160531      * autogenerazione spunte uscita (per fil. con Picking NO VdL)
185600160531     C                   MOVE      Vagspus       §OGagspus
185700101215     c* IMA colli spuntati lna finale
185800101215     c                   move      Vimaa         §OGimaa
185900040301     c*
186000120924     C****               MOVE      Vspv          §OGspv
186100120924     C****               MOVE      Vspp          §OGspp
186200040517     C                   MOVE      Vsea          §OGsea
186300020618     C                   MOVEL     OG150         ORGDF0
186400080225     c                   movel     orgfil        $cf(150)
186500020618      *
186600040301      * Des. linea arrivo per stampa segnacollo
186700020618     C                   MOVEL     VASS          ORGDE5
186800040928     c
186900040928     c                   else
187000040928     c* per immissione imposto lo stesso del descrizioni vuote
187100040928     c                   if        *in01
187200040928     C                   MOVEL     OG140         ORGDE0
187300080225     c                   movel     orgfil        $cf(140)
187400060301     C                   MOVEL     OG141         ORGDE1
187500080225     c                   movel     orgfil        $cf(141)
187600040928     C                   MOVEL     OG142         ORGDE2
187700080225     c                   movel     orgfil        $cf(142)
187800040928     C                   MOVEL     OG143         ORGDE3
187900080225     c                   movel     orgfil        $cf(143)
188000040928     C                   MOVEL     OG144         ORGDE4
188100080225     c                   movel     orgfil        $cf(144)
188200040928     C                   MOVEL     OG146         ORGDE6
188300080225     c                   movel     orgfil        $cf(146)
188400040928     C                   MOVEL     OG147         ORGDE7
188500080225     c                   movel     orgfil        $cf(147)
188600040928     C                   MOVEL     OG148         ORGDE8
188700080225     c                   movel     orgfil        $cf(148)
188800040928     C                   MOVEL     OG149         ORGDE9
188900080225     c                   movel     orgfil        $cf(149)
189000040928     C                   MOVEL     OG150         ORGDF0
189100080225     c                   movel     orgfil        $cf(150)
189200040928     c                   endif
189300040928     c
189400040525     C                   ENDIF
189500040525     C                   ENDIF
189600020614     C
189700021029      *
189800920317     C   01
189900920317     CANN88              WRITE     AZORG
190000920317     C   02
190100920317     CANN88              UPDATE    AZORG
190200920317     C   01
190300920317     CAN 88              WRITE     AZOSE
190400920317     C   02
190500920317     CAN 88              UPDATE    AZOSE
190600920317     C   88              EXSR      AGGSED
190700900328     C                   ENDSR
190800021029      *------------------------------------------------------
190900030430      * Pulizia VIDEO 2
191000021029      *------------------------------------------------------
191100021029     C     PULVID2       BEGSR
191200030430      *
191300040924     C                   movel     *blanks       vfag
191400040924     C                   movel     *blanks       vdesf
191500030430     C                   movel     *blanks       vindf
191600030430     C                   z-add     0             vcapf
191700030430     C                   movel     *blanks       vlocf
191800030430     C                   movel     *blanks       vprof
191900030430     C                   movel     *blanks       vtlxf
192000030430     C                   movel     *blanks       vfaxf
192100030430     C                   movel     *BLANKS       VCAA
192200030430     C                   movel     *BLANKS       VTELF
192300030430     C                   movel     *BLANKS       VDESA
192400030430     C                   z-add     0             VCAPA
192500030430     C                   movel     *BLANKS       VLOCA
192600030430     C                   movel     *BLANKS       VPROA
192700030430     C                   movel     *BLANKS       VINDA
192800030430     C                   movel     *BLANKS       VTELA
192900030430     C                   movel     *BLANKS       VFAXA
193000030430     C                   movel     *blanks       vtlxa
193100040518     C                   movel     *blanks       vteld
193200030430     C                   movel     *blanks       vcts
193300030430     C                   move      *zeros        vcar
193400030430     C                   move      *zeros        vcre
193500030430     C                   movel     *blanks       vdcts
193600030430     C                   movel     *blanks       vdfl3
193700030430     C                   movel     *blanks       vdcar
193800030430     C                   movel     *blanks       vdcre
193900030430     C                   movel     *blanks       vlpo
194000030430     C                   movel     *blanks       vdlpo
194100030430     C                   movel     *blanks       vntw
194200100930     C                   movel     *blanks       vdntw
194300100929     C                   movel     *blanks       vlue
194400100930     C                   movel     *blanks       vfiue
194500100930     C                   movel     *blanks       vdfiue
194600030430     C                   movel     *blanks       vdit
194700030430     C                   movel     *blanks       vfl1
194800030430     C                   movel     *blanks       vfl3
194900030430     C                   movel     'N'           vdpd
195000030430     C                   movel     *blanks       vpos
195100040924     C                   movel     *blanks       vtfp
195200040924     C                   movel     *blanks       vdtfp
195300040924     C                   movel     *blanks       vtfa
195400040924     C                   movel     *blanks       vdtfa
195500071012     c                   clear                   vindip
195600030430      *
195700020614     C                   ENDSR
195800021029      *-----------------------------------------------------
195900030430      * Riempimento VIDEO 2
196000021029      *-----------------------------------------------------
196100040517     C     AGGVID2       BEGSR
196200100929     c                   setoff                                       19
196300040924     c
196400040924     c* Organigramma di sede
196500040924    1c                   if        *in88
196600040924     c                   eval      vfild=vfil
196700040924     C                   move      'F'           VTip
196800040928     c                   seton                                        80
196900040924    1c                   endif
197000040924     c
197100040924     c* Imposto e decodifico tipo p.o.
197200040924    1c                   if        not *in88
197300040924     c
197400040924    2C                   IF        VTip = *blanks
197500040924     C                   eval      VTip = OrgFag
197600040924     c* linea per tariffe
197700040924    3c                   if        orgfl2='S' and orgfag='V'
197800040924     c                   eval      vtip='T'
197900040924    3C                   ENDIF
198000040924    2C                   ENDIF
198100040924      * 80 off - agenzia
198200040924    2C                   IF        Vtip = 'F'or VTip = 'V' OR VTIP = 'T'
198300040924     C                   Eval      *in80 = *on
198400040924    2C                   ENDIF
198500100929     c* 19 on - se tipo "V" devo emettere scritta se linea per gestione unità EDP
198600100929    2C                   IF        Vtip = 'V'
198700100929     C                   Eval      *in19 = *on
198800100929    2C                   ENDIF
198900040924     c*
199000040924     C                   SELECT
199100040924     C     VTIP          WHENEQ    'F'
199200040924     C                   MOVEL     'FILIALE'     VFAG
199300040924     C     VTIP          WHENEQ    'A'
199400040924     C                   MOVEL     'AGENZIA'     VFAG
199500040924     C     VTIP          WHENEQ    'V'
199600040924     C                   MOVEL     'VARIE'       VFAG
199700040924     C     VTIP          WHENEQ    'T'
199800080225     C                   MOVEL     C_Ln_x_Tar    VFAG
199900040924     C                   ENDSL
200000040924    1c                   endif
200100040924     c* Se variazione, riempo tutti gli altri campi
200200040924     c
200300040924    1c                   if        not *in01
200400040924     c*
200500080225     C                   MOVEL     $DE           VDE
200600080225     C                   Z-ADD     $CF           VCF
200700030430      * Dati descrittivi
200800900328     C                   MOVEL     ORGDES        VDESF
200900900328     C                   MOVEL     ORGIND        VINDF
201000900328     C                   Z-ADD     ORGCPF        VCAPF
201100900328     C                   MOVEL     ORGLOC        VLOCF
201200900328     C                   MOVEL     ORGPRO        VPROF
201300900328     C                   MOVEL     ORGTEL        VTELF
201400900328     C                   MOVEL     ORGFAX        VFAXF
201500900328     C                   MOVEL     ORGTLX        VTLXF
201600030430      * telefono diretto P.O
201700040928     C                   movel     ORGDE9        Og149
201800040518     C                   movel     §OgTld        VTELD
201900030430      * Dati descrittivi per tipo <> 'F'
202000040924    2C  N80              DO
202100030430     C                   MOVEL     ORGDEA        VDESA
202200030430     C                   MOVEL     ORGINA        VINDA
202300030430     C                   Z-ADD     ORGCPA        VCAPA
202400030430     C                   MOVEL     ORGLOA        VLOCA
202500030430     C                   MOVEL     ORGPRA        VPROA
202600030430     C                   MOVEL     ORGTEA        VTELA
202700030430     C                   MOVEL     ORGFAA        VFAXA
202800030430     C                   MOVEL     ORGTLA        VTLXA
202900040924    2C                   END
203000040924     c* solo per organigramma di filiale
203100040924    2c                   if        not *in88
203200040924     c* Imposto tutte le ds "OGxxx"
203300040924     C                   MOVEL     ORGDE0        OG140
203400050708     C                   MOVEL     ORGDE1        OG141
203500040924     C                   MOVEL     ORGDE2        OG142
203600040924     C                   MOVEL     ORGDE3        OG143
203700040924     C                   MOVEL     ORGDE4        og144
203800040924     C                   MOVEL     ORGDE6        og146
203900040924     C                   MOVEL     ORGDE7        OG147
204000040924     C                   MOVEL     ORGDE8        OG148
204100040924     C                   MOVEL     ORGDF0        og150
204200030430      * tassazione
204300900328     C                   MOVEL     ORGCTS        VCTS
204400100125      * direzione commerciale
204500030430     C                   MOVEL     ORGFL3        VFL3
204600030430      * regione
204700910122     C                   MOVE      ORGCRE        VCRE
204800030430      * area
204900030430     C                   MOVE      ORGCAR        VCAR
205000021106      *
205100030430      * Livello P.O
205200021029     C                   MOVE      §OGLPO        VLPO
205300030430      * aspettativa aziendale
205400030430     C                   MOVEL     ORGCAA        VCAA
205500021028      * NetWork
205600020617     C                   MOVEL     §OGNTW        VNTW
205700100929     C                   MOVEL     §OGlue        Vlue
205800030430      * ramo aziendale
205900030430     C                   MOVEL     ORGDIT        VDIT
206000030430      * p.o italia/estero
206100030430     C                   MOVEL     ORGFL1        VFL1
206200020617      * Dpd
206300020617     C                   MOVEL     §OGDPD        VDPD
206400020617      * Poste
206500020617     C                   MOVEL     §OGPT         VPOS
206600071012      * Indirizzo IP
206700071012     c                   movel     §ogiip        vindip
206800040924     c
206900040924     c* Da fare solo per AZORG e non per AZOSE
207000040924     c* (della 2° videata c'e' soltanto l'indirizzo dell'azienda)
207100040924    2C                   EXSR      DecVid2
207200040924    1c                   endif
207300040924     c                   endif
207400030430      *
207500900328     C                   ENDSR
207600030430      *------------------------------------------------------
207700030430      * Decodifiche VIDEO 2
207800030430      *------------------------------------------------------
207900030430     C     DECVID2       BEGSR
208000030430      *
208100030430      * tassazione
208200080225     C                   movel     'CT'          TBLcod
208300080225     C                   movel     *blanks       TBLkey
208400080225     C                   movel     vcts          TBLkey
208500080225     C     k03tabel      chain     tabel                              36
208600030430     C  n36              movel     tbluni        vdcts
208700030430      *
208800100125      * direzione commerciale
208900080225     C                   movel     '17'          TBLcod
209000080225     C                   movel     *blanks       TBLkey
209100080225     C                   movel     vfl3          TBLkey
209200080225     C     k03tabel      chain     tabel                              36
209300030430     C  n36              movel     tbluni        vdfl3
209400030430      *
209500030430      * Regione
209600080225     C                   movel     '14'          TBLcod
209700080225     C                   movel     *blanks       TBLkey
209800080225     C                   movel     vcre          TBLkey
209900080225     C     k03tabel      chain     tabel                              36
210000030430     C  n36              movel     tbluni        vdcre
210100030430      *
210200030430      * area
210300080225     C                   movel     '05'          TBLcod
210400080225     C                   movel     *blanks       TBLkey
210500080225     C                   movel     vcar          TBLkey
210600080225     C     k03tabel      chain     tabel                              36
210700030430     C  n36              movel     tbluni        vdcar
210800030430      * Livello p.o
210900030430     C                   move      *blanks       vdlpo
211000030430     C                   SELECT
211100030430     C     vlpo          WHENEQ    *blanks
211200080225     C                   movel     C_NotOpe      vdlpo
211300030430     C     vlpo          WHENEQ    '1'
211400080225     C                   movel     C_1_Liv       vdlpo
211500030430     C     vlpo          WHENEQ    '2'
211600080225     C                   movel     C_2_liv       vdlpo
211700030430     C                   ENDSL
211800030430      * Network
211900030527     C                   IF        vntw <> *blanks
212000080225     C                   clear                   TIBS02ds
212100030430     C                   movel     'C'           T02mod
212200030430     C                   movel     knsif         T02sif
212300030430     C                   movel     'NTW'         T02cod
212400030430     C                   movel     *blanks       T02ke1
212500030505     C                   movel     vntw          T02ke1
212600030430     C                   CALL      'TIBS02R'
212700030430     C                   parm                    kpjba
212800080225     C                   parm                    TIBS02ds
212900030430      *
213000030430     C                   IF        t02err = *blanks
213100030430     C                   movel     t02uni        vdntw
213200030430     C                   ENDIF
213300030430     C                   ENDIF
213400030430      *
213500030430     C                   ENDSR
213600021029      *-----------------------------------------------------
213700030430      * Controlli VIDEO 2
213800021029      *-----------------------------------------------------
213900040518     C     CTRVID2       BEGSR
214000021029      *
214100021029      * descrizione filiale
214200030430     C                   IF        VDesF = *blanks
214300900328     C                   SETON                                        5298
214400030429     C                   GOTO      END2
214500900328     C                   END
214600021029      *
214700021029      * Per i tipo "V" e "T" non è obbligatorio indicare l'indirizzo
214800021029      * se però è stato immesso un solo campo l'ind. deve essere completo
214900020626     C                   move      *on           $CtrIndF          1
215000040924     C                   IF        Vtip='V' or  Vtip='T'
215100040924     C                   IF        VIndF=*blanks and VCapF=*zeros
215200020626     C                             and VlocF= *blanks and VProF= *blanks
215300020626     C                             and  VTelF =*blanks
215400020626     C                   move      *off          $CtrIndF          1
215500020625     C                   ENDIF
215600040924     C                   ENDIF
215700021029      * indirizzo filiale
215800020625     c                   IF        $CtrIndF =*on
215900030430     C                   IF        vindf = *blanks
216000900328     C                   SETON                                        5398
216100030429     C                   GOTO      END2
216200900328     C                   END
216300021029      * cap filiale
216400030430     C                   IF        vcapf = *zeros
216500900328     C                   SETON                                        5498
216600030429     C                   GOTO      END2
216700900328     C                   END
216800021029      * località filiale
216900030430     C                   IF        vlocf = *blanks
217000900328     C                   SETON                                        5598
217100030429     C                   GOTO      END2
217200900328     C                   END
217300021029      * provincia filaile
217400030430     C                   IF        vprof = *blanks
217500900329     C                   SETON                                        7898
217600030429     C                   GOTO      END2
217700900329     C                   END
217800090709      * telefono filiale
217900030430     C                   IF        vtelf = *blanks
218000900328     C                   SETON                                        5698
218100030429     C                   GOTO      END2
218200900328     C                   END
218300020625     C                   ENDIF
218400040924      * telefono diretto filiale
218500040518     C  n88              IF        vteld = *blanks
218600040518     C                   IF        vtip = 'F' or vtip='A'
218700040518     C                   SETON                                        7798
218800040518     C                   GOTO      END2
218900040518     C                   END
219000040518     C                   ENDIF
219100020625      *
219200020626     C  N80              DO
219300040924      * descrizione agenzia
219400030430     C                   IF        vdesa = *blanks
219500900330     C                   SETON                                        5898
219600030429     C                   GOTO      END2
219700900328     C                   END
219800030430     C                   IF        vdesa = vdesf
219900900330     C                   SETON                                        5798
220000030429     C                   GOTO      END2
220100900328     C                   END
220200021029      *
220300021029      * indirizzo agenzia
220400030430     C                   IF        vinda = *blanks
220500900328     C                   SETON                                        6198
220600030429     C                   GOTO      END2
220700900328     C                   END
220800021029      * cap agenzia
220900030430     C                   IF        vcapa = *zeros
221000900328     C                   SETON                                        5998
221100030429     C                   GOTO      END2
221200900328     C                   END
221300021029      * località agenzia
221400030430     C                   IF        Vloca = *blanks
221500900328     C                   SETON                                        6098
221600030429     C                   GOTO      END2
221700900328     C                   END
221800021029      * provincia agenzia
221900030430     C                   IF        vproa = *blanks
222000900329     C                   SETON                                        7998
222100030429     C                   GOTO      END2
222200900329     C                   END
222300021029      * telefono agenzia
222400030430     C                   IF        vtela = *blanks
222500900328     C                   SETON                                        6298
222600030429     C                   GOTO      END2
222700900328     C                   END
222800910220     C                   END                                                       N80
222900020801      *
223000021029      * Controlli e decodifiche da farsi se non elaboro azose
223100020801     C  N88              DO
223200020801      *
223300021029      * Codice di tassazione
223400020801     C                   MOVEL     *blanks       VDCTS
223500900328     C     VCTS          IFEQ      *BLANKS
223600900328     C                   SETON                                        6398
223700030429     C                   GOTO      END2
223800020801      *
223900020801     C                   ELSE
224000040924     C     '?'           scan      vcts                                   31
224100910122     C   31              DO
224200020801     C                   MOVE      *BLANKS       VCTS
224300120712     c                   clear                   TRTB09DS
224400120712     c                   eval      TB09fun = '1'
224500120712     c                   eval      TB09ord = '1'
224600120712     c                   eval      kpjbu = TRTB09DS
224700120712     c                   call      'TRTB09R'
224800120712     c                   parm                    kpjba
224900120712     c                   eval      TRTB09DS = kpjbu
225000120712     C                   if        TB09cod <> *blanks
225100120712     c                   eval      vcts  = TB09cod
225200120712     c                   eval      vdcts = TB09des
225300020801     C                   endif
225400090709     C                   SETON                                          9809
225500030429     C                   GOTO      END2
225600910306     C                   END
225700020801      *
225800020801      * decodifica piu' controllo
225900080225     C                   MOVEL     'CT'          TBLcod
226000080225     C                   MOVEL     *BLANKS       TBLkey
226100080225     C                   MOVEL     VCTS          TBLkey
226200080225     C     k03tabel      CHAIN     TABEL                              36
226300900402     C  N36              MOVEL     TBLUNI        VDCTS
226400900328     C   36              SETON                                        6398
226500030429     C   98              GOTO      END2
226600900328     C                   END
226700020801      *
226800100125      * codice direzione commerciale
226900020801     C                   MOVEL     *blanks       VDFL3
227000910306     C     VFL3          IFEQ      *BLANKS
227100910306     C                   SETON                                        6498
227200030429     C                   GOTO      END2
227300020801      *
227400910306     C                   ELSE
227500910306     C     VFL3          IFEQ      '?'
227600080225     C                   MOVEL     C_CodUt       §KUT
227700080225     C                   MOVEL     '17'          §COD
227800020801     C                   MOVE      *BLANKS       §key
227900020801     C                   MOVEL     *blanks       VFL3
228000910306     C                   CALL      'X§TABER'
228100910306     C                   PARM                    §KUT
228200080225     C                   PARM                    §COD
228300080225     C                   PARM                    §KEY
228400080225     C                   PARM                    §DES
228500020801     C                   if        §key <> *blanks
228600910306     C                   MOVEL     §KEY          VFL3
228700040526     C                   MOVEL     §DES          VDFL3
228800020801     C                   endif
228900090709     C                   SETON                                          9809
229000030429     C                   GOTO      END2
229100910306     C                   END
229200020801      * decodifiche piu' controlli
229300080225     C                   MOVEL     '17'          TBLcod
229400080225     C                   MOVEL     *BLANKS       TBLkey
229500080225     C                   MOVEL     VFL3          TBLkey
229600080225     C     k03tabel      CHAIN     TABEL                              36
229700910306     C  N36              MOVEL     TBLUNI        VDFL3
229800910306     C   36              SETON                                        6498
229900030429     C   98              GOTO      END2
230000910306     C                   END
230100030403      *
230200030403      * codice regione
230300030403     C                   MOVEL     *blanks       VDCRE
230400030403     C     VCRE          IFEQ      *BLANKS
230500030403     C                   SETON                                        8598
230600030429     C                   GOTO      END2
230700030403      *
230800030403     C                   ELSE
230900040924     C     '?'           scan      Vcre                                   31
231000030403     C   31              DO
231100080225     C                   MOVEL     C_CodUt       §KUT
231200080225     C                   MOVEL     '14'          §COD
231300030403     C                   MOVE      *BLANKS       §key
231400030403     C                   MOVE      *BLANKS       VCRE
231500030403     C                   CALL      'X§TABER'
231600030403     C                   PARM                    §KUT
231700080225     C                   PARM                    §COD
231800080225     C                   PARM                    §KEY
231900080225     C                   PARM                    §DES
232000030403     C                   if        §key <> *blanks
232100030403     C                   MOVEL     §KEY          VCRE
232200040526     C                   MOVEL     §DES          VDCRE
232300030403     C                   endif
232400090709     C                   SETON                                          9809
232500030429     C                   GOTO      END2
232600030403     C                   END
232700030403      *decodifica e controllo
232800080225     C                   MOVEL     '14'          TBLcod
232900080225     C                   MOVEL     *BLANKS       TBLkey
233000080225     C                   MOVEL     VCRE          TBLkey
233100080225     C     k03tabel      CHAIN     TABEL                              36
233200030403     C  N36              MOVEL     TBLUNI        VDCRE
233300030403     C   36              SETON                                        8598
233400030429     C   98              GOTO      END2
233500030403     C                   END
233600020801      *
233700021029      * codice area
233800020801     C                   MOVEL     *blanks       VDCAR
233900910122     C     VCAR          IFEQ      *BLANKS
234000900405     C                   SETON                                        8498
234100030429     C                   GOTO      END2
234200020801      *
234300900405     C                   ELSE
234400040924     C     '?'           scan      Vcar                                   31
234500910122     C   31              DO
234600080225     C                   MOVEL     C_CodUt       §KUT
234700080225     C                   MOVEL     '05'          §COD
234800020801     C                   MOVE      *BLANKS       §key
234900020801     C                   MOVEL     *blanks       VCAR
235000910122     C                   CALL      'X§TABER'
235100910122     C                   PARM                    §KUT
235200080225     C                   PARM                    §COD
235300080225     C                   PARM                    §KEY
235400080225     C                   PARM                    §DES
235500020801     C                   if        §key <> *blanks
235600910122     C                   MOVEL     §KEY          VCAR
235700040526     C                   MOVEL     §DES          VDCAR
235800020801     C                   endif
235900090709     C                   SETON                                          9809
236000030429     C                   GOTO      END2
236100021029     C                   END
236200020801      * decodifica e controllo
236300080225     C                   MOVEL     '05'          TBLcod
236400080225     C                   MOVEL     *BLANKS       TBLkey
236500080225     C                   MOVEL     VCAR          TBLkey
236600080225     C     k03tabel      CHAIN     TABEL                              36
236700900405     C  N36              MOVEL     TBLUNI        VDCAR
236800900405     C   36              SETON                                        8498
236900030429     C   98              GOTO      END2
237000910220     C                   END
237100071012      * indirizzo IP
237200071012     c                   if        vindip<>*blanks
237300071015     c                             and vindip<=*zeros or vindip>'254'
237400071015     C                   SETON                                        2998
237500071012     c                   goto      end2
237600071012     c                   endif
237700040924      *
237800040924      * Tipo P.O per V/T puo' solo essere a *blanks
237900040924     C                   IF        Vtip = 'V' and VLpo <> ' ' or
238000040924     C                             Vtip = 'T' and VLpo <> ' '
238100040924     C                   SETON                                        4198
238200040924     C                   GOTO      END2
238300040924     C                   ENDIF
238400021029      *
238500040924      * Decodifica Tipo P.O
238600030404     C                   MOVE      *BLANKS       VDLpo
238700030404     C                   SELECT
238800030404     C     VLPO          WHENEQ    *blanks
238900080225     C                   MOVEL     C_NotOpe      VDLpo
239000030404     C     VLPO          WHENEQ    '1'
239100080225     C                   MOVEL     C_1_Liv       VDLpo
239200030404     C     VLPO          WHENEQ    '2'
239300080225     C                   MOVEL     C_2_liv       VDLpo
239400030404     C                   ENDSL
239500021029      *
239600021029      * Network
239700020617     C                   MOVEL     *blanks       VDNTW
239800020617     C     VNTW          IFEQ      *BLANKS
239900020617     C                   SETON                                        6598
240000030429     C                   GOTO      END2
240100020617     C                   ELSE
240200020617     C     '?'           SCAN      VNTW                                   31
240300020617     C   31              DO
240400020617      * PER RIEMETTERE IL VIDEO ALMENO UNA VOLTA DOPO LE RICERCHE
240500090709     C                   SETON                                        9809
240600080225     C                   CLEAR                   TIBS02ds
240700020617     C                   MOVEL     'R'           T02MOD
240800020617     C                   MOVEL     KNSIF         T02SIF
240900020617     C                   MOVEL     'NTW'         T02COD
241000020617     C                   CALL      'TIBS02R'
241100020617     C                   PARM                    KPJBA
241200080225     C                   PARM                    TIBS02ds
241300020617     C     T02ERR        IFEQ      *BLANKS
241400020617     C                   MOVEL     T02KE1        VNTW
241500020617     C                   ENDIF
241600090709     c
241700090709     C                   GOTO      END2
241800020617     C                   ENDDO
241900020617     C                   ENDIF
242000021029      *
242100021029      * controllo validità network
242200030526     C                   MOVEL     *blanks       vdntw
242300030527     C                   IF        vntw <> *blanks
242400080225     C                   CLEAR                   TIBS02ds
242500020617     C                   MOVEL     'C'           T02MOD
242600020617     C                   MOVEL     KNSIF         T02SIF
242700020617     C                   MOVEL     'NTW'         T02COD
242800020617     C                   MOVEL     *BLANKS       T02KE1
242900020617     C                   MOVEL     VNTW          T02KE1
243000020617     C                   CALL      'TIBS02R'
243100020617     C                   PARM                    KPJBA
243200080225     C                   PARM                    TIBS02ds
243300020617      *
243400020617     C     T02ERR        IFNE      *BLANKS
243500020617     C                   SETON                                        6698
243600030429     C                   GOTO      END2
243700020617     C                   ELSE
243800020617     C                   MOVEL     T02UNI        VDNTW
243900020617     C                   ENDIF
244000020617     C                   ENDIF
244100040518     c
244200040518     C                   END
244300020625      *
244400040924     C     end2          ENDSR
244500130422      *------------------------------------------------------
244600130422      * Pulizia VIDEO 2a
244700130422      *------------------------------------------------------
244800130422     C     PULVID21      BEGSR
244900130422
245000130422     c                   clear                   H2riga
245100130422     c                   clear                   H2colo
245200130422     c                   clear                   V02oramd
245300130422     c                   clear                   V02orama
245400130422     c                   clear                   V02orapd
245500130422     c                   clear                   V02orapa
245600130422     c                   clear                   V02ascm
245700130422     c                   clear                   V02comt
245800130422     c                   clear                   V02comm
245900131108     c                   clear                   V02orfmd
246000131108     c                   clear                   V02orfma
246100131108     c                   clear                   V02orfpd
246200131108     c                   clear                   V02orfpa
246300130422
246400130422     C                   ENDSR
246500130422      *-----------------------------------------------------
246600130422      * Riempimento VIDEO 2a
246700130422      *-----------------------------------------------------
246800130422     C     AGGVID21      BEGSR
246900130423
247000130423      * Non visualizzo alcuni dati per filiali di secondo livello
247100130423     c                   eval      *in28 = (vlpo <> '1')
247200130422
247300130422      * Se variazione imposto i campi
247400130422     c                   IF        not *in01
247500130422     c                   eval      OG130 = ORGdd0
247600130423     c                   IF        §OGoramd <> *blanks
247700130423     c                   eval      V02oramd = %int(§OGoramd)
247800130423     c                   ELSE
247900130423     c                   clear                   V02oramd
248000130423     c                   ENDIF
248100130423     c                   IF        §OGorama <> *blanks
248200130423     c                   eval      V02orama = %int(§OGorama)
248300130423     c                   ELSE
248400130423     c                   clear                   V02orama
248500130423     c                   ENDIF
248600130423     c                   IF        §OGorapd <> *blanks
248700130423     c                   eval      V02orapd = %int(§OGorapd)
248800130423     c                   ELSE
248900130423     c                   clear                   V02orapd
249000130423     c                   ENDIF
249100130423     c                   IF        §OGorapa <> *blanks
249200130423     c                   eval      V02orapa = %int(§OGorapa)
249300130423     c                   ELSE
249400130423     c                   clear                   V02orapa
249500130423     c                   ENDIF
249600130422     c                   eval      V02ascm = ORGdd2
249700130422     c                   eval      V02comt = ORGdd3
249800130422     c                   eval      V02comm = ORGdd4
249900131108     c                   eval      OG129 = ORGdc9
250000131108     c                   IF        §OGorfmd <> *blanks
250100131108     c                   eval      V02orfmd = %int(§OGorfmd)
250200131108     c                   ELSE
250300131108     c                   clear                   V02orfmd
250400131108     c                   ENDIF
250500131108     c                   IF        §OGorfma <> *blanks
250600131108     c                   eval      V02orfma = %int(§OGorfma)
250700131108     c                   ELSE
250800131108     c                   clear                   V02orfma
250900131108     c                   ENDIF
251000131108     c                   IF        §OGorfpd <> *blanks
251100131108     c                   eval      V02orfpd = %int(§OGorfpd)
251200131108     c                   ELSE
251300131108     c                   clear                   V02orfpd
251400131108     c                   ENDIF
251500131108     c                   IF        §OGorfpa <> *blanks
251600131108     c                   eval      V02orfpa = %int(§OGorfpa)
251700131108     c                   ELSE
251800131108     c                   clear                   V02orfpa
251900131108     c                   ENDIF
252000130422     c                   ENDIF
252100130422
252200130422     C                   ENDSR
252300130422      *-----------------------------------------------------
252400130422      * Controlli VIDEO 2a
252500130422      *-----------------------------------------------------
252600130422     C     CTRVID21      BEGSR
252700130423
252800131108     c                   clear                   H2riga
252900131108     c                   clear                   H2colo
253000130423      * controllo solo per primo e secondo livello
253100131113     c***                IF        vlpo = *blanks
253200131113     c***                leavesr
253300131113     c***                ENDIF
253400130422
253500130422      * Controllo che gli orari immessi siano validi
253600131113     c                   IF        (V02oramd<1 and vlpo<>*blanks)
253700131113     c                             or V02oramd>2359
253800130423     c                   eval      *in11 = *on
253900131113     c                   eval      H2riga = 10
254000130527     c                   eval      H2colo = 08
254100130423     c                   eval      V02msg = 'Orario errato'
254200130423     c                   leavesr
254300130423     c                   ENDIF
254400130423
254500131113     c                   IF        (V02orama < 1 and vlpo<>*blanks)
254600131113     c                             or V02orama > 2359
254700130423     c                   eval      *in11 = *on
254800131113     c                   eval      H2riga = 10
254900130527     c                   eval      H2colo = 19
255000130423     c                   eval      V02msg = 'Orario errato'
255100130423     c                   leavesr
255200130423     c                   ENDIF
255300131113      * l'ora dalle del mattino non può essere superiore dell'ora alle del mattino
255400131113     c                   if        v02oramd>v02orama
255500131113     c                   eval      *in11 = *on
255600131113     c                   eval      H2riga = 10
255700131113     c                   eval      H2colo = 19
255800131113     c                   if        v02orama=0
255900131113     c                   eval      V02msg = 'Orario errato'
256000131113     c                   else
256100131113     c                   eval      V02msg = 'Orario "dalle" non congruente con +
256200131113     c                             orario "alle"'
256300131113     c                   endif
256400131113     c                   leavesr
256500131113     c                   endif
256600130423
256700130524      * l'ora dalle del pomeriggio non può essere minore dell'ora alle del mattino
256800130524     c                   IF        V02orapd > 0 and V02orapd < V02orama
256900130524     c                   eval      *in11 = *on
257000131113     c                   eval      H2riga = 10
257100130524     c                   eval      H2colo = 35
257200131113     c                   eval      V02msg = 'Orario non congruente con quello +
257300131113     c                             del mattino'
257400130524     c                   leavesr
257500130524     c                   ENDIF
257600130524
257700130524     c                   IF        V02orapd > 0
257800130423     c                   IF        V02orapd < 1 or V02orapd > 2359
257900130423     c                   eval      *in11 = *on
258000131113     c                   eval      H2riga = 10
258100130423     c                   eval      H2colo = 35
258200130423     c                   eval      V02msg = 'Orario errato'
258300130423     c                   leavesr
258400130423     c                   ENDIF
258500130524     c                   ENDIF
258600130423
258700130527     c                   IF        V02orapd > 0 and V02orapa = 0
258800130527     c                   eval      *in11 = *on
258900131113     c                   eval      H2riga = 10
259000130527     c                   eval      H2colo = 46
259100130527     c                   eval      V02msg = 'Orario errato'
259200130527     c                   leavesr
259300130527     c                   ENDIF
259400130524     c                   IF        V02orapa > 0
259500130423     c                   IF        V02orapa < 1 or V02orapa > 2359
259600130423     c                   eval      *in11 = *on
259700131113     c                   eval      H2riga = 10
259800130423     c                   eval      H2colo = 46
259900130423     c                   eval      V02msg = 'Orario errato'
260000130423     c                   leavesr
260100130423     c                   ENDIF
260200130524     c                   ENDIF
260300131113      * l'ora dalle del pomeriggio non può essere superiore dell'ora alle del pom
260400131113     c                   if        v02orapd>v02orapa
260500131113     c                   eval      *in11 = *on
260600131113     c                   eval      H2riga = 10
260700131113     c                   eval      H2colo = 46
260800131113     c                   if        v02orapa=0
260900131113     c                   eval      V02msg = 'Orario errato'
261000131113     c                   else
261100131113     c                   eval      V02msg = 'Orario "dalle" non congruente con +
261200131113     c                             orario "alle"'
261300131113     c                   endif
261400131113     c                   leavesr
261500131113     c                   endif
261600130422
261700130422      * Controllo gli indirizzi e-mail
261800130422     c                   IF        V02ascm <> *blanks
261900130422     c                   clear                   dsemail
262000130422     c                   eval      §emlindi = %trim(V02ascm) + %trim('@brt.it')
262100130422     c                   call      'XEMAIL'
262200130422     c                   parm                    dsemail
262300130422if  3c                   IF        §emlerro <> '0'
262400130422     c                   eval      *in11 = *on
262500130422     c                   eval      H2riga = 11
262600130422     c                   eval      H2colo = 29
262700130422     c                   Eval      V02msg = §emlmsgo
262800130422     c                   leavesr
262900130422     c                   ENDIF
263000130422     c                   ENDIF
263100130422
263200130422     c                   IF        V02comm <> *blanks
263300130422     c                   clear                   dsemail
263400130422     c                   eval      §emlindi = %trim(V02comm) + %trim('@brt.it')
263500130422     c                   call      'XEMAIL'
263600130422     c                   parm                    dsemail
263700130422if  3c                   IF        §emlerro <> '0'
263800130422     c                   eval      *in11 = *on
263900130422     c                   eval      H2riga = 15
264000130422     c                   eval      H2colo = 29
264100130422     c                   Eval      V02msg = §emlmsgo
264200130422     c                   leavesr
264300130422     c                   ENDIF
264400130422     c                   ENDIF
264500131108      * ORARIO DI FILIALE
264600131108      * Controllo che gli orari immessi siano validi
264700131120     c                   IF        (V02orfmd<1 and vlpo<>*blanks
264800131120     c                             and vlpo=*blanks)
264900131113     c                             or V02orfmd > 2359
265000131108     c                   eval      *in11 = *on
265100131113     c                   eval      H2riga = 07
265200131108     c                   eval      H2colo = 08
265300131108     c                   eval      V02msg = 'Orario errato'
265400131108     c                   leavesr
265500131108     c                   ENDIF
265600131108
265700131120     c                   IF        (V02orfma < 1 and vlpo<>*blanks
265800131120     c                             and vlpo=*blanks)
265900131113     c                             or V02orfma > 2359
266000131108     c                   eval      *in11 = *on
266100131113     c                   eval      H2riga = 07
266200131108     c                   eval      H2colo = 19
266300131108     c                   eval      V02msg = 'Orario errato'
266400131108     c                   leavesr
266500131108     c                   ENDIF
266600131113      * l'ora dalle non può essere superiore dell'ora alle
266700131113     c                   if        v02orfmd>v02orfma
266800131113     c                   eval      *in11 = *on
266900131113     c                   eval      H2riga = 07
267000131113     c                   eval      H2colo = 19
267100131113     c                   if        v02orfma=0
267200131113     c                   eval      V02msg = 'Orario errato'
267300131113     c                   else
267400131113     c                   eval      V02msg = 'Orario "dalle" non congruente con +
267500131113     c                             orario "alle"'
267600131113     c                   endif
267700131113     c                   leavesr
267800131113     c                   endif
267900131108
268000131108      * l'ora dalle del pomeriggio non può essere minore dell'ora alle del mattino
268100131108     c                   IF        V02orfpd > 0 and V02orfpd < V02orfma
268200131108     c                   eval      *in11 = *on
268300131113     c                   eval      H2riga = 07
268400131108     c                   eval      H2colo = 35
268500131113     c                   eval      V02msg = 'Orario non congruente con quello +
268600131113     c                             del mattino'
268700131108     c                   leavesr
268800131108     c                   ENDIF
268900131108
269000131108     c                   IF        V02orfpd > 0
269100131108     c                   IF        V02orfpd < 1 or V02orfpd > 2359
269200131108     c                   eval      *in11 = *on
269300131113     c                   eval      H2riga = 07
269400131108     c                   eval      H2colo = 35
269500131108     c                   eval      V02msg = 'Orario errato'
269600131108     c                   leavesr
269700131108     c                   ENDIF
269800131108     c                   ENDIF
269900131108
270000131108     c                   IF        V02orfpd > 0 and V02orfpa = 0
270100131108     c                   eval      *in11 = *on
270200131113     c                   eval      H2riga = 07
270300131108     c                   eval      H2colo = 46
270400131108     c                   eval      V02msg = 'Orario errato'
270500131108     c                   leavesr
270600131108     c                   ENDIF
270700131108     c                   IF        V02orfpa > 0
270800131108     c                   IF        V02orfpa < 1 or V02orfpa > 2359
270900131108     c                   eval      *in11 = *on
271000131113     c                   eval      H2riga = 07
271100131108     c                   eval      H2colo = 46
271200131108     c                   eval      V02msg = 'Orario errato'
271300131108     c                   leavesr
271400131108     c                   ENDIF
271500131108     c                   ENDIF
271600131113      * l'ora dalle non può essere superiore dell'ora alle
271700131113     c                   if        v02orfpd>v02orfpa
271800131113     c                   eval      *in11 = *on
271900131113     c                   eval      H2riga = 07
272000131113     c                   eval      H2colo = 46
272100131113     c                   if        v02orfpa=0
272200131113     c                   eval      V02msg = 'Orario errato'
272300131113     c                   else
272400131113     c                   eval      V02msg = 'Orario "dalle" non congruente con +
272500131113     c                             orario "alle"'
272600131113     c                   endif
272700131113     c                   leavesr
272800131113     c                   endif
272900130422
273000130422     C                   ENDSR
273100021029      *----------------------------------------------------
273200030430      * Puliza  VIDEO 3
273300021029      *----------------------------------------------------
273400021029     C     PULVID3       BEGSR
273500040302     c                   exsr      offd03
273600040924      *
273700040924     C                   movel     *blanks       vdfle
273800040928     C                   z-add     046           vfle
273900030430     C                   move      *blanks       vara
274000040302     C                   move      *blanks       vdara
274100030430     C                   MOVE      *blanks       vapo
274200030430     C                   MOVEL     *blanks       vdapo
274300030430     C                   MOVE      *blanks       vaex
274400030430     C                   MOVEL     *blanks       vdaex
274500151028     C                   clear                   vARC
274600151028     C                   clear                   vdARC
274700040302     C                   MOVEL     *blanks       vdogas
274800060828     C                   movel     *blanks       Vfxi
274900060828     C                   movel     *blanks       Vfxo
275000060828     C                   movel     *blanks       Vssp
275100060828     C                   movel     *blanks       Vssc
275200100930     C                   movel     *blanks       Vfiue
275300100930     C                   movel     *blanks       Vdfiue
275400030429      * per i tipi V propongo 046
275500040928     C                   IF        VTip <> 'V' and vtip<>'T'
275600040928     C                   move      946           vogas
275700030429     C                   ELSE
275800030430     C                   z-add     046           vogas
275900030429     C                   ENDIF
276000030430     C                   movel     *blanks       vhub
276100030430     C                   movel     *blanks       vdpt
276200131016     C                   movel     *zeros        vlRESI
276300131016     C                   movel     *blanks       vlRESId
276400150430     C                   movel     *zeros        vflnpb
276500150430     C                   movel     *blanks       vdlnpb
276600090709     C                   z-add     046           vfcont
276700090709     C                   movel     *blanks       vdfcont
276800030429      *
276900030429      * Dati per tariffe
277000030430     C                   movel     *blanks       barfd1
277100030430     C                   movel     *blanks       barfd2
277200030430     C                   move      *zeros        vret
277300030430     C                   movel     *blanks       vdret
277400030430      *
277500020614     C                   ENDSR
277600021029      *------------------------
277700030430      * Riempimento VIDEO 3
277800021029      *------------------------
277900021029     C     AGGVID3       BEGSR
278000040924     c* descrizione p.o.
278100040924     C                   EVAL      VDFil = VDesF
278200040924      * p.o elaboratore
278300040924     C                   MOVEL     ORGFEL        VFLE
278400100930     c* filiale invio materiale EDP
278500100930     C                   MOVEL     §OGfiue       Vfiue
278600030429      *
278700030429      * Raggruppamento area/area ex as400/area POC
278800030521      *
278900030521     C                   if        §OGARA <> *zeros
279000030430     C                   MOVE      §OGARA        VARA
279100030521     C                   endif
279200030521      *
279300030521     C                   if        §OGAEX <> *zeros
279400030521     C                   MOVE      §OGAEX        VAEX
279500030521     C                   endif
279600030521      *
279700030521     C                   if        §OGAPO <> *zeros
279800030521     C                   MOVE      §OGAPO        VAPO
279900030521     C                   endif
280000151028      *
280100151028     C                   if        §ogARC <> *zeros
280200151028     C                   move      §ogARC        vARC
280300151028     C                   endif
280400030429      * Hub
280500060426     C***                if        §OGHUB <> *blanks and §oghub<>*zeros
280600060426     C***                MOVE      §OGHUB        VHUB
280700060426     C***                endif
280800060426     C                   if        §OGHb1 <> *blanks
280900060426     C                   MOVE      §OGHb1        VHUB
281000060426     C                   endif
281100030429      * Deposito
281200060426     C***                if        §OGDPT <> *blanks and §ogdpt<>*zeros
281300060426     C***                MOVE      §OGDPT        VDPT
281400060426     C***                endif
281500060426     C                   if        §OGDP1 <> *blanks
281600060426     C                   MOVE      §OGDP1        VDPT
281700060426     C                   endif
281800131016      * Linea x Forzare i RESI
281900131016     C                   if        §OGLNARES  <> *blanks
282000131016     C                   MOVE      §OGLNARES     VLRESI
282100131016     C                   endif
282200150430      * Filiale valida per linea di partenza bolla
282300150430     C                   if        §OGLNPB    <> *blanks
282400150430     C                   MOVE      §OGLNPB       VFlnpb
282500150430     C                   endif
282600070226      * p.o contabilità
282700090709     C                   MOVEL     ORGFC0        VFcont
282800030429      * Ambiente appartenenza
282900030430     C                   MOVEL     §OGAS         VOGAS
283000030429      * Regione
283100030429     C                   MOVE      §ogret        Vret
283200030429      * Stampa P.O nei terminals
283300030429     C                   MOVE      §OGBD1        BARFD1
283400030429     C                   MOVE      §OGBD2        BARFD2
283500060828      * Code Faxin/Faxout
283600060828     C                   MOVE      §OGFXI        VFXI
283700060828     C                   MOVE      §OGFXO        VFXO
283800060828      * Code stampa sede per P.O
283900060828     C                   MOVE      §ogssp        Vssp
284000060828      * Code stampa sede per Commerciale P.O
284100060828     C                   MOVE      §ogssc        Vssc
284200040924     c* Decodifiche
284300040924     C                   EXSR      DecVid3
284400020614     C                   ENDSR
284500020618     C**------------------------
284600021029     C** DECODIFICHE VIDEO 3
284700020618     C**------------------------
284800021029     C     DECVID3       BEGSR
284900040924      *
285000040924      * p.o elaboratore
285100040924     C                   IF        vfle > *ZERO
285200040924     C     vfle          chain(N)  azorg                              36
285300040924     C  n36              movel     orgdes        vdfle
285400040924     C                   END
285500131016      *
285600131016      * p.o LINEA Forzatura RESI
285700131016     C                   IF        vlRESI > *ZERO
285800131016     C     vlRESI        chain(N)  azorg                              36
285900131016     C  n36              movel     orgdes        vlRESId
286000131016     C                   END
286100150430      * filiale valida come linea di partenza bolla
286200150430     C                   IF        vflnpb > *ZERO
286300150430     C     vflnpb        chain(N)  azorg                              36
286400150430     C  n36              movel     orgdes        vdlnpb
286500150430     C                   END
286600030430      *
286700070226      * p.o contabilità
286800090709     C                   IF        vfcont > *ZERO
286900090709     C     vfcont        chain(N)  azorg                              36
287000090709     C  n36              movel     orgdes        vdfcont
287100070226     C                   END
287200100930      * fil invio materiale EDP
287300100930     C                   IF        vfiue> *ZERO
287400100930     C                   move      vfiue         wfil
287500100930     C     wfil          chain(N)  azorg                              36
287600100930     C  n36              movel     orgdes        vdfiue
287700100930     C                   END
287800030430      * Area ex As400
287900030430     C                   IF        vaex > *zeros
288000080225     C                   move      vaex          wfil
288100040924     C     wfil          chain(N)  AzOrg                              36
288200040924     C  N36              movel     orgdes        vdaex
288300030430     C                   ENDIF
288400030430      *
288500030430      * area POC
288600030430     C                   IF        vapo > *zeros
288700080225     C                   move      vapo          wfil
288800040924     C     wfil          chain(N)  AzOrg                              36
288900040924     C  N36              movel     orgdes        vdapo
289000030430     C                   ENDIF
289100020619      *
289200030430      * Regione ai fini tariffari
289300040302     C                   IF        vret > *zeros
289400040924     C                   move      vret          wfil
289500040924     C     wfil          chain(N)  AzOrg                              36
289600040924     C  n36              movel     OrgDes        vdret
289700040302     c                   endif
289800040302      *
289900040302      * ambiente appartenenza
290000040302     C                   IF        vogas> *zeros
290100080225     C                   move      vogas         wfil
290200040924     C     wfil          chain(N)  AzOrg                              36
290300040924     C  N36              movel     orgdes        vdogas
290400040302     C                   ENDIF
290500040302     c* Raggruppamento area
290600040302     c                   if        vara<>*blanks
290700080225     C                   MOVEL     '05'          TBLcod
290800080225     C                   MOVEL     *BLANKS       TBLkey
290900080225     C                   MOVEL     VARA          TBLkey
291000080225     C     k03tabel      CHAIN     TABEL                              36
291100040302     c  n36              movel     tbluni        vdara
291200040302     c                   endif
291300151028     c* Raggruppamento area centralino
291400151028     c                   if        vARC<>*blanks
291500151028     C                   MOVEL     '05'          TBLcod
291600151028     C                   MOVEL     *BLANKS       TBLkey
291700151028     C                   MOVEL     VARC          TBLkey
291800151028     C     k03tabel      CHAIN     TABEL                              36
291900151028     c  n36              movel     tbluni        vdArc
292000151028     c                   endif
292100040525     c
292200040517     c* Mi riposiziono sul mio azorg
292300040928     c                   if        not *in01
292400080225     c                   movel     vfil          §fil
292500080225     C     §fil          chain     AzOrg                              36
292600040928     c                   endif
292700030430      *
292800020618     C                   ENDSR
292900020614     C**------------------------
293000030430     C** Controlli VIDEO 3
293100020614     C**------------------------
293200021029     C     CTRVID3       BEGSR
293300040924     c
293400030430      * raggruppamento area ex as400
293500030430     C                   MOVEL     *blanks       VDAEX
293600030526     C                   IF        vaex <> *blanks and vaex <> *zeros
293700030430      * controllo che il campo contenga solo numeri
293800030430     C                   IF        %subst(vaex:1:1)<'0' or %subst(vaex:2:1)<'0'
293900030430     C                             or %subst(vaex:3:1)<'0'
294000040302     c                   eval      v3cmsg=msg(1)
294100040302     C                   SETON                                        929711
294200030430     C                   GOTO      END3
294300030430     C                   ELSE
294400080225     C                   move      vaex          wfil
294500040525     C     wfil          CHAIN(N)  AZORG                              36
294600030430     C                   If        *in36 = *off and
294700030430     C                             OrgFag='F' and OrgFva=' ' or *in36=*off
294800030527     C                             and OrgFag='A' and  OrgFva=' ' or
294900030527     C                             wfil = 046
295000030430     C                   MOVEL     ORGDES        VDAEX
295100030430     C                   else
295200040302     c                   eval      v3cmsg=msg(1)
295300040302     C                   SETON                                        929711
295400030430     C                   GOTO      END3
295500030430     C                   endif
295600030430     C                   ENDIF
295700030430     C                   ENDIF
295800040302     c* Area Ex AS400 obbligatoria per tipi F o A
295900040302     c                   if        vtip='F' or vtip='A'
296000040302     c                   if        vaex=*blanks or vaex=*zeros
296100040302     c                   eval      v3cmsg=msg(3)
296200040302     C                   SETON                                        929711
296300040302     C                   GOTO      END3
296400040302     C                   endif
296500040302     C                   endif
296600040302     c
296700030430      *
296800030430      * raggruppamento area POC
296900030430     C                   MOVEL     *blanks       VDAPO
297000040302     c* obbligatoria per tipi F o A
297100040302     c                   if        vtip='F' or vtip='A'
297200040302     c                   if        vapo=*blanks or vapo=*zeros
297300040302     c                   eval      v3cmsg=msg(4)
297400040302     C                   SETON                                        919711
297500040302     C                   GOTO      END3
297600040302     C                   endif
297700040302     C                   endif
297800040302     c
297900030430      * controllo che il campo contenga solo numeri
298000030526     C                   IF        vapo <> *zeros and vapo <> *blanks
298100030430     C                   IF        %subst(vapo:1:1)<'0' or %subst(vapo:2:1)<'0'
298200030430     C                             or %subst(vapo:3:1)<'0'
298300040302     c                   eval      v3cmsg=msg(2)
298400040302     C                   SETON                                        919711
298500030430     C                   GOTO      END3
298600030430     C                   ELSE
298700080225     C                   move      vapo          wfil
298800040525     C     wfil          CHAIN(N)  AZORG                              36
298900030430     C                   If        OrgFag='F' and OrgFva=' ' and *in36=*off
299000030430     C                             or OrgFag='A' and  OrgFva=' ' and *in36 =*off
299100030527     C                             or wfil = 046
299200030430     C                   MOVEL     ORGDES        VDAPO
299300030430     C                   else
299400040302     c                   eval      v3cmsg=msg(2)
299500040302     C                   SETON                                        919711
299600030430     C                   GOTO      END3
299700030430     C                   endif
299800030430     C                   ENDIF
299900030430     C                   ENDIF
300000030430      *
300100030429      * Raggruppamento area
300200040302     c                   clear                   vdara
300300030429     C     VARA          IFNE      *ZERO
300400030429     C     VARA          ANDNE     *BLANKS
300500030429     C     '?'           SCAN      VARA                                   31
300600030429     C   31              DO
300700080225     C                   MOVEL     C_CodUt       §KUT
300800080225     C                   MOVEL     '05'          §COD
300900030429     C                   MOVE      *BLANKS       §key
301000030429     C                   MOVE      *BLANKS       VARA
301100030429     C                   CALL      'X§TABER'
301200030429     C                   PARM                    §KUT
301300080225     C                   PARM                    §COD
301400080225     C                   PARM                    §KEY
301500080225     C                   PARM                    §DES
301600030429     C                   if        §key <> *blanks
301700030429     C                   MOVEL     §KEY          VARA
301800030429     C                   endif
301900090709     C                   SETON                                        459709
302000030429     C                   GOTO      END3
302100030429     C                   END
302200030429      * controllo
302300080225     C                   MOVEL     '05'          TBLcod
302400080225     C                   MOVEL     *BLANKS       TBLkey
302500080225     C                   MOVEL     VARA          TBLkey
302600080225     C     k03tabel      CHAIN     TABEL                              36
302700040302     c                   if        *in36 or  tblflg<>*blanks
302800040302     c                   eval      v3cmsg=msg(5)
302900040302     C                   SETON                                        459711
303000040302     C                   GOTO      END3
303100040302     c                   else
303200040302     c                   movel     tbluni        vdara
303300040302     c                   endif
303400040302     c
303500030429     C                   ELSE
303600040302      * campo obbligatorio per F/A
303700030429     C                   IF        Vtip = 'F' or Vtip = 'A'
303800040302     c                   eval      v3cmsg=msg(6)
303900040302     C                   SETON                                        459711
304000040517     C                   GOTO      END3
304100030429     C                   ENDIF
304200030429     C                   END
304300151028      *
304400151028      * Raggruppamento area CENTRALINO
304500151028     c                   clear                   vdArc
304600151028if  1C     VARC          IFNE      *ZERO
304700151028     C     VARC          ANDNE     *BLANKS
304800151028     C     '?'           SCAN      VARC                                   31
304900151028do  2C   31              DO
305000151028     C                   MOVEL     C_CodUt       §KUT
305100151028     C                   MOVEL     '05'          §COD
305200151028     C                   MOVE      *BLANKS       §key
305300151028     C                   MOVE      *BLANKS       VARC
305400151028     C                   CALL      'X§TABER'
305500151028     C                   PARM                    §KUT
305600151028     C                   PARM                    §COD
305700151028     C                   PARM                    §KEY
305800151028     C                   PARM                    §DES
305900151028if  3C                   if        §key <> *blanks
306000151028     C                   MOVEL     §KEY          VARC
306100151028e   3C                   endif
306200151028     C                   SETON                                        439709
306300151028     C                   GOTO      END3
306400151028e   2C                   ENDDO
306500151028      * controllo
306600151028     C                   MOVEL     '05'          TBLcod
306700151028     C                   MOVEL     *BLANKS       TBLkey
306800151028     C                   MOVEL     VARC          TBLkey
306900151028     C     k03tabel      CHAIN     TABEL                              36
307000151028if  2c                   if        *in36 or  tblflg<>*blanks
307100151028     c                   eval      v3cmsg=msg(5)
307200151028     C                   SETON                                        439711
307300151028     C                   GOTO      END3
307400151028x   2c                   else
307500151028     c                   movel     tbluni        vdArc
307600151028e   2c                   endif
307700151028     c
307800151028x   1C                   ELSE
307900151028      * campo obbligatorio per F/A
308000151028if  2C                   IF        Vtip = 'F' or Vtip = 'A'
308100151028     c                   eval      v3cmsg=msg(6)
308200151028     C                   SETON                                        439711
308300151028     C                   GOTO      END3
308400151028e   2C                   ENDIF
308500151028e   1C                   ENDIF
308600151028      *
308700040924      * P.O. elaboratore
308800151028     c                   clear                   vdfle
308900040924     C     VFLE          IFGT      *ZERO
309000040924     C     VFLE          CHAIN(N)  AZORG                              48
309100040924     C  N48              MOVEL     ORGDES        VDFLE
309200040924     c   48              eval      v3cmsg=msg(16)
309300040924     C   48              SETON                                          9711
309400070226     C   98              GOTO      END3
309500040924     C                   END
309600150430
309700150430      * Filiale valida come linea di partenza bolla
309800150430     C                   MOVEL     *blanks       Vdlnpb
309900150430    1C     Vflnpb        IFne      *ZERO
310000150430     C     Vflnpb        CHAIN(N)  AZORG                              27
310100150430    2c                   if        *in27
310200150430     c                   eval      v3cmsg=msg(21)
310300150430     C                   SETON                                          9711
310400150430     C                   GOTO      END3
310500150430   x2c                   else
310600150430     C                   MOVEL     ORGDES        Vdlnpb
310700150430     c* deve essere una fil dpd appartenente alla stessa area di partenza
310800150430     c                   movel     orgde3        w_og143
310900150430    3c                   if        w_§ogntw<>'DPD'
311000150430     c                   eval      v3cmsg=msg(22)
311100150430     C                   SETON                                        279711
311200150430     C                   GOTO      END3
311300150430   x3c                   else
311400150430     c* deve appartenere alla stessa area di partenza della filiale in manutenzione
311500150430     C                   CLEAR                   FNLV55ds
311600150430     C                   MOVEL     'P'           D55TPT
311700150430     C                   MOVEL     vflnpb        D55LIN
311800150430     C                   MOVEL     *date         D55DRF
311900150430     C                   CALL      'FNLV55R'
312000150430     C                   PARM                    FNLV55ds
312100150430     c                   eval      wtfp_lnpb=d55tfp
312200150430     C                   CLEAR                   FNLV55ds
312300150430     C                   MOVEL     'P'           D55TPT
312400150430     C                   MOVE      vfil          D55LIN
312500150430     C                   MOVEL     *date         D55DRF
312600150430     C                   CALL      'FNLV55R'
312700150430     C                   PARM                    FNLV55ds
312800150430    4c                   if        wtfp_lnpb<>d55tfp
312900150430     c                   eval      v3cmsg=msg(23)
313000150430     C                   SETON                                        279711
313100150430     C                   GOTO      END3
313200150430    4c                   endif
313300150430     c
313400150430    3c                   endif
313500150430     c
313600150430     c
313700150430    2C                   END
313800150430    1C                   END
313900131016      *
314000131016      * P.O. Forzare i Resi
314100131016     C                   MOVEL     *blanks       VlRESId
314200131016     C     VLresi        IFne      *ZERO
314300131016     C     VLresi        CHAIN(N)  AZORG                              35
314400131017     c                   if        *in35
314500131017     c                   eval      v3cmsg=msg(20)
314600131017     C                   SETON                                          9711
314700131017     C                   GOTO      END3
314800131017     c                   else
314900131017     C                   MOVEL     ORGDES        VlRESId
315000131016     C                   END
315100131016     C                   END
315200131016     c*
315300070226      * P.O. contabilità
315400090709     C                   MOVEL     *blanks       VDFcont
315500090709     C     VFcont        IFeq      *ZERO
315600070226     c                   seton                                        34
315700070226     c                   else
315800090709     C     VFcont        CHAIN(N)  AZORG                              34
315900090709     C  N34              MOVEL     ORGDES        VDFcont
316000070226     C                   END
316100090709     c* im immissione può essere uguale alla filiale da immettere
316200090709     c                   if        *in34 and *in01
316300090709     C                   movel     VFil          §Fil
316400090709     c                   if        vfcont=§fil
316500090709     c                   setoff                                       34
316600090709     c                   eval      vdfcont=vdfil
316700090709     c                   endif
316800090709     c                   endif
316900090709     c
317000070226     c                   if        *in34
317100070226     c                   eval      v3cmsg=msg(17)
317200070226     C                   SETON                                          9711
317300070226     C                   GOTO      END3
317400070226     C                   END
317500040302     c*
317600040302      * Ambiente di appartenenza obbligatorio se Filiale o Agenzia
317700040302     c                   clear                   vdogas
317800040302    1C                   IF        VOgas = *zeros  and VTip = 'F'  or
317900040302     C                             VOgAs = *zeros  and VTip = 'A'
318000040302     c                   eval      v3cmsg=msg(7)
318100040302     C                   SETON                                        469711
318200040302     C                   GOTO      END3
318300040302    1C                   ENDIF
318400040302      * può essere 946 oppure il terminal di partenza
318500040302    1c                   if        vogas>*zeros and vogas<>946  and vogas<>46
318600040302    2c                   if        vtip='V' or vtip='T'
318700040302     c                   eval      v3cmsg=msg(8)
318800040302     C                   SETON                                        469711
318900040302     C                   GOTO      END3
319000040302    2c                   endif
319100040302    1c                   endif
319200040302     c
319300040302    1c                   if        vogas>*zeros
319400040302     C                   MOVE      Vogas         wfil
319500040525     C     wfil          CHAIN(N)  AZORG                              46
319600040302    2c                   if        *in46 or orgfva<>*blanks
319700040302     c                   eval      v3cmsg=msg(8)
319800040302     C                   SETON                                        469711
319900040302     C                   GOTO      END3
320000040302    2c                   endif
320100040302     c
320200040302     c                   movel     orgdes        vdogas
320300040302     c
320400040302    2c                   if        vogas<>946 and vogas<>46
320500040518     c* questo controllo non lo faccio in immissione perchè il terminal
320600040518     c*  di partenza del p.o. non può essere ancora stato inserito
320700040518     c                   if        not *in01
320800080225     C                   CLEAR                   FNLV55ds
320900040302     C                   MOVEL     'P'           D55TPT
321000080225     C                   MOVEL     §fil          D55LIN
321100040927     C                   MOVEL     *date         D55DRF
321200040302     C                   CALL      'FNLV55R'
321300080225     C                   PARM                    FNLV55ds
321400040302     c*
321500040302    3c                   if        vogas<>d55tfp
321600040302     c                   eval      v3cmsg=msg(8)
321700040302     C                   SETON                                        469711
321800040302     C                   GOTO      END3
321900040302    3C                   ENDIF
322000040518    3C                   ENDIF
322100040302     C* DEVE ESSERE UGUALE A p.o. elaboratore
322200040518     c                   if        vogas<>vfle
322300040302     c                   eval      v3cmsg=msg(15)
322400040302     C                   SETON                                        469711
322500040302     C                   GOTO      END3
322600040302     c                   endif
322700040302     c
322800040302   x2c                   else
322900040302     c* P.O. elaboratore = 46
323000040518     c                   if        vfle<>46    and vtip<>'T' and vtip<>'V'
323100040302     c                   eval      v3cmsg=msg(14)
323200040302     C                   SETON                                        469711
323300040302     C                   GOTO      END3
323400040302    2C                   ENDIF
323500040302    2C                   ENDIF
323600040302    1C                   ENDIF
323700100930
323800100930      * Fil  invio materiale EDP
323900100930     C                   MOVEL     *blanks       VDfiue
324000100930    1C                   If        vfiue<>*blanks and vfiue<>*zeros
324100100930    2C                   IF        %subst(vfiue:1:1)<'0' or %subst(vfiue:2:1)<
324200100930     C                             '0' or %subst(vfiue:3:1)<'0'
324300100930     c                   eval      v3cmsg=msg(19)
324400100930     C                   SETON                                        209711
324500100930     C                   GOTO      END3
324600100930   x2C                   ELSE
324700100930     C                   move      vfiue         wfil
324800100930     C     wfil          CHAIN(N)  AZORG                              36
324900100930    3C                   If        OrgFag='F' and OrgFva=' ' and *in36=*off
325000100930     C                             or OrgFag='A' and  OrgFva=' ' and *in36 =*off
325100100930     C                   MOVEL     ORGDES        VDfiue
325200100930     C                   else
325300100930     c                   eval      v3cmsg=msg(19)
325400100930     C                   SETON                                        209711
325500100930     C                   GOTO      END3
325600100930     C                   endif
325700100930     C                   ENDIF
325800100930     C                   ENDIF
325900040302     c
326000040302     c*
326100030429      * Dpd codice Hub, obbligatorio per dpd
326200030429     C     VHUB          IFEQ      *BLANKS
326300030429     C     VNTW          ANDEQ     'DPD'
326400030429     C                   SETON                                        6797
326500030429     C                   GOTO      END3
326600030429     C                   ENDIF
326700030429      *
326800030429      * codice deposito
326900030429     C     VDPT          IFEQ      *BLANKS
327000030429     C     VTIP          ANDEQ     'F'
327100030429     C     VDPT          OREQ      *BLANKS
327200030429     C     VTIP          ANDEQ     'A'
327300030429     C                   SETON                                        6897
327400030429     C                   GOTO      END3
327500030429     C                   ENDIF
327600030429      *
327700030429      * DATI PER TARIFFE
327800021029      *
327900021029      * Regione ai fini tariffari
328000020619     C                   MOVEL     *BLANKS       VDRET
328100040302    1C     VRET          IFNE      *ZERO
328200020712     C     VRET          ANDNE     *BLANKS
328300020619     C     '?'           SCAN      VRET                                   31
328400040302    2C                   IF        *in31=*on
328500040302     C                   MOVE      *blanks       §des
328600040302     c                   movel     '.'           §§des
328700020619     C                   CALL      'TNSD24R'
328800080225     C                   PARM                    §§COD             3
328900080225     C                   PARM      'T'           §§TIP
329000020619     C                   PARM                    §§DES            25
329100020619     C                   PARM                    §§PRA             3
329200080225     C                   MOVEL     §§COD         VRET
329300040302      *
329400090709     C                   SETON                                        977609
329500021029     C                   GOTO      END3
329600040302    2C                   endif
329700040928     c
329800040928     C                   MOVE      VRET          wfil
329900040928     C     wfil          CHAIN(N)  AZORG                              36
330000021107      *
330100040928    2C                   IF        *in36 = *off and OrgFva = ' '
330200021107     C                             and orgfl2='S'   or
330300040928     C                             *in36 = *off and OrgFva = ' '
330400021107     C                             and orgfl2= 'S'
330500020619     C                   MOVEL     ORGDES        VDRET
330600020619     C                   ELSE
330700040302     c                   eval      v3cmsg=msg(12)
330800040302     C                   SETON                                        769711
330900021029     C                   GOTO      END3
331000040302    2C                   ENDIF
331100020619     C                   ELSE
331200021107      * campo obbligatorio COR/MES
331300030404     C                   IF        VNtw = 'COR' or
331400030404     C                             VNtw = 'MES'
331500040302     c                   eval      v3cmsg=msg(13)
331600040302     C                   SETON                                        769711
331700021029     C                   GOTO      END3
331800020619     C                   ENDIF
331900020619     C                   ENDIF
332000060828      * Coda faxin/faxout obbligatorie per 1°livello
332100060828     C                   IF        VFxi=*blanks and Vtip='F' and vlpo='1' or
332200060828     C                             VFxi=*blanks and Vtip='A' and vlpo='1'
332300060828     C                   seton                                        4297
332400060828     C                   GOTO      END3
332500060828     C                   ENDIF
332600060828     C                   IF        VFxo=*blanks and Vtip='F' and vlpo='1' or
332700060828     C                             VFxo=*blanks and Vtip='A' and vlpo='1'
332800060828     C                   seton                                        8997
332900060828     C                   GOTO      END3
333000060828     C                   ENDIF
333100060828     c* coda stampa sede per p.o. obbligatoria per F o A
333200060828     c                   if        vssp=*blanks
333300060828     c                   if        vtip='F' or vtip='A'
333400060828     C                   seton                                        8397
333500060828     C                   GOTO      END3
333600060828     C                   ENDIF
333700060828     C                   ENDIF
333800060828     c* coda stampa sede per Commerciale p.o. obbligatoria per F o A
333900060828     c                   if        vssc=*blanks
334000060828     c                   if        vtip='F' or vtip='A'
334100060828     C                   seton                                        9097
334200060828     C                   GOTO      END3
334300060828     C                   ENDIF
334400060828     C                   ENDIF
334500060828     c
334600040525     c     end3          tag
334700040525     c* Mi riposiziono sul mio azorg
334800040928     c                   if        not *in01
334900080225     c                   movel     vfil          §fil
335000080225     C     §fil          chain     AzOrg                              36
335100040928     c                   endif
335200030429      *
335300040525     C                   ENDSR
335400030429      *------------------------------------------------------
335500030430      * Pulizia VIDEO 4
335600030429      *------------------------------------------------------
335700030429     C     PULVID4       BEGSR
335800030430      *
335900040517     C                   movel     *blanks       Vlfv
336000030430     C                   movel     *blanks       Vlbl
336100030430     C                   movel     *blanks       Vasp
336200040518     C                   movel     *blanks       VaspCV
336300030430     C                   movel     *blanks       Vase
336400030430     C                   movel     *blanks       Vdkc
336401170227     C                   movel     *blanks       Vdirdkc
336500031016     C                   movel     *blanks       Vpck
336600050509     C                   movel     *blanks       Vpkm
336700160506     C                   movel     *blanks       Vturno
336800041213     C                   movel     *blanks       Vtis
336900160531     C                   movel     *blanks       Vagspus
337000030430     C                   movel     *blanks       Vnoc
337100030430     C                   movel     *blanks       Vnid
337200030430     C                   movel     *blanks       Veid
337300040518     C                   movel     *blanks       Vorm
337400070228     C*                  movel     *blanks       Vfrr
337500040517     C                   z-add     0             Vdsd
337600040517     C                   z-add     0             Vdse
337700040927     c                   z-add     0             Vvol
337800030430     C                   z-add     0             Vpes
337900120924     C****               movel     *blanks       Vspv
338000120924     C****               movel     *blanks       Vspp
338100040301     C                   movel     *blanks       Vass
338200030430     C                   movel     *blanks       Vlpr
338300040517     C                   movel     *blanks       Vsea
338400101215     C                   movel     *blanks       Vimaa
338500040518     c* in immissione, propongo S aolo per azorg e non tipi V o T
338600040924     c                   if        *in01  and not *in88  and
338700040924     c                             vtip<>'V' and vtip<>'T'
338800040518     C                   movel     'S'           VaspCV
338900040518     C                   movel     'S'           Vorm
339000040518     c                   endif
339100030430      *
339200030429     C                   ENDSR
339300030429      *-----------------------------------------------------
339400030430      * Riempimento  video 4
339500030429      *-----------------------------------------------------
339600030429     C     AGGVID4       BEGSR
339700030429      *
339800030429      * L.arrivo stampa segnacollo
339900030429     C                   MOVEL     ORGDE5        Vass
340000030429      * Frame relay
340100070228     C*                  MOVE      §ogfrr        Vfrr
340200040301     c* date scannerizazione
340300040301     c                   if        §ogdsd<>*blanks
340400040301     C                   CLEAR                   WLBDAT
340500040301     C                   MOVEL     '3'           G02ERR
340600040301     C                   move      §ogdsd        G02INV
340700040301     C                   CALL      'XSRDA8'
340800040301     C                   PARM                    WLBDAT
340900040301     C                   Z-ADD     G02DAT        Vdsd
341000040301     c                   endif
341100040301     c*
341200040301     c                   if        §ogdse<>*blanks
341300040301     C                   CLEAR                   WLBDAT
341400040301     C                   MOVEL     '3'           G02ERR
341500040301     C                   move      §ogdse        G02INV
341600040301     C                   CALL      'XSRDA8'
341700040301     C                   PARM                    WLBDAT
341800040301     C                   Z-ADD     G02DAT        Vdse
341900040301     c                   endif
342000030429      * Bolle sede per posta
342100030429     C                   MOVE      §ognoc        Vnoc
342200030429      * Linea  bollettazione
342300030429     C                   MOVE      §oglbl        Vlbl
342400030429      * Linea  gestita da fogli viaggio
342500030429     C                   MOVE      §oglfv        Vlfv
342600030429      * P.O non esegue IDD
342700030429     C                   MOVE      §ognid        Vnid
342800040924      * P.O esegue IDD giorno dopo
342900030429     C                   MOVE      §ogeid        Veid
343000030429      * ORM
343100030429     C                   MOVE      §ogorm        Vorm
343200030429      * Linea da proporre in tassazione P.A
343300030429     C                   MOVE      §oglpr        Vlpr
343400040517     c
343500040518      * Autogenerazione spunte solo per F o A
343600030429     C                   SELECT
343700040517     C     §ogags        WHENEQ    ' '
343800040518     c                   if        vtip='A' or vtip='F'
343900030429     C                   move      'S'           VAsp
344000040518     c                   endif
344100030429      *
344200040517     C     §ogagp        WHENne    'P'
344300030429     C     §ogags        ANDEQ     'E'
344400030429     C                   move      'S'           VAspCV
344500030429      *
344600030429     C     §ogagp        WHENEQ    'P'
344700030429     C     §ogags        ANDEQ     'E'
344800030429     C                   move      'S'           VAse
344900030429     C                   ENDSL
345000030429      *
345100030429      * Data utilizzo macchinone per peso/volume
345200030429     C                   MOVE      §ogvol        Vvol
345300030429     C                   MOVE      §ogpes        Vpes
345400120924     C****               MOVE      §ogspv        Vspv
345500120924     C****               MOVE      §ogspp        Vspp
345600030429     C                   MOVE      §ogdkc        Vdkc
345601170227     C                   MOVE      §ogdkcdir     Vdirdkc
345700031016     C                   MOVE      §ogpck        Vpck
345800050509     C                   MOVE      §ogpkm        Vpkm
345900160506     C                   MOVE      §ogturno      Vturno
346000041213     C                   MOVE      §ogtis        Vtis
346100160531     C                   MOVE      §OGagspus     Vagspus
346200040517     C                   MOVE      §ogsea        Vsea
346300101215     C                   MOVE      §ogimaa       Vimaa
346400030429     C                   ENDSR
346500030429      *-----------------------------------------------------
346600030430      * Controlli VIDEO 4
346700030429      *-----------------------------------------------------
346800030429     C     CTRVID4       BEGSR
346900030429      *
347000030429      * Autogenerazione spunte
347100030429     C                   z-add     0             $Spunte           1 0
347200030429     C                   IF        VASP = 'S'
347300030429     C                   add       1             $Spunte
347400030429     C                   ENDIF
347500030429     C                   IF        VASPCV = 'S'
347600030429     C                   add       1             $Spunte
347700030429     C                   ENDIF
347800030429     C                   IF        VASE = 'S'
347900030429     C                   add       1             $Spunte
348000030429     C                   ENDIF
348100040518     C                   IF        $SPUNTE>1
348200030429     C                   seton                                        6994
348300030429     C                   GOTO      END4
348400030429     C                   ENDIF
348500040518     C                   IF        $SPUNTE=0  and vtip<>'V' and vtip<>'T'
348600040518     C                   seton                                        6994
348700040518     C                   GOTO      END4
348800040518     C                   ENDIF
348900041214     c* stampa ddt si in arrivo
349000120612     c**                 if        vpck = 'S' and vsda = 'S'
349100120612     c**                 seton                                        4394
349200120612     c**                 goto      end4
349300120612     c**                 endif
349301170227     c* Dirottamento/resi ckome disk "C" solo se filiale abilitata la disk "C"
349302170227     c                   if        vdirdkc= 'S' and vdkc<>'S'
349303170227     c                   seton                                        4594
349305170227     c                   goto      end4
349306170227     c                   endif
349400040301      * Controllo campi data scannerizzazione
349500040301     c                   clear                   wdsd
349600040301     C     Vdsd          IFNE      *ZEROS
349700040301     C                   clear                   WLBDAT
349800040301     C                   z-add     Vdsd          G02Dat
349900040301     C                   CALL      'XSRDA8'
350000040301     C                   PARM                    WLBDAT
350100040301     C     G02Err        ifne      '0'
350200040301     C                   seton                                        3894
350300040301     C                   GOTO      END4
350400040301     c                   else
350500040301     c                   z-add     g02inv        wdsd
350600040517     c                   z-add     g02dat        vdsd
350700040301     C                   ENDIF
350800040301     C                   ENDIF
350900040301     c***
351000040301     c                   clear                   wdse
351100040301     C     Vdse          IFNE      *ZEROS
351200040301     C                   clear                   WLBDAT
351300040301     C                   z-add     Vdse          G02Dat
351400040301     C                   CALL      'XSRDA8'
351500040301     C                   PARM                    WLBDAT
351600040301     C     G02Err        ifne      '0'
351700040525     C                   seton                                        3794
351800040301     C                   GOTO      END4
351900040301     c                   else
352000040301     c                   z-add     g02inv        wdse
352100040517     c                   z-add     g02dat        vdse
352200040301     C                   ENDIF
352300040301     C                   ENDIF
352400030429      *
352500040301      * Controllo data utilizzo macchinone peso e volume
352600030429     C     VVOL          IFNE      *ZEROS
352700040301     C                   clear                   WLBDAT
352800040301     C                   z-add     VVol          G02Dat
352900040301     C                   CALL      'XSRDA8'
353000030429     C                   PARM                    WLBDAT
353100030429     C     G02Err        ifne      '0'
353200030429     C                   seton                                        8694
353300030429     C                   GOTO      END4
353400030429     C                   ENDIF
353500030429     C                   ENDIF
353600030429      *
353700030429     C     VPES          IFNE      *ZEROS
353800040301     C                   clear                   WLBDAT
353900040301     C                   z-add     VPes          G02Dat
354000040301     C                   CALL      'XSRDA8'
354100030429     C                   PARM                    WLBDAT
354200030429     C     G02Err        ifne      '0'
354300030429     C                   seton                                        8794
354400030429     C                   GOTO      END4
354500030429     C                   ENDIF
354600030429     C                   ENDIF
354700030429      *
354800030429      * Ricerca e controllo linea parallela da proporre in tass.ne
354900040928     C                   IF        Vlpr <> *blanks and Vlpr<>*zeros
355000030429     C     '?'           SCAN      Vlpr                                   31
355100030429     C                   IF        *in31=*on
355200080225     C                   MOVE      'E'           §§TIP
355300030429     C                   CALL      'TNSD24R'
355400080225     C                   PARM                    §§COD             3
355500080225     C                   PARM                    §§TIP
355600030429     C                   PARM                    §§DES            25
355700030429     C                   PARM                    §§PRA             3
355800080225     C                   MOVEL     §§COD         Vlpr
355900030429      * per riemettere il video almeno una volta dopo le ricerche
356000090709     C                   SETON                                        9409
356100030429     C                   GOTO      END4
356200030429     C                   ENDIF
356300040928      *
356400040928     C                   TESTN                   Vlpr                 36
356500040928     c                   move      vlpr          w001a             1
356600040928     c*
356700040928     c                   if        not *in36 or w001a<*zeros
356800040928     c                   seton                                        3994
356900040928     c                   else
357000040928     c
357100040928     C                   move      VLpr          wfil
357200040928     C     wfil          CHAIN(N)  AZORG                              36
357300030429     C   36              seton                                        3994
357400030429     C                   endif
357500030429     C                   ENDIF
357600030429      *
357700030430      *
357800040525     c     end4          tag
357900040525      *
358000040525      * Riaggancio azorg con corretto P.O
358100040928     c                   if        not *in01
358200080225     C                   movel     VFil          §Fil
358300080225     C     §FIL          CHAIN     AZORG                              36
358400040928     c                   endif
358500030429      *
358600040525     C                   ENDSR
358700070828      *------------------------------------------------------
358800070828      * Pulizia VIDEO 5
358900070828      *------------------------------------------------------
359000070828     C     PULVID5       BEGSR
359100070828      *
359200070828     c                   clear                   vtlls
359300080206     c                   movel     *blanks       vpdaorm
359400080206     c                   movel     *blanks       vpdacon
359500070828     c                   movel     *blank        Vgeot
359600070828     C                   z-add     0             Vdda
359700070828     c                   movel     *blank        Vdoada
359800070828     c                   movel     *blank        Vfppda
359900070926     c                   movel     *blank        Vfrtuo
360000070828     c                   clear                   vcgio
360100070828     c                   z-add     0             vddao
360200070828      *
360300070828     C                   ENDSR
360400070828      *-----------------------------------------------------
360500070828      * Riempimento  video 5
360600070828      *-----------------------------------------------------
360700070828     C     AGGVID5       BEGSR
360800070828      * TELLUS
360900070828     C                   MOVE      §ogTLLS       Vtlls
361000070828      * flag avviamento gestione telefonate per GEO
361100070828     c                   movel     §oggeot       vgeot
361200070828     c* data inizio distinte consegna automatiche
361300070828     c                   if        §ogdda<>*blanks
361400070828     C                   CLEAR                   WLBDAT
361500070828     C                   MOVEL     '3'           G02ERR
361600070828     C                   move      §ogdda        G02INV
361700070828     C                   CALL      'XSRDA8'
361800070828     C                   PARM                    WLBDAT
361900070828     C                   Z-ADD     G02DAT        Vdda
362000070828     c                   endif
362100080206      * PDA ORM
362200080206     c                   move      §ogpdaorm     vpdaorm
362300080206      * PDA consegne
362400080206     c                   move      §ogpdacon     vpdacon
362500070828      * Abilitazione richiesta data e ora limite abbinamento
362600070828     c                   move      §ogdoada      vdoada
362700070828      * Abilitazione richiesta tipo ditinta mattino/pomeriggio
362800070828     c                   move      §ogfppda      vfppda
362900070828      * Procedura GIRI su ORM
363000070828     c                   move      §ogcgio       vcgio
363100070828      * Data inizio distinte ORM automatiche
363200070828     c                   if        §ogddao <> *blanks
363300070828     c                   clear                   wlbdat
363400070828     c                   eval      g02err = '3'
363500070828     c                   move      §ogddao       g02inv
363600070828     c                   call      'XSRDA8'
363700070828     c                   parm                    wlbdat
363800070828     c                   z-add     g02dat        vddao
363900070828     c                   endif
364000070926      * Abilitazione richiesta tipo ditinta mattino/pomeriggio  ORM
364100070926     c                   move      §ogfrtuo      vfrtuo
364200070828     C                   ENDSR
364300070828      *-----------------------------------------------------
364400070828      * Controlli VIDEO 5
364500070828      *-----------------------------------------------------
364600070828     C     CTRVID5       BEGSR
364700070828      *
364800070828     c* controllo data inizio distinte automatiche
364900070828     c                   clear                   wdda
365000070828     C     Vdda          IFNE      *ZEROS
365100070828     C                   clear                   WLBDAT
365200070828     C                   z-add     Vdda          G02Dat
365300070828     C                   CALL      'XSRDA8'
365400070828     C                   PARM                    WLBDAT
365500070828     C     G02Err        ifne      '0'
365600070828     C                   seton                                        3330
365700070828     C                   GOTO      END5
365800070828     c                   else
365900070828     c                   z-add     g02inv        wdda
366000070828     c                   z-add     g02dat        vdda
366100070828     C                   ENDIF
366200070828     C                   ENDIF
366300070828
366400070828      * Controllo data inizio distinte ORM automatiche
366500070828     c                   clear                   wddao
366600070828     c                   if        vddao <> *zeros
366700070828     c                   clear                   wlbdat
366800070828     c                   z-add     vddao         g02dat
366900070828     c                   call      'XSRDA8'
367000070828     c                   parm                    wlbdat
367100070828     c                   if        g02err <> '0'
367200070828     c                   seton                                        3230
367300070828     c                   goto      end5
367400070828     c                   endif
367500070828     c                   z-add     g02inv        wddao
367600070828     c                   z-add     g02dat        vddao
367700070828     c                   endif
367800091109      *
367900091109
368000070828     c     end5          tag
368100070828      *
368200070828      * Riaggancio azorg con corretto P.O
368300070828     c                   if        not *in01
368400080225     C                   movel     VFil          §Fil
368500080225     C     §FIL          CHAIN     AZORG                              36
368600070828     c                   endif
368700070828      *
368800070828     C                   ENDSR
368900030430      *-------------------------------------------
369000030430      * Annullamento/Ripristino AzOrg00f/AzOse00f
369100030430      *-------------------------------------------
369200920317     C     AGGFIL        BEGSR
369300080225     C                   movel     vfil          §FIL
369400030430      *
369500080225     C  N88§FIL          CHAIN     AZORG                              36
369600080225     C   88§FIL          CHAIN     AZOSE                              36
369700900330     C   KE              MOVEL     *BLANKS       ORGFVA
369800900330     C   KQ              MOVEL     '*'           ORGFVA
369900900409     C                   MOVEL     *BLANKS       ORGFTR
370000900409     C                   Z-ADD     0             ORGNTR
370100920317     C  N88              UPDATE    AZORG
370200920317     C   88              UPDATE    AZOSE
370300900329     C                   ENDSR
370400030430      *-------------------------------------------------
370500030430      * Aggiornamento/ripristino AzOse10f
370600030430      *-------------------------------------------------
370700920317     C     AGGSED        BEGSR
370800080225     C                   MOVEL     'OR'          TBLcod
370900080225     C                   MOVEL     *BLANKS       TBLkey
371000920317     C                   MOVEL     ORGDES        OR1DES
371100920317     C                   MOVEL     ORGFIL        OR1FIL
371200030430      * CANCELLA I RECORDS ESISTENTI
371300920317     C     OR1FIL        SETLL     AZOSE10
371400920317     C                   DO        *HIVAL
371500920317     C     OR1FIL        READE     AZOSE10                                96
371600920317     C  N96              DELETE    AZOSE10
371700920317     C  N96              END
371800030430      *
371900030430      *          SCRIVO PER OGNI VOCE PIENA
372000030430      *
372100080225     C                   DO        150           xx
372200080225     C     VCF(xx)       IFGT      *ZERO
372300080225     C                   Z-ADD     xx            OR1CVO
372400080225     C                   MOVEL     OR1CVO        TBLkey
372500080225     C     k03tabel      CHAIN     TABEL                              95
372600920317     C  N95              MOVEL     TBLUNI        OR1DCO
372700080225     C                   MOVEL     VCF(xx)       OR1CFI
372800080225     C                   MOVEL     VDE(xx)       OR1DVO
372900080225     C     VCF(xx)       CHAIN(N)  AZORG                              95
373000920317     C  N95              MOVEL     ORGDES        OR1DFI
373100920317     C                   WRITE     AZOSE10
373200920317     C                   END
373300920317     C                   END
373400920317     C                   ENDSR
373500040302      *-------------------------------------------------
373600040302      * Spengo indicatori di posizionamento cursore
373700040302      *-------------------------------------------------
373800040924     c     offd03        begsr
373900040302     c                   setoff                                       929145
374000040302     c                   setoff                                       467447
374100040302     c                   setoff                                       769711
374200150430     c                   setoff                                       27
374300040302     c                   endsr
374400040302**
374500040302Area  EX AS400  errata                                                        01
374600040302Area  POC  errata                                                             02
374700040302Area  EX AS400 obbligatoria per Filiali o Agenzie                             03
374800040302Area  POC  obbligatoria per Filiali o Agenzie                                 04
374900040302Raggruppamento Area  errato                                                   05
375000040302Raggruppamento Area  obbligatorio per Filiali o Agenzie                       06
375100040302Ambiente di Appartenenza  obbligatorio per Filiali o Agenzie                  07
375200080225Ambiente di Appartenenza  errato: 946 o 46 o terminal di partenza della fil.  08
375300080225Filiale gestione tariffe obbligatorio per Filiali o agenzie                   09
375400080225Filiale gestione tariffe errato                                               10
375500080225TIPO filale gestione tariffe obbligatorio per Filiali o Agenzie               11
375600040302Regione ai fini tariffari errata                                              12
375700040518Regione ai fini tariffari obbligatoria per il network indicato                13
375800080225Per ambiente di appartenenza 946 o 46, FIL. ELABORATORE deve essere 46        14
375900080225Ambiente di appartenenza deve essere uguale a Fil. Elaboratore se non è SEDE  15
376000080225Filiale elaboratore inesistente                                               16
376100080226Filiale contabilità errata                                                    17
376200080225Utente NON abilitato - Premere "Invio" per tornare a menù                     18
376300100930filiale invio materiale EDP errata                                            19
376400131016filiale sui cui Forzare Invio dei RESI errata                                 20
376500150504Filiale errata                                                                21
376600150504Immettere una Filiale DPD                                                     22
376700150430Filiale appartenente ad altra area di partenza                                23
