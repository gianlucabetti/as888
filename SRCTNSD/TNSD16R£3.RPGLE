000100080228      * TNSD16R *-----------------------------------------------------*
000200080228      *?INTERROGAZIONE ORGANIGRAMMA                                  ?*
000300080228      *---------------------------------------------------------------*
000400080228      *
000500080228     h dftname(CN0500)
000600080228     h decedit('0,') datedit(*ymd/) option(*nodebugio)
000700080228      *
000800080228      *?  A R C H I V I  ?--------------------------------------------*
000900080228      *
001000080228     fAZORG01L  if   e           k disk
001100080228     fAZOSE01L  if   e           k disk
001200080228     f                                     rename(AZORG:AZOSE)
001300080228     fTABEL00F  if   e           k disk
001400080228      *
001500080228     fTNSD15D   cf   e             workstn
001600080228     f                                     sfile(SD15DSF:NRR)
001700080228      *
001800080228      *?  C O S T A N T I  ?------------------------------------------*
001900080228      *
002000080228     d C_Ln_x_Tar      c                   const('LINEA PER TARIFFE')
002100080228     d C_NotOpe        c                   const('NON OPERATIVO  ')
002200080228     d C_1_Liv         c                   const('1° LIVELLO ')
002300080228     d C_2_liv         c                   const('2° LIVELLO ')
002400080228     d C_Not_Pres      c                   const('Non presente')
002500080228      *
002600080228      *?  S C H I E R E  ?--------------------------------------------*
002700080228      *
002800080228      *
002900080228      * - Messaggi di errore
003000080228     d $Msg            s             78    dim(01)  ctdata  perrcd(1)
003100080228      *
003200080228      * - Descrizioni a video
003300080228     d VDE             s             25    dim(150) inz
003400080228      * - Filiali appartenenza a video
003500080228     d VCF             s              3  0 dim(150) inz
003600080228      *
003700080228      *?  S T R U T T U R E   D A T I  ?------------------------------*
003800080228      *
003900080228      * Parametri ricevuti
004000080228     d KPJBA         e ds
004100080228      *
004200080228      * - Parametri x Controllo profilo utenti
004300080228     d TIBS34ds      e ds                  inz
004400080228      * - Ds di riferimento al file esterno AZUTE00F
004500080228     d AZUTEds       e ds                  extname(AZUTE00F)
004600080228      * - Ds per dati organigramma
004700080228     d dDatiUte      e ds
004800080228      * - Abilitazioni utenti aziendali
004900080228     d dUte01        e ds
005000130830
005100130830     d tisio0ds      e ds
005200080228      *
005300080228     d dsOG          e ds                  inz
005400080228     d dsOR          e ds                  inz
005500080228      *
005600080228      * DS per FNLV55R - Reperimento Terminal di Partenza e di Arrivo
005700080228     d FNLV55ds      e ds                  inz
005800080228      *
005900131108     d Og129         e ds                  inz
006000130423     d Og130         e ds                  inz
006100080228     d Og140         e ds                  inz
006200080228     d Og141         e ds                  inz
006300080228     d Og142         e ds                  inz
006400080228     d Og143         e ds                  inz
006500080228     d Og144         e ds                  inz
006600080228     d Og146         e ds                  inz
006700080228     d Og147         e ds                  inz
006800080228     d Og148         e ds                  inz
006900080228     d Og149         e ds                  inz
007000080228     d Og150         e ds                  inz
007100080228      *
007200080228     d DE_ds           ds                  inz
007300080228     d  ORGd01                                                                     1     25
007400080228     d  ORGd02                                                                    26     50
007500080228     d  ORGd03                                                                    51     75
007600080228     d  ORGd04                                                                    76    100
007700080228     d  ORGd05                                                                   101    125
007800080228     d  ORGd06                                                                   126    150
007900080228     d  ORGd07                                                                   151    175
008000080228     d  ORGd08                                                                   176    200
008100080228     d  ORGd09                                                                   201    225
008200080228     d  ORGd10                                                                   226    250
008300080228     d  ORGd11                                                                   251    275
008400080228     d  ORGd12                                                                   276    300
008500080228     d  ORGd13                                                                   301    325
008600080228     d  ORGd14                                                                   326    350
008700080228     d  ORGd15                                                                   351    375
008800080228     d  ORGd16                                                                   376    400
008900080228     d  ORGd17                                                                   401    425
009000080228     d  ORGd18                                                                   426    450
009100080228     d  ORGd19                                                                   451    475
009200080228     d  ORGd20                                                                   476    500
009300080228     d  ORGd21                                                                   501    525
009400080228     d  ORGd22                                                                   526    550
009500080228     d  ORGd23                                                                   551    575
009600080228     d  ORGd24                                                                   576    600
009700080228     d  ORGd25                                                                   601    625
009800080228     d  ORGd26                                                                   626    650
009900080228     d  ORGd27                                                                   651    675
010000080228     d  ORGd28                                                                   676    700
010100080228     d  ORGd29                                                                   701    725
010200080228     d  ORGd30                                                                   726    750
010300080228     d  ORGd31                                                                   751    775
010400080228     d  ORGd32                                                                   776    800
010500080228     d  ORGd33                                                                   801    825
010600080228     d  ORGd34                                                                   826    850
010700080228     d  ORGd35                                                                   851    875
010800080228     d  ORGd36                                                                   876    900
010900080228     d  ORGd37                                                                   901    925
011000080228     d  ORGd38                                                                   926    950
011100080228     d  ORGd39                                                                   951    975
011200080228     d  ORGd40                                                                   976   1000
011300080228     d  ORGd41                                                                  1001   1025
011400080228     d  ORGd42                                                                  1026   1050
011500080228     d  ORGd43                                                                  1051   1075
011600080228     d  ORGd44                                                                  1076   1100
011700080228     d  ORGd45                                                                  1101   1125
011800080228     d  ORGd46                                                                  1126   1150
011900080228     d  ORGd47                                                                  1151   1175
012000080228     d  ORGd48                                                                  1176   1200
012100080228     d  ORGd49                                                                  1201   1225
012200080228     d  ORGd50                                                                  1226   1250
012300080228     d  ORGd51                                                                  1251   1275
012400080228     d  ORGd52                                                                  1276   1300
012500080228     d  ORGd53                                                                  1301   1325
012600080228     d  ORGd54                                                                  1326   1350
012700080228     d  ORGd55                                                                  1351   1375
012800080228     d  ORGd56                                                                  1376   1400
012900080228     d  ORGd57                                                                  1401   1425
013000080228     d  ORGd58                                                                  1426   1450
013100080228     d  ORGd59                                                                  1451   1475
013200080228     d  ORGd60                                                                  1476   1500
013300080228     d  ORGd61                                                                  1501   1525
013400080228     d  ORGd62                                                                  1526   1550
013500080228     d  ORGd63                                                                  1551   1575
013600080228     d  ORGd64                                                                  1576   1600
013700080228     d  ORGd65                                                                  1601   1625
013800080228     d  ORGd66                                                                  1626   1650
013900080228     d  ORGd67                                                                  1651   1675
014000080228     d  ORGd68                                                                  1676   1700
014100080228     d  ORGd69                                                                  1701   1725
014200080228     d  ORGd70                                                                  1726   1750
014300080228     d  ORGd71                                                                  1751   1775
014400080228     d  ORGd72                                                                  1776   1800
014500080228     d  ORGd73                                                                  1801   1825
014600080228     d  ORGd74                                                                  1826   1850
014700080228     d  ORGd75                                                                  1851   1875
014800080228     d  ORGd76                                                                  1876   1900
014900080228     d  ORGd77                                                                  1901   1925
015000080228     d  ORGd78                                                                  1926   1950
015100080228     d  ORGd79                                                                  1951   1975
015200080228     d  ORGd80                                                                  1976   2000
015300080228     d  ORGd81                                                                  2001   2025
015400080228     d  ORGd82                                                                  2026   2050
015500080228     d  ORGd83                                                                  2051   2075
015600080228     d  ORGd84                                                                  2076   2100
015700080228     d  ORGd85                                                                  2101   2125
015800080228     d  ORGd86                                                                  2126   2150
015900080228     d  ORGd87                                                                  2151   2175
016000080228     d  ORGd88                                                                  2176   2200
016100080228     d  ORGd89                                                                  2201   2225
016200080228     d  ORGd90                                                                  2226   2250
016300080228     d  ORGd91                                                                  2251   2275
016400080228     d  ORGd92                                                                  2276   2300
016500080228     d  ORGd93                                                                  2301   2325
016600080228     d  ORGd94                                                                  2326   2350
016700080228     d  ORGd95                                                                  2351   2375
016800080228     d  ORGd96                                                                  2376   2400
016900080228     d  ORGd97                                                                  2401   2425
017000080228     d  ORGd98                                                                  2426   2450
017100080228     d  ORGd99                                                                  2451   2475
017200080228     d  ORGdA0                                                                  2476   2500
017300080228     d  ORGdA1                                                                  2501   2525
017400080228     d  ORGdA2                                                                  2526   2550
017500080228     d  ORGdA3                                                                  2551   2575
017600080228     d  ORGdA4                                                                  2576   2600
017700080228     d  ORGdA5                                                                  2601   2625
017800080228     d  ORGdA6                                                                  2626   2650
017900080228     d  ORGdA7                                                                  2651   2675
018000080228     d  ORGdA8                                                                  2676   2700
018100080228     d  ORGdA9                                                                  2701   2725
018200080228     d  ORGdB0                                                                  2726   2750
018300080228     d  ORGdB1                                                                  2751   2775
018400080228     d  ORGdB2                                                                  2776   2800
018500080228     d  ORGdB3                                                                  2801   2825
018600080228     d  ORGdB4                                                                  2826   2850
018700080228     d  ORGdB5                                                                  2851   2875
018800080228     d  ORGdB6                                                                  2876   2900
018900080228     d  ORGdB7                                                                  2901   2925
019000080228     d  ORGdB8                                                                  2926   2950
019100080228     d  ORGdB9                                                                  2951   2975
019200080228     d  ORGdC0                                                                  2976   3000
019300080228     d  ORGdC1                                                                  3001   3025
019400080228     d  ORGdC2                                                                  3026   3050
019500080228     d  ORGdC3                                                                  3051   3075
019600080228     d  ORGdC4                                                                  3076   3100
019700080228     d  ORGdC5                                                                  3101   3125
019800080228     d  ORGdC6                                                                  3126   3150
019900080228     d  ORGdC7                                                                  3151   3175
020000080228     d  ORGdC8                                                                  3176   3200
020100080228     d  ORGdC9                                                                  3201   3225
020200080228     d  ORGdD0                                                                  3226   3250
020300080228     d  ORGdD1                                                                  3251   3275
020400080228     d  ORGdD2                                                                  3276   3300
020500080228     d  ORGdD3                                                                  3301   3325
020600080228     d  ORGdD4                                                                  3326   3350
020700080228     d  ORGdD5                                                                  3351   3375
020800080228     d  ORGdD6                                                                  3376   3400
020900080228     d  ORGdD7                                                                  3401   3425
021000080228     d  ORGdD8                                                                  3426   3450
021100080228     d  ORGdD9                                                                  3451   3475
021200080228     d  ORGdE0                                                                  3476   3500
021300080228     d  ORGdE1                                                                  3501   3525
021400080228     d  ORGdE2                                                                  3526   3550
021500080228     d  ORGdE3                                                                  3551   3575
021600080228     d  ORGdE4                                                                  3576   3600
021700080228     d  ORGdE5                                                                  3601   3625
021800080228     d  ORGdE6                                                                  3626   3650
021900080228     d  ORGdE7                                                                  3651   3675
022000080228     d  ORGdE8                                                                  3676   3700
022100080228     d  ORGdE9                                                                  3701   3725
022200080228     d  ORGdF0                                                                  3726   3750
022300080228     d   $DE                   1   3750    dim(150)
022400080228      *
022500080228     d CF_ds           ds                  inz
022600080228     d  ORGf01                                                                     1      3  0
022700080228     d  ORGf02                                                                     4      6  0
022800080228     d  ORGf03                                                                     7      9  0
022900080228     d  ORGf04                                                                    10     12  0
023000080228     d  ORGf05                                                                    13     15  0
023100080228     d  ORGf06                                                                    16     18  0
023200080228     d  ORGf07                                                                    19     21  0
023300080228     d  ORGf08                                                                    22     24  0
023400080228     d  ORGf09                                                                    25     27  0
023500080228     d  ORGf10                                                                    28     30  0
023600080228     d  ORGf11                                                                    31     33  0
023700080228     d  ORGf12                                                                    34     36  0
023800080228     d  ORGf13                                                                    37     39  0
023900080228     d  ORGf14                                                                    40     42  0
024000080228     d  ORGf15                                                                    43     45  0
024100080228     d  ORGf16                                                                    46     48  0
024200080228     d  ORGf17                                                                    49     51  0
024300080228     d  ORGf18                                                                    52     54  0
024400080228     d  ORGf19                                                                    55     57  0
024500080228     d  ORGf20                                                                    58     60  0
024600080228     d  ORGf21                                                                    61     63  0
024700080228     d  ORGf22                                                                    64     66  0
024800080228     d  ORGf23                                                                    67     69  0
024900080228     d  ORGf24                                                                    70     72  0
025000080228     d  ORGf25                                                                    73     75  0
025100080228     d  ORGf26                                                                    76     78  0
025200080228     d  ORGf27                                                                    79     81  0
025300080228     d  ORGf28                                                                    82     84  0
025400080228     d  ORGf29                                                                    85     87  0
025500080228     d  ORGf30                                                                    88     90  0
025600080228     d  ORGf31                                                                    91     93  0
025700080228     d  ORGf32                                                                    94     96  0
025800080228     d  ORGf33                                                                    97     99  0
025900080228     d  ORGf34                                                                   100    102  0
026000080228     d  ORGf35                                                                   103    105  0
026100080228     d  ORGf36                                                                   106    108  0
026200080228     d  ORGf37                                                                   109    111  0
026300080228     d  ORGf38                                                                   112    114  0
026400080228     d  ORGf39                                                                   115    117  0
026500080228     d  ORGf40                                                                   118    120  0
026600080228     d  ORGf41                                                                   121    123  0
026700080228     d  ORGf42                                                                   124    126  0
026800080228     d  ORGf43                                                                   127    129  0
026900080228     d  ORGf44                                                                   130    132  0
027000080228     d  ORGf45                                                                   133    135  0
027100080228     d  ORGf46                                                                   136    138  0
027200080228     d  ORGf47                                                                   139    141  0
027300080228     d  ORGf48                                                                   142    144  0
027400080228     d  ORGf49                                                                   145    147  0
027500080228     d  ORGf50                                                                   148    150  0
027600080228     d  ORGf51                                                                   151    153  0
027700080228     d  ORGf52                                                                   154    156  0
027800080228     d  ORGf53                                                                   157    159  0
027900080228     d  ORGf54                                                                   160    162  0
028000080228     d  ORGf55                                                                   163    165  0
028100080228     d  ORGf56                                                                   166    168  0
028200080228     d  ORGf57                                                                   169    171  0
028300080228     d  ORGf58                                                                   172    174  0
028400080228     d  ORGf59                                                                   175    177  0
028500080228     d  ORGf60                                                                   178    180  0
028600080228     d  ORGf61                                                                   181    183  0
028700080228     d  ORGf62                                                                   184    186  0
028800080228     d  ORGf63                                                                   187    189  0
028900080228     d  ORGf64                                                                   190    192  0
029000080228     d  ORGf65                                                                   193    195  0
029100080228     d  ORGf66                                                                   196    198  0
029200080228     d  ORGf67                                                                   199    201  0
029300080228     d  ORGf68                                                                   202    204  0
029400080228     d  ORGf69                                                                   205    207  0
029500080228     d  ORGf70                                                                   208    210  0
029600080228     d  ORGf71                                                                   211    213  0
029700080228     d  ORGf72                                                                   214    216  0
029800080228     d  ORGf73                                                                   217    219  0
029900080228     d  ORGf74                                                                   220    222  0
030000080228     d  ORGf75                                                                   223    225  0
030100080228     d  ORGf76                                                                   226    228  0
030200080228     d  ORGf77                                                                   229    231  0
030300080228     d  ORGf78                                                                   232    234  0
030400080228     d  ORGf79                                                                   235    237  0
030500080228     d  ORGf80                                                                   238    240  0
030600080228     d  ORGf81                                                                   241    243  0
030700080228     d  ORGf82                                                                   244    246  0
030800080228     d  ORGf83                                                                   247    249  0
030900080228     d  ORGf84                                                                   250    252  0
031000080228     d  ORGf85                                                                   253    255  0
031100080228     d  ORGf86                                                                   256    258  0
031200080228     d  ORGf87                                                                   259    261  0
031300080228     d  ORGf88                                                                   262    264  0
031400080228     d  ORGf89                                                                   265    267  0
031500080228     d  ORGf90                                                                   268    270  0
031600080228     d  ORGf91                                                                   271    273  0
031700080228     d  ORGf92                                                                   274    276  0
031800080228     d  ORGf93                                                                   277    279  0
031900080228     d  ORGf94                                                                   280    282  0
032000080228     d  ORGf95                                                                   283    285  0
032100080228     d  ORGf96                                                                   286    288  0
032200080228     d  ORGf97                                                                   289    291  0
032300080228     d  ORGf98                                                                   292    294  0
032400080228     d  ORGf99                                                                   295    297  0
032500080228     d  ORGfA0                                                                   298    300  0
032600080228     d  ORGfA1                                                                   301    303  0
032700080228     d  ORGfA2                                                                   304    306  0
032800080228     d  ORGfA3                                                                   307    309  0
032900080228     d  ORGfA4                                                                   310    312  0
033000080228     d  ORGfA5                                                                   313    315  0
033100080228     d  ORGfA6                                                                   316    318  0
033200080228     d  ORGfA7                                                                   319    321  0
033300080228     d  ORGfA8                                                                   322    324  0
033400080228     d  ORGfA9                                                                   325    327  0
033500080228     d  ORGfB0                                                                   328    330  0
033600080228     d  ORGfB1                                                                   331    333  0
033700080228     d  ORGfB2                                                                   334    336  0
033800080228     d  ORGfB3                                                                   337    339  0
033900080228     d  ORGfB4                                                                   340    342  0
034000080228     d  ORGfB5                                                                   343    345  0
034100080228     d  ORGfB6                                                                   346    348  0
034200080228     d  ORGfB7                                                                   349    351  0
034300080228     d  ORGfB8                                                                   352    354  0
034400080228     d  ORGfB9                                                                   355    357  0
034500080228     d  ORGfC0                                                                   358    360  0
034600080228     d  ORGfC1                                                                   361    363  0
034700080228     d  ORGfC2                                                                   364    366  0
034800080228     d  ORGfC3                                                                   367    369  0
034900080228     d  ORGfC4                                                                   370    372  0
035000080228     d  ORGfC5                                                                   373    375  0
035100080228     d  ORGfC6                                                                   376    378  0
035200080228     d  ORGfC7                                                                   379    381  0
035300080228     d  ORGfC8                                                                   382    384  0
035400080228     d  ORGfC9                                                                   385    387  0
035500080228     d  ORGfD0                                                                   388    390  0
035600080228     d  ORGfD1                                                                   391    393  0
035700080228     d  ORGfD2                                                                   394    396  0
035800080228     d  ORGfD3                                                                   397    399  0
035900080228     d  ORGfD4                                                                   400    402  0
036000080228     d  ORGfD5                                                                   403    405  0
036100080228     d  ORGfD6                                                                   406    408  0
036200080228     d  ORGfD7                                                                   409    411  0
036300080228     d  ORGfD8                                                                   412    414  0
036400080228     d  ORGfD9                                                                   415    417  0
036500080228     d  ORGfE0                                                                   418    420  0
036600080228     d  ORGfE1                                                                   421    423  0
036700080228     d  ORGfE2                                                                   424    426  0
036800080228     d  ORGfE3                                                                   427    429  0
036900080228     d  ORGfE4                                                                   430    432  0
037000080228     d  ORGfE5                                                                   433    435  0
037100080228     d  ORGfE6                                                                   436    438  0
037200080228     d  ORGfE7                                                                   439    441  0
037300080228     d  ORGfE8                                                                   442    444  0
037400080228     d  ORGfE9                                                                   445    447  0
037500080228     d  ORGfF0                                                                   448    450  0
037600080228     d   $CF                   1    450  0 dim(150)
037700080228      *
037800080228      * - DS PER TRTB69R - TRTB70R - TRTB72R - TRTB73R - INT/GEST PARTIC.
037900080228     d TIBS02ds      e ds                  inz
038000040303      *
038100080228      * - Controllo/Inversione date
038200080228     d WLBdat          ds                  inz
038300080228     d  G02dat                 1      8  0 inz
038400080228     d  G02inv                 9     16  0 inz
038500080228     d  G02err                17     17    inz('3')
038600080228     d  G02tgi                18     22  0 inz
038700080228      *
038800080228      *?  V A R I A B I L I  ?----------------------------------------*
038900080228      *
039000080228      * - Flag booleani
039100080228      *
039200080228      * - Indici di schiera
039300080228     d xa              s              3  0 inz
039400080228      *
039500080228      * - Parametri per X§TABER
039600080228     d §Kut            s              1  0 inz
039700080228     d §Cod            s              2    inz
039800080228     d §Key            s              8    inz
039900080228     d §Des            s             30    inz
040000080228      * - Parametri per TNSD24R
040100080228     d §§Cod           s              3    inz
040200080228     d §§Tip           s                   like(ORGfag)  inz
040300080228     d §§Des           s             25    inz
040400080228     d §§Pra           s              3    inz
040500080228      *  - Comodo
040600080228     d §Fil            s                   like(ORGfil)  inz
040700080228     d wFil            s                   like(ORGfil)  inz
040800130830     d Datasys         s               d   datfmt(*iso) inz(*sys)
040900130830     d klna            s              3  0 inz
041000080228      *
041100080228      *?  K E Y - L I S T  ?------------------------------------------*
041200080228      *
041300080228     c     k02tabel      klist
041400080228     c                   kfld                    TBLkut
041500080228     c                   kfld                    TBLcod
041600080228     c     k03tabel      klist
041700080228     c                   kfld                    TBLkut
041800080228     c                   kfld                    TBLcod
041900080228     c                   kfld                    TBLkey
042000080228      *
042100080228      *?  I N D I C A T O R I   U T I L I Z Z A T I  ?----------------*
042200080228      *
042300080228      *  03        ANNULLATO
042400080228      *  21        Comodo
042500080228      *  22        E.o.F. TABEL
042600130423      *  28        Filiale NON di primo livello non visualizzo alcuni campi
042700080228      *  36        CHAIN GENERICO
042800080228      *  40        OFF --> PROFILE EDP
042900080228      *  48        Errore su P.O. elaboratore
043000080228      *  50        Errore:   p.o. inserito
043100080228      *  88        ORGANIGRAMMA DI SEDE
043200080228      *  71        FLAG protezione su sfl
043300080228      *  73        flag non visualizzazione su sfl
043400080228      *  75        PULIZIA SUBFILE
043500080228      *  80        Il p.o. immesso non è una agenzia
043600080228      *  81        OFF --> MANUTENZIONE   ON --> INTERROGAZIONE
043700080228      *  88        ORGANIGRAMMA DI SEDE
043800080228      *  91        Errore su area POC
043900080228      *  92        Errore su AREA EX AS400
044000080228      *
044100080228      *?  M A I N - L I N E  ?----------------------------------------*
044200080228      *
044300080228     c     *Entry        plist
044400080228     c                   parm                    KPJBA
044500131021      *
044600131021      *  Controlla se si tratta di UTENTE EDP* 24=*ON
044700131021     c                   clear                   utente_EDP        1
044800131021     c                   setoff                                       24
044900131021     c                   if        %subst(knmus:1:3) = 'EDP'
045000131021     c                   eval           utente_EDP ='S'
045100131021     c                   setoN                                        24
045200131021     c                   end
045300080228      *
045400080228      * Reperisco dati job
045500080228     c                   exsr      DatiJob
045600080228      *
045700080228      * Verifica autorizzazioni utente
045800080305     c                   eval      *in40 = (§UTEgorg <> 'C'   and
045900080305     c                                      %subst(KNMUS : 1 : 3) <> 'EDP')
046000080228      *
046100080228      * 88 on - organigramma di sede
046200080228     c                   eval      *in88 = (%subst(KPJBU : 1 : 4) = 'SEDE')
046300080228     c                   eval      TBLkut = 1
046400080228      *
046500080228      *---------------------------------------------------------------------
046600080228      *
046700080228      *  81 on - Interrogazione
046800080228     C                   eval      *in81=*on
046900030430      *
047000000000     C     INIZIO        TAG
047100080228     C                   eval      *in80=*off
047200080228     C                   eval      *in03=*off
047300080228     C                   movel     *blanks       $De
047400080228     C                   movel     *blanks       VDe
047500080228     C                   z-add     0             $Cf
047600080228     C                   z-add     0             Vcf
047700080228     C                   movel     *blanks       VFil
047800080228     C                   movel     '?'           VFil
047900080228     C                   movel     *blanks       VTip
048000030430      *
048100000000     C     VID1          TAG
048200080228     c                   write     SD15T01
048300000000     C                   EXFMT     SD15D01
048400000000     C   KC              GOTO      FINE
048500130904      *
048600130904      * F07 - Orari servizi standard
048700130904      *
048800130904     c                   if        *inkg=*on
048900131021     c                             and  utente_EDP ='S'
049000130904     c                   eval      klna=999
049100130904     c                   exsr      Ges_serv
049200130904     C                   GOTO      inizio
049300130904     c                   endif
049400030430      *
049500030430      * Gestione VIDEO 1
049600030430      *
049700000000     C     VFIL          IFEQ      *ZERO
049800000000     C                   SETON                                        50
049900000000     C                   GOTO      VID1
050000000000     C                   END
050100000000     C*
050200080228     C     '?'           scan      VFil                                   21
050300000000     C   21              DO
050400080228     C   88              MOVE      '§'           §§Tip
050500971203     C                   CALL      'TNSD24R'
050600080228     C                   PARM                    §§Cod
050700080228     C                   PARM                    §§Tip
050800080228     C                   PARM                    §§DES
050900080228     C                   PARM                    §§PRA
051000080228     C                   MOVEL     §§COD         VFIL
051100080228     C                   MOVEL     §§TIP         VTIP
051200000000     C                   GOTO      VID1
051300080228     C                   ENDdo
051400000000     C** CONTROLLO CHE IL CODICE FILIALE IMMESSO SIA
051500000000     C** NUMERICO
051600040922     C                   TESTN                   VFIL                 36
051700040922     c                   move      vfil          w001a             1
051800040922     c
051900040922     c                   if        not *in36 or w001a<'0'
052000000000     C                   SETON                                        50
052100000000     C                   GOTO      VID1
052200000000     C                   END
052300000000     C*
052400080228     C                   MOVEL     VFIL          §Fil
052500080228     C  N88§Fil          CHAIN     AZORG                              36
052600080228     C   88§Fil          CHAIN     AZOSE                              36
052700020617     C     *IN36         IFEQ      *ON
052800000000     C                   SETON                                        50
052900000000     C                   GOTO      VID1
053000040922     C                   endif
053100030430      *
053200030430      * Gestione 2° video
053300030430      *
053400030430     C                   EXSR      PulVid2
053500130423     C                   EXSR      PulVid21
053600040303     C                   EXSR      PulVid3
053700040303     C                   EXSR      PulVid4
053800070828     C                   EXSR      PulVid5
053900030430     C  n36              EXSR      Aggvid2
054000130423     C                   EXSR      AggVid21
054100040922     C                   IF        *in88= *off and *in40 =*off
054200040303     C                   EXSR      AggVid3
054300040303     C                   EXSR      AggVid4
054400070828     C                   EXSR      AggVid5
054500040303     c                   endif
054600040303     c
054700020625     C     VID2          TAG
054800080228     c                   clear                   VDFil
054900080228     C                   eval      *in98 = *off
055000080228     c                   write     SD15T01
055100080228     c                   write     SD15T02
055200000000     C                   EXFMT     SD15D02
055300080228      * Fine lavoro
055400000000     C   KC              GOTO      INIZIO
055500080228      *
055600080228      * Descrizione p.o.
055700080228     c                   eval      VDFil = VDesF
055800130423
055900130423      * Gestione video 2a
056000130423      *
056100130423     c     VID21         TAG
056200130423     c                   write     SD15T01
056300130423     c                   write     SD15T02
056400130423     C                   EXFMT     SD15D021
056500130423
056600130423     C                   eval      *in11 = *off
056700130423      * Fine lavoro
056800130423     C   KC              GOTO      INIZIO
056900130423      * Video precedente
057000130423     C   KL              GOTO      VID2
057100130830      *  F7 - servizi orari
057200130830     c                   if        *inkg = *on
057300131021     c                             and  utente_EDP ='S'
057400130830     c                   eval      klna=§fil
057500130830     c                   exsr      Ges_serv
057600130830     C                   GOTO      VID21
057700130830     c                   endif
057800130830
057900130423
058000030430      *
058100030430      * LE VIDEATE SUCCESSIVE VENGONO GESTITE SOLO PER UTENTE
058200030430      * EDP E NON STO GESTENDO L'ORGANIGRAMMA DI SEDE
058300030430      *
058400030430     C                   IF        *in88= *off and *in40 =*off
058500030430      *
058600030430      * Gestione video 3
058700030430      *
058800021029     C     VID3          TAG
058900080228     c                   write     SD15T01
059000080228     c                   write     SD15T02
059100021029     C                   EXFMT     SD15D03
059200080228      * f3 - fine
059300080228     C   KC              GOTO      INIZIO
059400030430      * Video precedente
059500130423     C   KL              GOTO      VID21
059600030430      *
059700030430      * Gestione video 4
059800030430      *
059900030430     C     VID4          TAG
060000080228     C                   eval      *in94 = *off
060100080228     c                   write     SD15T01
060200080228     c                   write     SD15T02
060300030430     C                   EXFMT     SD15D04
060400080228      * Fine lavooro
060500080228     C   KC              GOTO      INIZIO
060600030430      * Video precedente
060700030430     C   KL              GOTO      VID3
060800070828      *
060900070828      * Gestione video 5
061000070828     C     VID5          TAG
061100080228     C                   eval      *in30 = *off
061200080228     c                   write     SD15T01
061300080228     c                   write     SD15T02
061400070828     C                   EXFMT     SD15D05
061500080228      * Fine lavoro
061600080228     C   KC              GOTO      INIZIO
061700070828      * Video precedente
061800070828     C   KL              GOTO      VID4
061900030430      *
062000030430     C                   ENDIF
062100040303     c
062200030430      * Pulizia subfile
062300021029     C                   EXSR      PULSFL
062400030430      * Caricamento subfile
062500021029     C                   EXSR      CARSFL
062600040928     c                   if        nrr>0
062700000000     C                   Z-ADD     1             NRR
062800020625     C     C1TAG         TAG
062900080228     C                   SETOFF                                       99
063000080228     c                   write     SD15T01
063100080228     c                   if        NOT *in88
063200080228     c                   write     SD15T02
063300080228     c                   endif
063400090709     C                   WRITE     SD15Z02
063500000000     C                   EXFMT     SD15DCT
063600030430      *
063700070828      * Video precedente: carico il video 5 se sono EDP e se non
063800030430      * sto leggendo AzOse
063900030430     C                   IF        *inKL = *on and *in40 = *off
064000030430     C                             and *in88 = *off
064100030430     C
064200070828     C                   GOTO      VID5
064300030430     C                   ENDIF
064400030430     C
064500130423     C   KL              GOTO      VID21
064600040928     c                   else
064700040928     c                   if        *in40=*off and *in88 = *off
064800070828     C                   GOTO      VID5
064900040928     c                   else
065000130423     C                   GOTO      VID21
065100040928     c                   endif
065200040928     c                   endif
065300020628     C                   GOTO      INIZIO
065400000000     C     FINE          TAG
065500030430      *
065600040922     C                   CLEAR                   fnlv55ds
065700980204     C                   MOVEL     'C'           D55TLA
065800980204     C                   CALL      'FNLV55R'
065900040922     C                   PARM                    fnlv55ds
066000030430      *
066100000000     C                   SETON                                        LR
066200080228      *
066300080228      *---------------------------------------------------------------*
066400080228      * Reperimento Dati del job (Utente/Operativi)                   *
066500080228      *---------------------------------------------------------------*
066600080228     c     DatiJob       BEGSR
066700080228      *
066800080228     c     *dtaara       define    §azute        azuteds
066900080228     c     *dtaara       define    §datiute      ddatiute
067000080228      *
067100080228     c                   in(E)     *dtaara
067200080228     c                   IF        %ERROR or RSUT = *blanks
067300080228     c                   clear                   Tibs34Ds
067400080228     c                   call      'TIBS34R'
067500080228     c                   parm                    Tibs34Ds
067600080228     c                   in        *dtaara
067700080228     c                   ENDIF
067800080228      *
067900080228     c                   eval      dUTE01 = UTEfaf
068000080228      *
068100080228     c                   ENDSR
068200040922      *--------------------------------------------------------------------
068300040922      *-PULIZIA-DEL-SUBFILE
068400040922      *--------------------------------------------------------------------
068500021029     C     PULSFL        BEGSR
068600000000     C                   SETON                                        75
068700000000     C                   WRITE     SD15DCT
068800000000     C                   SETOFF                                       75
068900000000     C                   ENDSR
069000040922      *--------------------------------------------------------------------
069100021029      * CARICAMENTO SUBFILE
069200021029      *----------------------
069300021029     C     CARSFL        BEGSR
069400000000     C                   Z-ADD     0             NRR               4 0
069500080228     C                   Z-ADD     0             xa
069600000000     C* CARICO TUTTA LA TABELLA 'OG/OR'
069700080228     C  n88              MOVEL     'OG'          TBLcod
069800080228     C   88              MOVEL     'OR'          TBLcod
069900080228     C     k02tabel      SETLL     TABEL
070000080228     C     k02tabel      READE     TABEL                                  22
070100080228do  1C     *IN22         DOWEQ     '0'
070200000000     C                   SETOFF                                       73  71
070300080228if  2c                   if        tblkey<>*blanks and tblflg=*blanks
070400030521     C  n88              MOVEL     TBLUNI        DSOG
070500030521     C   88              MOVEL     TBLUNI        DSOR
070600030521      *
070700030521      * CONTROLLO FLAGS DSOG
070800030521      *
070900080228if  3C                   if        not *in88
071000040922     c* Essendo in interogazione i campi sono sempre protetti.
071100040922     c*  controllo selo la visibilità  per F/A o V/T
071200040922      *  in cui distinguo i casi EDP/non EDP
071300040922     c*
071400030519      * Caso F/A
071500080228if  4C                   IF        VTip = 'F' or VTip = 'A'
071600030519     C                   SELECT
071700030519      *
071800040922      * Non visibile per tutti a parte per EDP
071900030519     C     §OGFRI        WHENEQ    'Z'
072000040928     C     §OGFRI        oreq      'W'
072100030519     C   40              SETON                                        73        NON VISIBILE
072200030519      *
072300030519      * Non visibile in generale,oppure per 1° o 2° livello (in questi
072400030519      * due casi si fa riferimento al campo in prima videata)
072500030519     C     §OGFRI        WHENEQ    'Y'                                          NON VISIBILE
072600970514     C     §OGFRI        OREQ      '1'                                          NON VISIB. 1°LIV.
072700040525     C     vlpo          ANDEQ     '1'
072800970514     C     §OGFRI        OREQ      '2'                                          NON VISIB. 1°LIV.
072900040525     C     vlpo          ANDEQ     '2'
073000030519     C                   SETON                                        73
073100030519     C                   ENDSL
073200030519      *
073300030519      * Caso T/V
073400080228x   4C                   ELSE
073500030519     C                   SELECT
073600030519      *
073700040922      * Non visibile per tutti a parte per EDP
073800030519     C     §OGFRV        WHENEQ    'Z'
073900040928     C     §OGFRV        oreq      'W'
074000030519     C   40              SETON                                        73        NON VISIBILE
074100030519      *
074200030519      * Non visibile
074300030519     C     §OGFRV        WHENEQ    'Y'                                          NON VISIBILE
074400030519     C                   SETON                                        73
074500050503      * visibile solo per il network LOG
074600050503     C     §OGFRV        WHENEQ    'L'                                          NON VISIBILE
074700050503     c                   if        vntw<>'LOG'
074800050503     C                   SETON                                        73
074900050503     c                   endif
075000030519     C                   ENDSL
075100080228e   4C                   ENDIF
075200080228e   3C                   endif
075300030521      *
075400030521      * MEMORIZZA CHIAVE COMPLETA
075500030521      *
075600000000     C                   MOVEL     *BLANKS       SFRAG
075700000000     C                   MOVEL     *BLANKS       SFDES
075800000000     C                   Z-ADD     0             SFFIA
075900000000     C                   MOVEL     TBLKEY        SFCOD
076000080228     C                   Z-ADD     SFCOD         xa
076100000000     C                   MOVEL     TBLUNI        SFTAB
076200030521     C  N88              MOVEL     §OGSIG        SFSIG
076300080228     C                   MOVEL     VDE(xa)       SFRAG
076400080228     C                   MOVEL     VCF(xa)       SFFIA
076500040922     C                   Z-ADD     SFFIA         wFIL
076600040922     C     wfil          CHAIN     AZORG                              36
076700030521     C  N36              MOVEL     ORGDES        SFDES
076800040922     c
076900040922     c*
077000040922     c* Se visualizzabile, 73 off,  scrivo
077100080228     C  N73              DO
077200000000     C                   ADD       1             NRR
077300000000     C                   WRITE     SD15DSF
077400080228     C                   END
077500080228      *
077600080228e   2C                   endif
077700080228      *
077800080228     C     k02tabel      READE     TABEL                                  22
077900080228e   1C                   ENDdo
078000000000     C                   ENDSR
078100030430      *------------------------------------------------------
078200030430      * Pulizia VIDEO 2
078300030430      *------------------------------------------------------
078400030430     C     PULVID2       BEGSR
078500030430      *
078600040518     c                   eval      vfild=vfil
078700030430     C                   movel     *blanks       vdesf
078800030430     C                   movel     *blanks       vindf
078900030430     C                   z-add     0             vcapf
079000030430     C                   movel     *blanks       vlocf
079100030430     C                   movel     *blanks       vprof
079200030430     C                   movel     *blanks       vtlxf
079300030430     C                   movel     *blanks       vfaxf
079400030430     C                   movel     *blanks       vcaa
079500030430     C                   movel     *blanks       vtelf
079600030430     C                   movel     *blanks       vdesa
079700030430     C                   z-add     0             vcapa
079800030430     C                   movel     *blanks       vloca
079900030430     C                   movel     *blanks       vproa
080000030430     C                   movel     *blanks       vinda
080100030430     C                   movel     *blanks       vtela
080200030430     C                   movel     *blanks       vfaxa
080300030430     C                   movel     *blanks       vtlxa
080400040518     C                   movel     *blanks       vteld
080500030430     C                   movel     *blanks       vcts
080600030430     C                   move      *zeros        vcar
080700030430     C                   move      *zeros        vcre
080800030430     C                   movel     *blanks       vdcts
080900030430     C                   movel     *blanks       vdfl3
081000030430     C                   movel     *blanks       vdcar
081100030430     C                   movel     *blanks       vdcre
081200030430     C                   movel     *blanks       vlpo
081300030430     C                   movel     *blanks       vdlpo
081400030430     C                   movel     *blanks       vntw
081500030430     C                   movel     *blanks       vdntw
081600030430     C                   movel     *blanks       vdit
081700030430     C                   movel     *blanks       vfl1
081800030430     C                   movel     *blanks       vfl3
081900030430     C                   movel     'N'           vdpd
082000030430     C                   movel     *blanks       vpos
082100040922     C                   movel     *blanks       vdtfp
082200040922     C                   movel     *blanks       vdtfa
082300040922     C                   move      *blanks       vtfp
082400040922     C                   move      *blanks       vtfa
082500071015     c                   clear                   vindip
082600030430      *
082700000000     C                   ENDSR
082800030430      *-----------------------------------------------------
082900030430      * Riempimento VIDEO 2
083000030430      *-----------------------------------------------------
083100030430     C     AGGVID2       BEGSR
083200100930     c                   setoff                                       19
083300080228     C                   MOVEL     $DE           VDE
083400080228     C                   Z-ADD     $CF           VCF
083500040922     C                   MOVEL     ORGFAG        VTIP
083600080228     c* Annullamento 03 on
083700080228     c                   eval      *in03 = (ORGfva = '*')
083800040922     c* no agenzia 80 on
083900040922     C     VTIP          IFNE      'A'                                          AGENZIA
084000040922     C                   SETON                                        80
084100040922     C                   END
084200030430      * Dati descrittivi
084300030430     C                   MOVEL     ORGDES        VDESF
084400040922     C                   MOVEL     ORGDES        VDfil
084500030430     C                   MOVEL     ORGIND        VINDF
084600030430     C                   Z-ADD     ORGCPF        VCAPF
084700030430     C                   MOVEL     ORGLOC        VLOCF
084800030430     C                   MOVEL     ORGPRO        VPROF
084900030430     C                   MOVEL     ORGTEL        VTELF
085000030430     C                   MOVEL     ORGFAX        VFAXF
085100030430     C                   MOVEL     ORGTLX        VTLXF
085200040922      * Dati descrittivi per tipo <> 'F'
085300040922     C  N80              DO
085400040922     C                   MOVEL     ORGDEA        VDESA
085500040922     C                   MOVEL     ORGINA        VINDA
085600040922     C                   Z-ADD     ORGCPA        VCAPA
085700040922     C                   MOVEL     ORGLOA        VLOCA
085800040922     C                   MOVEL     ORGPRA        VPROA
085900040922     C                   MOVEL     ORGTEA        VTELA
086000040922     C                   MOVEL     ORGFAA        VFAXA
086100040922     C                   MOVEL     ORGTLA        VTLXA
086200040922     C                   END
086300040922     c* Imposto tutte le Ds presenti, anche se poi non le visualizzo
086400040922     C* SOLO SE ORGANIGRAMMA DI FILIALE
086500040922     C                   if        not *in88
086600040922     C                   MOVEL     ORGDE0        OG140
086700050708     C                   MOVEL     ORGDE1        OG141
086800040922     C                   MOVEL     ORGDE2        OG142
086900040922     C                   MOVEL     ORGDE3        OG143
087000040922     C                   MOVEL     ORGDE4        og144
087100040922     C                   MOVEL     ORGDE6        og146
087200040922     C                   MOVEL     ORGDE7        OG147
087300040922     C                   MOVEL     ORGDE8        OG148
087400040922     C                   movel     ORGDE9        Og149
087500040922     C                   MOVEL     ORGDF0        og150
087600040922     c
087700040922      * telefono diretto P.O
087800040518     C                   movel     §OgTld        VTELD
087900030430      * tassazione
088000030430     C                   MOVEL     ORGCTS        VCTS
088100100125      * direzione commerciale
088200030430     C                   MOVEL     ORGFL3        VFL3
088300030430      * regione
088400030430     C                   MOVE      ORGCRE        VCRE
088500030430      * area
088600030430     C                   MOVE      ORGCAR        VCAR
088700030430      *
088800030430      * Livello P.O
088900030430     C                   MOVE      §OGLPO        VLPO
089000030430      * aspettativa aziendale
089100030430     C                   MOVEL     ORGCAA        VCAA
089200030430      * NetWork
089300030430     C                   MOVEL     §OGNTW        VNTW
089400100930     c* Filiale invio materiale EDP
089500100930     C                   MOVEL     §OGlue        Vlue
089600030430      * ramo aziendale
089700030430     C                   MOVEL     ORGDIT        VDIT
089800030430      * p.o italia/estero
089900030430     C                   MOVEL     ORGFL1        VFL1
090000030430      * Dpd
090100030430     C                   MOVEL     §OGDPD        VDPD
090200030430      * Poste
090300030430     C                   MOVEL     §OGPT         VPOS
090400071015      * Indirizzo IP
090500071015     c                   movel     §ogiip        vindip
090600030430     C                   CLEAR                   VFAG
090700040922      * Tipo p.o.
090800030430     C                   SELECT
090900030430     C     ORGFAG        WHENEQ    'F'
091000030430     C                   MOVEL     'FILIALE'     VFAG
091100030430     C     ORGFAG        WHENEQ    'A'
091200030430     C                   MOVEL     'AGENZIA'     VFAG
091300030430     C     ORGFAG        WHENEQ    'V'
091400030430     C     ORGFL2        ANDEQ     ' '
091500030430     C                   MOVEL     'VARIE'       VFAG
091600100930     C                   Eval      *in19 = *on
091700030430     C     ORGFAG        WHENEQ    'V'
091800030430     C     ORGFL2        ANDEQ     'S'
091900080228     C                   MOVEL     C_Ln_x_Tar    VFAG
092000030430     C                   ENDSL
092100040922     c* Terminal partenza
092200040930     c* solo per tipi F o a
092300040930     c                   if        orgfag='A' or orgfag='F'
092400040922     C                   CLEAR                   FNLV55DS
092500040922     C                   MOVEL     'P'           D55TPT
092600040922     C                   MOVE      vfil          D55LIN
092700040922     C                   MOVE      *date         d55drf
092800040922     C                   CALL      'FNLV55R'
092900040922     C                   PARM                    FNLV55DS
093000040922     c                   if        d55err<>*blanks
093100080228     c                   movel(p)  C_Not_Pres    vdtfp
093200040922     c                   else
093300040922     c                   movel     d55tfp        vtfp
093400040922     c     d55tfp        chain     azorg
093500040922     c                   if        %found(azorg01l)
093600040922     c                   movel     orgdes        vdtfp
093700040922     c                   endif
093800040922     c                   endif
093900040922     c* Terminal arrivo
094000040922     C                   CLEAR                   FNLV55DS
094100040922     C                   MOVEL     'A'           D55TPT
094200040922     C                   MOVE      vfil          D55LIN
094300040922     C                   MOVE      *date         d55drf
094400040922     C                   CALL      'FNLV55R'
094500040922     C                   PARM                    FNLV55DS
094600100617     c
094700100617     c* Se trovato errore, vedo se ancora da decorrere
094800100617     C*  UTILIZZando la DATA INIZIO SCANNERIZZAZIONE LDV
094900100617     c                   if        d55err<>*blanks  and
095000100617     c                             §ogdsd>*zeros
095100100617     c                   movel     §ogdsd        w0080             8 0
095200100617     c                   if        w0080>d55drf
095300100617     c                   movel     w0080         d55drf
095400100617     C                   CALL      'FNLV55R'
095500100617     C                   PARM                    FNLV55DS
095600100617     c                   endif
095700100617     c                   endif
095800100617     c
095900100617     c                   if        d55err<>*blanks
096000080228     c                   movel     C_Not_Pres    vdtfa
096100040922     c                   else
096200040922     c                   movel     d55tfa        vtfa
096300040922     c     d55tfa        chain     azorg
096400040922     c                   if        %found(azorg01l)
096500040922     c                   movel     orgdes        vdtfa
096600040922     c                   endif
096700040922     c                   endif
096800040930     c                   endif
096900030430      *
097000030430      * DECODIFICHE
097100030430      *
097200030430      * tassazione
097300080228     C                   movel     'CT'          TBLcod
097400080228     C                   movel     *blanks       TBLkey
097500080228     C                   movel     vcts          TBLkey
097600080228     C     k03tabel      chain     tabel                              36
097700030430     C  n36              movel     tbluni        vdcts
097800030430      *
097900100125      * direzione commerciale
098000080228     C                   movel     '17'          TBLcod
098100080228     C                   movel     *blanks       TBLkey
098200080228     C                   movel     vfl3          TBLkey
098300080228     C     k03tabel      chain     tabel                              36
098400030430     C  n36              movel     tbluni        vdfl3
098500030430      *
098600030430      * Regione
098700080228     C                   movel     '14'          TBLcod
098800080228     C                   movel     *blanks       TBLkey
098900080228     C                   movel     vcre          TBLkey
099000080228     C     k03tabel      chain     tabel                              36
099100030430     C  n36              movel     tbluni        vdcre
099200030430      *
099300030430      * area
099400080228     C                   movel     '05'          TBLcod
099500080228     C                   movel     *blanks       TBLkey
099600080228     C                   movel     vcar          TBLkey
099700080228     C     k03tabel      chain     tabel                              36
099800030430     C  n36              movel     tbluni        vdcar
099900030430      *
100000030430      * Livello p.o
100100030430     C                   SELECT
100200030430     C     vlpo          WHENEQ    *blanks
100300080228     C                   movel     C_NotOpe      vdlpo
100400030430     C     vlpo          WHENEQ    '1'
100500080228     C                   movel     C_1_Liv       vdlpo
100600030430     C     vlpo          WHENEQ    '2'
100700080228     C                   movel     C_2_liv       vdlpo
100800030430     C                   ENDSL
100900030430      * Network
101000030430     C                   IF        vntw <> *blanks
101100080228     C                   clear                   TIBS02ds
101200030430     C                   movel     'C'           T02mod
101300030430     C                   movel     knsif         T02sif
101400030430     C                   movel     'NTW'         T02cod
101500030430     C                   movel     *blanks       T02ke1
101600030505     C                   movel     vntw          T02ke1
101700030430     C                   CALL      'TIBS02R'
101800030430     C                   parm                    kpjba
101900080228     C                   parm                    TIBS02ds
102000030430      *
102100030430     C                   IF        t02err = *blanks
102200030430     C                   movel     t02uni        vdntw
102300030430     C                   ENDIF
102400030430     C                   ENDIF
102500040922     c
102600040922      *
102700040922      * Riaggancio azorg con corretto P.O
102800080228     C     §Fil          CHAIN     AZORG                              36
102900040922     C                   ENDIF
103000030430      *
103100030430     C                   ENDSR
103200130423      *------------------------------------------------------
103300130423      * Pulizia VIDEO 2a
103400130423      *------------------------------------------------------
103500130423     C     PULVID21      BEGSR
103600130423
103700130423     c                   clear                   V02oramd
103800130423     c                   clear                   V02orama
103900130423     c                   clear                   V02orapd
104000130423     c                   clear                   V02orapa
104100130423     c                   clear                   V02ascm
104200130423     c                   clear                   V02comt
104300130423     c                   clear                   V02comm
104400131108     c                   clear                   V02orfmd
104500131108     c                   clear                   V02orfma
104600131108     c                   clear                   V02orfpd
104700131108     c                   clear                   V02orfpa
104800130423     C                   ENDSR
104900130423      *-----------------------------------------------------
105000130423      * Riempimento VIDEO 2a
105100130423      *-----------------------------------------------------
105200130423     C     AGGVID21      BEGSR
105300130423
105400130423      * Non visualizzo alcuni dati per filiali di secondo livello
105500130423     c                   eval      *in28 = (vlpo <> '1')
105600130423
105700130423     c                   eval      OG130 = ORGdd0
105800130423     c                   IF        §OGoramd <> *blanks
105900130423     c                   eval      V02oramd = %int(§OGoramd)
106000130423     c                   ELSE
106100130423     c                   clear                   V02oramd
106200130423     c                   ENDIF
106300130423     c                   IF        §OGorama <> *blanks
106400130423     c                   eval      V02orama = %int(§OGorama)
106500130423     c                   ELSE
106600130423     c                   clear                   V02orama
106700130423     c                   ENDIF
106800130423     c                   IF        §OGorapd <> *blanks
106900130423     c                   eval      V02orapd = %int(§OGorapd)
107000130423     c                   ELSE
107100130423     c                   clear                   V02orapd
107200130423     c                   ENDIF
107300130423     c                   IF        §OGorapa <> *blanks
107400130423     c                   eval      V02orapa = %int(§OGorapa)
107500130423     c                   ELSE
107600130423     c                   clear                   V02orapa
107700130423     c                   ENDIF
107800130423     c                   eval      V02ascm = ORGdd2
107900130423     c                   eval      V02comt = ORGdd3
108000130423     c                   eval      V02comm = ORGdd4
108100131108
108200131108     c                   eval      OG129 = ORGdc9
108300131108     c                   IF        §OGorfmd <> *blanks
108400131108     c                   eval      V02orfmd = %int(§OGorfmd)
108500131108     c                   ELSE
108600131108     c                   clear                   V02orfmd
108700131108     c                   ENDIF
108800131108     c                   IF        §OGorfma <> *blanks
108900131108     c                   eval      V02orfma = %int(§OGorfma)
109000131108     c                   ELSE
109100131108     c                   clear                   V02orfma
109200131108     c                   ENDIF
109300131108     c                   IF        §OGorfpd <> *blanks
109400131108     c                   eval      V02orfpd = %int(§OGorfpd)
109500131108     c                   ELSE
109600131108     c                   clear                   V02orfpd
109700131108     c                   ENDIF
109800131108     c                   IF        §OGorfpa <> *blanks
109900131108     c                   eval      V02orfpa = %int(§OGorfpa)
110000131108     c                   ELSE
110100131108     c                   clear                   V02orfpa
110200131108     c                   ENDIF
110300130423
110400130423     C                   ENDSR
110500030430      *----------------------------------------------------
110600030430      * Puliza  VIDEO 3
110700030430      *----------------------------------------------------
110800030430     C     PULVID3       BEGSR
110900030430      * Raggruppamenti
111000030430     C                   move      *blanks       vara
111100040303     C                   move      *blanks       vdara
111200030430     C                   MOVE      *blanks       vapo
111300030430     C                   MOVEL     *blanks       vdapo
111400030430     C                   MOVE      *blanks       vaex
111500030430     C                   MOVEL     *blanks       vdaex
111600151028     C                   clear                   vArc
111700151028     C                   clear                   vdArc
111800040303     C                   MOVEL     *blanks       vdogas
111900040922     C                   movel     *blanks       vdfle
112000040922     C                   z-add     0             vfle
112100030430     C                   move      *zeros        vogas
112200030430     C                   movel     *blanks       vhub
112300030430     C                   movel     *blanks       vdpt
112400131016     C                   z-add     0             vlRESI
112500131016     C                   movel     *blanks       vlRESId
112600150430     C                   z-add     0             vflnpb
112700150430     C                   movel     *blanks       vdlnpb
112800090709     C                   z-add     0             vfcont
112900090709     C                   movel     *blanks       vdfcont
113000060828     C                   movel     *blanks       Vssp
113100060828     C                   movel     *blanks       Vssc
113200060828     C                   movel     *blanks       Vfxi
113300060828     C                   movel     *blanks       Vfxo
113400030430      *
113500030430      * Dati per tariffe
113600030430     C                   movel     *blanks       barfd1
113700030430     C                   movel     *blanks       barfd2
113800030430     C                   move      *zeros        vret
113900030430     C                   movel     *blanks       vdret
114000030430      *
114100030430     C                   ENDSR
114200030430      *------------------------
114300030430      * Riempimento VIDEO 3
114400030430      *------------------------
114500030430     C     AGGVID3       BEGSR
114600040922      * p.o elaboratore
114700040922     C                   MOVEL     ORGFEL        VFLE
114800100930     c* filiale invio materiale EDP
114900100930     C                   MOVEL     §OGfiue       Vfiue
115000100930     c
115100090709     C                   MOVEL     ORGFC0        VFCont
115200040922      *
115300040922     C                   IF        vfle > *ZERO
115400040922     C     vfle          chain     azorg                              48
115500040922     C  n48              movel     orgdes        vdfle
115600040922     C                   END
115700131016     c
115800070227      * p.o contabilità
115900070227      *
116000090709     C                   IF        vfcont > *ZERO
116100090709     C     vfcont        chain     azorg
116200070227     c                   if        %found(azorg01l)
116300090709     C                   movel     orgdes        vdfcont
116400070227     C                   END
116500070227     c                   else
116600090709     c                   clear                   vdfcont
116700070227     C                   END
116800100930     c
116900100930      * fil invio materiale EDP
117000100930     c                   clear                   vdfiue
117100100930     C                   IF        vfiue> *ZERO
117200100930     C                   move      vfiue         wfil
117300100930     C     wfil          chain(N)  azorg                              36
117400100930     C  n36              movel     orgdes        vdfiue
117500100930     C                   END
117600100930     c
117700151028      * Raggruppamento area/area ex as400/area POC/area centralino
117800030521     C                   if        §OGARA <> *zeros
117900030521     C                   MOVE      §OGARA        VARA
118000080228     C                   MOVEL     '05'          TBLcod
118100080228     C                   MOVEL     *BLANKS       TBLkey
118200080228     C                   MOVEL     VARA          TBLkey
118300080228     C     k03tabel      CHAIN     TABEL                              36
118400040303     c  n36              movel     tbluni        vdara
118500030521     C                   endif
118600030521      *
118700030521     C                   if        §OGAEX <> *zeros
118800030521     C                   MOVE      §OGAEX        VAEX
118900030521     C                   endif
119000030521      *
119100030521     C                   if        §OGAPO <> *zeros
119200030521     C                   MOVE      §OGAPO        VAPO
119300030521     C                   endif
119400151028      *
119500151028     C                   if        §OGARC <> *zeros
119600151028     C                   MOVE      §OGARC        VARC
119700151028     C                   MOVEL     '05'          TBLcod
119800151028     C                   MOVEL     *BLANKS       TBLkey
119900151028     C                   MOVEL     VARC          TBLkey
120000151028     C     k03tabel      CHAIN     TABEL                              36
120100151028     c  n36              movel     tbluni        vdArc
120200151028     C                   endif
120300030521      *
120400040922      * Hub
120500060426     c                   move      §oghb1        vhub
120600030521      * Deposito
120700060426     c                   move      §ogdp1        vdpt
120800150430      * Filiale valida come linea di partenza bolla
120900150430     C                   if        §OGlnpb    <> *blanks
121000150430     c                   move      §oglnpb       vflnpb
121100150430     c                   end
121200150430      *
121300150430     C                   IF        vflnpb > *ZERO
121400150430     C     vflnpb        chain     azorg
121500150430     c                   if        %found(azorg01l)
121600150430     C                   movel     orgdes        vdlnpb
121700150430     C                   END
121800150430     c                   else
121900150430     c                   clear                   vdlnpb
122000150430     C                   END
122100131016      * Linea Forzatura RESI
122200131018     C                   if        §OGLNARES  <> *blanks
122300131016     c                   move      §ogLnaRes     vlRESI
122400131018     c                   end
122500131016      * p.o Forzatura Resi
122600131016     C                   IF        vlresi > *ZERO
122700131016     C     vlresi        chain     azorg
122800131016     c                   if        %found(azorg01l)
122900131016     C                   movel     orgdes        vlresiD
123000131016     C                   END
123100131016     c                   else
123200131016     c                   clear                   vlresiD
123300131016     C                   END
123400131016      *
123500030430      * Ambiente appartenenza
123600030430     C                   MOVEL     §OGAS         VOGAS
123700030430      * Regione
123800030430     C                   MOVE      §ogret        Vret
123900030430      * Stampa P.O nei terminals
124000030430     C                   MOVE      §OGBD1        BARFD1
124100030430     C                   MOVE      §OGBD2        BARFD2
124200060828      * Code Faxin/Faxout
124300060828     C                   MOVE      §OGFXI        VFXI
124400060828     C                   MOVE      §OGFXO        VFXO
124500060828      * Code stampa sede per P.O
124600060828     C                   MOVE      §ogssp        Vssp
124700060828      * Code stampa sede per Commerciale P.O
124800060828     C                   MOVE      §ogssc        Vssc
124900030430      *
125000030430      * DECODIFICHE
125100030430      *
125200030430      * Area ex As400
125300030430     C                   IF        vaex > *zeros
125400080228     C                   move      vaex          wfil
125500030430     C     wfil          chain     AzOrg                              92
125600030430     C  N92              movel     orgdes        vdaex
125700030430     C                   ENDIF
125800040303      *
125900040303      * ambiente appartenenza
126000040303     C                   IF        vogas> *zeros
126100080228     C                   move      vogas         wfil
126200040303     C     wfil          chain     AzOrg                              92
126300040303     C  N92              movel     orgdes        vdogas
126400040303     C                   ENDIF
126500030430      *
126600030430      * area POC
126700030430     C                   IF        vapo > *zeros
126800080228     C                   move      vapo          wfil
126900030430     C     wfil          chain     AzOrg                              91
127000030430     C  N91              movel     orgdes        vdapo
127100030430     C                   ENDIF
127200030430      *
127300030430      * Regione ai fini tariffari
127400040922     C                   IF        vret > *zeros
127500040922     C                   move      vret          wfil
127600040922     C     wfil          chain     AzOrg                              48
127700030430     C  n48              movel     OrgDes        vdret
127800030430     C                   ENDIF
127900040922     c
128000040922      * riaggancio azorg giusto
128100080228     C     §Fil          CHAIN     AZORG                              36
128200030430     C                   ENDSR
128300030430      *------------------------------------------------------
128400030430      * Pulizia VIDEO 4
128500030430      *------------------------------------------------------
128600030430     C     PULVID4       BEGSR
128700030430      *
128800030430     C                   movel     *blanks       Vlfv
128900030430     C                   movel     *blanks       Vlbl
129000170608     C***                movel     *blanks       Vasp
129100040922     C                   movel     *blanks       VaspCV
129200030430     C                   movel     *blanks       Vase
129300040922     C                   movel     *blanks       Vorm
129400030430     C                   movel     *blanks       Vdkc
129500170227     C                   movel     *blanks       Vdirdkc
129600031016     C                   movel     *blanks       Vpck
129700050509     C                   movel     *blanks       Vpkm
129800160506     C                   movel     *blanks       Vturno
129900041213     C                   movel     *blanks       Vtis
130000160531     C                   movel     *blanks       VagSpUs
130100030430     C                   movel     *blanks       Vnoc
130200030430     C                   movel     *blanks       Vnid
130300030430     C                   movel     *blanks       Veid
130400070301     C***                movel     *blanks       Vfrr
130500040922     C                   movel     *blanks       Vsea
130600101215     C                   movel     *blanks       Vimaa
130700030430     C                   z-add     0             Vvol
130800030430     C                   z-add     0             Vpes
130900040303     C                   z-add     0             Vdsd
131000040303     C                   z-add     0             Vdse
131100030430     C                   movel     *blanks       Vass
131200030430     C                   movel     *blanks       Vlpr
131300120924     C****               movel     *blanks       Vspv
131400120924     C****               movel     *blanks       Vspp
131500170321     C                   clear                   vEsBlDi
131600030430      *
131700030430     C                   ENDSR
131800030430      *-----------------------------------------------------
131900030430      * Riempimento  video 4
132000030430      *-----------------------------------------------------
132100030430     C     AGGVID4       BEGSR
132200030430      *
132300030430      * L.arrivo stampa segnacollo
132400030430     C                   MOVEL     ORGDE5        Vass
132500030430      * Frame relay
132600070301     C***                MOVE      §ogfrr        Vfrr
132700040303      * Date scannerizzazione
132800040303     c                   if        §ogdsd<>*blanks
132900040303     C                   CLEAR                   WLBDAT
133000040303     C                   MOVEL     '3'           G02ERR
133100040303     C                   move      §ogdsd        G02INV
133200040303     C                   CALL      'XSRDA8'
133300040303     C                   PARM                    WLBDAT
133400040303     C                   Z-ADD     G02DAT        Vdsd
133500040303     c                   endif
133600040303     c*
133700040303     c                   if        §ogdse<>*blanks
133800040303     C                   CLEAR                   WLBDAT
133900040303     C                   MOVEL     '3'           G02ERR
134000040303     C                   move      §ogdse        G02INV
134100040303     C                   CALL      'XSRDA8'
134200040303     C                   PARM                    WLBDAT
134300040303     C                   Z-ADD     G02DAT        Vdse
134400040303     c                   endif
134500030430      * Bolle sede per posta
134600030430     C                   MOVE      §ognoc        Vnoc
134700030430      *
134800030430      * Linea  bollettazione
134900030430     C                   MOVE      §oglbl        Vlbl
135000030430      * Linea  gestita da fogli viaggio
135100030430     C                   MOVE      §oglfv        Vlfv
135200030430      * P.O non esegue IDD
135300030430     C                   MOVE      §ognid        Vnid
135400030430      * P.O esegue IDD giornoo dopo
135500030430     C                   MOVE      §ogeid        Veid
135600030430      * ORM
135700030430     C                   MOVE      §ogorm        Vorm
135800030430      * Linea da proporre in tassazione P.A
135900030430     C                   MOVE      §oglpr        Vlpr
136000170608      * Autogenerazione spunte  PARTENZA
136001170608     c                   if        vtip='A' or vtip='F'
136100030430     C                   SELECT
136200170608     C***  §ogags        WHENEQ    ' '
136400170608     C***                move      'S'           VAsp
136600030430      *
136700170608     C***  §ogagp        WHENne    'P'
136800170608     C     §ogags        WHENEQ    'E'
136900030430     C                   move      'S'           VAspCV
137000030430      *
137100170608     C***  §ogagp        WHENEQ    'P'
137200170608     C     §ogags        WHENEQ    'S'
137300030430     C                   move      'S'           VAse
137400030430     C                   ENDSL
137401170608     c                   endif
137500030430      * Data utilizzo macchinone per peso/volume
137600030430     C                   MOVE      §ogvol        Vvol
137700030430     C                   MOVE      §ogpes        Vpes
137800030430     C                   MOVE      §ogdkc        Vdkc
137900170227     C                   MOVE      §ogdkcdir     Vdirdkc
138000031016     C                   MOVE      §ogpck        Vpck
138100050509     C                   MOVE      §ogpkm        Vpkm
138200160506     C                   MOVE      §ogturno      Vturno
138300041213     C                   MOVE      §ogtis        Vtis
138400160531     C                   MOVE      §ogAgSpUs     VagSpUs
138500120924     C****               MOVE      §ogspv        Vspv
138600120924     C****               MOVE      §ogspp        Vspp
138700040517     C                   MOVE      §ogsea        Vsea
138800101215     C                   MOVE      §ogimaa       Vimaa
138900170321      * - Flag "Esente Blocco Dirottamento"
139000170321     C                   movel     §ogEsBlDi     vEsBlDi
139100170321      *
139200030430     C                   ENDSR
139300070828      *------------------------------------------------------
139400070828      * Pulizia VIDEO 5
139500070828      *------------------------------------------------------
139600070828     C     PULVID5       BEGSR
139700070828      *
139800080206     c                   movel     *blanks       vpdaorm
139900080206     c                   movel     *blanks       vpdacon
140000070828     C                   movel     *blanks       Vgeot
140100070828     C                   z-add     0             Vdda
140200070828     c                   z-add     0             vddao
140300070828     c                   movel     *blank        Vdoada
140400070828     c                   movel     *blank        Vfppda
140500070926     c                   movel     *blank        Vfrtuo
140600070828     C                   movel     *blanks       Vtlls
140700070828     c                   movel     *blanks       vcgio
140800070828      *
140900070828     C                   ENDSR
141000070828      *-----------------------------------------------------
141100070828      * Riempimento  video 5
141200070828      *-----------------------------------------------------
141300070828     C     AGGVID5       BEGSR
141400070828      *
141500070828      * flag avviamento gestione telefonate per GEO
141600070828     c                   movel     §oggeot       vgeot
141700070828     c* data inizio distinta di consegne automatica
141800070828     c                   if        §ogdda<>*blanks
141900070828     C                   CLEAR                   WLBDAT
142000070828     C                   MOVEL     '3'           G02ERR
142100070828     C                   move      §ogdda        G02INV
142200070828     C                   CALL      'XSRDA8'
142300070828     C                   PARM                    WLBDAT
142400070828     C                   Z-ADD     G02DAT        Vdda
142500070828     c                   endif
142600080206      * PDA ORM
142700080206     c                   move      §ogpdaorm     vpdaorm
142800080206      * PDA consegne
142900080206     c                   move      §ogpdacon     vpdacon
143000070828      * Abilitazione richiesta data e ora limite abbinamento
143100070828     c                   move      §ogdoada      vdoada
143200070828      * Abilitazione richiesta tipo ditinta mattino/pomeriggio
143300070828     c                   move      §ogfppda      vfppda
143400070828      * Procedura GIRI su ORM
143500070828     c                   move      §ogcgio       vcgio
143600070828      * Data inizio distinta ORM automatica
143700070828     c                   if        §ogddao <> *blanks
143800070828     c                   clear                   wlbdat
143900070828     c                   eval      g02err = '3'
144000070828     c                   move      §ogddao       g02inv
144100070828     c                   call      'XSRDA8'
144200070828     c                   parm                    wlbdat
144300070828     c                   z-add     g02dat        vddao
144400070828     c                   endif
144500070926      * Abilitazione richiesta tipo ditinta mattino/pomeriggio  ORM
144600070926     c                   move      §ogfrtuo      vfrtuo
144700070828      * TELLUS
144800070828     C                   MOVE      §ogtlls       Vtlls
144900070828     C                   ENDSR
145000130830      **----------------------------------------------------
145100130830      ** Gestione orari servizi
145200130830      **----------------------------------------------------
145300130830     C     Ges_serv      BEGSR
145400130830     c                   clear                   tisio0ds
145500130830     C                   MOVEL     'I'           do0tric
145600130830     c                   movel     DATASYS       do0dri
145700130830     C                   MOVEL     klna          DO0LNA
145800130830
145900130830     C                   call      'TISIO2R'
146000130830     C                   PARM                    KPJBA
146100130830     C                   PARM                    tisio0ds
146200130830     C*
146300130830     C                   ENDSR
146400130830      *
146500080228** - $Msg -------------------------------------------------------------------*
146600080228Utente NON abilitato - Premere "Invio" per tornare a menù                      01
