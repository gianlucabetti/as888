000100090327     ***************************************************************************
000200090327     **
000300120220     ** Società delle filiali.
000400090327     ** Ingresso gestione.
000500090327     **
000600090327     ***************************************************************************
000700120405     H DFTACTGRP(*NO) ACTGRP('AZSOF')
000800090330
000900090330     ***************************************************************************
001000090330     **
001100120220     ** Costanti.
001200090330     **
001300090330     ***************************************************************************
001400120220     D/COPY GAITRASRC/SRCCONST,TNSD4100R
001500120320     D ESITO_ERROR...
001600120320     D                 C                   -1
001700120320     D ESITO_OK...
001800120320     D                 C                   0
001900120320     D ESITO_WARNING...
002000120320     D                 C                   1
002100120320     D OPCODE_FILTRO...
002200120220     D                 C                   1
002300120220     D OPCODE_ELENCO...
002400120220     D                 C                   2
002500120220     D OPCODE_DONE...
002600120220     D                 C                   7
002700120220     D OPCODE_FINE...
002800120220     D                 C                   8
002900120220     D OPCODE_RITORNO...
003000120220     D                 C                   9
003100120220
003200090330     ***************************************************************************
003300090330     **
003400120220     ** Prototipi.
003500090330     **
003600090330     ***************************************************************************
003700120220     D/COPY GAITRASRC/SRCPROTOPR,TNSD4100R
003800090330
003900090330     ***************************************************************************
004000090330     **
004100120220     ** Strutture dati.
004200090330     **
004300090330     ***************************************************************************
004400120319     D kpjba         E DS                  QUALIFIED INZ
004500120319     D tnsd4110i     E DS                  QUALIFIED INZ(*EXTDFT)
004600120320     D tnsd4120i     E DS                  QUALIFIED INZ(*EXTDFT)
004700120320     D tnsd4130i     E DS                  QUALIFIED INZ(*EXTDFT)
004800120320     D tnsd4140i     E DS                  QUALIFIED INZ(*EXTDFT)
004900120319     D tnsd4110o     E DS                  QUALIFIED INZ(*EXTDFT)
005000120320     D tnsd4120o     E DS                  QUALIFIED INZ(*EXTDFT)
005100120319     D tnsd4130o     E DS                  QUALIFIED INZ(*EXTDFT)
005200120320     D tnsd4140o     E DS                  QUALIFIED INZ(*EXTDFT)
005300090330
005400090330     ***************************************************************************
005500090330     **
005600120220     ** Campi.
005700090330     **
005800090330     ***************************************************************************
005900090330     D opCodeCur...
006000120220     D                 S             10I 0
006100090330     D opCodeNxt...
006200090330     D                 S                   LIKE(opCodeCur)
006300120320     D                                     INZ(OPCODE_FILTRO)
006400090330     D opCodePrv...
006500090330     D                 S                   LIKE(opCodeCur)
006600090330     D rpyIdMsg...
006700090330     D                 S             10I 0
006800090330     D rpyOpCode...
006900120220     D                 S             10I 0
007000090330
007100090330     ***************************************************************************
007200090330     **
007300120220     ** Parametri procedura principale.
007400090330     **
007500090330     ***************************************************************************
007600120220     D Tnsd41_Gestione...
007700090330     D                 PI
007800120220     D  priKpjba...
007900090330     D                                     LIKEDS(kpjba)
008000090330
008100090330
008200090330      /FREE
008300090330
008400090330       *INLR = *ON;
008500090415
008600120322       tnsd4110i.valDat = %DATE();
008700120322
008800120220       DOU opCodeCur = OPCODE_FINE;
008900090330
009000090330         opCodeCur = opCodeNxt;
009100090330
009200120319         SELECT;
009300120319
009400120320           WHEN opCodeCur = OPCODE_FILTRO;
009500090330
009600120320             Tnsd41_Filtro( *ZERO
009700120320                          : rpyOpCode
009800120320                          : rpyIdMsg
009900120320                          : 'TNSD4110I'
010000120320                          : tnsd4110i
010100120320                          : %SIZE(tnsd4110i)
010200120320                          : 'TNSD4110O'
010300120320                          : tnsd4110o
010400120320                          : %SIZE(tnsd4110o)
010500120320                          );
010600090330
010700120320             IF rpyOpCode = TNSD41_RPYOPCODE_FINE
010800120319             OR rpyOpCode = TNSD41_RPYOPCODE_RITORNO;
010900120319               opCodeNxt = OPCODE_FINE;
011000120319             ELSE;
011100120319               EVAL-CORR tnsd4110i = tnsd4110o;
011200120321               RESET tnsd4110i.formato;
011300120321               RESET tnsd4110i.versione;
011400120320               EVAL-CORR tnsd4120i = tnsd4110o;
011500120321               RESET tnsd4120i.formato;
011600120321               RESET tnsd4120i.versione;
011700120319               opCodeNxt = OPCODE_ELENCO;
011800120319             ENDIF;
011900090330
012000120319           WHEN opCodeCur = OPCODE_ELENCO;
012100120321
012200120321             Tnsd41_Elenco( *ZERO
012300120321                          : rpyOpCode
012400120321                          : rpyIdMsg
012500120321                          : tnsd4120i.formato
012600120321                          : tnsd4120i
012700120321                          : %SIZE(tnsd4120i)
012800120321                          : tnsd4120o.formato
012900120321                          : tnsd4120o
013000120321                          : %SIZE(tnsd4120o)
013100120321                          );
013200090403
013300120319             IF rpyOpCode = TNSD41_RPYOPCODE_RITORNO;
013400120319               opCodeNxt = OPCODE_FILTRO;
013500120319             ELSEIF rpyOpCode = TNSD41_RPYOPCODE_FINE;
013600120319               opCodeNxt = OPCODE_FINE;
013700120319             ELSEIF rpyOpCode = TNSD41_RPYOPCODE_DONE;
013800120319               opCodeNxt = OPCODE_FINE;
013900120319             ENDIF;
014000090403
014100120319           WHEN opCodeCur = OPCODE_FINE;
014200090330
014300120319             LEAVE;
014400090330
014500120319           OTHER;
014600090330
014700120319             opCodeNxt = OPCODE_FINE;
014800090330
014900120319         ENDSL;
015000090330
015100090330       ENDDO;
015200090330
015300090330       //***********************************************************************
015400090330       //
015500090330       // Inizializzazioni.
015600090330       //
015700090330       //***********************************************************************
015800090330
015900090330       BEGSR *INZSR;
016000090420
016100120220         kpjba = priKpjba;
016200090420
016300120220         Tnsd41_Filtro( TNSD41_RQSOPCODE_INIT
016400090330                       : rpyOpCode
016500090330                       : rpyIdMsg
016600090330                       : 'KPJBA'
016700090330                       : kpjba
016800090330                       : %SIZE(kpjba)
016900090330                       );
017000120220       //
017100120220       //Tnsd41_Elenco( TNSD41_RQSOPCODE_INIT
017200120220       //              : rpyOpCode
017300120220       //              : rpyIdMsg
017400120220       //              : 'KPJBA'
017500120220       //              : kpjba
017600120220       //              : %SIZE(kpjba)
017700120220       //              );
017800090330
017900090330       ENDSR;
018000090330
018100090330      /END-FREE
