000100060908      *PARMS CLOSQLCSR(*ENDACTGRP)  DBGVIEW(*SOURCE)
000200060908      *===============================================================*
000300060908      *?TNSD67R * Pulizia files per SEDE - WFRFT00F -                ?*
000400060908      *===============================================================*
000500060908
000600060908     h decedit('0,') datedit(*dmy/) option(*nodebugio)
000700060908     h alwnull(*inputonly)
000800060908
000900060908      *?A R C H I V I?------------------------------------------------*
001000060908
001100060908      *?C O S T A N T I?----------------------------------------------*
001200060908
001300060908      *?S C H I E R E?------------------------------------------------*
001400060908
001500060908      *?S T R U T T U R E   D A T I?----------------------------------*
001600060908      *
001700060908      * - Parametri
001800060908     d KPJBA         e ds
001900060908     d Param           ds             8
002000060908     d  DatRFT                        8s 0
002100060908      *
002200060908      * - Parametri x Controllo profilo utenti
002300060908     d TIBS34ds      e ds                  inz
002400060908      * - Ds di riferimento al file esterno AZUTE00F
002500060908     d AZUTEds       e ds                  extname(AZUTE00F)
002600060908      * - Ds per dati organigramma
002700060908     d DDatiUte      e ds
002800060908
002900060908      *?V A R I A B I L I?--------------------------------------------*
003000060908
003100060908      *?K E Y - L I S T?----------------------------------------------*
003200060908
003300060908      *===============================================================*
003400060908      *                                                               *
003500060908      *?I N D I C A T O R I?------------------------------------------*
003600060908      *                                                               *
003700060908      *                                                               *
003800060908      *===============================================================*
003900060908
004000060908     c     *Entry        plist
004100060908     c                   parm                    KPJBA
004200060908     c                   movel     KPJBU         Param
004300060908      *
004400060908      * Operazioni Iniziali
004500060908     c                   exsr      RoutInz
004600060908      *
004700060908      * Cancellazione Records
004800060908     c                   exsr      Delete_RFT
004900060908      *
005000060908      * Operazioni Finali
005100060908     c                   exsr      RoutEnd
005200060908
005300060908      *?S U B R O U T I N E S?----------------------------------------*
005400060908
005500060908      *---------------------------------------------------------------*
005600060908      *?Operazioni Iniziali                                          ?*
005700060908      *---------------------------------------------------------------*
005800060908     c     RoutInz       BEGSR
005900060908      *
006000060908      * Reperimento dati job
006100060908     c                   exsr      DatiJob
006200060908      *
006300060908     c                   ENDSR
006400060908
006500060908      *---------------------------------------------------------------*
006600060908      *?Reperimento Dati del job (Utente/Operativi)                  ?*
006700060908      *---------------------------------------------------------------*
006800060908     c     DatiJob       BEGSR
006900060908      *
007000060908     c     *dtaara       define    §azute        AZUTEds
007100060908     c     *dtaara       define    §datiute      dDatiUte
007200060908      *
007300060908     c                   in(E)     *dtaara
007400060908     c                   IF        %ERROR or RSUT = *blanks
007500060908     c                   clear                   TIBS34ds
007600060908     c                   call      'TIBS34R'
007700060908     c                   parm                    TIBS34ds
007800060908     c                   in        *dtaara
007900060908     c                   ENDIF
008000060908      *
008100060908     c                   ENDSR
008200060908
008300060908      *---------------------------------------------------------------*
008400060908      *?Cancellazione records                                        ?*
008500060908      *---------------------------------------------------------------*
008600060908     c     Delete_RFT    BEGSR
008700060908      *
008800060908     c/exec sql
008900060908     c+     DELETE
009000060908     c+     from    WFRFT00F
009100060908     c+     where   RFTdta  <  :DatRFT
009200060908     c/end-exec
009300060908      *
009400060908     c                   ENDSR
009500060908
009600060908      *---------------------------------------------------------------*
009700060908      *?Operazioni Finali                                            ?*
009800060908      *---------------------------------------------------------------*
009900060908     c     RoutEnd       BEGSR
010000060908      *
010100060908     c                   eval      *inLR   = *on
010200060908     c                   return
010300060908      *
010400060908     c                   ENDSR
