000100070111      *PARMS CLOSQLCSR(*ENDACTGRP)  DBGVIEW(*SOURCE)
000200070111      *===============================================================*
000300070111      *?TNSD68R * Pulizia files per SEDE - TILAD00F -                ?*
000400070111      *===============================================================*
000500070111
000600070111     h decedit('0,') datedit(*dmy/) option(*nodebugio)
000700070111     h alwnull(*inputonly)
000800070111
000900070111      *?A R C H I V I?------------------------------------------------*
001000070111
001100070111      *?C O S T A N T I?----------------------------------------------*
001200070111
001300070111      *?S C H I E R E?------------------------------------------------*
001400070111
001500070111      *?S T R U T T U R E   D A T I?----------------------------------*
001600070111      *
001700070111      * - Parametri
001800070111     d KPJBA         e ds
001900070111     d Param           ds             8
002000070111     d  DatLAD                        8s 0
002100070111      *
002200070111      * - Parametri x Controllo profilo utenti
002300070111     d TIBS34ds      e ds                  inz
002400070111      * - Ds di riferimento al file esterno AZUTE00F
002500070111     d AZUTEds       e ds                  extname(AZUTE00F)
002600070111      * - Ds per dati organigramma
002700070111     d DDatiUte      e ds
002800070111
002900070111      *?V A R I A B I L I?--------------------------------------------*
003000070111
003100070111      *?K E Y - L I S T?----------------------------------------------*
003200070111
003300070111      *===============================================================*
003400070111      *                                                               *
003500070111      *?I N D I C A T O R I?------------------------------------------*
003600070111      *                                                               *
003700070111      *                                                               *
003800070111      *===============================================================*
003900070111
004000070111     c     *Entry        plist
004100070111     c                   parm                    KPJBA
004200070111     c                   movel     KPJBU         Param
004300070111      *
004400070111      * Operazioni Iniziali
004500070111     c                   exsr      RoutInz
004600070111      *
004700070111      * Cancellazione Records
004800070111     c                   exsr      Delete_TILAD
004900070111      *
005000070111      * Operazioni Finali
005100070111     c                   exsr      RoutEnd
005200070111
005300070111      *?S U B R O U T I N E S?----------------------------------------*
005400070111
005500070111      *---------------------------------------------------------------*
005600070111      *?Operazioni Iniziali                                          ?*
005700070111      *---------------------------------------------------------------*
005800070111     c     RoutInz       BEGSR
005900070111      *
006000070111     c/exec sql
006100070111     c+     set  option  DYNUSRPRF = *OWNER,
006200070111     c+                  CLOSQLCSR = *ENDACTGRP
006300070111     c/end-exec
006400070111      *
006500070111      * Reperimento dati job
006600070111     c                   exsr      DatiJob
006700070111      *
006800070111     c                   ENDSR
006900070111
007000070111      *---------------------------------------------------------------*
007100070111      *?Reperimento Dati del job (Utente/Operativi)                  ?*
007200070111      *---------------------------------------------------------------*
007300070111     c     DatiJob       BEGSR
007400070111      *
007500070111     c     *dtaara       define    §azute        AZUTEds
007600070111     c     *dtaara       define    §datiute      dDatiUte
007700070111      *
007800070111     c                   in(E)     *dtaara
007900070111     c                   IF        %ERROR or RSUT = *blanks
008000070111     c                   clear                   TIBS34ds
008100070111     c                   call      'TIBS34R'
008200070111     c                   parm                    TIBS34ds
008300070111     c                   in        *dtaara
008400070111     c                   ENDIF
008500070111      *
008600070111     c                   ENDSR
008700070111
008800070111      *---------------------------------------------------------------*
008900070111      *?Cancellazione records                                        ?*
009000070111      *---------------------------------------------------------------*
009100070111     c     Delete_TILAD  BEGSR
009200070111      *
009300070111     c/exec sql
009400070111     c+     DELETE
009500070111     c+     from    TILAD00F
009600070111     c+     where   LADtim  <  (:DatLAD * 1000000)
009700070111     c+       and   LADela  >  '00'
009800070111     c/end-exec
009900070111      *
010000070111     c                   ENDSR
010100070111
010200070111      *---------------------------------------------------------------*
010300070111      *?Operazioni Finali                                            ?*
010400070111      *---------------------------------------------------------------*
010500070111     c     RoutEnd       BEGSR
010600070111      *
010700070111     c                   eval      *inLR   = *on
010800070111     c                   return
010900070111      *
011000070111     c                   ENDSR
