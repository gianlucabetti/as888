000100070111      *PARMS CLOSQLCSR(*ENDACTGRP)  DBGVIEW(*SOURCE)
000200070111      *===============================================================*
000300120709      *?TNSD70R * Pulizia files per SEDE - TIJDD00F -                ?*
000400070111      *===============================================================*
000500070111
000600070111     h decedit('0,') datedit(*dmy/) option(*nodebugio)
000700070111     h alwnull(*inputonly)
000800070111
000900070111      *?A R C H I V I?------------------------------------------------*
001000070111
001100070111      *?C O S T A N T I?----------------------------------------------*
001200070111
001300070111      *?S C H I E R E?------------------------------------------------*
001400070111
001500070111      *?S T R U T T U R E   D A T I?----------------------------------*
001600070111      *
001700070111      * - Parametri
001800070111     d KPJBA         e ds
001900070111     d Param           ds             8
002000070111     d  DatLAD                        8s 0
002100070122      *
002200070122      * - Parametri x Controllo profilo utenti
002300070122     d TIBS34ds      e ds                  inz
002400070122      * - Ds di riferimento al file esterno AZUTE00F
002500070122     d AZUTEds       e ds                  extname(AZUTE00F)
002600070122      * - Ds per dati organigramma
002700070122     d DDatiUte      e ds
002800070111
002900070111      *?V A R I A B I L I?--------------------------------------------*
003000070122      *
003100070122     d wTimLAD         s             14    inz(*zeros)
003200070111
003300070111      *?K E Y - L I S T?----------------------------------------------*
003400070111
003500070111      *===============================================================*
003600070111      *                                                               *
003700070111      *?I N D I C A T O R I?------------------------------------------*
003800070111      *                                                               *
003900070111      *                                                               *
004000070111      *===============================================================*
004100070111
004200070111     c     *Entry        plist
004300070111     c                   parm                    KPJBA
004400070111     c                   movel     KPJBU         Param
004500070122     c                   movel     DatLAD        wTimLAD
004600070111      *
004700070111      * Operazioni Iniziali
004800070111     c                   exsr      RoutInz
004900070111      *
005000070111      * Cancellazione Records
005100120709     c                   exsr      Delete_TIJDD
005200070111      *
005300070111      * Operazioni Finali
005400070111     c                   exsr      RoutEnd
005500070111
005600070111      *?S U B R O U T I N E S?----------------------------------------*
005700070111
005800070111      *---------------------------------------------------------------*
005900070111      *?Operazioni Iniziali                                          ?*
006000070111      *---------------------------------------------------------------*
006100070111     c     RoutInz       BEGSR
006200070111      *
006300070111     c/exec sql
006400070111     c+     set  option  DYNUSRPRF = *OWNER,
006500070111     c+                  CLOSQLCSR = *ENDACTGRP
006600070111     c/end-exec
006700070111      *
006800070122      * Reperimento dati job
006900070122     c                   exsr      DatiJob
007000070111      *
007100070111     c                   ENDSR
007200070111
007300070111      *---------------------------------------------------------------*
007400070111      *?Reperimento Dati del job (Utente/Operativi)                  ?*
007500070111      *---------------------------------------------------------------*
007600070122     c     DatiJob       BEGSR
007700070122      *
007800070122     c     *dtaara       define    §azute        AZUTEds
007900070122     c     *dtaara       define    §datiute      dDatiUte
008000070122      *
008100070122     c                   in(E)     *dtaara
008200070122     c                   IF        %ERROR or RSUT = *blanks
008300070122     c                   clear                   TIBS34ds
008400070122     c                   call      'TIBS34R'
008500070122     c                   parm                    TIBS34ds
008600070122     c                   in        *dtaara
008700070122     c                   ENDIF
008800070122      *
008900070122     c                   ENDSR
009000070111
009100070111      *---------------------------------------------------------------*
009200070111      *?Cancellazione records                                        ?*
009300070111      *---------------------------------------------------------------*
009400120709     c     Delete_TIJDD  BEGSR
009500070111      *
009600070111     c/exec sql
009700070111     c+     DELETE
009800120709     c+     from    TIJDD00F
009900070122     c+     where   LADtim  <  :wTimLAD
010000070111     c+       and   LADela  >  '00'
010100070111     c/end-exec
010200070111      *
010300070111     c                   ENDSR
010400070111
010500070111      *---------------------------------------------------------------*
010600070111      *?Operazioni Finali                                            ?*
010700070111      *---------------------------------------------------------------*
010800070111     c     RoutEnd       BEGSR
010900070111      *
011000070111     c                   eval      *inLR   = *on
011100070111     c                   return
011200070111      *
011300070111     c                   ENDSR
