000100170713       //==============================================================
000200170713       //?TNSF27R - Eventuale ripristino Tipo Fattura NO Split Payment ?
000300170713       //==============================================================
000400170713
000500170713       //--------------------------------------------------------------
000600170713       //?Parametri di compilazione (vedi *cmd UBCRTOBJ).              ?
000700170713       //--------------------------------------------------------------
000800170713
000900170713     /*PRM  dbgview(*source)
001000170713     /*END
001100170713
001200170713       //--------------------------------------------------------------
001300170713       //?Specifiche di controllo.                                     ?
001400170713       //--------------------------------------------------------------
001500170713
001600170713     h decedit('0,') datedit(*dmy/) option(*nodebugio)
001700170713     h dftactgrp(*no)
001800170713
001900170713      //---------------------------------------------------------------
002000170713      //?Dichiarazione file.
002100170713      //---------------------------------------------------------------
002200170713
002300170713       // -?Anagrafica Clienti Split Payment con Distinta?
002400170713     fANSPIKCF  if   e           k disk
002500170713
002600170713       // -?BAR_ Anagrafica clienti x gestionale?
002700170713     fYBACL01L  Uf   e           k disk
002800170713
002900170713       //--------------------------------------------------------------
003000170713       //?Definizione costanti.                                        ?
003100170713       //--------------------------------------------------------------
003200170713
003300170713
003400170713       //--------------------------------------------------------------
003500170713       //?Definizione schiere.                                         ?
003600170713       //--------------------------------------------------------------
003700170713
003800170713
003900170713       //--------------------------------------------------------------
004000170713       //?Definizione aree dati.                                       ?
004100170713       //--------------------------------------------------------------
004200170713
004300170713
004400170713       //--------------------------------------------------------------
004500170713       //?Definizione strutture dati.                                  ?
004600170713       //--------------------------------------------------------------
004700170713
004800170713       // -?Parametri ricevuti?
004900170713     d KPJBA         e ds
005000170713
005100170713       //--------------------------------------------------------------
005200170713       //?Definizione variabili globali.                               ?
005300170713       //--------------------------------------------------------------
005400170713
005500170713
005600170713       //--------------------------------------------------------------
005700170713       //?Definizione procedure usate.                                 ?
005800170713       //--------------------------------------------------------------
005900170713
006000170713
006100170713       //--------------------------------------------------------------
006200170713       //?Definizione prototipi.                                       ?
006300170713       //--------------------------------------------------------------
006400170713
006500170713
006600170713       //--------------------------------------------------------------
006700170713       //?Definizione key-list.                                        ?
006800170713       //--------------------------------------------------------------
006900170713
007000170713       // -?File YBACL01L?
007100170713     d keyYBACL01    e ds                  extname( YBACL01L : *key )
007200170713     d                                     prefix( k_ )  inz
007300170713
007400170713       //--------------------------------------------------------------
007500170713       //?M A I N - L I N E                                            ?
007600170713       //--------------------------------------------------------------
007700170713
007800170713     c     *Entry        plist
007900170713     c                   parm                    kpjba
008000170713
008100170713      /free
008200170713
008300170713       // -?Operazioni iniziali?
008400170713       exsr  sr_RoutInz;
008500170713
008600170713       // -?Ciclo di lettura ANSPIKCF per aggiornamento YBACL00F?
008700170713       read  ANSPIKSC;
008800170713       DoW  Not %eof( ANSPIKCF );
008900170713         exsr  sr_UpdateYBACL;
009000170713         read  ANSPIKSC;
009100170713       EndDo;
009200170713
009300170713       // -?Operazioni finali?
009400170713       exsr  sr_RoutEnd;
009500170713
009600170713       //--------------------------------------------------------------
009700170713       //?Operazioni iniziali.                                         ?
009800170713       //--------------------------------------------------------------
009900170713       BEGSR  sr_RoutInz;
010000170713
010100170713         // -?Impostazione chiusura?
010200170713         *inLR = *on;
010300170713
010400170713       ENDSR;
010500170713
010600170713       //--------------------------------------------------------------
010700170713       //?Aggiornamento Tipo Fattura in anagrafica clienti YBACL00F    ?
010800170713       //?- SE 1 = Distinta - da memorizzaz. (precedente) in ANSPIKCF. ?
010900170713       //--------------------------------------------------------------
011000170713       BEGSR  sr_UpdateYBACL;
011100170713
011200170713         // -?Aggancio YBACL01L?
011300170713         clear  keyYBACL01;
011400170713         k_ACLsocieta = ANKsocieta;
011500170713         k_ACLkcc     = ANKkcc;
011600170713         k_ACLksc     = ANKksc;
011700170713
011800170713         chain  %kds( keyYBACL01 )  YBACL000;
011900170713
012000170713         //*·If  %found( YBACL01L )  and  ACLtft = 1;
012100170713         If  %found( YBACL01L )  and  ACLtft <> ANKtft;
012200170713
012300170713           // -?Aggiornamento di YBACL00F?
012400170713           //*·ACLtft = 0;
012500170713           ACLtft = ANKtft;
012600170713           //_______________
012700170713           update  YBACL000;
012800170713           //¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
012900170713
013000170713         EndIf;
013100170713
013200170713       ENDSR;
013300170713
013400170713       //--------------------------------------------------------------
013500170713       //?Operazioni finali.                                           ?
013600170713       //--------------------------------------------------------------
013700170713       BEGSR  sr_RoutEnd;
013800170713
013900170713         // -?Uscita dal *pgm?
014000170713         return;
014100170713
014200170713       ENDSR;
014300170713
014400170713      /end-free
