000100051219     h Decedit('0,') Datedit(*dmy.) Option(*nodebugio)
000200051219
000300051219      *------------------------------------------------------------------------*
000400061026      *          Annullamento tariffe clienti bloccati                         *
000500051219      *------------------------------------------------------------------------*
000600051219
000700051219      *------------------------------------------------------------------------*
000800051219      *   N O T E
000900051219      *------------------------------------------------------------------------*
001000051219      *
001100051219      *------------------------------------------------------------------------*
001200051219
001300061026     fTnta95d   cf   e             Workstn
001400051219
001500051219      *------------------------------------------------------------------------*
001600051219      *   C A M P I   D I   L A V O R O
001700051219      *------------------------------------------------------------------------*
001800051222     d dateu           s              8  0
001900051223     d w0140           s             14  0
002000051223     d wdata           s              8  0
002100051222
002200051219
002300051219      *------------------------------------------------------------------------*
002400051219      *   S C H I E R E
002500051219      *------------------------------------------------------------------------*
002600051219
002700051219      *------------------------------------------------------------------------*
002800051219      *   D S   I N T E R N E / E S T E R N E
002900051219      *------------------------------------------------------------------------*
003000051219
003100051219     d wlbdat          ds                  Inz
003200051219     d  g02dat                 1      8  0
003300051219     d  g02inv                 9     16  0
003400051219     d  g02err                17     17
003500051219     d  g02tgi                18     22  0
003600051219
003700061026     d AzuteDs       e ds                  ExtName(AzUte00F)
003800061026     d DDatiUte      e ds
003900061026     d Tibs34Ds      e ds
004000061026
004100051219     d Kpjba         e ds
004200051219
004300051219      *------------------------------------------------------------------------*
004400051219      *   I N D I C A T O R I
004500051219      *------------------------------------------------------------------------*
004600051222      * 30    Errore generico
004700061026      * 40    Tipo elaborazione errata
004800051219      *------------------------------------------------------------------------*
004900051219
005000051219      *------------------------------------------------------------------------*
005100051222      * CICLO PRINCIPALE
005200051222      *------------------------------------------------------------------------*
005300051222
005400051222     c                   Do        *Hival
005500051222      *
005600061026     c                   exfmt     Ta95d01
005700061026      * F3 / KC Fine
005800061026     c                   If        *inkc
005900061026     c                   leave
006000061026     c                   endif
006100061026      *
006200061026      * controllo se non inserito il flag di elaborazione emetto errore
006300061026     c                   If        V1csim = ' '
006400061026     c                   eval      *in40 = *on
006500061026     c                   iter
006600061026     c                   endif
006700051222      * F6 / KF Conferma
006800051222     c                   If        *inkf
006900051222     c                   exsr      SrConfe
007000060104     c                   leave
007100051222     c                   endif
007200051222      *
007300051222     c                   enddo
007400051222      *
007500051222     c     fine          tag
007600051222     c                   eval      *inlr = *on
007700051222      *------------------------------------------------------------------------*
007800051222      * ROUTINE CONTROLLO DELLA VIDEATA
007900051222      *------------------------------------------------------------------------*
008000051222     c     SrContrD01    BegSr
008100051222
008200051222     c                   endsr
008300051223      *------------------------------------------------------------------------*
008400051223      * ROUTINE CONFERMA DELLA VIDEATA
008500051223      *------------------------------------------------------------------------*
008600051223     c     SrConfe       BegSr
008700051223
008800061026      * Preparazione della KPJBU per  il lancio
008900051223
008901061027      * passo in kpjbu solo se si tratta di simulazione
008902061027     c                   clear                   kpjbu
008903061027     c                   If        v1csim = 'S'
009000061027     c                   movel     v1csim        Kpjbu
009001061027     c                   endif
009100061026     c                   movel     'TA94'        Kcoaz
009200061026      * BCH09
009400051223     c                   move      '3'           Kritb
009500051223     c                   call      'BCH09'
009600051223     c                   parm                    Kpjba
009800060104      * BCH10
009900051223     c                   If        Kritb = ' '
010000060306     c                   call      'BCH10'
010100060306     c****               call      'TNSB45R'
010200060227     C                   parm                    Kpjba
010300051223     c                   endif
010400060104
010500060104     c
010600051223      *
010700051223     c                   Endsr
010800051222      *
010900051219      *------------------------------------------------------------------------*
011000051219      * ROUTINE INIZIALE
011100051219      *------------------------------------------------------------------------*
011200051219     c     *Inzsr        BegSr
011300051219
011400051219     c     *entry        plist
011500051219     c                   parm                    Kpjba
011600051222      * Reperisco data corrente
011700051222     c                   time                    w0140
011800051222     c                   move      w0140         wData
011900051222     c                   clear                   WLBdat
012000051222     c                   eval      G02dat = wData
012100051222     c                   call      'XSRDA8'
012200051222     c                   parm                    WLBdat
012300051222     c                   z-add     G02inv        DateU
012400051219
012500051219     c     *dtaara       define    §azute        azuteds
012600051219     c     *dtaara       define    §datiute      ddatiute
012700051219     c                   in(E)     *dtaara
012800051219     c                   If        %error  or RSUT = *blanks
012900051219     c                   CLEAR                   tibs34ds
013000051219     c                   CALL      'TIBS34R'
013100051219     c                   PARM                    tibs34ds
013200051219     c                   in        *dtaara
013300051219     c                   EndIf
013400051223      *
013500051219     c                   EndSr
