000100040302      /TITLE Aggiorna TITAS31C TASFA2.
000200030711
000300030711     H DFTACTGRP(*NO) ACTGRP(*CALLER)
000400030711     H BNDDIR('PJXBND') BNDDIR('PJCBND') BNDDIR('YNSF')
000500030711
000600040302     FTITAS31C  UF   E           K DISK
000700030711     F                                     USROPN
000800040302     F                                     COMMIT
000900030711
001000030711     D Eseguito        C                   '0'
001100030711     D Errore          C                   '1'
001200040302     D StornoTotale    C                   'S'
001300030711
001400030711     D KPJBA         E DS
001500040302     D YNSF8045S     E DS
001600030711     D                                     INZ
001700040302
001800040302     ITITAS000      01
001900040302     ITITAS010      02
002000040302     ITITASP00      03
002100030711
002200030711     ***********************************************************************
002300030711     **?
002400030711     **?Main
002500030711     **?
002600030711     ***********************************************************************
002700030711     C     *ENTRY        PLIST
002800030711     C                   PARM                    KPJBA
002900030711
003000040302     C                   EXSR      RcvParm
003100040302
003200040302     C                   OPEN      TITAS31C
003300040302
003400040302     C                   MOVE      KSC           TASKSC
003500040302     C                   MOVE      DRP           TASDFT
003600040302     C                   EVAL      TASNFT = NRP
003700040302     C     K03TAS31      SETLL     TITAS31C
003800040302
003900040302     C                   DO        *HIVAL
004000040302     C
004100040302     C                   EVAL      *IN01 = *OFF
004200040302     C                   EVAL      *IN02 = *OFF
004300040302     C                   EVAL      *IN03 = *OFF
004400040302     C     K03TAS31      READE     TITAS31C
004500040302     C
004600040302     C                   IF        %EOF
004700040302     C                   LEAVE
004800040302     C                   ENDIF
004900040302     C
005000040302     C                   IF        TASFA2 <> FA2
005100040302     C
005200040302     C                   EVAL      TASFA2 = FA2
005300040302     C                   EVAL      NbrRcdUpd = NbrRcdUpd + 1
005400040302     C
005500040302     C                   SELECT
005600040302     C                   WHEN      *IN02
005700040302     C                   UPDATE    TITAS010
005800040302     C                   WHEN      *IN03
005900040302     C                   UPDATE    TITASP00
006000040302     C                   WHEN      *IN01
006100040302     C                   UPDATE    TITAS000
006200040302     C                   ENDSL
006300040302     C
006400040302     C                   ENDIF
006500040302     C
006600040302     C                   ENDDO
006700040302
006800040302     C                   CLOSE     TITAS31C
006900030711
007000030711     C                   EXSR      Uscita
007100040302
007200040302     ***********************************************************************
007300040302     **?
007400040302     **?Ricezione e controllo parametri.
007500040302     **?
007600040302     ***********************************************************************
007700040302     C     RcvParm       BEGSR
007800040302
007900040302     C                   EVAL      YNSF8045S = KPJBU
008000040302
008100040302     C                   IF        KSC = *BLANK OR DRP = *LOVAL OR NRP = *ZERO
008200040302     C                             OR (FA2 <> *BLANK AND FA2 <> StornoTotale)
008300040302     C                   EVAL      Esito = Errore
008400040302     C                   EXSR      Uscita
008500040302     C                   ENDIF
008600040302
008700040302     C                   CLEAR                   Esito
008800040302     C                   CLEAR                   NbrRcdUpd
008900040302
009000040302     C                   ENDSR
009100030711
009200030711     ***********************************************************************
009300030711     **?
009400030711     **?Operazioni iniziali.
009500030711     **?
009600030711     ***********************************************************************
009700030711     C     *INZSR        BEGSR
009800030711
009900040302     C     K03TAS31      KLIST
010000040302     C                   KFLD                    TASKSC
010100040302     C                   KFLD                    TASDFt
010200040302     C                   KFLD                    TASNFt
010300030711
010400030711     C                   ENDSR
010500030711
010600030711     ***********************************************************************
010700030711     **?
010800030711     **?Uscita
010900030711     **?
011000030711     ***********************************************************************
011100030711     C     Uscita        BEGSR
011200030711
011300040302     C                   IF        Esito = *BLANK
011400040302     C                   EVAL      Esito = Eseguito
011500040302     C                   ENDIF
011600040302
011700040302     C                   EVAL      KPJBU = YNSF8045S
011800030711     C                   RETURN
011900030711
012000030711     C                   ENDSR
