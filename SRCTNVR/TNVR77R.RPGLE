000100990407     h*--------------------------------------------------------------------------------------------*
000200990408     h* Aggiunge il mese in ECFIM
000300990407     k*--------------------------------------------------------------------------------------------*
000400990407     h DECEDIT('0,') DATEDIT(*DMY.)
000500990407     f*--------------------------------------------------------------------------------------------*
000600990407     f* Data base
000700990407     f*--------------------------------------------------------------------------------------------*
000800990407     fecfim30C  UF   E           K DISK                                         *Metricubi  INFRA
000900990407     ftntas30c  IF   E           K DISK                                         *Bolle
001000990407     d*--------------------------------------------------------------------------------------------*
001100990407     d* Data structure
001200990407     d*--------------------------------------------------------------------------------------------*
001300990407     d*---
001400990407     d* Prefisso variabili --> § = passaggio routine esterne
001500990407     d*                    --> w = passaggio routine interne
001600990407     d*                    --> $ = di controllo
001700990407     d*---
001800990407     d* Variabili riferite al data base
001900990407     d*---
002000990407     d kasaas          S                   LIKE(tasaas)                         *lettura tntas00f
002100990407     d kaslnp          S                   LIKE(taslnp)
002200990407     d kasnrs          S                   LIKE(tasnrs)
002300990407     d kasnsp          S                   LIKE(tasnsp)
002400990407     d kastbl          S                   LIKE(tastbl)
002500990407     i*--------------------------------------------------------------------------------------------*
002600990407     i* Input
002700990407     i*--------------------------------------------------------------------------------------------*
002800990407     i*---
002900990407     i* Indicatori lettura formati record ECFIM
003000990407     i*---
003100990407     iecfim000      20
003200990407     iecfimp00      21
003300990407     c*--------------------------------------------------------------------------------------------*
003400990407     c* Main lines
003500990407     c*--------------------------------------------------------------------------------------------*
003600990407     c*---
003700990407     c* ECFIM -metricubi-
003800990407     c*---
003900990407     C                   SETOFF                                       2021      *lettura formati
004000990407     c                   READ      ecfim30c                               99
004100990407do  1c                   DOW       NOT *in99
004200990408if  2c                   IF        fimmes = *zeros                              *mese non aggiornato
004300990407     c* legge la bolla
004400990407     c                   Z-ADD     fimaas        kasaas
004500990407     c                   Z-ADD     fimlnp        kaslnp
004600990407     c                   Z-ADD     fimnrs        kasnrs
004700990407     c                   Z-ADD     fimnsp        kasnsp
004800990407     c                   MOVEL     fimtbl        kastbl
004900990407     c     keytas        CHAIN     tntas30c                           98
005000990408if  3c                   IF        NOT *in98                                    *bolla trovata
005100990407     c                   MOVEL     tasmgs        fimmes                         *imposta il mese
005200990407     c* aggiorna
005300990408if  4c                   IF        *in20                                        *lettura ecfim000
005400990407     c                   EXCEPT    aggfim000                                    *aggiorna
005500990408e   4c                   ENDIF
005600990408if  4c                   IF        *in21                                        *lettura ecfim000
005700990407     c                   EXCEPT    aggfimp00
005800990408e   4c                   ENDIF
005900990408e   3c                   ENDIF
006000990408e   2c                   ENDIF
006100990407     c* lettura successiva
006200990407     C                   SETOFF                                       2021      *lettura formati
006300990407     c                   READ      ecfim30c                               99
006400990407e   1c                   ENDDO
006500990407     c*
006600990407     c                   SETON                                            lr
006700990407     c*--------------------------------------------------------------------------------------------*
006800990407     C* *inzsr - operazioni iniziali
006900990407     c*--------------------------------------------------------------------------------------------*
007000990407     C     *inzsr        BEGSR
007100990407     c*
007200990407     c* chiavi di lettura
007300990407     c     keytas        KLIST                                                  *tntas30c
007400990407     c                   KFLD                    kasaas                          -anno
007500990407     c                   KFLD                    kaslnp                          -linea partenza
007600990407     c                   KFLD                    kasnrs                          -serie
007700990407     c                   KFLD                    kasnsp                          -spedizione
007800990407     c                   KFLD                    kastbl                          -tipo bolla
007900990407     c*
008000990407     c                   ENDSR
008100990407     o*--------------------------------------------------------------------------------------------*
008200990407     o* Righe di aggiornamento file
008300990407     o*--------------------------------------------------------------------------------------------*
008400990407     o*---
008500990407     o* metricubi
008600990407     o*---
008700990407     oecfim000  E            aggfim000
008800990407     o                       fimmes
008900990407     oecfimp00  E            aggfimp00
009000990407     o                       fimmes
