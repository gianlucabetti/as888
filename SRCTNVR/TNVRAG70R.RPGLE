000100100413      //---------------------------------------------------------------
000200171123      //?TNVRag70R -
000300100413      //---------------------------------------------------------------
000400100413
000500100413     h decedit('0,') datedit(*ymd/) option(*nodebugio)
000600100413
000700100413      //---------------------------------------------------------------
000800100413      //?Dichiarazione file.
000900100413      //---------------------------------------------------------------
001000171123     fTFNTC01L  if   e           k disk
001100101203     fCNACO00F  if   e           k disk
001200171123     fwfalfa0f  o  a e             disk
001400100413
001500100413      //---------------------------------------------------------------
001600100413      //?Definizione costanti.
001700100413      //---------------------------------------------------------------
001800100413
001900100413      //---------------------------------------------------------------
002000100413      //?Definizione schiere.
002100100413      //---------------------------------------------------------------
002101171123     D ksc             s              7s 0 dim(300) ctdata perrcd(1)              codici clienti
002500100413      //---------------------------------------------------------------
002600100413      //?Definizione aree dati.
002700100413      //---------------------------------------------------------------
002800100413
002900100413      //---------------------------------------------------------------
003000100413      //?Definizione strutture dati.
003100100413      //---------------------------------------------------------------
003200100415
003300100415     d KPJBA         e ds
003400100415
003500100413      //---------------------------------------------------------------
003600100413      //?Definizione variabili globali.
003700100413      //---------------------------------------------------------------
003800100413
003900100413      // - Flags booleani
004000100413     d $End            s               n   inz(*off)
004100101203     d $NoACO          s               n   inz(*off)
004300100413
004400100413      // - Campi di comodo
004900101203     d w0070           s              7  0
004901171123     d knk1            s                   like(ntcnk1)  inz
004902171123     d knk2            s                   like(ntcnk2)  inz
004903171123     d ktnt            s                   like(ntctnt)  inz
004904171123      * - Indici di schiera
004905171123     d xx              s              3  0 inz
005000100413
005100100413      //---------------------------------------------------------------
005200100413      //?Definizione procedure esterne.
005300100413      //---------------------------------------------------------------
005400100413
005500100413      //---------------------------------------------------------------
005600100413      //?prototipi
005700100413      //---------------------------------------------------------------
005800100414
005900100413
006000100413      //---------------------------------------------------------------
006100100413      //?Definizione key-list.
006200100413      //---------------------------------------------------------------
006300100415
006400100413
006500100413      //---------------------------------------------------------------
006600100413      //?Riepilogo indicatori.
006700100413      //---------------------------------------------------------------
006800100414
006900100414      // 99    : Salto pagina
007000100413
007100100413      //---------------------------------------------------------------
007200100413      //?M A I N - L I N E
007300100413      //---------------------------------------------------------------
007400100413
007500100413     c     *Entry        plist
007501171123     c                   parm                    kpjba
007700100413
007800100413      /free
007900100413
008000100413       //?Operazioni iniziali
008100100513       exsr RoutInz;
008200100413
008300100726       //?Elaboro
008400100726       exsr Elabora;
008500100413
008600100413       //?Operazioni finali
008700100513       exsr RoutEnd;
008800100413
008900100413       //--------------------------------------------------------------
009000100413       //?Operazioni iniziali.
009100100413       //--------------------------------------------------------------
009200100513       BEGSR RoutInz;
009300100726
009700100414
010400100413
010500100413       ENDSR;
010600100413
010700100413       //--------------------------------------------------------------
010800100422       //?Elaboro.
010900100413       //--------------------------------------------------------------
011000100513       BEGSR Elabora;
011100100413
011200100413         $End = *off;
011300100413
011301171123       // Leggo il file delle bolle per ogni ksc della schiera
011302171123         dow xx <= 300;
011303171123             xx = xx+1 ;
011304171123              If  ksc(xx) <> 0;
011305171123                 clear wfalfa00;
011306171123                 alfaksc = ksc(xx) ;
011400101203       //?Estraggo solo le note Clienti
011401171123                 clear ntcrnt ;
011402171123                 Knk1 = %editc( 0151 : 'X' ) +
011403171123                     %editc( ksc(xx)  : 'X' );
011404171123                 chain     ( 'C' : Knk1 : Knk2 : '06' )  TFNTC01l;
011405171123                 alfaind = ntcrnt ;
016500171123       //?Aggancio  su CNACO
016600171123         w0070 = ksc(xx);
016700101203         ACOkut = 1;
016800101203         ACOkcc = 151;
016900101203         chain (ACOkut:ACOkcc:w0070) CNACO00F;
017000101203         IF  not %found(CNACO00F);
017100171123           clear acorag;
017200101203         ENDIF;
017201171123       //
017202171123         alfarag = acorag ;
017300100726
017301171123         write wfalfa00;
017302171123         else ;
017303171123          leave ;
017304171123         endif ;
017305171123       enddo;
017400100726       ENDSR;
020700100413
020800100413       //--------------------------------------------------------------
020900100413       //?Operazioni finali.
021000100413       //--------------------------------------------------------------
021100100513       BEGSR RoutEnd;
021200100413
021300100413         *inLR = *on;
021400100413         return;
021500100413
021600100413       ENDSR;
021700100413
021800100413      /end-free
021900171123** KSC
022000171123  12881
022100171123  14089
022200171123  14089
022300171123  14089
022400171123  14304
022500171123  15443
022600171123  15638
022700171123  15961
022800171123  20651
022900171123  21352
023000171123  21929
023100171123  22534
023200171123  22709
023300171123  23731
023400171123  23938
023500171123  24187
023600171123  40916
023700171123  90861
023800171123 120172
023900171123 140381
024000171123 140423
024100171123 140655
024200171123 140884
024300171123 141167
024400171123 151225
024500171123 151256
024600171123 151812
024700171123 170618
024800171123 203988
024900171123 240860
025000171123 240866
025100171123 240975
025200171123 241196
025300171123 241462
025400171123 261668
025500171123 262171
025600171123 262180
025700171123 270713
025800171123 270713
025900171123 270713
026000171123 270713
026001171123 270713
026100171123 270783
026200171123 286283
026300171123 287337
026400171123 311390
026500171123 311497
026600171123 311753
026700171123 312057
026800171123 312134
026900171123 312134
027000171123 312134
027100171123 312134
027200171123 312135
027300171123 312360
027400171123 312480
027500171123 312680
027600171123 312900
027700171123 320020
027800171123 340222
027900171123 350206
028000171123 360595
028100171123 390545
028200171123 390925
028300171123 391811
028400171123 420893
028500171123 440955
028600171123 441279
028700171123 450189
028800171123 480006
028900171123 480131
029000171123 492086
029100171123 504194
029200171123 505385
029300171123 506409
029400171123 560137
029500171123 634811
029600171123 670086
029700171123 672291
029800171123 672900
029900171123 673042
030000171123 673079
030100171123 673317
030200171123 673779
030300171123 673895
030400171123 674517
030500171123 674544
030600171123 674888
030700171123 700112
030800171123 700472
030900171123 750162
031000171123 750251
031100171123 750817
031200171123 771444
031300171123 780880
031400171123 781016
031500171123 781203
031600171123 781268
031700171123 781268
031800171123 781402
031900171123 781596
032000171123 782017
032100171123 782148
032200171123 921002
032300171123 921184
032400171123 990819
032500171123 992485
0326001711231031468
0327001711231091089
0328001711231091305
0329001711231152960
0330001711231190399
0331001711231190707
0332001711231221094
0333001711231221116
0334001711231221117
0335001711231270002
0336001711231270105
0337001711231270578
0338001711231270678
0339001711231271392
0340001711231272176
0341001711231302710
0342001711231310431
0343001711231310657
0344001711231310938
0345001711231333339
0346001711231430432
0347001711231430562
0348001711231430801
0349001711231431003
0350001711231431197
0351001711231490037
0352001711231490409
0353001711231490720
0354001711231510224
0355001711231510597
0356001711231540176
0357001711231540198
0358001711231540237
0359001711231540307
0360001711231540735
0361001711231570063
0362001711231570408
0363001711231570599
0364001711231590020
0365001711231590307
0366001711231620220
0367001711231620768
0368001711231640243
0369001711231640271
0370001711231640938
0371001711231641187
0372001711231641231
0373001711231662059
0374001711231690125
0375001711231690186
0376001711231690197
0377001711232140919
0378001711232221276
0379001711232242078
0380001711232242181
0381001711232242209
0382001711232242223
0383001711232550932
0384001711232771429
0385001711232771535
0386001711232801188
0387001711232801369
0388001711232801403
0389001711232801597
