000100050222      *BIND
000200050222      /TITLE Ricodifica condizione pagamento.
000300050222     ***********************************************************************************************
000400050222     **?
000500050222     **?Questo modulo esegue la ricodifica della condizione pagamento.
000600050222     **?
000700050222     **?Modulo......: TNVRCDP01
000800050222     **?Descrizione.: Ricodifica condizione pagamento.
000900050222     **?
001000050222     **?Compilazione: CRTRPGMOD  MODULE(GAITRAFIL/TNVRCDP01)
001100050222     **?                         SRCFILE(GAITRASRC/SRCTNVR)
001200050222     **?                         SRCMBR(TNVRCDP01)
001300050222     **?                         REPLACE(*YES)
001400050222     **?
001500050222     **?              CRTSRVPGM  SRVPGM(GAITRAFIL/TNVRCDP01)
001600050222     **?                         EXPORT(*ALL)
001700050222     **?
001800050222     **?              DLTMOD     MODULE(GAITRAFIL/TNVRCDP01)
001900050222     **?
002000050222     **?              ADDBNDDIRE BNDDIR(GAITRAFIL/TNVRCDP)
002100050222     **?                         OBJ((*LIBL/TNVRCDP01 *SRVPGM))
002200050222     **?                         (da eseguire solo la prima volta)
002300050222     **?
002400050222     ***********************************************************************************************
002500050222
002600050222     H NOMAIN
002700050222
002800050222     D CPV             S              3
002900050222     D                                     DIM(55)
003000050222     D                                     PERRCD(1)
003100050222     D                                     CTDATA
003200050222     D                                     ASCEND
003300050222     D CPN             S              3
003400050222     D                                     DIM(55)
003500050222     D                                     PERRCD(1)
003600050222     D                                     CTDATA
003700050222     D i               S              5I 0
003800050222
003900050222     D GetNewCondPag...
004000050222     D                 PR             3
004100050222     D  CondPag...
004200050222     D                                3
004300050222     D                                     VALUE
004400050222     D  NewCondPag...
004500050222     D                                3
004600050222     D  Esito                         5I 0
004700050222
004800050222     ***********************************************************************************************
004900050222     **?
005000050223     **?Cambia codice pagamento.
005100050222     **?
005200050222     ***********************************************************************************************
005300050222     P GetNewCondPag...
005400050222     P                 B
005500050222     P                                     EXPORT
005600050222
005700050222     D GetNewCondPag...
005800050222     D                 PI             3
005900050222     D  CondPag...
006000050222     D                                3
006100050222     D                                     VALUE
006200050222     D  NewCondPag...
006300050222     D                                3
006400050222     D  Esito                         5I 0
006500050222
006600050222     C                   CLEAR                   NewCondPag
006700050222     C                   CLEAR                   Esito
006800050222
006900050222     C                   IF        CondPag = *BLANK
007000050222     C                   EVAL      Esito = -1
007100050222     C                   ELSE
007200050222     C                   EVAL      i = 1
007300050222     C     CondPag       LOOKUP    CPV(i)                             01  01
007400050222     C                   IF        %EQUAL
007500050222     C                   EVAL      NewCondPag = CPN(i)
007600050222     C                   ELSE
007700050222     C                   EVAL      Esito = -100
007800050222     C                   ENDIF
007900050222     C                   ENDIF
008000050222
008100050222     C                   RETURN    NewCondPag
008200050222
008300050222     P GetNewCondPag...
008400050222     P                 E
008500050222
008600050222**CTDATA CPV
008700050222000
008800050222020
008900050222030
009000050222031
009100050222039
009200050222040
009300050222041
009400050222045
009500050222050
009600050222055
009700050222060
009800050222069
009900050222070
010000050222071
010100050222075
010200050222090
010300050222091
010400050222099
010500050222100
010600050222101
010700050222120
010800050222130
010900050222131
011000050222139
011100050222140
011200050222141
011300050222145
011400050222150
011500050222155
011600050222160
011700050222169
011800050222170
011900050222171
012000050222175
012100050222190
012200050222191
012300050222199
012400050222210
012500050222211
012600050222213
012700050222214
012800050222230
012900050222239
013000050222240
013100050222245
013200050222250
013300050222255
013400050222260
013500050222269
013600050222270
013700050222275
013800050222290
013900050222291
014000050222299
014100050222600
014200050222**CTDATA CPN
014300050222B00
014400050222B20
014500050222B30
014600050222B30
014700050222B39
014800050222B40
014900050222B40
015000050222B45
015100050222B50
015200050222B50
015300050222B60
015400050222B69
015500050222B70
015600050222B70
015700050222B70
015800050222B90
015900050222B91
016000050222B99
016100050222B00
016200050222B00
016300050222B20
016400050222B30
016500050222B30
016600050222B39
016700050222B40
016800050222B40
016900050222B45
017000050222B50
017100050222B50
017200050222B60
017300050222B69
017400050222B70
017500050222B70
017600050222B70
017700050222B90
017800050222B91
017900050222B99
018000050222R10
018100050222R12
018200050222R11
018300050222R13
018400050222R30
018500050222R39
018600050222R40
018700050222R45
018800050222R50
018900050222R50
019000050222R60
019100050222R69
019200050222R70
019300050222R70
019400050222R90
019500050222R91
019600050222R99
019700050222B00
