000100020904     H DECEDIT('0,') DATEDIT(*DMY.)
000200020904
000300020904      **************************************************************************
000400020904      *                                                                        *
000500020904      *          Cancellazione  clienti potenziali  "duplicati"                *
000600020904      *                                                                        *
000700020904      *                        E S E C U Z I O N E                             *
000800020904      *                                                                        *
000900020904      **************************************************************************
001000020904
001100020904     fTNCPS12L  uf   e           k disk
001200020904      *
001300020904     fQSYSPRT   o    f  132        printer oflind(*inof)
001400020904
001500020904     d TIBS34DS      e ds
001600020904     d AZUTEDS       e ds                  extname(AZUTE00F)
001700020904     d DDATIUTE      e ds
001800020905     d TNCPSds1      e ds                  extname(TNCPS00F) inz
001900020905     d TNCPSds2      e ds                  extname(TNCPS00F)
002000020905     d                                     prefix(CPX:3)     inz
002100020904     d Status         sds           333
002200020904     d  SDSpgm           *proc
002300020904     d  SDSusr               254    263
002400020905     d CPOds           ds            11
002500020905     d  CPScpo1                1      3  0
002600020905     d  CPScpo2                4     11  0
002700020904     d wTIME           s              6  0
002800020904     d wToDel          s              1    inz(*off)
002900020904     d wNrDup          s              7  0 inz
003000020904
003100020904      *------------------------------------------------------------------------*
003200020904      *                                                                        *
003300020904      *    OPERAZIONI INIZIALI                                                 *
003400020904      *                                                                        *
003500020904      *------------------------------------------------------------------------*
003600020904
003700020904     c     *entry        plist
003800020904     c                   parm                    $DEL              1
003900020904      *
004000020904     c     *dtaara       define    §azute        AZUTEDS
004100020904     c     *dtaara       define    §datiute      DDATIUTE
004200020904     c                   clear                   AZUTEDS
004300020904     c                   clear                   DDATIUTE
004400020904     c                   clear                   TIBS34DS
004500020904     c                   in(E)     *dtaara
004600020904if  1c                   IF        %Error  or  RSUT = *blanks
004700020904     c                   call      'TIBS34R'
004800020904     c                   parm                    TIBS34DS
004900020904     c                   in        *dtaara
005000020904e   1c                   ENDIF
005100020904      *
005200020904     c                   time                    wTIME
005300020904     c     $Del          comp      *on                                    01
005400020904     c                   except    TESTAT
005500020904      *
005600020904
005700020904      *------------------------------------------------------------------------*
005800020904      *                                                                        *
005900020904      *    ROUTINE PRINCIPALE                                                  *
006000020904      *                                                                        *
006100020904      *------------------------------------------------------------------------*
006200020904
006300020904      *    Lettura File Potenziali
006400020904      *    =======================
006500020904
006600020904     c     *loval        setll     TNCPS12L
006700020904     c                   read      TNCPS12L
006800020904      *
006900020904do  1c                   dow       not %eof(TNCPS12L)
007000020904
007100020904      *    Controlli / Stampa / Cancellazione  record doppi
007200020904      *    ================================================
007300020904
007400020904     c                   exsr      PRT_DEL
007500020904      *
007600020904     c                   read      TNCPS12L
007700020904      *
007800020904e   1c                   enddo
007900020904
008000020904      *    Fine Programma
008100020904      *    ==============
008200020904
008300020904     c                   if        wNrDup  = 0
008400020904     c                   except    NESSUN
008500020904     c                   else
008600020904     c                   except    FINES
008700020904     c                   endif
008800020904      *
008900020904     c                   eval      *inLR = *on
009000020904     c                   return
009100020904
009200020904      *------------------------------------------------------------------------*
009300020904      *                                                                        *
009400020904      *    SUBROUTINES                                                         *
009500020904      *                                                                        *
009600020904      *------------------------------------------------------------------------*
009700020904
009800020904      *------------------------------------------------------------------------*
009900020904      *    PRT_DEL - Stampa & Cancellazione record "doppi"                     *
010000020904      *------------------------------------------------------------------------*
010100020904
010200020904     c     PRT_DEL       BEGSR
010300020904      *
010400020905     c                   movel     TNCPSds1      TNCPSds2
010500020904     c     K10CPS12      reade     TNCPS12L
010600020904      *
010700020904do  1c                   dow       not %eof(TNCPS12L)
010800020904      *
010900020904if  2c                   if        CPSatb = *blanks
011000020904      *
011100020904      *    Stampa
011200020904      *    ======
011300020904      *
011400020904if  3c                   if        *inof   = *on
011500020904     c                   except    TESTAT
011600020904     c                   eval      *inof   = *off
011700020904e   3c                   endif
011800020904     c                   move      CPScpo        CPOds
011900020904     c                   except    STAMPA
012000020904     c                   add       1             wNrDup
012100020904      *
012200020904      *    Cancellazione
012300020904      *    =============
012400020904      *
012500020904if  3c                   if        $Del   = *on
012600020904     c                   eval      CPSatb = 'A'
012700020905     c                   eval      CPSftr = *blanks
012800020905     c***                eval      CPSdtr = *zeros
012900020904     c                   update    TNCPS000
013000020904e   3c                   endif
013100020904      *
013200020904e   2c                   endif
013300020904      *
013400020904     c     K10CPS12      reade     TNCPS12L
013500020904      *
013600020904e   1c                   enddo
013700020904      *
013800020904     c     K10CPS12      setgt     TNCPS12L
013900020904      *
014000020904     c                   ENDSR
014100020904
014200020904      *------------------------------------------------------------------------*
014300020904      *    KEYLIST - Definizione KLIST                                         *
014400020904      *------------------------------------------------------------------------*
014500020904
014600020904     c     KEYLIST       BEGSR
014700020904      *
014800020904     c     K10CPS12      klist
014900020904     c                   kfld                    CPScpo
015000020904     c                   kfld                    CPSdst
015100020904     c                   kfld                    CPSdim
015200020904     c                   kfld                    CPShim
015300020904     c                   kfld                    CPSfst
015400020904     c                   kfld                    CPSksc
015500020904     c                   kfld                    CPSclt
015600020904     c                   kfld                    CPScnc
015700020904     c                   kfld                    CPSpru
015800020904     c                   kfld                    CPSfle
015900020904      *
016000020904     c                   ENDSR
016100020904
016200020904      *------------------------------------------------------------------------*
016300020904      *                                                                        *
016400020904      *    STAMPA                                                              *
016500020904      *                                                                        *
016600020904      *------------------------------------------------------------------------*
016700020904
016800020904     oQSYSPRT   e            TESTAT            2
016900020904     o                       RSUT
017000020904     o                                        +   0 '/'
017100020904     o                       DUTpou           +   0
017200020904     o                                           60 'STATI CLIENTI POTENZIALI'
017300020904     o              N01                          72 'ELIMINABILI'
017400020904     o               01                          72 'ELIMINATI  '
017500020904     o                       *date               94 '  /  /    '
017600020904     o                       wTIME            +   2 '  :  :  '
017700020904     o
017800020904     o          e            TESTAT      1
017900020904     o                       DUTdpo
018000020904     o                       SDSusr           +   1
018100020904     o                       SDSpgm              94
018200020904     o                                        +   2 'Pag.'
018300020904     o                       Page          Z  +   0
018400020904     o          e            TESTAT      2
018500020904     o                                              'Potenziale  '
018600020904     o                                        +   2 'Data Stato'
018700020904     o                                        +   2 'Dt Immiss.'
018800020904     o                                        +   2 'Ora Imm'
018900020904     o                                        +   2 'Stato'
019000020905     o                                        +   2 'Num. Visita'
019100020905     o                                        +   2 'Comm.le'
019200020905     o                                        +   2 'N.Visita OK'
019300020905     o                                        +   2 'Comm.OK'
019400020904     o          e            TESTAT      1  1
019500020904     o                                              '------------'
019600020904     o                                        +   2 '----------'
019700020904     o                                        +   2 '----------'
019800020904     o                                        +   2 '-------'
019900020904     o                                        +   2 '-----'
020000020905     o                                        +   2 '-----------'
020100020905     o                                        +   2 '-------'
020200020905     o                                        +   2 '-----------'
020300020905     o                                        +   2 '-------'
020400020904     o          e            STAMPA      1
020500020904     o                       CPScpo1       z
020600020904     o                                        +   0 '/'
020700020904     o                       CPScpo2          +   0 '      0 '
020800020904     o                       CPSdst           +   2 '    /  /0 '
020900020904     o                       CPSdim           +   2 '    /  /0 '
021000020904     o                       CPShim           +   3 '  :  '
021100020904     o                       CPSfst           +   5
021200020905     o                       CPSnrv           +   4 '   .   / '
021300020905     o                       CPScmm        z  +   3
021400020905     o                       CPXnrv           +   3 '   .   / '
021500020905     o                       CPXcmm        z  +   3
021600020904     o          e            FINES       2
021700020904     o                                        +  35 '***   Fine Stampa   ***'
021800020905     o                                        +   6 'Tot. Rec.:'
021900020904     o                       wNrDup        k  +   0
022000020904     o          e            NESSUN      2
022100020904     o                                        +  35 '***   Nessun cliente poten-
022200020904     o                                              ziale elaborato   ***'
