000100091021      //---------------------------------------------------------------
000200091021      //
000300131223      //      Sistema date a zero su ORM e ORF
000400091021      //
000500091021      //---------------------------------------------------------------
000600091021
000700091021     h Decedit('0,') Datedit(*ymd.) Option(*nodebugio)
000800091021
000900091021      //---------------------------------------------------------------
001000091021      //?Dichiarazione file.
001100091021      //---------------------------------------------------------------
001200091021
001300100329     ffnorf00f  uf   e             disk
001400131223     ffnorm01l  if   e           k disk    rename(fnorm000:fnorm01)
001500131223     ffnorm00f  uf   e             disk
001600091021
001700091021      //---------------------------------------------------------------
001800091021      //?Definizione costanti.
001900091021      //---------------------------------------------------------------
002000091021
002100091021      //---------------------------------------------------------------
002200091021      //?Definizione schiere.
002300091021      //---------------------------------------------------------------
002400091021
002500091021      //---------------------------------------------------------------
002600091021      //?Definizione aree dati.
002700091021      //---------------------------------------------------------------
002800091021
002900091021      //---------------------------------------------------------------
003000091021      //?Definizione strutture dati.
003100091021      //---------------------------------------------------------------
003200091021
003300091021      //---------------------------------------------------------------
003400091021      //?Definizione variabili globali.
003500091021      //---------------------------------------------------------------
003600091021      // - Flags booleani
003700131223     d wEnd            s               n   inz(*off)
003800091021
003900091021      //---------------------------------------------------------------
004000091021      //?Definizione procedure esterne.
004100091021      //---------------------------------------------------------------
004200091021
004300091021      //---------------------------------------------------------------
004400091021      //?Definizione key-list.
004500091021      //---------------------------------------------------------------
004600091021
004700091021      //---------------------------------------------------------------
004800091021      //?Main.
004900091021      //---------------------------------------------------------------
005000131223
005100131223     C                   goto      dopo
005200091021
005300091021      /free
005400100323
005500100323       DOW not %eof;
005600100329         read fnorf000;
005700100329         IF  orfdae = 0;
005800100329           chain (orfpoe:orfnsr:orfnor:orfnrv) FNORM01L;
005900100329           IF  %found(FNORM01L);
006000100329             orfdae = ormdao;
006100100329             orfore = ormoao;
006200100329             update fnorf000;
006300100329           ENDIF;
006400100329         ENDIF;
006500100323       ENDDO;
006600131223
006700131223      /end-free
006800131223
006900131223     C     dopo          tag
007000131223
007100131223      /free
007200131223       DOW not %eof;
007300131223         read fnorm00f;
007400131223         IF  ormdar = 0 and ormfao > 500 and ORMtco = 'M';
007500131223           ormdar = ormdfo;
007600131223           update fnorm000;
007700131223         ENDIF;
007800131223       ENDDO;
007900080225
008000100323       *inlr = *on;
