000100121218      //---------------------------------------------------------------
000200121218      //
000300140606      //?        Creo RCD 'S' FNORE cancellato da CAU 97
000400121218      //
000500121218      //---------------------------------------------------------------
000600121218
000700121218     h Decedit('0,') Datedit(*ymd.) Option(*nodebugio)
000800040119
000900040119      *---------------------------------------------------------------*
001000121218
001100140606     fTIORI02L  if   e           k disk
001200140606     fTIORE01L  if   e           k disk
001300140606     fFNORE01L  if a e           k disk
001400040119
001500040119      *---------------------------------------------------------------*
001600121218
001700121218       // - Campi di comodo
001800140606     d k_ORIidc        s                   like(ORIidc) inz('00060257')
001900140606     d k_OREtrc        s                   like(OREtrc)
002000121218
002100121218       // - flag booleani
002200121218     d wEoF            s               n
002300090212
002400090212       //--------------------------------------------------------------
002500090212       //?Definizione procedure usate.                                 ?
002600090212       //--------------------------------------------------------------
002700040119
002800040119      *---------------------------------------------------------------*
002900040119
003000121218      /free
003100121218
003200121218        wEoF = *off;
003300121218
003400140606        setll (k_ORIidc) TIORI02L;
003500140606        reade (k_ORiidc) TIORI02L;
003600121218        DOW not wEoF;
003700140606          IF  %eof(TIORI02L);
003800121218            leave;
003900121218          ENDIF;
004000140606
004100140606          k_OREtrc = 'S ';
004200140606          chain (ORIprg:k_OREtrc) TIORE01L;
004300140606          IF  %found(TIORE01L);
004400140606
004500140606            k_OREtrc = 'G ';
004600140606            chain (ORIpoe:ORInsr:ORInor:ORInrv:k_OREtrc) FNORE01L;
004700140606            IF  %found(FNORE01L);
004800140606
004900140606              k_OREtrc = 'S ';
005000140606              chain (ORIpoe:ORInsr:ORInor:ORInrv:k_OREtrc) FNORE01L;
005100140606              IF  not %found(FNORE01L);
005200140606
005300140606                clear FNORE000;
005400140606                OREpoe = ORIpoe;
005500140606                OREnsr = ORInsr;
005600140606                OREnor = ORInor;
005700140606                OREnrv = ORInrv;
005800140606                OREtrc = k_OREtrc;
005900140606                OREdati = VAOEdati;
006000140606                write FNORE000;
006100140606
006200140606              ENDIF;
006300140606            ENDIF;
006400140606          ENDIF;
006500140331
006600140606          reade (k_ORiidc) TIORI02L;
006700121218        ENDDO;
006800121218
006900121218        *inLR = *ON;
007000050330
007100121218      /end-free
007200140331
