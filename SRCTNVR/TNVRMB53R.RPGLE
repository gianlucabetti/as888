000100161006      //---------------------------------------------------------------
000200161229      //?      Sistemo dati su FIAGA00F
000300161006      //---------------------------------------------------------------
000400161006     h Decedit('0,') Datedit(*dmy.) Option(*nodebugio)
000500161006
000600161006      //---------------------------------------------------------------
000700161006      //?Dichiarazione file.
000800161006      //---------------------------------------------------------------
000900161229     fFIAGA01L  uf   e           k disk
001000161229     fFIAPD01L  if   e           k disk
001100161006
001200161006      //---------------------------------------------------------------
001300161006      //?Definizione costanti.
001400161006      //---------------------------------------------------------------
001500161006
001600161006      //---------------------------------------------------------------
001700161006      //?Definizione schiere.
001800161006      //---------------------------------------------------------------
001900161006
002000161006      //---------------------------------------------------------------
002100161006      //?Definizione aree dati.
002200161006      //---------------------------------------------------------------
002300161006
002400161006      //---------------------------------------------------------------
002500161006      //?Definizione strutture dati.
002600161006      //---------------------------------------------------------------
002700161006     d Kpjba         e ds
002800161229
002900161229      // - Ricerca/Controllo tabelle
003000161229     d TIBS02ds      e ds                  inz
003100161006
003200161229      // - Tabella ACA
003300161229     d dACA          e ds                  inz
003400161006
003500161006      //---------------------------------------------------------------
003600161006      //?Definizione variabili globali.
003700161006      //---------------------------------------------------------------
003800161006      // - Flags booleani
003900161006     d wEoF            s               n   inz(*off)
004000161229
004100161229      // - Campi di comodo
004200161229     d wpdr            s                   like(AGApdr) inz (0010001)
004300161006
004400161006      //---------------------------------------------------------------
004500161006      //?Definizione procedure esterne.
004600161006      //---------------------------------------------------------------
004700161006
004800161006      //---------------------------------------------------------------
004900161006      //?Definizione prototipi.
005000161006      //---------------------------------------------------------------
005100161229      /copy gaitrasrc/srcprotopr,tibs02r
005200161006
005300161006      //---------------------------------------------------------------
005400161006      //?Definizione key-list.
005500161006      //---------------------------------------------------------------
005600161229      // - File FIAPD01L?
005700161229     d kFIAPD01      e ds                  extname(FIAPD01L:*key)
005800161229     d                                     prefix(k_) inz
005900161006
006000161006      //---------------------------------------------------------------
006100161006      //?Riepilogo indicatori.
006200161006      //---------------------------------------------------------------
006300161006
006400161006      //---------------------------------------------------------------
006500161006      //?M A I N - L I N E
006600161006      //---------------------------------------------------------------
006700161006     c     *ENTRY        PLIST
006800161006     c                   PARM                    KPJBA
006900161006
007000161006      /free
007100161006
007200161229       k_APDtip = 'A';
007300161229
007400161229       //?Leggo FIAGA
007500161229       setll (wpdr) FIAGA01L;
007600161229       read FIAGA01L;
007700161229       DOW  not %eof(FIAGA01L);
007800161229         //?Cerco la ragione sociale dell'autista
007900161229         k_APDpdr = AGApdr;
008000161229         chain %kds(kFIAPD01) FIAPD01L;
008100161229         //?Cerco la descrizione della causale
008200161229         clear TIBS02ds;
008300161229         clear dACA;
008400161229         T02mod = 'C';
008500161229         T02cod = 'ACA';
008600161229         T02ke1 = AGAcau;
008700161229         T02sif = KNSIF;
008800161229         TNTBE_RicercaControllo (kpjba : tibs02ds);
008900161229         IF  T02err = *blanks;
009000161229           dACA = T02uni;
009100161229         ENDIF;
009200161229
009300161229         AGApdd = APDrsc;
009400161229         AGAcad = §ACAdes;
009500161229         update FIAGA000;
009600161229
009700161229         read FIAGA01L;
009800161229
009900161229       ENDDO;
010000161006
010100161229       *inLR = *on;
010200161006
010300161006      /end-free
