000100011003     H DECEDIT('0,') DATEDIT(*DMY.)
000101121204     h dftactgrp(*no) actgrp(*caller)
000201121204     Ftivrb00f  o  a E             DISK
000407111012     FPRTF198   O    F  198        PRINTER OFLIND(*INOF)
000408111012
000409121204     d $Endvrb         s               n   inz(*off)
000410121204     d dsvrbsav      e ds                  extname(tivrbsav) inz
001500100317
001600011003     C*------------------------------------------------------------------------*
001700011003     C* MAIN LINE
001800011003     C*------------------------------------------------------------------------*
001801121204         $EndVrb = *off;
001802121204         exec sql
001803121204          declare VRB cursor for
001804121204          select *
001805121204          from tivrbsav order by vrbaas, vrblnp, vrbnrs, vrbnsp,
001806121204          vrbtbl, vrbcvb, vrbtmst;
001807121204
001808121204         exec sql
001809121204           open VRB;
001810121204           IF sqlcode < 0;
001812121204             $Endvrb = *on;
001813121204           ENDIF;
001814121204
001815121204         DOW not $EndVrb;
001816121204           exec sql
001817121204             fetch next from TBS into :dsvrbsav;
001818121204             IF sqlcod = 100 or sqlcod < 0;
001819121204               $EndVrb = *on;
001820121204               leave;
001821121204             ENDIF;
001822121204
001823121204             if vrbcvb=*blanks;
001824121204                exsr wrtnewvrb;
001825121204             else;
001826121204                exsr aggnewvrb;
001827121204             endif;
001828121204         ENDDO;
001829121204
001830121204         exec sql close TBS;
004500011003     C*
013900011003     C                   SETON                                        LR
013901111012     c******************************************************************************
013902121204     c*
013903111012     c******************************************************************************
013904121204       BEGSR wrtnewvrb     ;
013905121204       ENDSR;
013906121204     c******************************************************************************
013907121204     c*
013908121204     c******************************************************************************
013909121204       BEGSR aggnewvrb     ;
013910121204       ENDSR;
018600111012     OPRTF198   E            bolla       1
018700100317     O                       tasaas           +   1
018800100317     O                       taslnp           +   1
018900100317     O                       tasnrs           +   1
019000100317     O                       tasnsp        2  +   1
019100111012     o                       tasccm           +   1
019101111012     o                       wimpvrm       2  +   2
019102111012     o                       oldemd           +   1
019103111012     O          E            notitas     2
019104111012     O                       ar5aas           +   1
019105111012     O                       ar5lnp           +   1
019106111012     O                       ar5nrs           +   1
019107111012     O                       ar5nsp        2  +   1
019108111012     O                                        +   1 'Non trovato titas'
