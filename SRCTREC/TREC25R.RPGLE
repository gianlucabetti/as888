000100000000     H*------------------------------------------------------------------------*
000200000000     H* FATTURAZIONE INFRAGRUPPO MCUBI - RICHIESTA PARAMETRI                   *
000300000000     H*------------------------------------------------------------------------*
000400000000     H DATEDIT(*YMD)
000500000000     F*------------------------------------------------------------------------*
000600000000     F* DATA BASE
000700000000     F*------------------------------------------------------------------------*
000800000000     FTREC25D   CF   E             WORKSTN
000900000000     D*------------------------------------------------------------------------*
001000000000     D* SCHIERE
001100000000     D*------------------------------------------------------------------------*
001200000000     D*-------------------
001300000000     D* MESSAGGI VIDEO
001400000000     D*-------------------
001500000000     D MSG             S             78    DIM(10) CTDATA PERRCD(1)
001600000000     D*------------------------------------------------------------------------*
001700000000     D* INPUT
001800000000     D*------------------------------------------------------------------------*
001900000000     D*------------------
002000000000     D* DS PARAMETRI DI LANCIO
002100000000     D*------------------
002200000000     D PARAM           DS                  INZ
002300990324     D  PARANN                 1      4  0
002400990324     D  PARMES                 5      6  0
002500990420     D  PARSIM                 7      7
002600000000     D*-------------------
002700000000     D* ARCHITETTURA
002800000000     D*-------------------
002900000000     D KPJBA         E DS
003000000000     C*------------------------------------------------------------------------*
003100000000     C* MAIN LINE
003200000000     C*------------------------------------------------------------------------*
003300000000     C*
003400000000     C* IMPOSTAZIONI PRIMA VIDEATA
003500000000     C                   EXSR      IMPVD1
003600000000     C*
003700000000     C* CICLO FINO A RICHIESTA DI FINE ELABORAZIONE
003800000000DO  1C     $FINE         DOUEQ     'S'
003900000000     C     $TIVID        CASEQ     '1'           GESVD1
004000000000     C                   ENDCS
004100000000E   1C                   ENDDO
004200000000     C*
004300000000     C                   SETON                                        LR
004400000000     C*------------------------------------------------------------------------*
004500000000     C* IMPVD1 - IMPOSTAZIONI PRIMA VIDEATA
004600000000     C*------------------------------------------------------------------------*
004700000000     C     IMPVD1        BEGSR
004800000000     C*
004900000000     C* REIMPOSTA FORMATO VIDEO E INDICATORI
005000000000     C                   EXSR      SETVD1
005100000000     C                   MOVEL     '1'           $TIVID
005200000000     C*
005300000000     C                   ENDSR
005400000000     C*------------------------------------------------------------------------*
005500000000     C* SETVD1 - IMPOSTAZIONI INDICATORI PRIMA VIDEATA
005600000000     C*------------------------------------------------------------------------*
005700000000     C     SETVD1        BEGSR
005800000000     C*
005900990324     C                   SETOFF                                       202122
006000000000     C                   SETOFF                                       90
006100000000     C                   MOVEL     *BLANKS       $MSG
006200000000     C*
006300000000     C                   ENDSR
006400000000     C*------------------------------------------------------------------------*
006500000000     C* GESVD1 - GESTIONE PRIMA VIDEATA
006600000000     C*------------------------------------------------------------------------*
006700000000     C     GESVD1        BEGSR
006800000000     C*
006900000000     C* EMISSIONE VIDEATA
007000000000IF  1C     $TESVD        IFEQ      '1'
007100000000     C                   WRITE     EC25D00
007200000000     C                   MOVEL     '0'           $TESVD
007300000000E   1C                   ENDIF
007400000000     C                   EXFMT     EC25D01
007500000000     C                   EXSR      SETVD1
007600000000     C* F03-FINE
007700000000IF  1C     *INKC         IFEQ      *ON
007800000000     C                   EXSR      F03GES
007900000000     C                   GOTO      FINVD1
008000000000E   1C                   ENDIF
008100000000     C* F12-RITORNO
008200000000IF  1C     *INKL         IFEQ      *ON
008300000000     C                   EXSR      F12GES
008400000000     C                   GOTO      FINVD1
008500000000E   1C                   ENDIF
008600000000     C* ENTER-CONTROLLA VIDEO
008700000000     C                   EXSR      CTRVD1
008800000000IF  1C     *IN90         IFEQ      *ON
008900000000     C                   GOTO      FINVD1
009000000000E   1C                   ENDIF
009100000000     C* F06-CONFERMA
009200000000IF  1C     *INKF         IFEQ      *ON
009300000000     C                   EXSR      F06GES
009400000000     C                   GOTO      FINVD1
009500000000E   1C                   ENDIF
009600000000     C*
009700000000     C     FINVD1        ENDSR
009800000000     C*------------------------------------------------------------------------*
009900000000     C* CTRVD1 - CONTROLLA PRIMA VIDEATA
010000000000     C*------------------------------------------------------------------------*
010100000000     C     CTRVD1        BEGSR
010200000000     C*
010300000000     C* REIMPOSTA LE VARIABILI DI LAVORO
010400000000     C                   MOVEL     '0'           WERR
010500990407     C*---
010600990407     C* ANNO
010700990407     C*---
010800990407IF  1C     WERR          IFEQ      '0'
010900990407IF  2C     V1CANN        IFLE      *ZEROS
011000990407     C                   SETON                                        2090
011100990407     C                   MOVEL     MSG(1)        $MSG
011200990407     C                   MOVEL     '1'           WERR
011300990407     C                   GOTO      FINCT1
011400990407E   2C                   ENDIF
011500990407E   1C                   ENDIF
011600990415     C*---
011700990415     C* MESE
011800990415     C*---
011900990415IF  1C     WERR          IFEQ      '0'
012000990420IF  2C     V1CMES        IFGE      1
012100990415     C     V1CMES        ANDLE     12
012200990415X   2C                   ELSE
012300990415     C                   SETON                                        2190
012400990415     C                   MOVEL     MSG(2)        $MSG
012500990415     C                   MOVEL     '1'           WERR
012600990415     C                   GOTO      FINCT1
012700990415E   2C                   ENDIF
012800990415E   1C                   ENDIF
012900990324     C*---
013000990324     C* SIMULAZIONE
013100990324     C*---
013200990324IF  1C     WERR          IFEQ      '0'
013300990324IF  2C     V1CSIM        IFNE      'S'
013400990324     C     V1CSIM        ANDNE     'N'
013500990324     C                   SETON                                        2290
013600990324     C                   MOVEL     MSG(3)        $MSG
013700990324     C                   MOVEL     '1'           WERR
013800990324     C                   GOTO      FINCT1
013900990324E   2C                   ENDIF
014000990324E   1C                   ENDIF
014100000000     C*
014200000000     C     FINCT1        ENDSR
014300000000     C*------------------------------------------------------------------------*
014400000000     C* F03GES - GESTIONE TASTO FUNZIONALE F03 ==> FINE
014500000000     C*------------------------------------------------------------------------*
014600000000     C     F03GES        BEGSR
014700000000     C*
014800000000     C                   MOVEL     'S'           $FINE
014900000000     C*
015000000000     C                   ENDSR
015100000000     C*------------------------------------------------------------------------*
015200000000     C* F12GES - GESTIONE TASTO FUNZIONALE F12 ==> RITORNO
015300000000     C*------------------------------------------------------------------------*
015400000000     C     F12GES        BEGSR
015500000000     C*
015600000000     C                   MOVEL     'S'           $FINE
015700000000     C*
015800000000     C                   ENDSR
015900000000     C*------------------------------------------------------------------------*
016000000000     C* F06GES - GESTIONE TASTO FUNZIONALE F06 ==> CONFERMA
016100000000     C*------------------------------------------------------------------------*
016200000000     C     F06GES        BEGSR
016300000000     C*
016400000000     C* LANCIA IL PROGRAMMA
016500990324     C                   Z-ADD     V1CANN        PARANN
016600990324     C                   Z-ADD     V1CMES        PARMES
016700000000     C                   MOVEL     V1CSIM        PARSIM
016800000000     C                   MOVEL     'EC26'        KCOAZ
016900000000     C                   MOVEL     PARAM         KPJBU
017000000000     C                   CALL      'BCH10'
017100000000     C                   PARM                    KPJBA
017200000121     C*---                 MOVEL'S'       $FINE            *FINE PROGRAMMA
017300000000     C*
017400000000     C                   ENDSR
017500000000     C*------------------------------------------------------------------------*
017600000000     C* *INZSR - OPERAZIONI INIZIALI
017700000000     C*------------------------------------------------------------------------*
017800000000     C     *INZSR        BEGSR
017900000000     C*---
018000000000     C* RICEVIMENTO PARAMETRI
018100000000     C*---
018200000000     C     *ENTRY        PLIST
018300000000     C                   PARM                    KPJBA
018400000000     C*---
018500000000     C* VARIABILI NON RIFERITE AL DATABASE
018600000000     C*---
018700000000     C                   MOVEL     'N'           $FINE             1
018800000000     C                   MOVEL     '1'           $TESVD            1
018900000000     C                   MOVEL     '1'           $TIVID            1
019000000000     C                   MOVEL     '0'           WERR              1
019100000000     C*
019200000000     C                   ENDSR
019300000000     O*------------------------------------------------------------------------*
019400990324** -MSG-
019500990324TREC25R- Anno errato                                                          1
019600990324TREC25R- Mese errato                                                          2
019700990324TREC25R- Immettere uno dei valori possibili                                   3
019800990324TREC25R- 4
019900990324TREC25R- 5
020000990324TREC25R- 6
020100990324TREC25R- 7
020200990324TREC25R- 8
020300990324TREC25R- 9
020400990324TREC25R- Impossibile lanciare questa elaborazione in SDI !!!                  10
