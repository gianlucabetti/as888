000100970903     H*------------------------------------------------------------------------*
000200970903     H* PULIZIA VOCI E TARIFFE DI CONTO ECONOMICO - ESEGUE
000300970903     H*------------------------------------------------------------------------*
000400970903     H DECEDIT('0,') DATEDIT(*DMY.)
000500970903     F*------------------------------------------------------------------------*
000600970903     F* DATA BASE
000700970903     F*------------------------------------------------------------------------*
000800970903     FECEVT01L  UF   E           K DISK
000900140114     FECEVD06L  UF   E           K DISK
001000091020     FECEVm01L  UF   E           K DISK
001100970903     D*------------------------------------------------------------------------*
001200970903     D* INPUT
001300970903     D*------------------------------------------------------------------------*
001400970903     D*-------------------
001500970903     D* ARCHITETTURA
001600970903     D*-------------------
001700970903     D KPJBA         E DS
001800970903     D*-------------------
001900970903     D* DS PARAMETRI DI LANCIO
002000970903     D*-------------------
002100970903     D PARAM           DS
002200970903     D  PARDAT                 1      8  0
002300010808     D*------------------
002400010808     D* CALL XSRDA8 - CONTROLLO DATE
002500010808     D*------------------
002600010808     D WLBDAT          DS                  INZ
002700010808     D  G08DAT                 1      8  0
002800010808     D  G08INV                 9     16  0
002900010808     D  G08ERR                17     17
003000010808     D  G08TGI                18     22  0
003100970903     C*------------------------------------------------------------------------*
003200970903     C* MAIN LINE
003300970903     C*------------------------------------------------------------------------*
003400970903     C*---
003500970903     C* VOCI
003600970903     C*---
003700970903     C     *LOVAL        SETLL     ECEVT01L
003800970903     C                   READ      ECEVT01L                               99
003900970903DO  1C     *IN99         DOWEQ     *OFF
004000970903IF  2C     EVTDSV        IFLE      PARDAT
004100970903     C                   MOVEL     'A'           EVTATB
004200970903     C                   MOVEL     *BLANKS       EVTFTR
004300970903     C                   EXCEPT    AGGEVT
004400091020     c* annullo anche le maggiorazioni
004500091020     c                   if        evttvo = 'M'
004600091020     c     kevm          setll     ecevm01l
004700091020     c                   do        *hival
004800091020     c     kevm          reade     ecevm01l
004900091020     c                   if        %eof(ecevm01l)
005000091020     c                   leave
005100091020     c                   end
005200091020     C                   MOVEL     'A'           EVMATB
005300091020     C                   MOVEL     *BLANKS       EVMFTR
005400091020     C                   Z-ADD     DATCOR        EVmdtr
005500091020     C                   EXCEPT    AGGEVm
005600091020E   1C                   ENDDO
005700091020     c                   end
005800091020     c*
005900970903E   2C                   ENDIF
006000970903     C                   READ      ECEVT01L                               99
006100970903E   1C                   ENDDO
006200970903     C*---
006300970903     C* TARIFFE
006400970903     C*---
006500140114     C     *LOVAL        SETLL     ECEVD06L
006600140114     C                   READ      ECEVD06L                               99
006700970903DO  1C     *IN99         DOWEQ     *OFF
006800970903IF  2C     EVDDST        IFLE      PARDAT
006900970903     C                   MOVEL     'A'           EVDATB
007000970903     C                   MOVEL     *BLANKS       EVDFTR
007100010808     C                   Z-ADD     DATCOR        EVDDUV
007200970903     C                   EXCEPT    AGGEVD
007300970903E   2C                   ENDIF
007400140114     C                   READ      ECEVD06L                               99
007500970903E   1C                   ENDDO
007600970903     C*
007700970903     C                   SETON                                        LR
007800970903     C*------------------------------------------------------------------------*
007900970903     C* *INZSR - OPERAZIONI INIZIALI
008000970903     C*------------------------------------------------------------------------*
008100970903     C     *INZSR        BEGSR
008200970903     C*--------------------
008300970903     C* RICEVIMENTO PARAMETRI
008400970903     C*--------------------
008500970903     C     *ENTRY        PLIST
008600970903     C                   PARM                    KPJBA
008700970903     C                   MOVEL     KPJBU         PARAM
008800010808     C*
008900010808     C* IMPOSTA DATA E ORA CORRENTE
009000010808     C                   TIME                    N14              14 0
009100010808     C                   MOVE      N14           N8                8 0
009200010808     C                   Z-ADD     N8            G08DAT
009300010808     C                   Z-ADD     *ZEROS        G08INV
009400010808     C                   MOVEL     '0'           G08ERR
009500010808     C                   CALL      'XSRDA8'
009600010808     C                   PARM                    WLBDAT
009700010808     C                   Z-ADD     G08INV        DATCOR            8 0
009800010808     C                   MOVE      00            DATCO0            8 0
009900091020     c*
010000091020     C     Kevm          KLIST
010100091020     C                   KFLD                    evtvoc
010200091020     C                   KFLD                    evtprg
010300970903     C*
010400970903     C                   ENDSR
010500970903     O*------------------------------------------------------------------------*
010600970903     O* AGGIORNAMENTO FILES
010700970903     O*------------------------------------------------------------------------*
010800970903     OECEVT     E            AGGEVT
010900970903     O                       EVTATB
011000970903     O                       EVTFTR
011100010808     OECEVD000  E            AGGEVD
011200970903     O                       EVDATB
011300970903     O                       EVDFTR
011400091020     O                       EVDduv
011500091020     OECEVM     E            AGGEVm
011600091020     O                       EVmATB
011700091020     O                       EVmFTR
011800091020     O                       EVmdtr
