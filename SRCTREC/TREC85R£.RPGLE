000100970903     H*------------------------------------------------------------------------*
000200970903     H* PULIZIA VOCI E TARIFFE DI CONTO ECONOMICO - ESEGUE
000300970903     H*------------------------------------------------------------------------*
000400970903     H DECEDIT('0,') DATEDIT(*DMY.)
000500970903     F*------------------------------------------------------------------------*
000600970903     F* DATA BASE
000700970903     F*------------------------------------------------------------------------*
000800970903     FECEVT01L  UF   E           K DISK
000900970903     FECEVD01L  UF   E           K DISK
000901091020     FECEVm01L  UF   E           K DISK
001000970903     D*------------------------------------------------------------------------*
001100970903     D* INPUT
001200970903     D*------------------------------------------------------------------------*
001300970903     D*-------------------
001400970903     D* ARCHITETTURA
001500970903     D*-------------------
001600970903     D KPJBA         E DS
001700970903     D*-------------------
001800970903     D* DS PARAMETRI DI LANCIO
001900970903     D*-------------------
002000970903     D PARAM           DS
002100970903     D  PARDAT                 1      8  0
002200010808     D*------------------
002300010808     D* CALL XSRDA8 - CONTROLLO DATE
002400010808     D*------------------
002500010808     D WLBDAT          DS                  INZ
002600010808     D  G08DAT                 1      8  0
002700010808     D  G08INV                 9     16  0
002800010808     D  G08ERR                17     17
002900010808     D  G08TGI                18     22  0
003000970903     C*------------------------------------------------------------------------*
003100970903     C* MAIN LINE
003200970903     C*------------------------------------------------------------------------*
003300970903     C*---
003400970903     C* VOCI
003500970903     C*---
003600970903     C     *LOVAL        SETLL     ECEVT01L
003700970903     C                   READ      ECEVT01L                               99
003800970903DO  1C     *IN99         DOWEQ     *OFF
003900970903IF  2C     EVTDSV        IFLE      PARDAT
004000970903     C                   MOVEL     'A'           EVTATB
004100970903     C                   MOVEL     *BLANKS       EVTFTR
004200970903     C                   EXCEPT    AGGEVT
004201091020     c* annullo anche le maggiorazioni
004202091020     c                   if        evttvo = 'M'
004203091020     c     kevm          setll     ecevm01l
004204091020     c                   do        *hival
004205091020     c     kevm          reade     ecevm01l
004206091020     c                   if        %eof(ecevm01l)
004207091020     c                   leave
004208091020     c                   end
004209091020     C                   MOVEL     'A'           EVMATB
004210091020     C                   MOVEL     *BLANKS       EVMFTR
004211091020     C                   Z-ADD     DATCOR        EVmdtr
004212091020     C                   EXCEPT    AGGEVm
004213091020E   1C                   ENDDO
004214091020     c                   end
004215091020     c*
004300970903E   2C                   ENDIF
004400970903     C                   READ      ECEVT01L                               99
004500970903E   1C                   ENDDO
004600970903     C*---
004700970903     C* TARIFFE
004800970903     C*---
004900970903     C     *LOVAL        SETLL     ECEVD01L
005000970903     C                   READ      ECEVD01L                               99
005100970903DO  1C     *IN99         DOWEQ     *OFF
005200970903IF  2C     EVDDST        IFLE      PARDAT
005300970903     C                   MOVEL     'A'           EVDATB
005400970903     C                   MOVEL     *BLANKS       EVDFTR
005500010808     C                   Z-ADD     DATCOR        EVDDUV
005600970903     C                   EXCEPT    AGGEVD
005700970903E   2C                   ENDIF
005800970903     C                   READ      ECEVD01L                               99
005900970903E   1C                   ENDDO
006000970903     C*
006100970903     C                   SETON                                        LR
006200970903     C*------------------------------------------------------------------------*
006300970903     C* *INZSR - OPERAZIONI INIZIALI
006400970903     C*------------------------------------------------------------------------*
006500970903     C     *INZSR        BEGSR
006600970903     C*--------------------
006700970903     C* RICEVIMENTO PARAMETRI
006800970903     C*--------------------
006900970903     C     *ENTRY        PLIST
007000970903     C                   PARM                    KPJBA
007100970903     C                   MOVEL     KPJBU         PARAM
007200010808     C*
007300010808     C* IMPOSTA DATA E ORA CORRENTE
007400010808     C                   TIME                    N14              14 0
007500010808     C                   MOVE      N14           N8                8 0
007600010808     C                   Z-ADD     N8            G08DAT
007700010808     C                   Z-ADD     *ZEROS        G08INV
007800010808     C                   MOVEL     '0'           G08ERR
007900010808     C                   CALL      'XSRDA8'
008000010808     C                   PARM                    WLBDAT
008100010808     C                   Z-ADD     G08INV        DATCOR            8 0
008200010808     C                   MOVE      00            DATCO0            8 0
008201091020     c*
008203091020     C     Kevm          KLIST
008204091020     C                   KFLD                    evtvoc
008205091020     C                   KFLD                    evtprg
008300970903     C*
008400970903     C                   ENDSR
008500970903     O*------------------------------------------------------------------------*
008600970903     O* AGGIORNAMENTO FILES
008700970903     O*------------------------------------------------------------------------*
008800970903     OECEVT     E            AGGEVT
008900970903     O                       EVTATB
009000970903     O                       EVTFTR
009100010808     OECEVD000  E            AGGEVD
009200970903     O                       EVDATB
009300970903     O                       EVDFTR
009400091020     O                       EVDduv
009500091020     OECEVM     E            AGGEVm
009600091020     O                       EVmATB
009700091020     O                       EVmFTR
009800091020     O                       EVmdtr
