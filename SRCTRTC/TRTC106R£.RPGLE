000100030116     hDECEDIT('0,') DATEDIT(*DMY.)
000200000000      *****************************************************************
000300050726      *     Visualizza QRY per tipo msg EDI
000400000000      *****************************************************************
000500040826     fkfazn11l  if   E           k disk
000600050726     Ftrtc106d  CF   E             WORKSTN
000700030116      *****************************************************************
000800030116     d KPJBA         E DS
000900030120     D Tibs36ds      E DS
001000000000     D CNCR80        E DS
001100000000     D UT§DSE        E DS                  EXTNAME(UT§DSE0F)
001200940926     D*
001300000000     D WLBDAT          DS
001400940926     D  G02DAT                 1      8  0
001500940926     D  G02INV                 9     16  0
001600940926     D  G02ERR                17     17
001700940926     D  G02TGI                18     22  0
001800050704     D*------------------
001900050704     D* DS DATA ULTIMO AGGIORNAMENTO SALDI
002000050704     D*------------------
002100050704     D                 DS
002200050704     D  AGGAA                  1      4  0
002300050704     D  AGGMM                  5      6  0
002400050704     D  AGGAM                  1      6  0
002500050704     D  AGGGG                  7      8  0
002600050704     D  WDAC                   1      8  0
002700030205      *
002800050510     D*-------------
002900050510     D* Reperimento nome PGM
003000050510     D STATUS         SDS           333
003100050510     D  DSPGM            *PROC
003200050510     D*-------------
003300050510     D digits          C                   CONST('0123456789')
003400030116      *****************************************************************
003500000000     C     *ENTRY        PLIST
003600000000     C                   PARM                    KPJBA
003700030120      *
003800030825     C* Imposta la UDATE  da TIME
003900030825     C                   TIME                    W0140            14 0
004000030825     C                   MOVE      W0140         UDATE8            8 0
004100030825     C*
004200030120      *  In base all'utente prende il P.O.
004300030120     C                   CLEAR                   Tibs36Ds
004400030120     c                   EVAL      I36ute = Knmus
004500030120     c                   EVAL      I36Tla = 'L'
004600030120     C                   CALL      'TIBS36R'
004700030120     C                   PARM                    Tibs36Ds
004800030827     c                   movel     KNMUS         ALFA3             3
004900030829     c                   setoff                                       0102
005000030829      * solo per EDP....:
005100030829     c                   if        ALFA3 ='EDP'
005200030829     c                   seton                                        01
005300030829     c                   end
005400030829      * per utenti di filiale:
005500030829     c                   if        ALFA3<>'EDP' and O36Pou <>46
005600030829     c                   seton                                        02
005700030829     c                   end
005800000000      *--------------------------------------------------------------*
005900000000      *             M A I N      L I N E
006000000000      *--------------------------------------------------------------*
006100000000     C                   Z-ADD     1             CODUT
006200000000     C                   CALL      'X§PARUT'
006300000000     C                   PARM                    UT§DSE
006400000000     C                   MOVEL     RAGUT         RSUT             20
006500000000     C                   MOVEL     RAGUT         RSUT2            20
006600000000     C                   MOVEL     REC80         CNCR80
006700050510     C                   MOVEL     DSPGM         NOMPGM
006800040819      *
006900050726     C                   Z-ADD     0             D1tipo
007000040819     C     INIZIO        tag
007100030825      *
007200000000      * Emetto il formato video
007300030116     C     Video1        TAG
007400020308     C                   SETOFF                                       90
007500050510     C                   EXFMT     d01
007600000000      *
007700000000     C   KC              GOTO      FINE                                         F3=USCITA
007800000000      *
007900000000      * Eseguo i  controlli sui campi immessi a video
008000000000     C                   EXSR      CONTR
008100040830      *
008200040830      * Se non vi sono errori ma non e' premuto F6 emetto video
008300040830     C   90
008400040830     CorNkf              GOTO      Video1
008500030905      *
008600050510      * parametri
008700040819      *
008800050510      *  richiama il pgm che scrive il workFile
008900050726     c                   movel(p)  D1TIPO        kpjbu
009000050726     c                   call      'TRTC106C'
009100040826     c                   parm                    kpjba
009200000000      *
009300050726     C                   GOTO      INIZIO
009400030116      *
009500000000     C     FINE          TAG
009600000000     C                   SETON                                        LR
009700000000      *--------------------------------------------------------------*
009800000000      * Routine per i controlli sui campi del formato video          *
009900000000      *--------------------------------------------------------------*
010000000000     C     CONTR         BEGSR
010100000000      *
010200030116     c                   movea     '0000000000'  *in(41)
010300040819     c                   movea     '0000000000'  *in(51)
010400030116      * --------------
010500040819      * --------------
010600040819      *
010700030116     C     endct1        ENDSR
010800030116      *--------------------------------------------------------------*
010900050704      *   x decodifiche iniziali
011000050704      *--------------------------------------------------------------*
011100050704     C     *InzSR        begSR
011200050704     C*
011300050704     C*---
011400050704     C                   ENDSR
011500050704      *--------------------------------------------------------------*
