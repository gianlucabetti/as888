000100001003     H DECEDIT('0,') DATEDIT(*DMY.)
000200000929      ***********************************************************************
002200050905      *                                                                     *
002300000929      ***********************************************************************
002600060222     FSTA784S   UF   E             DISK
002700060222     F                                     RENAME(STA784S:STA784S0)
004400000120      *---------------------------------------------------------------------*
006200060222     D Conta           s              4  0 INZ(0)
006201060222     D Contarig        s              5  0 INZ(0)
009800000120      *---------------------------------------------------------------------*
009900000120      * DS
010000000120      *---------------------------------------------------------------------*
010100010518     D KPJBA         E DS
010200010516     D EDTD00DS      E DS
010300010516     D  D00                   77    142    DIM(3)
012300000929      *---------------------------------------------------------------------*
012400000929      *                    .. 5 - 8  : tipo record letto
012500000929      *---------------------------------------------------------------------*
012600060222     D WDAT            DS           587
012700010524     D  SUMTPR                 5      8
012800000929     D  SUMINR                 5      6
013300000929     I*---------------------------------------------------------------------*
013400001002     I* FILE ridenominazione records
013500000929     I*---------------------------------------------------------------------*
014000060222     ISTA784S0
014100060222     I              SSIFTSTA                    STADAT
014800000120      *---------------------------------------------------------------------*
014900000120      * Ciclo principale
015000000120      *---------------------------------------------------------------------*
015003060222     C     *entry        plist
015004060222     C                   PARM                    KPJBA
015005060222     C*
015006060222     C                   READ      sta784s
015007060222      *
015008060222     C                   DOW       not %EOF(sta784s)
015009060222     C                   MOVEL     STADAT        WDAT
015010060222      *
015011060222      * reimposta la numerazione delle spedizioni
015012060222     C                   IF        SUMTPR = 'ST00'
015013060222     C                   Eval      Conta  = 0
015014060222     C                   Eval      Contarig  = 0
015015060222     C                   ENDIF
015016060222      *
015017060222      * reimposta la numerazione delle spedizioni
015018060222     C                   IF        SUMTPR = 'SD00'
015019060222     C                   CLEAR                   EDTD00DS
015020060222     C                   MOVEL     STADAT        EDTD00DS
015021060222     C                   Eval      Conta  = Conta  + 1
015022060222     C                   Eval      DA1490 = Conta
015023060222     C                   MOVEL     EDTD00DS      STADAT
015024060222     C                   ENDIF
015035060222      *
015036060222     C                   Eval      Contarig  = 1 + Contarig
015037060222     c                   z-add     contarig      ssprogr
015038060222      *
015039060222     C                   Update    sta784s0
015040060222     C                   READ      sta784s
015041060222     C                   ENDDO
019200010514      *
019300960329     C                   SETON                                        LR
068000010524      *----------------------------------------------------------------
