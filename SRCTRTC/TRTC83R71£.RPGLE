000100960530      ***********************************************************************
000200960530      *   ESPORTA DATI BOLLE VERSO  E.D.I. ESTERO                           *
000300960530      ***********************************************************************
000400960530     H DECEDIT('0,') DATEDIT(*DMY/)
000500960530     F*---------------------------------------------------------------------*
000600010612     FEDIFCSUM  UF   E             DISK
000700960530     D*---------------------------------------------------------------------*
000800960530     D* .. per scompozione dati ricevuti a seconda del tipo record
000900010612     D EDTT10DS      E DS
001000010612     D EDTT25DS      E DS
001100960530     D*---------------------------------------------------------------------*
001200960530     D*                    .. 5 - 8  : tipo record letto
001300960705     D WDAT            DS          1950
001400960726     D  SUMPRG                 1      4  0
001500960530     D  SUMTPR                 5      8
001600960530     D*---------------------------------------------------------------------*
001700960530     D KPJBA         E DS
001800960530     D TRTC82        E DS                  EXTNAME(TRTC82DS)
001900010612      *
002000010612      * *LDA Local Data Area per passare i totali da mettere in testata
002100010612     D AreaTot         DS
002200010612     D  Cnt1                   1      4  0 INZ(0)
002300010612     D  Cnt2                   5      8  0 INZ(0)
002400010612     D  Totcl1                 9     17  0 INZ(0)
002500010612     D  Totcl2                18     26  0 INZ(0)
002600010612     D  Totpe1                27     42  3 INZ(0)
002700010612     D  Totpe2                43     58  3 INZ(0)
002800050906     D  FileX                 59     59    INZ(' ')
002900050906     D  Cnt3                  61     64  0 INZ(0)
003000050906     D  Cnt4                  65     68  0 INZ(0)
003100050906     D  Totcl3                69     77  0 INZ(0)
003200050906     D  Totcl4                78     86  0 INZ(0)
003300050906     D  Totpe3                87    102  3 INZ(0)
003400050906     D  Totpe4               103    118  3 INZ(0)
003500050906     D CpysuFil1             104    104    INZ('N')
003600050906     D CpysuFil2             105    105    INZ('N')
003700050906     D CpysuFil3             106    106    INZ('N')
003800050906     D CpysuFil4             107    107    INZ('N')
003900960626     D*
004000010612     D FILE1           C                   CONST('DE/PRA/DE5       ')
004100010612     D FILE2           C                   CONST('DE/PRA/DE6       ')
004200050906     D FILE3           C                   CONST('DE/PRA/DE7       ')
004300050906     D FILE4           C                   CONST('DE/PRA/DE8       ')
004400960530     I*---------------------------------------------------------------------*
004500960530     I* FILE
004600960530     I*---------------------------------------------------------------------*
004700960704     IRRIFCSUM
004800960530     I              RRIFCSUM                    SUMDAT
004900960530     C*---------------------------------------------------------------------*
005000960530     C* Ciclo principale
005100960530     C*---------------------------------------------------------------------*
005200010612      *
005300010612      * Lettura iniziale sul file
005400010612      *               *----------------------------*
005500010612     C                   EXSR      Legge_rec
005600010612      *               *----------------------------*
005700010612      * Lettura fino a fine file
005800010612      *---------------
005900010612     C                   DOW       not %EOF(EDIFCSUM)
006000010612      *
006100010612      *  Al primo dettaglio esce
006200010612     C                   If        SUMTPR = 'TD00'
006300010612     C                   Leave
006400010612     C                   endif
006500010612      *
006600010612     C*  Aggiorna testata T10
006700010612     C                   If        SUMTPR = 'TT10'
006800010612     C                   EXSR      UPDTT10
006900010612     C                   end
007000010612      *
007100010612     C*  Aggiorna testata T25  (I m p o r t a n t e    x    P R A C H T)
007200010612     C                   If        SUMTPR = 'TT25'
007300010612     C                   EXSR      UPDTT25
007400010612     C                   end
007500010612      * Lettura sul file
007600010612      *               *----------------------------*
007700010612     C                   EXSR      Legge_rec
007800010612      *               *----------------------------*
007900010612     C                   ENDdo
008000010612      *---------------
008100960530     C                   SETON                                        LR
008200010612     C*--------------------------------------------------------------*
008300010612     C*? Lettura del Flat File
008400010612     C*--------------------------------------------------------------*
008500010612     C     Legge_Rec     BEGSR
008600010612      *
008700010612      * Lettura successiva
008800010612      *  muove il record su una DS di controllo
008900010612     C                   READ      EDIFCSUM
009000010612     C                   If        not %EOF(EDIFCSUM)
009100010612      *                          ++++++++++++++++++++++++
009200010612     C                   MOVEL     SUMDAT        WDAT
009300010612      *                          ++++++++++++++++++++++++
009400010612     C                   End
009500010612      *
009600010612     C                   ENDSR
009700960530     C*--------------------------------------------------------------*
009800010612     C* UPDTT10:  tipo record T10 in IFCSUM                         -*
009900960530     C*--------------------------------------------------------------*
010000010612     C     UPDTT10       BEGSR
010100960530     C*
010200010612     C                   CLEAR                   EDTT10DS
010300010612     C                   MOVEL     SUMDAT        EDTT10DS
010400010612     C*
010500010612     C* Totale Spedizioni
010600010612     C                   If        TC6069='10 '
010700050906     C                   If        FileX ='1'
010800010612     C                   eval      TC6066 = Cnt1
010900050906     C                   End
011000050906     C                   If        FileX ='2'
011100010612     C                   eval      TC6066 = Cnt2
011200010612     C                   End
011300050906     C                   If        FileX ='3'
011400050906     C                   eval      TC6066 = Cnt3
011500050906     C                   End
011600050906     C                   If        FileX ='4'
011700050906     C                   eval      TC6066 = Cnt4
011800050906     C                   End
011900010612     C                   End
012000010612     C*
012100010612     C                   If        TCA069='10 '
012200050906     C                   If        FileX ='1'
012300010612     C                   eval      TCA066 = Cnt1
012400050906     C                   End
012500050906     C                   If        FileX ='2'
012600010612     C                   eval      TCA066 = Cnt2
012700010612     C                   End
012800050906     C                   If        FileX ='3'
012900050906     C                   eval      TCA066 = Cnt3
013000050906     C                   End
013100050906     C                   If        FileX ='4'
013200050906     C                   eval      TCA066 = Cnt4
013300050906     C                   End
013400010612     C                   End
013500010612     C*
013600010612     C* Totale Colli
013700010612     C                   If        TC6069='11 '
013800050906     C                   If        FileX ='1'
013900010612     C                   eval      TC6066 = Totcl1
014000050906     C                   End
014100050906     C                   If        FileX ='2'
014200010612     C                   eval      TC6066 = Totcl2
014300010612     C                   End
014400050906     C                   If        FileX ='3'
014500050906     C                   eval      TC6066 = Totcl3
014600050906     C                   End
014700050906     C                   If        FileX ='4'
014800050906     C                   eval      TC6066 = Totcl4
014900050906     C                   End
015000010612     C                   End
015100010612     C*
015200010612     C                   If        TCA069='11 '
015300050906     C                   If        FileX ='1'
015400010612     C                   eval      TCA066 = Totcl1
015500050906     C                   End
015600050906     C                   If        FileX ='2'
015700010612     C                   eval      TCA066 = Totcl2
015800010612     C                   End
015900050906     C                   If        FileX ='3'
016000050906     C                   eval      TCA066 = Totcl3
016100050906     C                   End
016200050906     C                   If        FileX ='4'
016300050906     C                   eval      TCA066 = Totcl4
016400050906     C                   End
016500010612     C                   End
016600010612     C*
016700010612     C* Totale Peso
016800010612     C                   If        TC6069='7  '
016900050906     C                   If        FileX ='1'
017000010612     C                   eval      TC6066 = Totpe1
017100050906     C                   End
017200050906     C                   If        FileX ='2'
017300010612     C                   eval      TC6066 = Totpe2
017400010612     C                   End
017500050906     C                   If        FileX ='3'
017600050906     C                   eval      TC6066 = Totpe3
017700050906     C                   End
017800050906     C                   If        FileX ='4'
017900050906     C                   eval      TC6066 = Totpe4
018000050906     C                   End
018100010612     C                   End
018200010612     C*
018300010612     C                   If        TCA069='7  '
018400050906     C                   If        FileX ='1'
018500010612     C                   eval      TCA066 = Totpe1
018600050906     C                   End
018700050906     C                   If        FileX ='2'
018800010612     C                   eval      TCA066 = Totpe2
018900010612     C                   End
019000050906     C                   If        FileX ='3'
019100050906     C                   eval      TCA066 = Totpe3
019200050906     C                   End
019300050906     C                   If        FileX ='4'
019400050906     C                   eval      TCA066 = Totpe4
019500050906     C                   End
019600010612     C                   End
019700010612     C*
019800010612     C                   MOVEL     EDTT10DS      sumdat
019900010612     C                   UPDATE    RRIFCSUM
020000960530     C*
020100960530     C                   ENDSR
020200960530     C*--------------------------------------------------------------*
020300010612     C* UPDTT25:  tipo record T25 in IFCSUM                         -*
020400960530     C*--------------------------------------------------------------*
020500010612     C     UPDTT25       BEGSR
020600960530     C*
020700010612     C                   CLEAR                   EDTT25DS
020800010612     C                   MOVEL     SUMDAT        EDTT25DS
020900960530     C*  Ship to:
021000010612     C                   If        TF3035 = 'ST '
021100050906     C                   If        FileX ='1'
021200010612     C                   eval      TF3039 = File1
021300050906     C                   End
021400050906     C                   If        FileX ='2'
021500010612     C                   eval      TF3039 = File2
021600010612     C                   End
021700050906     C                   If        FileX ='3'
021800050906     C                   eval      TF3039 = File3
021900050906     C                   End
022000050906     C                   If        FileX ='4'
022100050906     C                   eval      TF3039 = File4
022200050906     C                   End
022300010612     C                   endif
022400010612     C*
022500010612     C                   MOVEL     EDTT25DS      sumdat
022600010612     C                   UPDATE    RRIFCSUM
022700960530     C*
022800960530     C                   ENDSR
022900960530     C*----------------------------------------------------------------
023000960530     C*  *INZSR - OPERAZIONI INIZIALI
023100960530     C*----------------------------------------------------------------
023200960530     C     *INZSR        BEGSR
023300960530     C*
023400960530     C     *ENTRY        PLIST
023500960530     C                   PARM                    KPJBA
023600010612     C                   MOVEL     KPJBU         TRTC82
023700010612     C*
023800010612     C* Definizione della Local Data Area e lettura del contenuto
023900010612     C     *DTAARA       DEFINE    *LDA          AreaTot
024000010612     C                   IN        AreaTot
024100960530     C*
024200960530     C                   ENDSR
