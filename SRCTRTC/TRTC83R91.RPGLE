000100960530      ***********************************************************************
000200960530      *   ESPORTA DATI BOLLE VERSO  E.D.I. ESTERO                           *
000300960530      ***********************************************************************
000400960530     H DECEDIT('0,') DATEDIT(*DMY/)
000500960530     F*---------------------------------------------------------------------*
000600010612     FEDIFCSUM  UF   E             DISK
000700960530     D*---------------------------------------------------------------------*
000800960530     D* .. per scompozione dati ricevuti a seconda del tipo record
000900110415     D EDTT00DS      E DS
001000110415     D EDTT10DS      E DS
001100010612     D EDTT25DS      E DS
001200960530     D*---------------------------------------------------------------------*
001300960530     D*                    .. 5 - 8  : tipo record letto
001400960705     D WDAT            DS          1950
001500960726     D  SUMPRG                 1      4  0
001600960530     D  SUMTPR                 5      8
001700960530     D*---------------------------------------------------------------------*
001800960530     D KPJBA         E DS
001900960530     D TRTC82        E DS                  EXTNAME(TRTC82DS)
002000010612      *
002100010612      * *LDA Local Data Area per passare i totali da mettere in testata
002200010612     D AreaTot         DS
002300010612     D  Cnt1                   1      4  0 INZ(0)
002400010612     D  Cnt2                   5      8  0 INZ(0)
002500010612     D  Totcl1                 9     17  0 INZ(0)
002600010612     D  Totcl2                18     26  0 INZ(0)
002700010612     D  Totpe1                27     42  3 INZ(0)
002800010612     D  Totpe2                43     58  3 INZ(0)
002900050906     D  FileX                 59     59    INZ(' ')
003000050906     D CpysuFil1             104    104    INZ('N')
003100050906     D CpysuFil2             105    105    INZ('N')
003200960626     D*
003300110415     D FILE1           C                   CONST('DK/AGI/CPH       ')
003400110415     D FILE2           C                   CONST('FI/AGI/HEL       ')
003500110415     D UNB1            C                   CONST('AGILITYDK        ')
003600110415     D UNB2            C                   CONST('AGILITYFI        ')
003700960530     I*---------------------------------------------------------------------*
003800960530     I* FILE
003900960530     I*---------------------------------------------------------------------*
004000960704     IRRIFCSUM
004100960530     I              RRIFCSUM                    SUMDAT
004200960530     C*---------------------------------------------------------------------*
004300960530     C* Ciclo principale
004400960530     C*---------------------------------------------------------------------*
004500010612      *
004600010612      * Lettura iniziale sul file
004700010612      *               *----------------------------*
004800010612     C                   EXSR      Legge_rec
004900010612      *               *----------------------------*
005000010612      * Lettura fino a fine file
005100010612      *---------------
005200010612     C                   DOW       not %EOF(EDIFCSUM)
005300010612      *
005400010612      *  Al primo dettaglio esce
005500010612     C                   If        SUMTPR = 'TD00'
005600010612     C                   Leave
005700010612     C                   endif
005800010612      *
005900110415     C*  Aggiorna testata T00   (I m p o r t a n t e    x    A G I L I T Y)
006000110415     C                   If        SUMTPR = 'TT00'
006100110415     C                   EXSR      UPDTT00
006200010612     C                   end
006300110415      *
006400110415     C*  Aggiorna testata T10
006500110415     C                   If        SUMTPR = 'TT10'
006600110415     C                   EXSR      UPDTT10
006700110415     C                   end
006800010612      *
006900110415     C*  Aggiorna testata T25  (I m p o r t a n t e    x    A G I L I T Y)
007000010612     C                   If        SUMTPR = 'TT25'
007100010612     C                   EXSR      UPDTT25
007200010612     C                   end
007300010612      * Lettura sul file
007400010612      *               *----------------------------*
007500010612     C                   EXSR      Legge_rec
007600010612      *               *----------------------------*
007700010612     C                   ENDdo
007800010612      *---------------
007900960530     C                   SETON                                        LR
008000010612     C*--------------------------------------------------------------*
008100010612     C*? Lettura del Flat File
008200010612     C*--------------------------------------------------------------*
008300010612     C     Legge_Rec     BEGSR
008400010612      *
008500010612      * Lettura successiva
008600010612      *  muove il record su una DS di controllo
008700010612     C                   READ      EDIFCSUM
008800010612     C                   If        not %EOF(EDIFCSUM)
008900010612      *                          ++++++++++++++++++++++++
009000010612     C                   MOVEL     SUMDAT        WDAT
009100010612      *                          ++++++++++++++++++++++++
009200010612     C                   End
009300010612      *
009400010612     C                   ENDSR
009500110415     C*--------------------------------------------------------------*
009600110415     C* UPDTT00:  tipo record T00 in IFCSUM  diversi UNB            -*
009700110415     C*--------------------------------------------------------------*
009800110415     C     UPDTT00       BEGSR
009900110415     C*
010000110415     C                   CLEAR                   EDTT00DS
010100110415     C                   MOVEL     SUMDAT        EDTT00DS
010200110415     C*  UNB  to:
010300110415     C                   If        FileX ='1'
010400110415     C                   eval      TA0010 = UNB1
010500110415     C                   End
010600110415     C                   If        FileX ='2'
010700110415     C                   eval      TA0010 = UNB2
010800110415     C                   End
010900110415     C*
011000110415     C                   MOVEL     EDTT00DS      sumdat
011100110415     C                   UPDATE    RRIFCSUM
011200110415     C*
011300110415     C                   ENDSR
011400960530     C*--------------------------------------------------------------*
011500010612     C* UPDTT10:  tipo record T10 in IFCSUM                         -*
011600960530     C*--------------------------------------------------------------*
011700010612     C     UPDTT10       BEGSR
011800960530     C*
011900010612     C                   CLEAR                   EDTT10DS
012000010612     C                   MOVEL     SUMDAT        EDTT10DS
012100010612     C*
012200010612     C* Totale Spedizioni
012300010612     C                   If        TC6069='10 '
012400050906     C                   If        FileX ='1'
012500010612     C                   eval      TC6066 = Cnt1
012600050906     C                   End
012700050906     C                   If        FileX ='2'
012800010612     C                   eval      TC6066 = Cnt2
012900010612     C                   End
013000010612     C                   End
013100010612     C*
013200010612     C                   If        TCA069='10 '
013300050906     C                   If        FileX ='1'
013400010612     C                   eval      TCA066 = Cnt1
013500050906     C                   End
013600050906     C                   If        FileX ='2'
013700010612     C                   eval      TCA066 = Cnt2
013800010612     C                   End
013900010612     C                   End
014000010612     C*
014100010612     C* Totale Colli
014200010612     C                   If        TC6069='11 '
014300050906     C                   If        FileX ='1'
014400010612     C                   eval      TC6066 = Totcl1
014500050906     C                   End
014600050906     C                   If        FileX ='2'
014700010612     C                   eval      TC6066 = Totcl2
014800010612     C                   End
014900010612     C                   End
015000010612     C*
015100010612     C                   If        TCA069='11 '
015200050906     C                   If        FileX ='1'
015300010612     C                   eval      TCA066 = Totcl1
015400050906     C                   End
015500050906     C                   If        FileX ='2'
015600010612     C                   eval      TCA066 = Totcl2
015700010612     C                   End
015800010612     C                   End
015900010612     C*
016000010612     C* Totale Peso
016100010612     C                   If        TC6069='7  '
016200050906     C                   If        FileX ='1'
016300010612     C                   eval      TC6066 = Totpe1
016400050906     C                   End
016500050906     C                   If        FileX ='2'
016600010612     C                   eval      TC6066 = Totpe2
016700010612     C                   End
016800010612     C                   End
016900010612     C*
017000010612     C                   If        TCA069='7  '
017100050906     C                   If        FileX ='1'
017200010612     C                   eval      TCA066 = Totpe1
017300050906     C                   End
017400050906     C                   If        FileX ='2'
017500010612     C                   eval      TCA066 = Totpe2
017600010612     C                   End
017700010612     C                   End
017800010612     C*
017900010612     C                   MOVEL     EDTT10DS      sumdat
018000010612     C                   UPDATE    RRIFCSUM
018100960530     C*
018200960530     C                   ENDSR
018300960530     C*--------------------------------------------------------------*
018400010612     C* UPDTT25:  tipo record T25 in IFCSUM                         -*
018500960530     C*--------------------------------------------------------------*
018600010612     C     UPDTT25       BEGSR
018700960530     C*
018800010612     C                   CLEAR                   EDTT25DS
018900010612     C                   MOVEL     SUMDAT        EDTT25DS
019000960530     C*  Ship to:
019100010612     C                   If        TF3035 = 'ST '
019200050906     C                   If        FileX ='1'
019300010612     C                   eval      TF3039 = File1
019400050906     C                   End
019500050906     C                   If        FileX ='2'
019600010612     C                   eval      TF3039 = File2
019700010612     C                   End
019800010612     C                   endif
019900010612     C*
020000010612     C                   MOVEL     EDTT25DS      sumdat
020100010612     C                   UPDATE    RRIFCSUM
020200960530     C*
020300960530     C                   ENDSR
020400960530     C*----------------------------------------------------------------
020500960530     C*  *INZSR - OPERAZIONI INIZIALI
020600960530     C*----------------------------------------------------------------
020700960530     C     *INZSR        BEGSR
020800960530     C*
020900960530     C     *ENTRY        PLIST
021000960530     C                   PARM                    KPJBA
021100010612     C                   MOVEL     KPJBU         TRTC82
021200010612     C*
021300010612     C* Definizione della Local Data Area e lettura del contenuto
021400010612     C     *DTAARA       DEFINE    *LDA          AreaTot
021500010612     C                   IN        AreaTot
021600960530     C*
021700960530     C                   ENDSR
