000100960530      ***********************************************************************
000200960530      *   ESPORTA DATI BOLLE VERSO  E.D.I. ESTERO                           *
000300960530      ***********************************************************************
000400960530     H DECEDIT('0,') DATEDIT(*DMY/)
000500960530     F*---------------------------------------------------------------------*
000600010612     FEDIFCSUM  UF   E             DISK
000700960530     D*---------------------------------------------------------------------*
000800960530     D* .. per scompozione dati ricevuti a seconda del tipo record
000900010612     D EDTT10DS      E DS
001000010612     D EDTT25DS      E DS
001100960530     D*---------------------------------------------------------------------*
001200960530     D*                    .. 5 - 8  : tipo record letto
001300960705     D WDAT            DS          1950
001400960726     D  SUMPRG                 1      4  0
001500960530     D  SUMTPR                 5      8
001600960530     D*---------------------------------------------------------------------*
001700960530     D KPJBA         E DS
001800960530     D TRTC82        E DS                  EXTNAME(TRTC82DS)
001900010612      *
002000010612      * *LDA Local Data Area per passare i totali da mettere in testata
002100010612     D AreaTot         DS
002200010612     D  Cnt1                   1      4  0 INZ(0)
002300010612     D  Cnt2                   5      8  0 INZ(0)
002400010612     D  Totcl1                 9     17  0 INZ(0)
002500010612     D  Totcl2                18     26  0 INZ(0)
002600010612     D  Totpe1                27     42  3 INZ(0)
002700010612     D  Totpe2                43     58  3 INZ(0)
002800050906     D  FileX                 59     59    INZ(' ')
002900050906     D CpysuFil1             104    104    INZ('N')
003000050906     D CpysuFil2             105    105    INZ('N')
003100960626     D*
003200081210     D FILE1           C                   CONST('DE/TOF/DE1       ')
003300081210     D FILE2           C                   CONST('PL/TOF/PL1       ')
003400960530     I*---------------------------------------------------------------------*
003500960530     I* FILE
003600960530     I*---------------------------------------------------------------------*
003700960704     IRRIFCSUM
003800960530     I              RRIFCSUM                    SUMDAT
003900960530     C*---------------------------------------------------------------------*
004000960530     C* Ciclo principale
004100960530     C*---------------------------------------------------------------------*
004200010612      *
004300010612      * Lettura iniziale sul file
004400010612      *               *----------------------------*
004500010612     C                   EXSR      Legge_rec
004600010612      *               *----------------------------*
004700010612      * Lettura fino a fine file
004800010612      *---------------
004900010612     C                   DOW       not %EOF(EDIFCSUM)
005000010612      *
005100010612      *  Al primo dettaglio esce
005200010612     C                   If        SUMTPR = 'TD00'
005300010612     C                   Leave
005400010612     C                   endif
005500010612      *
005600010612     C*  Aggiorna testata T10
005700010612     C                   If        SUMTPR = 'TT10'
005800010612     C                   EXSR      UPDTT10
005900010612     C                   end
006000010612      *
006100010612     C*  Aggiorna testata T25  (I m p o r t a n t e    x    P R A C H T)
006200010612     C                   If        SUMTPR = 'TT25'
006300010612     C                   EXSR      UPDTT25
006400010612     C                   end
006500010612      * Lettura sul file
006600010612      *               *----------------------------*
006700010612     C                   EXSR      Legge_rec
006800010612      *               *----------------------------*
006900010612     C                   ENDdo
007000010612      *---------------
007100960530     C                   SETON                                        LR
007200010612     C*--------------------------------------------------------------*
007300010612     C*? Lettura del Flat File
007400010612     C*--------------------------------------------------------------*
007500010612     C     Legge_Rec     BEGSR
007600010612      *
007700010612      * Lettura successiva
007800010612      *  muove il record su una DS di controllo
007900010612     C                   READ      EDIFCSUM
008000010612     C                   If        not %EOF(EDIFCSUM)
008100010612      *                          ++++++++++++++++++++++++
008200010612     C                   MOVEL     SUMDAT        WDAT
008300010612      *                          ++++++++++++++++++++++++
008400010612     C                   End
008500010612      *
008600010612     C                   ENDSR
008700960530     C*--------------------------------------------------------------*
008800010612     C* UPDTT10:  tipo record T10 in IFCSUM                         -*
008900960530     C*--------------------------------------------------------------*
009000010612     C     UPDTT10       BEGSR
009100960530     C*
009200010612     C                   CLEAR                   EDTT10DS
009300010612     C                   MOVEL     SUMDAT        EDTT10DS
009400010612     C*
009500010612     C* Totale Spedizioni
009600010612     C                   If        TC6069='10 '
009700050906     C                   If        FileX ='1'
009800010612     C                   eval      TC6066 = Cnt1
009900050906     C                   End
010000050906     C                   If        FileX ='2'
010100010612     C                   eval      TC6066 = Cnt2
010200010612     C                   End
010300010612     C                   End
010400010612     C*
010500010612     C                   If        TCA069='10 '
010600050906     C                   If        FileX ='1'
010700010612     C                   eval      TCA066 = Cnt1
010800050906     C                   End
010900050906     C                   If        FileX ='2'
011000010612     C                   eval      TCA066 = Cnt2
011100010612     C                   End
011200010612     C                   End
011300010612     C*
011400010612     C* Totale Colli
011500010612     C                   If        TC6069='11 '
011600050906     C                   If        FileX ='1'
011700010612     C                   eval      TC6066 = Totcl1
011800050906     C                   End
011900050906     C                   If        FileX ='2'
012000010612     C                   eval      TC6066 = Totcl2
012100010612     C                   End
012200010612     C                   End
012300010612     C*
012400010612     C                   If        TCA069='11 '
012500050906     C                   If        FileX ='1'
012600010612     C                   eval      TCA066 = Totcl1
012700050906     C                   End
012800050906     C                   If        FileX ='2'
012900010612     C                   eval      TCA066 = Totcl2
013000010612     C                   End
013100010612     C                   End
013200010612     C*
013300010612     C* Totale Peso
013400010612     C                   If        TC6069='7  '
013500050906     C                   If        FileX ='1'
013600010612     C                   eval      TC6066 = Totpe1
013700050906     C                   End
013800050906     C                   If        FileX ='2'
013900010612     C                   eval      TC6066 = Totpe2
014000010612     C                   End
014100010612     C                   End
014200010612     C*
014300010612     C                   If        TCA069='7  '
014400050906     C                   If        FileX ='1'
014500010612     C                   eval      TCA066 = Totpe1
014600050906     C                   End
014700050906     C                   If        FileX ='2'
014800010612     C                   eval      TCA066 = Totpe2
014900010612     C                   End
015000010612     C                   End
015100010612     C*
015200010612     C                   MOVEL     EDTT10DS      sumdat
015300010612     C                   UPDATE    RRIFCSUM
015400960530     C*
015500960530     C                   ENDSR
015600960530     C*--------------------------------------------------------------*
015700010612     C* UPDTT25:  tipo record T25 in IFCSUM                         -*
015800960530     C*--------------------------------------------------------------*
015900010612     C     UPDTT25       BEGSR
016000960530     C*
016100010612     C                   CLEAR                   EDTT25DS
016200010612     C                   MOVEL     SUMDAT        EDTT25DS
016300960530     C*  Ship to:
016400010612     C                   If        TF3035 = 'ST '
016500050906     C                   If        FileX ='1'
016600010612     C                   eval      TF3039 = File1
016700050906     C                   End
016800050906     C                   If        FileX ='2'
016900010612     C                   eval      TF3039 = File2
017000010612     C                   End
017100010612     C                   endif
017200010612     C*
017300010612     C                   MOVEL     EDTT25DS      sumdat
017400010612     C                   UPDATE    RRIFCSUM
017500960530     C*
017600960530     C                   ENDSR
017700960530     C*----------------------------------------------------------------
017800960530     C*  *INZSR - OPERAZIONI INIZIALI
017900960530     C*----------------------------------------------------------------
018000960530     C     *INZSR        BEGSR
018100960530     C*
018200960530     C     *ENTRY        PLIST
018300960530     C                   PARM                    KPJBA
018400010612     C                   MOVEL     KPJBU         TRTC82
018500010612     C*
018600010612     C* Definizione della Local Data Area e lettura del contenuto
018700010612     C     *DTAARA       DEFINE    *LDA          AreaTot
018800010612     C                   IN        AreaTot
018900960530     C*
019000960530     C                   ENDSR
