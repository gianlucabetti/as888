000100961003     H DECEDIT('0,') DATEDIT(*DMY.)
000200961003     H*---------------------------------------------------------------------*
000300961003     H*  Ritorno date arrivo ai partner  - E.D.I. - Estero -                *
000400961003     F*---------------------------------------------------------------------*
000500961003     F*  DATA BASE                                                          *
000600961003     F*---------------------------------------------------------------------*
000700980330     FTRTC87D6  CF   E             WORKSTN
000800980330     F                                     SFILE(TC87S01:NRR1)
000900961003     D*---------------------------------------------------------------------*
001000961003     D* DS
001100961003     D*---------------------------------------------------------------------*
001200961003     D KPJBA         E DS
001300961007     D TRTC87        E DS                  EXTNAME(TRTC87DS)
001400961003     D                SDS
001500961003     D  NOMPGM                 1     10
001600961003     C*---------------------------------------------------------------------*
001700961003     C* Ciclo principale
001800961003     C*---------------------------------------------------------------------*
001900961003     C* Inizializzo prima videata
002000980330     C     WCARSF        IFEQ      ' '
002100980330     C     WLNP          ORNE      D87LNP
002200980331     C     WNFE          ORNE      D87NFE
002300980330     C                   EXSR      CARS01
002400980330     C                   MOVEL     'S'           WCARSF            1
002500980330     C                   MOVE      D87LNP        WLNP              3 0
002600980331     C                   MOVE      D87NFE        WNFE              5 0
002700980330     C                   END
002800961003      * Loop gestione videate
002900961003     C     WFINE         DOWEQ     'N'
003000980330     C                   EXSR      GESD01
003100961003     C                   END
003200961003      * Fine Lavoro
003300961003     C     FINE          TAG
003400980331     C                   MOVEL     TRTC87        KPJBU
003500980401     C                   SETON                                        RT
003600961003     C*---------------------------------------------------------------*
003700980330     C*  CARS01: Inizializzo prima videata
003800961003     C*---------------------------------------------------------------*
003900980330     C     CARS01        BEGSR
004000961003     C*
004100961003     C*  Pulisco subfile
004200980330     C                   Z-ADD     0             NRR1              4 0
004300961003     C                   SETOFF                                       2021
004400980330     C                   WRITE     TC87C01
004500961003     C                   SETON                                        2021
004600980330     C* Carico una pagaina vuota
004700980331     C                   Z-ADD     1             NR1KEY
004800961008     C                   EXSR      ROLLUP
004900961003     C*
005000961003     C                   ENDSR
005100961003     C*---------------------------------------------------------------*
005200961003     C*  GESD01: Gestione prima videata
005300961003     C*---------------------------------------------------------------*
005400961003     C     GESD01        BEGSR
005500961003     C*
005600980331     C                   MOVEL     ' '           D87ECC
005700980331     C                   WRITE     TC87Z01
005800980331     C                   EXFMT     TC87C01
005900980330     C                   Z-ADD     1             NR1KEY
006000980330     C*  ROLLUP
006100980330     C     *IN95         IFEQ      '1'
006200980330     C                   EXSR      ROLLUP
006300980330     C                   Z-ADD     NRR1          NR1KEY
006400961008     C                   GOTO      FINVD1
006500961008     C                   END
006600980331     C*  CONFERMA
006700980331     C     *INKA         IFEQ      '1'
006800980331     C                   MOVEL     'S'           D87ECC
006900980331     C                   MOVEL     'S'           WFINE
007000980331     C                   GOTO      FINVD1
007100980331     C                   END
007200961003     C*
007300961003     C     FINVD1        ENDSR
007400961003     C*----------------------------------------------------*
007500961003     C*   ROLLUP: Caricamento dati da EDVAB                *
007600961003     C*----------------------------------------------------*
007700961003     C     ROLLUP        BEGSR
007800961003     C*
007900980330     C                   DO        7
008000980330     C                   CLEAR                   TC87S01
008100980330     C                   MOVEL     *BLANKS       V1CNOT
008200980330     C                   ADD       1             NRR1
008300980330     C                   WRITE     TC87S01
008400980326     C                   END
008500961003     C*
008600961003     C                   ENDSR
008700961003     C*----------------------------------------------------*
008800961003     C*   *INZSR: Operazioni iniziali                      *
008900961003     C*----------------------------------------------------*
009000961010     C     *INZSR        BEGSR
009100961003     C*
009200961003     C     *ENTRY        PLIST
009300961003     C                   PARM                    KPJBA
009400980330     C                   MOVEL     KPJBU         TRTC87
009500961003     C*  Inizializzo variabili
009600961003     C                   MOVEL     'N'           WFINE             1
009700961003     C*
009800961003     C                   ENDSR
