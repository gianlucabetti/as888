000100030730      /TITLE Controllo CIN italiano.
000200030730     ***********************************************************************
000300030730     ** Il CIN è calcolato su 22 caratteri (ABI, CAB e conto).
000400030730     ** Ogni carattere è convertito in un numero a seconda che
000500030730     ** si trovi in posizione pari o dispari nella stringa di 22.
000600030730     ** Il primo carattere a sinistra è in una posizione dispari.
000700030730     **
000800030730     ** Algoritmo trasformazione dispari
000900030730     ** A / 0 = 1  K = 2  U = 16
001000030730     ** B / 1 = 0  L = 4  V = 10
001100030730     ** C / 2 = 5  M = 18 W = 22
001200030730     ** D / 3 = 7  N = 20 X = 25
001300030730     ** E / 4 = 9  O = 11 Y = 24
001400030730     ** F / 5 = 13 P = 3  Z = 23
001500030730     ** G / 6 = 15 Q = 6
001600030730     ** H / 7 = 17 R = 8
001700030730     ** I / 8 = 19 S = 12
001800030730     ** J / 9 = 21 T = 14
001900030730     **
002000030730     ** Algoritmo trasformazione pari
002100030730     ** A / 0 = 0 K = 10 U = 20
002200030730     ** B / 1 = 1 L = 11 V = 21
002300030730     ** C / 2 = 2 M = 12 W = 22
002400030730     ** D / 3 = 3 N = 13 X = 23
002500030730     ** E / 4 = 4 O = 14 Y = 24
002600030730     ** F / 5 = 5 P = 15 Z = 25
002700030730     ** G / 6 = 6 Q = 16
002800030730     ** H / 7 = 7 R = 17
002900030730     ** I / 8 = 8 S = 18
003000030730     ** J / 9 = 9 T = 19
003100030730     **
003200030730     ** I numeri sono sommati e il risultato è diviso 26.
003300030730     ** Il resto è convertito in una lettera, che è il CIN, secondo la
003400030730     ** seguente tabella:
003500030730     **
003600030730     ** 0 = A  9 = J 18 = S
003700030730     ** 1 = B 10 = K 19 = T
003800030730     ** 2 = C 11 = L 20 = U
003900030730     ** 3 = D 12 = M 21 = V
004000030730     ** 4 = E 13 = N 22 = W
004100030730     ** 5 = F 14 = O 23 = X
004200030730     ** 6 = G 15 = P 24 = Y
004300030730     ** 7 = H 16 = Q 25 = Z
004400030730     ** 8 = I 17 = R
004500030730     ***********************************************************************
004600030730
004700030730     H DFTACTGRP(*NO) ACTGRP(*CALLER)
004800030730
004900030730     D ABI             S              5
005000030730     D CAB             S              5
005100030730     D Conto           S             12
005200030730     D CIN             S              1
005300030730     D Esito           S              1
005400030730
005500030730     D Val             S              1
005600030730     D                                     DIM(36)
005700030730     D                                     CTDATA
005800030730     D                                     PERRCD(36)
005900030730     D                                     ASCEND
006000030730     D Dis             S              2S 0
006100030730     D                                     DIM(36)
006200030730     D                                     CTDATA
006300030730     D                                     PERRCD(36)
006400030730     D Par             S              2S 0
006500030730     D                                     DIM(36)
006600030730     D                                     CTDATA
006700030730     D                                     PERRCD(36)
006800030730     D Str             S              1
006900030730     D                                     DIM(22)
007000030730     D I               S              5I 0
007100030730     D J               S              5I 0
007200030730     D Somma           S              5U 0
007300030730
007400030730     ***********************************************************************
007500030730     **
007600030730     **
007700030730     **
007800030730     ***********************************************************************
007900030730     C     *ENTRY        PLIST
008000030730     C                   PARM                    ABI
008100030730     C                   PARM                    CAB
008200030730     C                   PARM                    Conto
008300030730     C                   PARM                    CIN
008400030730     C                   PARM                    Esito
008500030730
008600030730     C                   CLEAR                   Esito
008700030730
008800030730     C                   EXSR      Calcolo
008900030730
009000030730     C                   IF        CIN <> *BLANK
009100030730     C                   IF        CIN <> Val(J)
009200030730     C                   EVAL      Esito = *ON
009300030730     C                   ENDIF
009400030730     C                   ELSE
009500030730     C                   EVAL      CIN = Val(J)
009600030730     C                   ENDIF
009700030730
009800030730     C                   EXSR      Uscita
009900030730
010000030730     ***********************************************************************
010100030730     **
010200030730     ** Calcolo CIN.
010300030730     **
010400030730     ***********************************************************************
010500030730     C     Calcolo       BEGSR
010600030730
010700030730     C                   MOVEA     ABI           Str(1)
010800030730     C                   MOVEA     CAB           Str(6)
010900030730     C                   MOVEA     Conto         Str(11)
011000030730     C                   CLEAR                   Somma
011100030730
011200030730     C                   DO        22            I
011300030730     C
011400030730     C                   EVAL      J = 1
011500030730     C     Str(I)        LOOKUP    Val(J)                             01  01
011600030730     C
011700030730     C                   IF        %EQUAL
011800030730     C
011900030730     C                   IF        I = 1 OR I = 3 OR I = 5 OR I = 7 OR I = 9
012000030730     C                             OR I = 11 OR I = 13 OR I = 15 OR I = 17
012100030730     C                             OR I = 19 OR I = 21
012200030730     C                   EVAL      Somma = Somma + Dis(J)
012300030730     C                   ELSE
012400030730     C                   EVAL      Somma = Somma + Par(J)
012500030730     C                   ENDIF
012600030730     C
012700030730     C                   ELSE
012800030730     C
012900030730     C                   EVAL      Esito = *ON
013000030730     C                   EXSR      Uscita
013100030730     C
013200030730     C                   ENDIF
013300030730     C
013400030730     C                   ENDDO
013500030730
013600030730     C     Somma         DIV       26            J
013700030730     C                   MVR                     J
013800030730     C                   EVAL      J = J + 1
013900030730
014000030730     C                   ENDSR
014100030730
014200030730     ***********************************************************************
014300030730     **
014400030730     **
014500030730     **
014600030730     ***********************************************************************
014700030730     C     Uscita        BEGSR
014800030730
014900030730     C                   IF        Esito = *BLANK
015000030730     C                   EVAL      Esito = *OFF
015100030730     C                   ENDIF
015200030730
015300030730     C                   RETURN
015400030730
015500030730     C                   ENDSR
015600030730
015700030730**CTDATA VAL
015800030730ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
015900030730**CTDATA DIS
016000030730010005070913151719210204182011030608121416102225242301000507091315171921
016100030730**CTDATA PAR
016200030730000102030405060708091011121314151617181920212223242500010203040506070809
