000100130911      //---------------------------------------------------------------
000200131108      //?TRULORFR - Visualizza Orari di Filiale
000300130911      //---------------------------------------------------------------
000400130911     h decedit('0,') datedit(*ymd.) option(*nodebugio)
000500130911     h dftactgrp(*no) actgrp(*caller)
000600130911
000700130911      //---------------------------------------------------------------
000800130911      //?Dichiarazione file.
000900130911      //---------------------------------------------------------------
001000130911
001001131112     fazorg01l  if   e           k disk
001100130911       // -?File video
001200131108     fTRULORFD  cf   e             workstn
001300130911
001400130911      //---------------------------------------------------------------
001500130911      //?Definizione costanti.
001600130911      //---------------------------------------------------------------
001700130911
001800130911      //---------------------------------------------------------------
001900130911      //?Definizione schiere.
002000130911      //---------------------------------------------------------------
002100130911
002200130911      //---------------------------------------------------------------
002300130911      //?Definizione aree dati.
002400130911      //---------------------------------------------------------------
002500130911
002600130911      //---------------------------------------------------------------
002700130911      //?Definizione strutture dati.
002800130911      //---------------------------------------------------------------
002900130911
003000130911      // - Parametri ricevuti
003100130911     d KPJBA         e ds
003200131108     d TRULORFds     e ds
003201131112
003202131112     d og129         e ds
003203131112     d og130         e ds
003300130911
003600130911
003700130911      //---------------------------------------------------------------
003800130911      //?Definizione variabili globali.
003900130911      //---------------------------------------------------------------
004000130911
004001131112     d w0040           s              4  0
004002131112     d w0040a          s              4  0
004100130911      // - Flags booleani
004200130911     d wFine           s               n   inz(*off)
004400130925
005400130911
005500130911      //---------------------------------------------------------------
005600130911      //?Definizione procedure esterne.
005700130911      //---------------------------------------------------------------
005800130911
006300130911
006400130911      //---------------------------------------------------------------
006500130911      //?Definizione prototipi.
006600130911      //---------------------------------------------------------------
006700130911
006800130911      //---------------------------------------------------------------
006900130911      //?Definizione key-list.
007000130911      //---------------------------------------------------------------
007100130911
007200130911      //---------------------------------------------------------------
007300130911      //?Main.
007400130911      //---------------------------------------------------------------
007500130911
007600130911     c     *Entry        plist
007700130911     c                   parm                    KPJBA
007800131108     c                   parm                    trulorfds
007900130911
008000130911      /free
008100130911
008200130911       //?Operazioni iniziali
008300130911       exsr RoutInz;
008400130911
008500130911       //?Elaboro
008600130911       DOW  wFine = *off;
008700130911         exsr Elabora;
008800130911       ENDDO;
008900130911
009000130911       //?Operazioni finali
009100130911       exsr RoutEnd;
009200130911
009300130911       //--------------------------------------------------------------
009400130911       //?Operazioni iniziali.
009500130911       //--------------------------------------------------------------
009600130911       BEGSR RoutInz;
009700130911
009800131112         clear OORFerr;
009900131112         clear OORFmsg;
010100130911
010200130911       //?Se non ho la Linea di riferimento esco dal pgm con errore
010300131112         IF  IORFfil = *zeros;
010400131112           OORFerr = '1';
010500131112           OORFmsg = 'Manca la filiale di riferimento';
010600130911           wFine = *on;
010700130911           leavesr;
010800130911         ENDIF;
014100130912
014200131016       //?Se non ho riga posizionamento WIN imposto riga 13
014400131112         IF  IORFrig = *zeros ;
014500131113           IORFrig = 06;
014600130912         ENDIF;
015700131016       //?Se non ho colonna posizionamento WIN imposto colonna 2
015800131112         IF  IORFcol = *zeros;
015900131113           IORFcol = 28;
016000130912         ENDIF;
016100130925
016400130911
016500130911       ENDSR;
016600130911
016700130911       //--------------------------------------------------------------
016800130911       //?Elabora.
016900130911       //--------------------------------------------------------------
017000130911       BEGSR Elabora;
017100130911
017200130911         wFine = *on;
017300130911
017400131112         clear ULORFW01C;
017800131015
018800130912
018900131112         W1rig = IORFrig;
019000131112         W1col = IORFcol;
019100131016
019101131112         //  con la filiale ricevuta chaino azorg
019102131112         chain iorffil  azorg01l;
019103131112         if %founD(azorg01l) and (orgfag='F' or orgfag='A');
019104131112         // dati di filiale
019105131112            orfdes=orgdes;
019106131112            orfind=orgind;
019107131112            orfloc=%editc(orgcpf:'X') + ' ' + %trim(orgloc)
019108131112            + ' (' + orgpro + ')';
019109131112            og129=orgdc9;
019110131113            if §ogorfmd>*zeros;
019111131113               w0040=%int(§OGORFMd);
019112131113               w0040a=%int(§OGORFMa);
019113131113               orfore = %editW(w0040:'  :  ')  + ' - ' + %editw(w0040a:'  :  ');
019114131113            endif;
019115131113            if §OGORFpD>*zeros;
019116131113               w0040=%int(§OGORFpd);
019117131113               w0040a=%int(§OGORFpa);
019118131113               orfore = %trim(orfore ) + '  ' + %editW(w0040:'  :  ')
019119131113               + ' - ' + %editw(w0040a:'  :  ');
019120131113            endif;
019121131112         // dati servizio clienti
019122131112            orftel=orgtel;
019123131112            og130=orgdd0;
019124131113            if §OGORamD>*zeros;
019125131113               w0040=%int(§OGORaMd);
019126131113               w0040a=%int(§OGOraMa);
019127131113               orforesc=%editW(w0040:'  :  ')  + ' - ' + %editw(w0040a:'  :  ');
019128131113            endif;
019129131113            if §OGORapD>*zeros;
019130131113               w0040=%int(§OGORapd);
019131131113               w0040a=%int(§OGORapa);
019132131113               orforesc = %trim(orforesc) + '  ' + %editW(w0040:'  :  ')
019133131113               + ' - ' + %editw(w0040a:'  :  ');
019134131113            endif;
019135131113            orffax=orgfax;
019136131113            if orgdd2<>*blanks;
019137131113               orfmail=%trim(orgdd2) + '@brt.it'        ;
019138131113            endif;
019139131113            exfmt  ULORFW01C;
019140131112         else;
019141131113           OORFerr = '1';
019142131113           OORFmsg = 'Il Codice ricevuto non è di filiale';
019143131112         endif;
024900130925
032000130911       ENDSR;
032100130911
032200130911       //--------------------------------------------------------------
032300130911       //?Operazioni finali.
032400130911       //--------------------------------------------------------------
032500130911       BEGSR RoutEnd;
032600130911
032700130911         *inLR = *on;
032800130911         return;
032900130911
033000130911       ENDSR;
033100130911
033200130911      /end-free
