000100050527     ***********************************************************************************************
000200050527     **?
000300050527     **?Questo programma riceve una stringa e restituisce una stringa
000400050527     **?eliminando gli spazi a sinistra e gli spazi in eccesso tra ogni pezzo della stringa
000500050527     **?
000600050527     **?Esempi:
000700050527     **?
000800050527     **?-----------------------------------------
000900050527     **?|         i        | s |        o       |
001000050527     **?|------------------|---|----------------|
001100050527     **?|' danilo  cussini'| 0 |'danilocussini' |
001200050527     **?|' danilo  cussini'| 1 |'danilo cussini'|
001300050527     **?-----------------------------------------
001400050527     **?
001500050527     ***********************************************************************************************
001600050527     H DFTACTGRP(*NO) ACTGRP(*CALLER)
001700050527     ***********************************************************************************************
001800050527     **?
001900050527     **?Definizione parametri procedura.
002000050527     **?
002100050527     ***********************************************************************************************
002200050527     D trultrimc       PR
002300050527     D  a                          9999
002400050527     D  i                            10I 0
002500050527     D  a                          9999
002600050527     D  i                            10I 0
002700050527
002800050527     D trultrimc       PI
002900050527     D  i                          9999                                         Stringa di input
003000050527     D  s                            10I 0                                      Spazi da lasciare
003100050527     D  o                          9999                                         Stringa di output
003200050527     D  esito                        10I 0                                      Esito
003300050527
003400050527     ***********************************************************************************************
003500050527     **?
003600050527     **?Definizione variabili e schiere.
003700050527     **?
003800050527     ***********************************************************************************************
003900050527     D w               S          32767
004000050527     D l               S              5I 0
004100050527     D pw              S              5I 0
004200050527     D po              S              5I 0
004300050527
004400050527     ***********************************************************************************************
004500050527     **?
004600050527     **?Main.
004700050527     **?
004800050527     ***********************************************************************************************
004900050527     C                   EXSR      chkParm
005000050527     C                   EXSR      trimc
005100050527     C                   EXSR      uscita
005200050527
005300050527     ***********************************************************************************************
005400050527     **?
005500050527     **?Elimino gli spazi a sinistra e in mezzo.
005600050527     **?
005700050527     ***********************************************************************************************
005800050527     C     trimc         BEGSR
005900050527
006000050527     C                   EVAL      w = %TRIML(i)
006100050527     C                   EVAL      l = %LEN(%TRIMR(w))
006200050527     C                   RESET                   po
006300050527
006400050527     C                   DO        l             pw
006500050527     C                   IF        %SUBST(w:pw:s+1) = *BLANK
006600050527     C                   ITER
006700050527     C                   ENDIF
006800050527     C                   EVAL      po = po + 1
006900050527     C                   EVAL      %SUBST(o:po:1) = %SUBST(w:pw:1)
007000050527     C                   ENDDO
007100050527
007200050527     C                   ENDSR
007300050527
007400050527     ***********************************************************************************************
007500050527     **?
007600050527     **?Controllo parametri ricevuti.
007700050527     **?
007800050527     ***********************************************************************************************
007900050527     C     chkParm       BEGSR
008000050527
008100050527     C                   CLEAR                   o
008200050527     C                   CLEAR                   esito
008300050527
008400050527     C                   IF        i = *BLANK
008500050527     C                   EXSR      uscita
008600050527     C                   ENDIF
008700050527
008800050527     C                   IF        s < 0
008900050527     C                   CLEAR                   s
009000050527     C                   ENDIF
009100050527
009200050527     C                   ENDSR
009300050527
009400050527     ***********************************************************************************************
009500050527     **?
009600050527     **?Uscita.
009700050527     **?
009800050527     ***********************************************************************************************
009900050527     C     uscita        BEGSR
010000050527
010100050527     C                   RETURN
010200050527
010300050527     C                   ENDSR
