000100000414
000200000414     H DECEDIT('0,') DATEDIT(*DMY.)
000300000414
000400001120     D*-----------------
000500001120     D* VARIABILI DI WRK
000600001120     D*-----------------
000700010912     D WrkEml          S            253
000800010912     D WrkOgg          S             44
000900010912     D WrkMsg          S           5000
001000010912     D WMsg            S           5000    VARYING
001100010912     D lenWrk          S              5  0
001200010912     D strCMD          S           6000
001300010912     D lenCMD          S             15  5 INZ(6000)
001400001120
001500010912     D*------------
001600010912     D* SHIERE COMANDI
001700010912     D*------------
001800010912     D CMD             S             80    DIM(4) CTDATA PERRCD(1)
001900001120
002000000411
002100000414     C*------------------------------------------------------------------------*
002200000414     C* MAIN LINE
002300000414     C*------------------------------------------------------------------------*
002400000414     C*
002500010912     C                   EVAL      WMsg = %trim(WrkMsg)
002600010912     C                   EVAL      %len(WMsg) = %len(%trim(WrkMsg))
002700010912     C                   EVAL      lenWrk = %len(%trim(WrkMsg))
002800010912     C*
002900010912     C                   EVAL      strCMD = %trim(CMD(1))               +' '  +
003000010912     C                                      %trim(CMD(2))+ ''''               +
003100010912     C                                      %trim(WrkEML)+ ''''         +')) '+
003200010912     C                                      %trim(CMD(3))+ ''''               +
003300010912     C                                      %trim(WrkOgg)+ ''''         +') ' +
003400010912     C                                      %trim(CMD(4))+ ''''               +
003500010912     C                                      %trim(WMsg)  + ''''         +')'
003600010912     C*
003700010912     C* Eseguo comando
003800010912     C                   CALL      'QCMDEXC'
003900010912     C                   PARM                    strCMD
004000010912     C                   PARM                    lenCMD
004100001120     C*
004200001120     C                   SETON                                        LR
004300001120
004400001120
004500000414     C*------------------------------------------------------------------------*
004600000414     C* *INZSR - OPERAZIONI INIZIALI
004700000414     C*------------------------------------------------------------------------*
004800000414     C     *INZSR        BEGSR
004900001120     C*
005000000414     C*--------------------
005100000414     C* RICEVIMENTO PARAMETRI
005200000414     C*--------------------
005300000414     C     *ENTRY        PLIST
005400010912     C                   PARM                    WrkEml
005500010912     C                   PARM                    WrkOgg
005600010912     C                   PARM                    WrkMsg
005700001120     C*
005800000414     C                   ENDSR
005900010912** CMD - COMANDI CL
006000010912SNDDST TYPE(*LMSG)
006100010912TOINTNET((
006200010912DSTD(
006300020522LONGMSG(
