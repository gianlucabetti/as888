000100100817       //==============================================================
000200100817       //?                                                             ?
000300100817       //?VISUALIZZAZIONE  INDICATORI UTILIZZATI DA UN PGM. RPG IV     ?
000400100817       //?                                                             ?
000500100817       //==============================================================
000600110218
000700110218       //--------------------------------------------------------------
000800110218       //?Parametri di compilazione (vedi *cmd UBCRTOBJ).              ?
000900110218       //--------------------------------------------------------------
001000110218
001100110218     /*CMD ovrdbf file(SOURCE) tofile(GAITRASRC/SRCTRUL) ovrscope(*calllvl)
001200110218     /*END dltovr file(SOURCE) lvl(*)
001300110218     /*END
001400110218
001500110218       //--------------------------------------------------------------
001600110218       //?Specifiche di controllo.                                     ?
001700110218       //--------------------------------------------------------------
001800100817
001900100817     h debug decedit('0,') datedit(*DMY/)
002000110218
002100110218       //--------------------------------------------------------------
002200110218       //?Dichiarazione file.                                          ?
002300110218       //--------------------------------------------------------------
002400110218
002500110218       // -?Sorgente?
002600110218     fSOURCE    if   f   92        disk
002700100817
002800110218       // -?Video?
002900100817     fUBONOFFD  cf   e             workstn
003000110218
003100110218       //--------------------------------------------------------------
003200110218       //?Definizione costanti.                                        ?
003300110218       //--------------------------------------------------------------
003400110218
003500110218       // -?Attributi di Visualizzazione?
003600110218     d c_DspAtrNorm    c                   const(x'A0')
003700110218     d c_DspAtr_HI_RI  c                   const(x'A3')
003800110218     d c_DspAtr_ND     c                   const(x'A7')
003900110218     d c_DspAtrRed_RI  c                   const(x'A9')
004000110218
004100110218       // -?Costante x CHECK numerico di un campo alfa?
004200110218     d c_Digits        c                   const('0123456789')
004300110218
004400110218       //--------------------------------------------------------------
004500110218       //?Definizione schiere.                                         ?
004600110218       //--------------------------------------------------------------
004700100817
004800110218       // -?Indicatorei in spedifiche "I" del sorgente?
004900100817     d $I              s              2    dim(5)
005000110218       // -?Indicatorei in spedifiche "C" del sorgente?
005100100817     d $C              s              2    dim(6)
005200110218     d SK              s              6    dim(3)
005300110218       // -?Indicatorei in spedifiche "O" del sorgente?
005400100817     d $O              s              2    dim(3)
005500110218
005600110218       // -?Elenco completo indicatori usati?
005700100817     d SavInd          s              1    dim(99)
005800110218
005900110218       //--------------------------------------------------------------
006000110218       //?Definizione aree dati.                                       ?
006100110218       //--------------------------------------------------------------
006200110218
006300110218
006400110218       //--------------------------------------------------------------
006500110218       //?Definizione strutture dati.                                  ?
006600110218       //--------------------------------------------------------------
006700110218
006800100817     d dsIN            ds             2    inz
006900100817     d  dsIN1                  1      1    inz
007000100817     d  dsIN2                  2      2    inz
007100110218
007200110218       //--------------------------------------------------------------
007300110218       //?Definizione variabili globali.                               ?
007400110218       //--------------------------------------------------------------
007500110218
007600110218       // -?Flags booleani?
007700110218     d $All            s               n   inz(*off)
007800110218
007900110218       // -?Indici di schiera?
008000100817     d xx              s              1  0 inz
008100100817     d wIN             s              2  0 inz
008200110218
008300110218       //--------------------------------------------------------------
008400110218       //?Definizione prototipi procedure.                             ?
008500110218       //--------------------------------------------------------------
008600110218
008700110218
008800110218       //--------------------------------------------------------------
008900110218       //?Definizione key-list.                                        ?
009000110218       //--------------------------------------------------------------
009100110218
009200110218
009300110218       //--------------------------------------------------------------
009400110218       //?Specifiche di input.                                         ?
009500110218       //--------------------------------------------------------------
009600100817
009700110218       // -?Membro Sorgente?
009800100817     iSOURCE    nn
009900100817     i                                 13   14  EOF
010000100817     i                                 18   18  SPEC
010100100817     i                                 19   19  CHAR
010200110218       //   ·?Specifiche "I"?
010300100817     i                                 31   32  $I(1)
010400100817     i                                 75   76  $I(2)
010500100817     i                                 81   82  $I(3)
010600100817     i                                 83   84  $I(4)
010700100817     i                                 85   86  $I(5)
010800110218       //   ·?Specifiche "C"?
010900100817     i                                 22   23  $C(1)
011000100817     i                                 25   26  $C(2)
011100100817     i                                 28   29  $C(3)
011200100817     i                                 66   67  $C(4)
011300100817     i                                 68   69  $C(5)
011400100817     i                                 70   71  $C(6)
011500100817     i                                 30   35  SK(1)
011600100817     i                                 45   50  SK(2)
011700100817     i                                 55   60  SK(3)
011800110218       //   ·?Specifiche "O"?
011900100817     i                                 36   37  $O(1)
012000100817     i                                 39   40  $O(2)
012100100817     i                                 42   43  $O(3)
012200110218
012300110218       //--------------------------------------------------------------
012400110218       //?M A I N - L I N E                                            ?
012500110218       //--------------------------------------------------------------
012600100817
012700100817     c     *Entry        plist
012800100817     c                   parm                    £Lib             10
012900100817     c                   parm                    £SrcF            10
013000100817     c                   parm                    £Mbr             10
013100100817     c                   parm                    £Type            10
013200100817      /free
013300100817
013400100817       *inLR = *on;
013500100817
013600110218       // -?Ciclo di lettura specifiche nel membro sorgente?
013700100817       DoU  %eof(Source);
013800100817
013900100817         read  Source;
014000100817
014100100817         if  %eof(SOURCE)
014200100817             or  EoF   = '**';
014300100817           leave;
014400100817         endif;
014500100817
014600110218         // -?Record "particolari"?
014700100817         if  Spec = '/'   or
014800100817             Char = '/'   or
014900100817             Char = '+'   or
015000100817             Char = '*';
015100100817           iter;
015200100817         endif;
015300100817
015400100817         select;
015500110218           // -?Specifica "I"?
015600100817           when  Spec = 'I'   or   Spec = 'i';
015700100817             exsr  sr_I;
015800110218           // -?Specifica "C"?
015900100817           when  Spec = 'C'   or   Spec = 'c';
016000100817             exsr  sr_C;
016100110218           // -?Specifica "O"?
016200100817           when  Spec = 'O'   or   Spec = 'o';
016300100817             exsr  sr_O;
016400100817         endsl;
016500100817
016600100817       EndDo;
016700100817
016800110218       // -?Emissione window?
016900100817       W1typ = £Type + ':';
017000100817       W1pgm = £Mbr;
017100100817       W1lib = £Lib;
017200100817       W1fil = £SrcF;
017300100817       *in   = SavInd;
017400110218       if  $All;
017500110218         DAxAll = c_DspAtr_HI_RI;
017600110218       else;
017700110218         DAxAll = c_DspAtr_ND;
017800110218       endif;
017900100817       exfmt  OnOffW1;
018000100817
018100100817       //--------------------------------------------------------------
018200100817       //?TEST X INDICATORI SPECFICHE DI INPUT                         ?
018300100817       //--------------------------------------------------------------
018400100817       BEGSR  sr_I;
018500100817
018600100817         For  xx = 1  To  3;
018700100817
018800100817           if  %check( c_Digits : $I(xx) ) = *zero;
018900100817             wIN = %int( $I(xx) );
019000100817             if  wIN > *zero;
019100100817               SavInd(wIN) = *on;
019200100817             endif;
019300100817           endif;
019400100817
019500100817         EndFor;
019600100817
019700100817       ENDSR;
019800100817
019900100817       //--------------------------------------------------------------
020000100817       //?TEST X INDICATORI SPECFICHE DI CALCOLO                       ?
020100100817       //--------------------------------------------------------------
020200100817       BEGSR  sr_C;
020300100817
020400100817         exsr  sr_C1;
020500100817         exsr  sr_C2;
020600100817
020700100817       ENDSR;
020800100817
020900100817       //--------------------------------------------------------------
021000100817       //?Specifiche "C": 'nn' a sinistra (3) e a destra (3)           ?
021100100817       //--------------------------------------------------------------
021200100817       BEGSR  sr_C1;
021300100817
021400100817         For  xx = 1  To  6;
021500100817
021600100817           if  %check( c_Digits : $C(xx) ) = *zero;
021700100817             wIN = %int( $C(xx) );
021800100817             if  wIN > *zero;
021900100817               SavInd(wIN) = *on;
022000100817             endif;
022100100817           endif;
022200100817
022300100817         EndFor;
022400100817
022500100817       ENDSR;
022600100817
022700100817       //--------------------------------------------------------------
022800100817       //?Specifiche "C": '*INnn' in fatt.1/2 o risultato              ?
022900100817       //--------------------------------------------------------------
023000100817       BEGSR  sr_C2;
023100100817
023200100817         For  xx = 1  To  3;
023300100817
023400100817           if  %subst( SK(xx) : 1 : 3 ) = '*IN';
023500100817
023600110218             select;
023700110218
023800110218               when  %subst( SK(xx) : 4 : 1 ) = *blank;
023900110218                 $All = *on;
024000110218                 iter;
024100100817
024200110218               when  %subst( SK(xx) : 4 : 1 ) = ',';
024300110218                 dsIN = %subst( SK(xx) : 5 : 2 );
024400110218
024500110218               other;
024600110218                 dsIN = %subst( SK(xx) : 4 : 2 );
024700110218
024800110218             endsl;
024900100817
025000100817             if  dsIN2 = *blank;
025100100817               dsIN2 = dsIN1;
025200100817               dsIN1 = *zero;
025300100817             endif;
025400100817
025500100817             if  %check( c_Digits : dsIN ) = *zero;
025600100817               wIN = %int( dsIN );
025700100817               if  wIN > *zero;
025800100817                 SavInd(wIN) = *on;
025900100817                 leavesr;
026000100817               endif;
026100100817             endif;
026200100817
026300100817           endif;
026400100817
026500100817         EndFor;
026600100817
026700100817       ENDSR;
026800100817
026900100817       //--------------------------------------------------------------
027000100817       //?TEST X INDICATORI SPECFICHE DI OUTPUT                        ?
027100100817       //--------------------------------------------------------------
027200100817       BEGSR  sr_O;
027300100817
027400100817         For  xx = 1  To  3;
027500100817
027600100817           if  $O(xx) <> '1P';
027700100817
027800100817             if  %check( c_Digits : $O(xx) ) = *zero;
027900100817               wIN = %int( $O(xx) );
028000100817               if  wIN > *zero;
028100100817                 SavInd(wIN) = *on;
028200100817               endif;
028300100817             endif;
028400100817
028500100817           endif;
028600100817
028700100817         EndFor;
028800100817
028900100817       ENDSR;
029000100817
029100100817      /end-free
