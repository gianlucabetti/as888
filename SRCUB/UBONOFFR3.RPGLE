000100100817       //==============================================================
000200100817       //?                                                             ?
000300100817       //?VISUALIZZAZIONE  INDICATORI UTILIZZATI IN UN DSPF O PRTF     ?
000400100817       //?                                                             ?
000500100817       //==============================================================
000600110218
000700110218       //--------------------------------------------------------------
000800110218       //?Parametri di compilazione (vedi *cmd UBCRTOBJ).              ?
000900110218       //--------------------------------------------------------------
001000110218
001100110218     /*CMD ovrdbf file(SOURCE) tofile(GAITRASRC/SRCTRUL) ovrscope(*calllvl)
001200110218     /*END dltovr file(SOURCE) lvl(*)
001300110218     /*END
001400110218
001500110218       //--------------------------------------------------------------
001600110218       //?Specifiche di controllo.                                     ?
001700110218       //--------------------------------------------------------------
001800100817
001900100817     h debug decedit('0,') datedit(*DMY/)
002000100817
002100110218       //--------------------------------------------------------------
002200110218       //?Dichiarazione file.                                          ?
002300110218       //--------------------------------------------------------------
002400110218
002500110218       // -?Sorgente?
002600110218     fSOURCE    if   f   92        disk
002700110218
002800110218       // -?Video?
002900100817     fUBONOFFD  cf   e             workstn
003000100817     f                                     infds(DSfmt)
003100110218
003200110218       //--------------------------------------------------------------
003300110218       //?Definizione costanti.                                        ?
003400110218       //--------------------------------------------------------------
003500110218
003600110218       // -?Attributi di Visualizzazione?
003700110218     d c_DspAtrNorm    c                   const(x'A0')
003800110218     d c_DspAtr_HI_RI  c                   const(x'A3')
003900110218     d c_DspAtr_ND     c                   const(x'A7')
004000110218     d c_DspAtrRed_RI  c                   const(x'A9')
004100110218
004200110218       // -?Costante x CHECK numerico di un campo alfa?
004300110218     d c_Digits        c                   const('0123456789')
004400110218
004500110218       // -?Tasti funzionali a video?
004600110218     d c_F01           c                   const(x'31')
004700110218     d c_F02           c                   const(x'32')
004800110218     d c_F03           c                   const(x'33')
004900110218     d c_F04           c                   const(x'34')
005000110218     d c_F05           c                   const(x'35')
005100110218     d c_F06           c                   const(x'36')
005200110218     d c_F07           c                   const(x'37')
005300110218     d c_F08           c                   const(x'38')
005400110218     d c_F09           c                   const(x'39')
005500110218     d c_F10           c                   const(x'3A')
005600110218     d c_F11           c                   const(x'3B')
005700110218     d c_F12           c                   const(x'3C')
005800110218     d c_F13           c                   const(x'B1')
005900110218     d c_F14           c                   const(x'B2')
006000110218     d c_F15           c                   const(x'B3')
006100110218     d c_F16           c                   const(x'B4')
006200110218     d c_F17           c                   const(x'B5')
006300110218     d c_F18           c                   const(x'B6')
006400110218     d c_F19           c                   const(x'B7')
006500110218     d c_F20           c                   const(x'B8')
006600110218     d c_F21           c                   const(x'B9')
006700110218     d c_F22           c                   const(x'BA')
006800110218     d c_F23           c                   const(x'BB')
006900110218     d c_F24           c                   const(x'BC')
007000110218     d c_Enter         c                   const(x'F1')
007100110218     d c_RolDwn        c                   const(x'F4')
007200110218     d c_RolUp         c                   const(x'F5')
007300110218
007400110218       // -?Attributi di visualizzazione?
007500110218     d c_B0            c                   const(x'20')
007600110218     d c_B1            c                   const(x'21')
007700110218     d c_B2            c                   const(x'22')
007800110218     d c_B3            c                   const(x'23')
007900110218     d c_B4            c                   const(x'24')
008000110218     d c_B5            c                   const(x'25')
008100110218     d c_B6            c                   const(x'26')
008200110218     d c_B7            c                   const(x'27')
008300110218     d c_B8            c                   const(x'28')
008400110218     d c_B9            c                   const(x'29')
008500110218     d c_BA            c                   const(x'2A')
008600110218     d c_BB            c                   const(x'2B')
008700110218     d c_BC            c                   const(x'2C')
008800110218     d c_BD            c                   const(x'2D')
008900110218     d c_BE            c                   const(x'2E')
009000110218     d c_BF            c                   const(x'2F')
009100110218
009200110218     d c_C0            c                   const(x'30')
009300110218     d c_C1            c                   const(x'31')
009400110218     d c_C2            c                   const(x'32')
009500110218     d c_C3            c                   const(x'33')
009600110218     d c_C4            c                   const(x'34')
009700110218     d c_C5            c                   const(x'35')
009800110218     d c_C6            c                   const(x'36')
009900110218     d c_C7            c                   const(x'37')
010000110218     d c_C8            c                   const(x'38')
010100110218     d c_C9            c                   const(x'39')
010200110218     d c_CA            c                   const(x'3A')
010300110218     d c_CB            c                   const(x'3B')
010400110218     d c_CC            c                   const(x'3C')
010500110218     d c_CD            c                   const(x'3D')
010600110218     d c_CE            c                   const(x'3E')
010700110218     d c_CF            c                   const(x'3F')
010800110218
010900110218       //--------------------------------------------------------------
011000110218       //?Definizione schiere.                                         ?
011100110218       //--------------------------------------------------------------
011200110218
011300110218     d $A              s              2    dim(3)
011400110218     d SavInd          s              1    dim(99) inz(*off)
011500110218     d $DA             s              1    dim(24) inz(c_C8)
011600110218
011700110218       //--------------------------------------------------------------
011800110218       //?Definizione aree dati.                                       ?
011900110218       //--------------------------------------------------------------
012000110218
012100110218
012200110218       //--------------------------------------------------------------
012300110218       //?Definizione strutture dati.                                  ?
012400110218       //--------------------------------------------------------------
012500100817
012600100817     d DSfmt           ds           512
012700100817     d  $Tasto               369    369
012800110218
012900110218       //--------------------------------------------------------------
013000110218       //?Definizione variabili globali.                               ?
013100110218       //--------------------------------------------------------------
013200110218
013300110218       // -?Indici di schiera?
013400100817     d xx              s              1  0 inz
013500100817     d wIN             s              2  0 inz
013600110218
013700110218       //--------------------------------------------------------------
013800110218       //?Specifiche di input.                                         ?
013900110218       //--------------------------------------------------------------
014000100817
014100110218       // -?Membro Sorgente?
014200100817     iSOURCE    nn
014300100817     i                                 18   18  Spec
014400100817     i                                 19   19  Char
014500110218       //   ·?Specifiche "A"?
014600100817     i                                 21   22  $A(1)
014700100817     i                                 24   25  $A(2)
014800100817     i                                 27   28  $A(3)
014900100817     i                                 57   58  CFCA
015000100817     i                                 59   60  TF
015100100817     i                                 57   69  DROPFOLD
015200110218
015300110218       //--------------------------------------------------------------
015400110218       //?M A I N - L I N E                                            ?
015500110218       //--------------------------------------------------------------
015600100817
015700100817     c     *Entry        plist
015800100817     c                   parm                    £Lib             10
015900100817     c                   parm                    £SrcF            10
016000100817     c                   parm                    £Mbr             10
016100100817     c                   parm                    £Type            10
016200100817      /free
016300100817
016400100817       *inLR = *on;
016500100817
016600110218       // -?Ciclo di lettura specifiche nel membro sorgente?
016700100817       DoU  %eof(Source);
016800100817
016900100817         read  Source;
017000100817
017100100817         if  %eof(SOURCE);
017200100817           leave;
017300100817         endif;
017400100817
017500110218         // -?Record "particolari"?
017600100817         if  Spec = '/'   or
017700100817             Char = '/'   or
017800100817             Char = '*';
017900100817           iter;
018000100817         endif;
018100100817
018200110218         // -?Specifica "A"?
018300100817         exsr  sr_A;
018400100817
018500100817       EndDo;
018600100817
018700110218       // -?Emissione window?
018800100817       W1typ = £Type + ':';
018900100817       W1pgm = £Mbr;
019000100817       W1lib = £Lib;
019100100817       W1fil = £SrcF;
019200100817       *in   = SavInd;
019300110218       DAxAll = c_DspAtr_ND;
019400100817
019500100817       if  £Type = 'DSPF      ';
019600100817         DA01 = $DA(01);
019700100817         DA02 = $DA(02);
019800100817         DA03 = $DA(03);
019900100817         DA04 = $DA(04);
020000100817         DA05 = $DA(05);
020100100817         DA06 = $DA(06);
020200100817         DA07 = $DA(07);
020300100817         DA08 = $DA(08);
020400100817         DA09 = $DA(09);
020500100817         DA10 = $DA(10);
020600100817         DA11 = $DA(11);
020700100817         DA12 = $DA(12);
020800100817         DA13 = $DA(13);
020900100817         DA14 = $DA(14);
021000100817         DA15 = $DA(15);
021100100817         DA16 = $DA(16);
021200100817         DA17 = $DA(17);
021300100817         DA18 = $DA(18);
021400100817         DA19 = $DA(19);
021500100817         DA20 = $DA(20);
021600100817         DA21 = $DA(21);
021700100817         DA22 = $DA(22);
021800100817         DA23 = $DA(23);
021900100817         DA24 = $DA(24);
022000100817       endif;
022100100817
022200100817       DoU  $Tasto = c_F12   or   $Tasto = c_Enter;
022300100817         if  £Type = 'DSPF      ';
022400100817           F24d  = 'F24=Tasti Funzionali';
022500100817         endif;
022600100817         exfmt  OnOffW1;
022700100817         if  £Type = 'DSPF      '   and   $Tasto = c_F24;
022800100817           F24d  = 'F24=Indicatori';
022900100817           exfmt  OnOffW2;
023000100817         endif;
023100100817       EndDo;
023200100817
023300100817       //--------------------------------------------------------------
023400100817       //?Controllo specifiche "A"                                     ?
023500100817       //--------------------------------------------------------------
023600100817       BEGSR  sr_A;
023700100817
023800100817         For  xx = 1  To  3;
023900100817
024000100817           if  %check( c_Digits : $A(xx) ) = *zero;
024100100817             wIN = %int( $A(xx) );
024200100817             if  wIN > *zero;
024300100817               SavInd(wIN) = *on;
024400100817             endif;
024500100817           endif;
024600100817
024700100817         EndFor;
024800100817
024900100817         select;
025000100817
025100100817           when  £Type <> 'DSPF      ';
025200100817
025300100817           when  CFCA = 'CF'   or   CFCA = 'CA';
025400100817             if  %check( c_Digits : TF ) = *zero;
025500100817               wIN = %int( TF );
025600100817               if  wIN > *zero;
025700100817                 $DA(wIN) = c_C3;
025800100817               endif;
025900100817             endif;
026000100817
026100100817           when  %subst(DROPFOLD : 1 : 9 ) = 'SFLDROP(C'   or
026200100817                 %subst(DROPFOLD : 1 : 9 ) = 'SFLFOLD(C';
026300100817             if  %check( c_Digits : %subst( DROPFOLD : 11 : 2 ) ) = *zero;
026400100817               wIN = %int( %subst( DROPFOLD : 11 : 2 ) );
026500100817               if  wIN > *zero;
026600100817                 $DA(wIN) = c_C3;
026700100817               endif;
026800100817             endif;
026900100817
027000100817         EndSl;
027100100817
027200100817       ENDSR;
027300100817
027400100817      /end-free
