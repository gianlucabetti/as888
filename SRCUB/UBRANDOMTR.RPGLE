000100111201     /*END
000200111201       //==============================================================
000300111201       //?TEST - Generatore di numeri casuali da <x> a <y>             ?
000400111201       //==============================================================
000500111201
000600111201     h decedit('0,') datedit(*dmy/) option(*nodebugio)
000700111201     h dftactgrp(*no) bnddir('UBBNDDIR')
000800111201
000900111201       //--------------------------------------------------------------
001000111201       //?Dichiarazione file.                                          ?
001100111201       //--------------------------------------------------------------
001200111201
001300111201       // -?Video?
001400111201     fUBRANDOMTDcf   e             workstn
001500111201     f                                     indds(IndDspF)
001600111201     f                                     infds(InfDspF)
001700111201
001800111201       //--------------------------------------------------------------
001900111201       //?Definizione costanti.                                        ?
002000111201       //--------------------------------------------------------------
002100111201
002200111201       // -?Tasti funzionali a video?
002300111201     d c_F01           c                   const(x'31')
002400111201     d c_F02           c                   const(x'32')
002500111201     d c_F03           c                   const(x'33')
002600111201     d c_F04           c                   const(x'34')
002700111201     d c_F05           c                   const(x'35')
002800111201     d c_F06           c                   const(x'36')
002900111201     d c_F07           c                   const(x'37')
003000111201     d c_F08           c                   const(x'38')
003100111201     d c_F09           c                   const(x'39')
003200111201     d c_F10           c                   const(x'3A')
003300111201     d c_F11           c                   const(x'3B')
003400111201     d c_F12           c                   const(x'3C')
003500111201     d c_F13           c                   const(x'B1')
003600111201     d c_F14           c                   const(x'B2')
003700111201     d c_F15           c                   const(x'B3')
003800111201     d c_F16           c                   const(x'B4')
003900111201     d c_F17           c                   const(x'B5')
004000111201     d c_F18           c                   const(x'B6')
004100111201     d c_F19           c                   const(x'B7')
004200111201     d c_F20           c                   const(x'B8')
004300111201     d c_F21           c                   const(x'B9')
004400111201     d c_F22           c                   const(x'BA')
004500111201     d c_F23           c                   const(x'BB')
004600111201     d c_F24           c                   const(x'BC')
004700111201     d c_Enter         c                   const(x'F1')
004800111201     d c_RollDown      c                   const(x'F4')
004900111201     d c_RollUp        c                   const(x'F5')
005000111201
005100111201       //--------------------------------------------------------------
005200111201       //?Definizione schiere.                                         ?
005300111201       //--------------------------------------------------------------
005400111201
005500111201
005600111201       //--------------------------------------------------------------
005700111201       //?Definizione aree dati.                                       ?
005800111201       //--------------------------------------------------------------
005900111201
006000111201       // -?Dati utente?
006100111201     d §AzUte        e ds                  extname(AZUTE00F)
006200111201     d                                     dtaara
006300111201     d §DatiUte      e ds                  extname(dDatiUte)
006400111201     d                                     dtaara
006500111201
006600111201       //--------------------------------------------------------------
006700111201       //?Definizione strutture dati.                                  ?
006800111201       //--------------------------------------------------------------
006900111201
007000111201       // -?Status ds?
007100111201     d Status         sds
007200111201     d  SDSpgm           *proc
007300111201     d  SDSprm           *parms
007400111201     d  SDSusr               254    263
007500111201
007600111201       // -?InfDS?
007700111201     d InfDspF         ds
007800111201     d  dsp_aid              369    369a
007900111201
008000111201       // -?Indicatori su DspF?
008100111201     d IndDspF         ds
008200111201        // -?Abilitazione tasti funzionali?
008300111201     d  AbilitF06                     1n   overlay(IndDspF : 06)
008400111201     d  AbilitF12                     1n   overlay(IndDspF : 12)
008500111201        // -?Indicatori di errore?
008600111201     d  ErrMessage                    1n   overlay(IndDspF : 28)
008700111201     d  ErrGenerico                   1n   overlay(IndDspF : 99)
008800111201
008900111201       // -?Parametri x Controllo profilo utenti?
009000111201     d TIBS34ds      e ds
009100111201
009200111201
009300111201       //--------------------------------------------------------------
009400111201       //?Definizione variabili globali.                               ?
009500111201       //--------------------------------------------------------------
009600111201
009700111201       // -?Flags booleani?
009800111201     d $Fine           s               n   inz(*off)
009900111201     d $InzD01         s               n   inz(*on)
010000111201     d $InzD02         s               n   inz(*on)
010100111201
010200111201       // -?Campi per la gestione del video?
010300111201     d $Video          s              2a   inz('D1')
010400111201
010500111201       //--------------------------------------------------------------
010600111201       //?Definizione prototipi procedure usate.                       ?
010700111201       //--------------------------------------------------------------
010800111201
010900111201       // -?Reperimento dati utente?
011000111201     d tibs34r         pr                  extpgm('TIBS34R')
011100111201     d   tibs34ds                          likeds(TIBS34ds)
011200111201
011300111201       // -?Generatore di numeri casuali da <x> a <y>?
011400111201      /copy gaitrasrc/srcProtoPi,ubRandom
011500111201      /copy gaitrasrc/srcProtoPr,ubRandom
011600111201
011700111201       //--------------------------------------------------------------
011800111201       //?Definizione key-list.                                        ?
011900111201       //--------------------------------------------------------------
012000111201
012100111201
012200111201       //--------------------------------------------------------------
012300111201       //?Riepilogo indicatori.                                        ?
012400111201       //--------------------------------------------------------------
012500111201
012600111201
012700111201       //--------------------------------------------------------------
012800111201       //?M A I N - L I N E                                            ?
012900111201       //--------------------------------------------------------------
013000111201
013100111201      /free
013200111201
013300111201       // -?Start?
013400111201       *inLR = *on;
013500111201
013600111201       // -?Elab?
013700111201       dow  $Fine = *off;
013800111201         select;
013900111201           when  $Video = 'D1';
014000111201             exsr  sr_GesD01;
014100111201           when  $Video = 'D2';
014200111201             exsr  sr_GesD02;
014300111201           other;
014400111201             $Fine = *on;
014500111201         endsl;
014600111201       enddo;
014700111201
014800111201       // -?End?
014900111201       return;
015000111201
015100111201       //--------------------------------------------------------------
015200111201       //?Operazioni iniziali                                          ?
015300111201       //--------------------------------------------------------------
015400111201       BEGSR  *InzSR;
015500111201
015600111201         // -?Reperimento dati utente?
015700111201         exsr  sr_DatiJob;
015800111201
015900111201         // -?Impostazione nome programma in testata a video?
016000111201         //VTDpgm = SDSpgm;
016100111201
016200111201       ENDSR;
016300111201
016400111201       //--------------------------------------------------------------
016500111201       //?Reperimento Dati del job (Utente/Operativi).                 ?
016600111201       //--------------------------------------------------------------
016700111201       BEGSR  sr_DatiJob;
016800111201
016900111201         in(E) §AzUte;
017000111201         if NOT %error;
017100111201           in(E)  §DatiUte;
017200111201         endif;
017300111201         if %error or RSut = *blanks;
017400111201           clear  TIBS34ds;
017500111201           tibs34r(tibs34ds);
017600111201           in §AzUte;
017700111201           in §DatiUte;
017800111201         endif;
017900111201
018000111201       ENDSR;
018100111201
018200111201       //--------------------------------------------------------------
018300111201       //?Gestione videata D01                                         ?
018400111201       //--------------------------------------------------------------
018500111201       BEGSR  sr_GesD01;
018600111201
018700111201         // -?Inizializzazione videata?
018800111201         if  $InzD01 = *on;
018900111201           clear  ubRANd1;
019000111201           $InzD01 = *off;
019100111201         endif;
019200111201         AbilitF06 = *on;
019300111201         AbilitF12 = *off;
019400111201
019500111201         // -?Emissione videata?
019600111201         if  ErrMessage = *off;
019700111201           write  ubRANt1;
019800111201           write  ubRANz1;
019900111201         endif;
020000111201
020100111201         exfmt  ubRANd1;
020200111201
020300111201         reset  ErrMessage;
020400111201         reset  ErrGenerico;
020500111201         clear  V1Dmsg;
020600111201
020700111201         SELECT;
020800111201
020900111201           // -?F3=Fine?
021000111201           WHEN  dsp_aid = c_F03;
021100111201             $Fine = *on;
021200111201
021300111201           // -?Invio o F6=Conferma?
021400111201           OTHER;
021500111201             exsr  sr_CtrD01;
021600111201             select;
021700111201               // -?rilevato errore?
021800111201               when  ErrGenerico = *on;
021900111201               // -?non premuto F6?
022000111201               when  dsp_aid <> c_F06;
022100111201               // -?premuto F6 ?
022200111201               other;
022300111201                 $Video = 'D2';
022400111201                 reset  $InzD02;
022500111201             endsl;
022600111201
022700111201         ENDSL;
022800111201
022900111201       ENDSR;
023000111201
023100111201       //--------------------------------------------------------------
023200111201       //?Controllo dati in videata D01                                ?
023300111201       //--------------------------------------------------------------
023400111201       BEGSR sr_CtrD01;
023500111201
023600111201         %subst(IndDspF : 28) = *off;
023700111201
023800111201       ENDSR;
023900111201
024000111201       //--------------------------------------------------------------
024100111201       //?Gestione videata D02                                         ?
024200111201       //--------------------------------------------------------------
024300111201       BEGSR  sr_GesD02;
024400111201
024500111201         // -?Inizializzazione videata?
024600111201         if  $InzD02 = *on;
024700111201           clear ubRANd2;
024800111201           exsr  Call_UbRANDOM;
024900111201           $InzD02  = *off;
025000111201           AbilitF06  = *off;
025100111201           AbilitF12  = *on;
025200111201         endif;
025300111201
025400111201         // -?Emissione videata?
025500111201         if  ErrMessage = *off;
025600111201           write  ubRANt1;
025700111201           write  ubRANz1;
025800111201           write  ubRANd1;
025900111201           write  Protect;
026000111201         endif;
026100111201
026200111201         exfmt  ubRANd2;
026300111201
026400111201         reset  ErrMessage;
026500111201         reset  ErrGenerico;
026600111201         clear  V1Dmsg;
026700111201
026800111201         SELECT;
026900111201
027000111201           // -?F3=Fine?
027100111201           WHEN  dsp_aid = c_F03;
027200111201             $Fine = *on;
027300111201
027400111201           // -?F12=Ritorno?
027500111201           WHEN  dsp_aid = c_F12;
027600111201             $Video = 'D1';
027700111201             //reset $InzD01;
027800111201             reset $InzD02;
027900111201
028000111201           // -?Invio?
028100111201           OTHER;
028200111201
028300111201         ENDSL;
028400111201
028500111201       ENDSR;
028600111201
028700111201       //--------------------------------------------------------------
028800111201       //?Richiamo Service Program UB§3EWUPD                           ?
028900111201       //--------------------------------------------------------------
029000111201       BEGSR Call_UbRANDOM;
029100111201
029200111201         pInValDa = V1NvalDa;
029300111201         pInValA  = V1NvalA;
029400111201         clear  pOutRandom;
029500111201
029600111201         UbRANDOM_Retrieve ( pInValDa : pInValA : pOutRandom );
029700111201
029800111201         V2Nrand = pOutRandom;
029900111201
030000111201       ENDSR;
030100111201
030200111201      /end-free
