000100091228       //==============================================================
000200140724       // Driver reperimento note
000300091228       //==============================================================
000400091228
000500091228       //--------------------------------------------------------------
000600121106       // Parametri di compilazione (vedi *cmd UBCRTOBJ).              ?
000700091228       //--------------------------------------------------------------
000800091228
000900100325     /*PRM dbgview(*source)
001000091223     /*END
001100091228
001200091228       //--------------------------------------------------------------
001300121106       // Specifiche di controllo.
001400091228       //--------------------------------------------------------------
001500091223
001600091223     h decedit('0,') datedit(*dmy/) option(*nodebugio)
001700100325     h dftactgrp(*no)
001800091223     h alwnull(*inputonly)
001900091223
002000091223       //--------------------------------------------------------------
002100121106       // Dichiarazione file.
002200091223       //--------------------------------------------------------------
002300100112
002400140724     FTFNTC01L  IF   E           K DISK
002500091223
002600091223       //--------------------------------------------------------------
002700121106       // Definizione costanti.
002800091223       //--------------------------------------------------------------
002900100302
003000091223
003100091223       //--------------------------------------------------------------
003200121106       // Definizione schiere.
003300091223       //--------------------------------------------------------------
003400091223
003500091223
003600091223       //--------------------------------------------------------------
003700121106       // Definizione aree dati.
003800091223       //--------------------------------------------------------------
003900091223
004000091223
004100140724       //--------------------------------------------------------------
004200140724       // Definizione strutture dati.
004300140724       //--------------------------------------------------------------
004400140724
004500121106       // - Status
004600110516     d Psds           sds
004700110516     d   SDSpgm          *proc
004800121106     d   JobName             244    253                                         Job name
004900121106     d   JobUser             254    263                                         User name
005000121106     d   JobNumber           264    269s 0                                      Job number
005100091223
005200091223       //--------------------------------------------------------------
005300121106       // Definizione variabili.
005400091223       //--------------------------------------------------------------
005500091223
005600121106       // - Parametri ricevuti:
005700140724     d pIn_Opz         s              1a
005800140724     d pIn_APL         s              1a
005900140724     d pIn_NK1         s             11a
006000140724     d pIn_NK2         s              4a
006100140724     d pIn_TNT         s              2a
006200140724     d pOut_RNT        s             60a
006300140724     d pOut_NTR        s              6s 0
006400140724     d pOut_Esito      s              1a
006500121106
006600121106       // Campi di comodo
006700121106     d wDate           s              8  0 inz
006800091223
006900091223       //--------------------------------------------------------------
007000121106       // Definizione prototipi procedure.
007100091223       //--------------------------------------------------------------
007200130307
007300091223       //--------------------------------------------------------------
007400121106       // Definizione key-list.
007500091223       //--------------------------------------------------------------
007600091223
007700140724       // - File TFNTC00F
007800140724     d k04tfntc00    e ds                  extname(TFNTC01L : *key)
007900140724     d                                     prefix(k_)   inz
008000091223
008100091223       //--------------------------------------------------------------
008200121107       // Definizione parametri procedura.
008300091223       //--------------------------------------------------------------
008400091223
008500091223     c     *Entry        plist
008600140724     c                   parm                    pIn_Opz
008700140724     c                   parm                    pIn_APL
008800140724     c                   parm                    pIn_NK1
008900140724     c                   parm                    pIn_NK2
009000140724     c                   parm                    pIn_TNT
009100140724     c                   parm                    pOut_RNT
009200140724     c                   parm                    pOut_NTR
009300140724     c                   parm                    pOut_Esito
009400091223
009500130307      /free
009600091223
009700091223       //--------------------------------------------------------------
009800121106       // M A I N - L I N E
009900091223       //--------------------------------------------------------------
010000130307
010100140806       // Inizializzazione esito di procedura
010200140806       pOut_Esito = '0';
010300140806
010400130307       // Operazioni iniziali?
010500130307       exsr sr_RoutInz;
010600130307
010700140724       // attività richiesta dal chiamante se non chiamato per chiusura
010800140724       if pIn_opz = *blank;
010900140724         K_ntcapl = pIn_APL;
011000140724         K_ntcnk1 = pIn_NK1;
011100140724         K_ntcnk2 = pIn_NK2;
011200140724         K_ntctnt = pIn_TNT;
011300140724         chain %kds(K04tfntc00) Tfntc01l ;
011400140724         If  %found(tfntc01l);
011500140724           pOut_RNT = NTCRNT;
011600140724           pOut_NTR = NTCNTR;
011700140724           pOut_Esito = '1';
011800140724         endif;
011900140724       endif;
012000091223
012100121106       // Operazioni finali?
012200091223       exsr sr_RoutEnd;
012300091223
012400091223       //--------------------------------------------------------------
012500121107       // Operazioni iniziali.
012600091223       //--------------------------------------------------------------
012700091223       BEGSR  sr_RoutInz;
012800121108
012900121108         // Reperimento data odierna (fmt aaaa/mm/gg)
013000121108         wDate = %dec( %date() );
013100140724
013200140724         // Se applicazione non passata, impongo 'C'
013300140724         if pIn_APL = *blank;
013400140724           pIn_APL = 'C';
013500140724         endif;
013600091223
013700091223       ENDSR;
013800121106
013900091223       //--------------------------------------------------------------
014000121107       // Operazioni finali.
014100091223       //--------------------------------------------------------------
014200091223       BEGSR  sr_RoutEnd;
014300140724
014400140724         // Chiusura pgm
014500140806         if pIn_Opz = 'C';
014600140724           *inlr = *on;
014700140724         else;
014800140724           *inrt = *on;
014900140724         endif;
015000140724         return;
015100091223
015200091223       ENDSR;
015300091223
015400091223      /end-free
