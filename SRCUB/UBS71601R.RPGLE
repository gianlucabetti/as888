000100170530     H DFTACTGRP(*NO) ACTGRP(*CALLER)
000200170428
000300170428
000400170428      //********************************************************************************************
000500170428      //
000600170428      // Definizione file.
000700170428      //
000800170428      //********************************************************************************************
000900170530     Ftivav01i  IF   E           K DISK
001000170523
001100170428
001200170428      //********************************************************************************************
001300170428      //
001400170428      // Definizione interfacce procedure.
001500170428      //
001600170428      //********************************************************************************************
001700170530     D/COPY GAITRASRC/SRCPROTOPI,UBS716TIS
001800170428
001900170428
002000170428      //********************************************************************************************
002100170428      //
002200170428      // Definizione variabili.
002300170428      //
002400170428      //********************************************************************************************
002500170530     D wKeySrvVAS      S             10    inz('VASWS')
002600170523
002700091027
002800091027
002900080620      //********************************************************************************************
003000080620      //
003100080620      // Definizione parametri procedura.
003200080620      //
003300080620      //********************************************************************************************
003400080620     C     *ENTRY        PLIST
003500170530     C                   PARM                    iS716DSVAB
003600170530     C                   PARM                    iS716TIS
003700170530     C                   PARM                    oS716FOUND
003800170530     C                   PARM                    oS716DTA
003900170523     C*
004000170428     C* Avvio il monitoring del intero flusso
004100170428     C                   monitor
004200170523     C*
004300170523     C* Inizializo l'esito a "errore" e clear dei dati
004400170530     C                   eval      oS716FOUND = -1
004500170530     C                   clear                   oS716DTA
004600170530     C*
004700170530     C* Sviluppo la maschera "Tipo ID Spedizione"
004800170602     C                   exsr      rtvMask
004900090810     C*
005000170530     C* Cerco se per la spedizione corrente già "reperiti segnacolli"
005100170530     C                   eval      VAVKEY1 = wKeySrvVAS
005200170602     C                   eval      VAVKEY2 = %editc(s716_CCM:'X')+'-'+
005300170602     C                                       %editc(s716_NRS:'X')
005400170530     C                   eval      VAVKEY3 = wMaskTIS
005500170530     C     KEYvav01_C    chain     tivav01i
005600170530     C                   if        %found(tivav01i)
005700170523     C*
005800170523     C* Se trovato valorizzo esito a "trovato"
005900170530     C                   eval      oS716FOUND = 1
006000170530     C                   eval      oS716DTA   = vavDTA
006100170523     C                   else
006200170523     C*
006300170523     C* Diversamente ... a "non trovato"
006400170530     C                   eval      oS716FOUND = 0
006500170523     C                   endif
006600170428     C*
006700170428     C* Gestisco eventuale errore
006800170428     C                   on-error
006900170523     C
007000170530     C                   eval      oS716FOUND = -1
007100170530     C                   clear                   oS716DTA
007200170428     C                   dump(A)
007300170428     C*
007400170428     C* Arresto il monitoring
007500170428     C                   endmon
007600090810     C*
007700090810     C                   return
007800170602
007900170602
008000170602
008100170602     C     rtvMask       BEGSR
008200170602     C*
008300170602     C/COPY GAITRASRC/SRCUB,UBS716TIS
008400170602     C*
008500170602     C                   ENDSR
008600170428
008700170428
008800170428
008900170428      /TITLE Inizializzazioni
009000170428     C     *inzSR        BEGSR
009100170428     C*
009200170428     C* Definizione chiavi di lettura
009300170530     C     KEYvav01_C    klist
009400170530     C                   kfld                    VAVKEY1
009500170530     C                   kfld                    VAVKEY2
009600170530     C                   kfld                    VAVKEY3
009700170428     C*
009800170428     C                   ENDSR
009900100330     C*--------------------------------------------------------------------
010000100330
