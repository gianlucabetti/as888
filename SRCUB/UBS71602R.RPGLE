000100170530     H DFTACTGRP(*NO) ACTGRP(*CALLER)
000200170428
000300170428
000400170428      //********************************************************************************************
000500170428      //
000600170428      // Definizione file.
000700170428      //
000800170428      //********************************************************************************************
000900170530     Ftivav01i  O    E           K DISK
001000170523
001100170428
001200170428      //********************************************************************************************
001300170428      //
001400170428      // Definizione interfacce procedure.
001500170428      //
001600170428      //********************************************************************************************
001700170530     D/COPY GAITRASRC/SRCPROTOPI,UBS716TIS
001800170428
001900170428
002000170428      //********************************************************************************************
002100170428      //
002200170428      // Definizione variabili.
002300170428      //
002400170428      //********************************************************************************************
002500170530     D wKeySrvVAS      S             10    inz('VASWS')
002600170530     D UBS716DS      e ds                  inz qualified
002700170530
002800091027
002900080620      //********************************************************************************************
003000080620      //
003100080620      // Definizione parametri procedura.
003200080620      //
003300080620      //********************************************************************************************
003400080620     C     *ENTRY        PLIST
003500170530     C                   PARM                    iS716DSVAB
003600170530     C                   PARM                    iS716TIS
003700170530     C                   PARM                    oS716ESI
003800170523     C*
003900170428     C* Avvio il monitoring del intero flusso
004000170428     C                   monitor
004100170523     C*
004200170523     C* Inizializo l'esito a "errore" e clear dei dati
004300170530     C                   eval      oS716ESI = -1
004400170530     C*
004500170530     C* Sviluppo la maschera "Tipo ID Spedizione"
004600170602     C                   exsr      rtvMask
004700090810     C*
004800170530     C* Inserisco l'ID Spedizione della spedizione corrente secondo il Tipo ID indicato in input
004900170530     C                   clear                   tivav000
005000170530     C                   eval      VAVKEY1 = wKeySrvVAS
005100170602     C                   eval      VAVKEY2 = %editc(s716_CCM:'X')+'-'+
005200170602     C                                       %editc(s716_NRS:'X')
005300170530     C                   eval      VAVKEY3 = wMaskTIS
005400170530     C                   eval      VAVMOM  = %timestamp(*SYS)
005500170530     C                   clear                   UBS716DS
005600170530     C                   eval      UBS716DS.S716FLS = s716_LNP
005700170530     C                   eval      UBS716DS.S716NRS = s716_NRS
005800170530     C                   eval      UBS716DS.S716NCD = s716_NCD
005900170530     C                   eval      UBS716DS.S716NCA = s716_NCA
006000170530     C                   eval      VAVDTA  = UBS716DS
006100170530     C                   write     tivav000
006200170523     C*
006300170530     C* Se arrivato sin qui => tutto OK
006400170530     C                   eval      oS716ESI = 0
006500170428     C*
006600170428     C* Gestisco eventuale errore
006700170428     C                   on-error
006800170523     C
006900170530     C                   eval      oS716ESI = -1
007000170428     C                   dump(A)
007100170428     C*
007200170428     C* Arresto il monitoring
007300170428     C                   endmon
007400090810     C*
007500090810     C                   return
007600170602
007700170602
007800170602
007900170602     C     rtvMask       BEGSR
008000170602     C*
008100170602     C/COPY GAITRASRC/SRCUB,UBS716TIS
008200170602     C*
008300170602     C                   ENDSR
008400170428
008500170428
008600170428
008700170428      /TITLE Inizializzazioni
008800170428     C     *inzSR        BEGSR
008900170428     C*
009000170428     C*
009100170428     C                   ENDSR
009200100330     C*--------------------------------------------------------------------
009300100330
