000001000000      /IF NOT DEFINED(PROTOTYPE_UBTL05R)
000002000000      *======================================================================
000003000000      *  Generated by WSDL2RPG 1.16.0beta / 07.04.2014
000004000000      *  Built on Set 17, 2014 (11:54:57)
000005000000      *  Built for V7R1M0
000006000000      *  Based on WS_SRV 1.16.0beta4 - 07.04.2014
000007000000      *======================================================================
000008000000      *
000009000000      *   This source member contains the common procedures
000010000000      *   of web service port:
000011000000      *
000012000000      *      TLAddressFinderWSClassSoap
000013000000      *
000014000000      *======================================================================
000015000000      *   Pre-Compiler tags used by STRPREPRC to retrieve creation
000016000000      *   commands from the source member.
000017000000      * ---------------------------------------------------------------------
000018000000      * >>PRE-COMPILER<<
000019000000      *   >>CRTCMD<< CRTRPGMOD    MODULE(&LI/&OB) +
000020000000      *                           SRCFILE(&SL/&SF) +
000021000000      *                           SRCMBR(&SM);
000022000000      *   >>COMPILE<<
000023000000      *     >>PARM<< TRUNCNBR(*NO);
000024000000      *     >>PARM<< DBGVIEW(*LIST);
000025000000      *     >>PARM<< OPTION(*EVENTF);
000026000000      *   >>END-COMPILE<<
000027000000      *   >>EXECUTE<<
000028000000      *   >>CMD<<    CRTSRVPGM +
000029000000      *              SRVPGM(&LI/&OB ) +
000030000000      *              MODULE(&LI/&OB   +
000031000000      *                     &LI/UBTL05R01        +
000032000000      *                             ) +
000033000000      *              EXPORT(*ALL) +
000034000000      *              BNDSRVPGM(*LIBL/WSDL2RPGRT  +
000035000000      *                        *LIBL/MIME        +
000036000000      *                        *LIBL/HTTPMIME    +
000037000000      *                        *LIBL/BASICS1   ) +
000038000000      *              TEXT('+
000039000000      *              Web Service: TLAddressFinderWSClassSoap+
000040000000      *              ') +
000041000000      *              DETAIL(*BASIC);
000042000000      * >>END-PRE-COMPILER<<
000043000000      *======================================================================
000044000000     H NOMAIN
000045000000     H DEBUG
000046000000     H BNDDIR('HTTPAPI': 'QC2LE')
000047000000     H OPTION(*SRCSTMT : *NODEBUGIO)
000048000000     H EXTBININT(*YES)
000049000000      /ENDIF
000050000000      /IF NOT DEFINED(PROTOTYPE_DEFINED_UBTL05R)
000051000000      /DEFINE PROTOTYPE_DEFINED_UBTL05R
000052000000      *
000053000000      *   Type definitions
000054000000 CPY  /COPY QWSDL2RPG,TYPES_H
000055000000      *
000056000000      *   Imported prototypes
000057000000 CPY  /COPY QWSDL2RPG,PWSDL2R82                    WSDL2RPG: Dynamic Array
000058000000 CPY  /COPY QWSDL2RPG,PWSDL2R84                    WSDL2RPG: MemoryManager
000059000000 CPY  /COPY QWSDL2RPG,PWSDL2R85                    WSDL2RPG: MessageContext
000060000000 CPY  /COPY QWSDL2RPG,PWSDL2R88                    WSDL2RPG: Public Helper Procedures
000061000000 CPY  /COPY QWSDL2RPG,PWSDL2R90                    WSDL2RPG: AppMsg
000062000000      *
000063000000      *   Array dimensions:
000064000000      *
000065000000      *   Web Service specific types:
000066000000      *
000067000000     D tns_NormalizeOne_t...
000068000000     D                 DS                  template
000069000000     D                                     qualified
000070000000     D  Xml                        2048A   varying
000071000000      *
000072000000      *
000073000000     D tns_NormalizeOneResponse_t...
000074000000     D                 DS                  template
000075000000     D                                     qualified
000076000000     D  NormalizeOneResult...
000077000000     D                             2048A   varying
000078000000      *
000079000000      *   Public prototypes
000080000000      *
000081000000      *   Web service: Returns the endpoint of the Web service
000082000000     D TLAddressFinderWSClassSoap_Endpoint_get...
000083000000     D                 PR         32767A          varying
000084000000     D                                     extproc('+
000085000000     D                                     TLAddressFinderWSClassSoap+
000086000000     D                                     _Endpoint_get+
000087000000     D                                     ')
000088000000      *
000089000000      *   Web service: Sets the endpoint of the Web service
000090000000     D TLAddressFinderWSClassSoap_Endpoint_set...
000091000000     D                 PR
000092000000     D                                     extproc('+
000093000000     D                                     TLAddressFinderWSClassSoap+
000094000000     D                                     _Endpoint_set+
000095000000     D                                     ')
000096000000     D  i_url                     32767A   const varying  options(*varsize)
000097000000      *
000098000000      *   Web service: Returns the host name of the Web Service endpoint
000099000000     D TLAddressFinderWSClassSoap_Endpoint_getHost...
000100000000     D                 PR         32767A          varying
000101000000     D                                     extproc('+
000102000000     D                                     TLAddressFinderWSClassSoap+
000103000000     D                                     _Endpoint_getHost+
000104000000     D                                     ')
000105000000      *
000106000000      *   Web service: Sets the host name of the Web service endpoint
000107000000     D TLAddressFinderWSClassSoap_Endpoint_setHost...
000108000000     D                 PR
000109000000     D                                     extproc('+
000110000000     D                                     TLAddressFinderWSClassSoap+
000111000000     D                                     _Endpoint_setHost+
000112000000     D                                     ')
000113000000     D  i_url                     32767A   const varying  options(*varsize)
000114000000      *
000115000000      *   Web service: Returns the port of the Web Service endpoint
000116000000     D TLAddressFinderWSClassSoap_Endpoint_getPort...
000117000000     D                 PR            10I 0
000118000000     D                                     extproc('+
000119000000     D                                     TLAddressFinderWSClassSoap+
000120000000     D                                     _Endpoint_getPort+
000121000000     D                                     ')
000122000000      *
000123000000      *   Web service: Sets the port of the Web service endpoint
000124000000     D TLAddressFinderWSClassSoap_Endpoint_setPort...
000125000000     D                 PR
000126000000     D                                     extproc('+
000127000000     D                                     TLAddressFinderWSClassSoap+
000128000000     D                                     _Endpoint_setPort+
000129000000     D                                     ')
000130000000     D  i_port                       10I 0 const
000131000000      *
000132000000      *   Web service: Initializes the web services port
000133000000     D TLAddressFinderWSClassSoap_Port_initialize...
000134000000     D                 PR
000135000000     D                                     extproc('+
000136000000     D                                     TLAddressFinderWSClassSoap+
000137000000     D                                     _Port_initialize+
000138000000     D                                     ')
000139000000     D  i_operName                         const  like(wsdl_operName_t )
000140000000      *
000141000000      *   Web service: Sets the proxy server to use for the connection
000142000000     D TLAddressFinderWSClassSoap_Port_setHttpProxy...
000143000000     D                 PR
000144000000     D                                     extproc('+
000145000000     D                                     TLAddressFinderWSClassSoap+
000146000000     D                                     _Port_setHttpProxy+
000147000000     D                                     ')
000148000000     D  i_server                    256A   const
000149000000     D  i_port                       10I 0 const
000150000000      *
000151000000      *   Web service: Returns the proxy server to use for the connection
000152000000     D TLAddressFinderWSClassSoap_Port_getHttpProxy...
000153000000     D                 PR                         likeds(wsdl_proxy_t )
000154000000     D                                     extproc('+
000155000000     D                                     TLAddressFinderWSClassSoap+
000156000000     D                                     _Port_getHttpProxy+
000157000000     D                                     ')
000158000000      *
000159000000      *   Web service: Enables/disables the debug log of HTTP API
000160000000     D TLAddressFinderWSClassSoap_Port_setHttpDebug...
000161000000     D                 PR
000162000000     D                                     extproc('+
000163000000     D                                     TLAddressFinderWSClassSoap+
000164000000     D                                     _Port_setHttpDebug+
000165000000     D                                     ')
000166000000     D   i_status                      N   const
000167000000     D   i_fileName                 500A   const  varying  options(*nopass)
000168000000     D   i_verbose                     N   const  options(*nopass)
000169000000      *
000170000000      *   Web service: Returns the HTTP API debug settings
000171000000     D TLAddressFinderWSClassSoap_Port_getHttpDebug...
000172000000     D                 PR                         likeds(wsdl_httpDebug_t )
000173000000     D                                     extproc('+
000174000000     D                                     TLAddressFinderWSClassSoap+
000175000000     D                                     _Port_getHttpDebug+
000176000000     D                                     ')
000177000000      *
000178000000      *   Web service: Sets the CCSID used for POST data.
000179000000     D TLAddressFinderWSClassSoap_Port_setPostCcsid...
000180000000     D                 PR
000181000000     D                                     extproc('+
000182000000     D                                     TLAddressFinderWSClassSoap+
000183000000     D                                     _Port_setPostCcsid+
000184000000     D                                     ')
000185000000     D  i_post_ccsid                 10I 0 const
000186000000      *
000187000000      *   Web service: Returns the CCSID used for POST data.
000188000000     D TLAddressFinderWSClassSoap_Port_getPostCcsid...
000189000000     D                 PR            10I 0
000190000000     D                                     extproc('+
000191000000     D                                     TLAddressFinderWSClassSoap+
000192000000     D                                     _Port_getPostCcsid+
000193000000     D                                     ')
000194000000      *
000195000000      *   Web service: Sets the timeout that HTTPAPI uses
000196000000      *   when connecting to the server or waiting for response.
000197000000     D TLAddressFinderWSClassSoap_Port_setTimeout...
000198000000     D                 PR
000199000000     D                                     extproc('+
000200000000     D                                     TLAddressFinderWSClassSoap+
000201000000     D                                     _Port_setTimeout+
000202000000     D                                     ')
000203000000     D  i_timeout                    10I 0 const
000204000000      *
000205000000      *   Web service: Returns the timeout that HTTPAPI uses
000206000000      *   when connecting to the server or waiting for response.
000207000000     D TLAddressFinderWSClassSoap_Port_getTimeout...
000208000000     D                 PR            10I 0
000209000000     D                                     extproc('+
000210000000     D                                     TLAddressFinderWSClassSoap+
000211000000     D                                     _Port_getTimeout+
000212000000     D                                     ')
000213000000      *
000214000000      *   Web service: Sets the user-agent that HTTPAPI uses
000215000000      *   to identify the client at the server.
000216000000     D TLAddressFinderWSClassSoap_Port_setUserAgent...
000217000000     D                 PR
000218000000     D                                     extproc('+
000219000000     D                                     TLAddressFinderWSClassSoap+
000220000000     D                                     _Port_setUserAgent+
000221000000     D                                     ')
000222000000     D  i_userAgent                        const  like(wsdl_userAgent_t )
000223000000      *
000224000000      *   Web service: Returns the user-agent that HTTPAPI uses
000225000000      *   to identify the client at the server.
000226000000     D TLAddressFinderWSClassSoap_Port_getUserAgent...
000227000000     D                 PR                         like(wsdl_userAgent_t )
000228000000     D                                     extproc('+
000229000000     D                                     TLAddressFinderWSClassSoap+
000230000000     D                                     _Port_getUserAgent+
000231000000     D                                     ')
000232000000      *
000233000000      *   Web service: Clears all error information
000234000000     D TLAddressFinderWSClassSoap_Port_clearErrors...
000235000000     D                 PR
000236000000     D                                     extproc('+
000237000000     D                                     TLAddressFinderWSClassSoap+
000238000000     D                                     _Port_clearErrors+
000239000000     D                                     ')
000240000000     D  io_errors                                 likeds(wsdl_errors_t )
000241000000      *
000242000000      *   Web service: Sets error information
000243000000     D TLAddressFinderWSClassSoap_Port_setErrors...
000244000000     D                 PR
000245000000     D                                     extproc('+
000246000000     D                                     TLAddressFinderWSClassSoap+
000247000000     D                                     _Port_setErrors+
000248000000     D                                     ')
000249000000     D  i_errors                           const  likeds(wsdl_errors_t )
000250000000      *
000251000000      *   Http: Returns cTrue in case of an error, else cFalse.
000252000000     D TLAddressFinderWSClassSoap_Port_isError...
000253000000     D                 PR              N
000254000000     D                                     extproc('+
000255000000     D                                     TLAddressFinderWSClassSoap+
000256000000     D                                     _Port_isError+
000257000000     D                                     ')
000258000000      *
000259000000      *   Http: Returns the last HTTP error (code) that occurred.
000260000000     D TLAddressFinderWSClassSoap_HttpError_getCode...
000261000000     D                 PR                  like(wsdl_http_ErrorNo_t  )
000262000000     D                                     extproc('+
000263000000     D                                     TLAddressFinderWSClassSoap+
000264000000     D                                     _HttpError_getCode+
000265000000     D                                     ')
000266000000      *
000267000000      *   Http: Returns the last HTTP error (text) that occurred.
000268000000     D TLAddressFinderWSClassSoap_HttpError_getText...
000269000000     D                 PR                  like(wsdl_http_ErrorText_t)
000270000000     D                                     extproc('+
000271000000     D                                     TLAddressFinderWSClassSoap+
000272000000     D                                     _HttpError_getText+
000273000000     D                                     ')
000274000000      *
000275000000      *   Soap: Returns the last SOAP error (code) that occurred.
000276000000     D TLAddressFinderWSClassSoap_SoapError_getCode...
000277000000     D                 PR                  like(wsdl_soap_faultcode_t  )
000278000000     D                                     extproc('+
000279000000     D                                     TLAddressFinderWSClassSoap+
000280000000     D                                     _SoapError_getCode+
000281000000     D                                     ')
000282000000      *
000283000000      *   Soap: Returns the last SOAP error (text) that occurred.
000284000000     D TLAddressFinderWSClassSoap_SoapError_getText...
000285000000     D                 PR                  like(wsdl_soap_faultstring_t)
000286000000     D                                     extproc('+
000287000000     D                                     TLAddressFinderWSClassSoap+
000288000000     D                                     _SoapError_getText+
000289000000     D                                     ')
000290000000      *
000291000000      *   Soap: Returns the last XML error (code) that occurred.
000292000000     D TLAddressFinderWSClassSoap_XmlError_getCode...
000293000000     D                 PR                  like(wsdl_xml_errorNo_t    )
000294000000     D                                     extproc('+
000295000000     D                                     TLAddressFinderWSClassSoap+
000296000000     D                                     _XmlError_getCode+
000297000000     D                                     ')
000298000000      *
000299000000      *   Soap: Returns the last XML error (text) that occurred.
000300000000     D TLAddressFinderWSClassSoap_XmlError_getText...
000301000000     D                 PR                  like(wsdl_xml_ErrorText_t  )
000302000000     D                                     extproc('+
000303000000     D                                     TLAddressFinderWSClassSoap+
000304000000     D                                     _XmlError_getText+
000305000000     D                                     ')
000306000000      *
000307000000      *   Registers an user callback procedure, that is called whenever
000308000000      *   a web service requires user authentification.
000309000000     D TLAddressFinderWSClassSoap_Port_registerLoginCallback...
000310000000     D                 PR
000311000000     D                                     extproc('+
000312000000     D                                     TLAddressFinderWSClassSoap+
000313000000     D                                     _Port_registerLoginCallback+
000314000000     D                                     ')
000315000000     D  i_pLoginProc                   *   value  procptr
000316000000      *
000317000000      *   Returns *ON if a login procedures has been registered.
000318000000     D TLAddressFinderWSClassSoap_Port_hasLoginCallback...
000319000000     D                 PR              N
000320000000     D                                     extproc('+
000321000000     D                                     TLAddressFinderWSClassSoap+
000322000000     D                                     _Port_hasLoginCallback+
000323000000     D                                     ')
000324000000      *
000325000000      *   Login to proxy server or web service.
000326000000     D TLAddressFinderWSClassSoap_Port_login...
000327000000     D                 PR            10I 0
000328000000     D                                     extproc('+
000329000000     D                                     TLAddressFinderWSClassSoap+
000330000000     D                                     _Port_login+
000331000000     D                                     ')
000332000000     D  i_http_err                   10I 0 value
000333000000     D  i_numAttempts                10I 0 value
000334000000      *
000335000000      *   Returns the name of the web service port.
000336000000     D TLAddressFinderWSClassSoap_Port_getName...
000337000000     D                 PR           512A          varying
000338000000     D                                     extproc('+
000339000000     D                                     TLAddressFinderWSClassSoap+
000340000000     D                                     _Port_getName+
000341000000     D                                     ')
000342000000      *
000343000000      *   Returns the UUID of the web service port.
000344000000     D TLAddressFinderWSClassSoap_Port_getUuid...
000345000000     D                 PR                         like(wsdl_uuid_t )
000346000000     D                                     extproc('+
000347000000     D                                     TLAddressFinderWSClassSoap+
000348000000     D                                     _Port_getUuid+
000349000000     D                                     ')
000350000000      *
000351000000      *   Adds an attachments to the list of attachments.
000352000000     D TLAddressFinderWSClassSoap_Attachments_put...
000353000000     D                 PR
000354000000     D                                     extproc('+
000355000000     D                                     TLAddressFinderWSClassSoap+
000356000000     D                                     _Attachments_put+
000357000000     D                                     ')
000358000000     D  i_attachmentID...
000359000000     D                                     const  like(wsdl_attachmentID_t )
000360000000     D  i_fileName                         const  like(wsdl_path_t         )
000361000000     D  i_uuid                             const  like(wsdl_uuid_t         )
000362000000     D                                            options(*nopass)
000363000000      *
000364000000      *   Returns the file name of the attachment that is associated to
000365000000      *   a given content ID.
000366000000     D TLAddressFinderWSClassSoap_Attachments_get...
000367000000     D                 PR                  like(wsdl_path_t     )
000368000000     D                                     extproc('+
000369000000     D                                     TLAddressFinderWSClassSoap+
000370000000     D                                     _Attachments_get+
000371000000     D                                     ')
000372000000     D  i_attachmentID...
000373000000     D                                     const  like(wsdl_attachmentID_t )
000374000000     D  i_uuid                             const  like(wsdl_uuid_t         )
000375000000     D                                            options(*nopass)
000376000000      *
000377000000      *   Returns the file name of the attachment that is associated to
000378000000      *   a given index.
000379000000     D TLAddressFinderWSClassSoap_Attachments_getAtPos...
000380000000     D                 PR                  likeds(wsdl_attachment_t )
000381000000     D                                     extproc('+
000382000000     D                                     TLAddressFinderWSClassSoap+
000383000000     D                                     _Attachments_getAtPos+
000384000000     D                                     ')
000385000000     D  i_index                      10I 0 const
000386000000     D  i_uuid                             const  like(wsdl_uuid_t         )
000387000000     D                                            options(*nopass)
000388000000      *
000389000000      *   Returns the number of attachments that were downloaded with the
000390000000      *   last call to the web service.
000391000000     D TLAddressFinderWSClassSoap_Attachments_getNumE...
000392000000     D                 PR            10I 0
000393000000     D                                     extproc('+
000394000000     D                                     TLAddressFinderWSClassSoap+
000395000000     D                                     _Attachments_getNumE+
000396000000     D                                     ')
000397000000     D  i_uuid                             const  like(wsdl_uuid_t         )
000398000000     D                                            options(*nopass)
000399000000      *
000400000000      *   Removes all attachments from the list of attachments of this web service.
000401000000     D TLAddressFinderWSClassSoap_Attachments_removeAll...
000402000000     D                 PR
000403000000     D                                     extproc('+
000404000000     D                                     TLAddressFinderWSClassSoap+
000405000000     D                                     _Attachments_removeAll+
000406000000     D                                     ')
000407000000     D  i_uuid                             const  like(wsdl_uuid_t         )
000408000000     D                                            options(*nopass)
000409000000      *
000410000000      *   Specifies the name of the folder where to put attachments in.
000411000000     D TLAddressFinderWSClassSoap_Attachments_setFolder...
000412000000     D                 PR
000413000000     D                                     extproc('+
000414000000     D                                     TLAddressFinderWSClassSoap+
000415000000     D                                     _Attachments_setFolder+
000416000000     D                                     ')
000417000000     D  i_folder                           const  like(wsdl_pathLong_t )
000418000000      *
000419000000      *   Returns the name of the folder where attachments are stored.
000420000000     D TLAddressFinderWSClassSoap_Attachments_getFolder...
000421000000     D                 PR                         like(wsdl_pathLong_t )
000422000000     D                                     extproc('+
000423000000     D                                     TLAddressFinderWSClassSoap+
000424000000     D                                     _Attachments_getFolder+
000425000000     D                                     ')
000426000000      *
000427000000      *   Initializes the memory manager.
000428000000     D TLAddressFinderWSClassSoap_initializeMemoryManager...
000429000000     D                 PR                         like(wsdl_uuid_t )
000430000000     D                                     extproc('+
000431000000     D                                     TLAddressFinderWSClassSoap+
000432000000     D                                     _initializeMemoryManager+
000433000000     D                                     ')
000434000000     D  i_uuid                             const  like(wsdl_uuid_t )
000435000000     D                                            options(*nopass: *omit)
000436000000      *
000437000000      *   Frees all allocated memory blocks of all dynamic List objects.
000438000000     D TLAddressFinderWSClassSoap_terminateMemoryManager...
000439000000     D                 PR
000440000000     D                                     extproc('+
000441000000     D                                     TLAddressFinderWSClassSoap+
000442000000     D                                     _terminateMemoryManager+
000443000000     D                                     ')
000444000000     D  i_uuid                             const  like(wsdl_uuid_t )
000445000000     D                                            options(*nopass: *omit)
000446000000      *
000447000000      *   Enables redirection of the HTTP response message to a
000448000000      *   stream file in the IFS.
000449000000     D TLAddressFinderWSClassSoap_RedirectResponse_toStmf...
000450000000     D                 PR
000451000000     D                                     extproc('+
000452000000     D                                     TLAddressFinderWSClassSoap+
000453000000     D                                     _RedirectResponse_toStmf+
000454000000     D                                     ')
000455000000     D  i_stmf                             const  like(wsdl_pathLong_t )
000456000000     D  i_replace                      N   const  options(*nopass: *omit)
000457000000     D  i_ccsid                      10I 0 const  options(*nopass: *omit)
000458000000     D  i_auth                       10I 0 const  options(*nopass: *omit)
000459000000      *
000460000000      *   Returns cTrue if response redirection is active, otherwise cFalse.
000461000000     D TLAddressFinderWSClassSoap_RedirectResponse_isActive...
000462000000     D                 PR              N
000463000000     D                                     extproc('+
000464000000     D                                     TLAddressFinderWSClassSoap+
000465000000     D                                     _RedirectResponse_isActive+
000466000000     D                                     ')
000467000000      *
000468000000      *   Terminates a response redirection and closes the
000469000000      *   file that receiced the response.
000470000000     D TLAddressFinderWSClassSoap_RedirectResponse_write...
000471000000     D                 PR              N
000472000000     D                                     extproc('+
000473000000     D                                     TLAddressFinderWSClassSoap+
000474000000     D                                     _RedirectResponse_write+
000475000000     D                                     ')
000476000000     D  i_data                         *   value
000477000000     D  i_length                     10I 0 value
000478000000      *
000479000000      *   Terminates a response redirection and closes the
000480000000      *   file that receiced the response.
000481000000     D TLAddressFinderWSClassSoap_RedirectResponse_terminate...
000482000000     D                 PR
000483000000     D                                     extproc('+
000484000000     D                                     TLAddressFinderWSClassSoap+
000485000000     D                                     _RedirectResponse_terminate+
000486000000     D                                     ')
000487000000      *
000488000000      * This procedure adds a file attachment. The attachment
000489000000      * is sent to the server the next time the web service is called.
000490000000     D TLAddressFinderWSClassSoap_Attachments_addFile...
000491000000     D                 PR                        like(wsdl_partID_t)
000492000000     D                                     extproc('+
000493000000     D                                     TLAddressFinderWSClassSoap+
000494000000     D                                     _Attachments_addFile+
000495000000     D                                     ')
000496000000     D  i_hMsgCtx                          const like(wsdl_hMsgCtx_t)
000497000000     D  i_path                             const like(wsdl_path_t)
000498000000     D  i_contentType                      const like(wsdl_contentType_t)
000499000000     D  i_transferEncoding...
000500000000     D                                     const like(
000501000000     D                                           wsdl_contentTransferEncoding_t)
000502000000     D                                           options(*nopass: *omit)
000503000000     D  i_suggestedFileName...
000504000000     D                                     const like(wsdl_path_t)
000505000000     D                                           options(*nopass: *omit)
000506000000      *
000507000000      * This procedure adds a buffer attachment. The attachment
000508000000      * is sent to the server the next time the web service is called.
000509000000     D TLAddressFinderWSClassSoap_Attachments_addBuffer...
000510000000     D                 PR                        like(wsdl_partID_t)
000511000000     D                                     extproc('+
000512000000     D                                     TLAddressFinderWSClassSoap+
000513000000     D                                     _Attachments_addBuffer+
000514000000     D                                     ')
000515000000     D  i_hMsgCtx                          const like(wsdl_hMsgCtx_t)
000516000000     D  i_name                             const like(wsdl_path_t)
000517000000     D  i_pBuffer                      *   const
000518000000     D  i_size                       10I 0 const
000519000000     D  i_contentType                      const like(wsdl_contentType_t)
000520000000     D  i_transferEncoding...
000521000000     D                                     const like(
000522000000     D                                           wsdl_contentTransferEncoding_t)
000523000000     D                                           options(*nopass: *omit)
000524000000     D  i_targetCcsid                10I 0 const options(*nopass: *omit)
000525000000      *
000526000000      /ENDIF
000527000000      /IF DEFINED(PROTOTYPE_UBTL05R)
000528000000      /EOF
000529000000      /ENDIF
000530000000      * ---------------------------------------------------------------------
000531000000      *
000532000000      * ------------------------------------
000533000000      *  Imported prototypes
000534000000      * ------------------------------------
000535000000 CPY  /COPY QBASICS1,PBASICS1                      Tools/400 Runtime Library
000536000000 CPY  /COPY QRPGLESRC,HTTPAPI_H                    HTTP-API Service Program
000537000000      *
000538000000 CPY  /COPY QWSDL2RPG,PWSDL2R71                    WSDL2RPG: HTTP Debug Log
000539000000 CPY  /COPY QWSDL2RPG,PWSDL2R89                    WSDL2RPG: List of Attachments
000540000000      *
000541000000      * ------------------------------------
000542000000      *  Internal prototypes
000543000000      * ------------------------------------
000544000000      *
000545000000     D getEndpoint...
000546000000     D                 PR         32767A          varying
000547000000     D                                     extproc('+
000548000000     D                                     getEndpoint+
000549000000     D                                     ')
000550000000      *
000551000000     D setEndpoint...
000552000000     D                 PR
000553000000     D                                     extproc('+
000554000000     D                                     setEndpoint+
000555000000     D                                     ')
000556000000     D  i_url                     32767A   const varying  options(*varsize)
000557000000      *
000558000000      * ------------------------------------
000559000000      *  Global fields & constants
000560000000      * ------------------------------------
000561000000      *
000562000000      *   Web service port name
000563000000     D cWEB_SERVICE_PORT_NAME...
000564000000     D                 C                   'TLAddressFinderWSClassSoap'
000565000000      *
000566000000      *   UUID of the web service as generated by WSDL2RPG
000567000000     D cWEB_SERVICE_UUID...
000568000000     D                 C                   '14C16C043EA119A695E80004AC18DC9A'
000569000000      *
000570000000      *   Default and current attachment folder
000571000000     D cATTACHMENT_FOLDER...
000572000000     D                 C                   '/tmp/attachments/'
000573000000      *
000574000000      *   Default POST data CCSID (1208 = UTF-8)
000575000000     D cPOST_DATA_CCSID...
000576000000     D                 C                   1208
000577000000      *
000578000000      *   Web service endpoint as specified in the WSDL file.
000579000000     D cURL            C                   'http://cedtellusbo3/tladdressfinder+
000580000000     D                                     ws/tladdressfinderws.asmx'
000581000000      *
000582000000      *   Web service endpoint
000583000000     D g_url           S          32767A   varying inz(cURL)
000584000000      *
000585000000      *   Proxy server to use
000586000000     D g_proxy         DS                  likeds(wsdl_proxy_t     ) inz
000587000000      *
000588000000      *   HTTPAPI debug settings
000589000000     D g_httpDebug     DS                  likeds(wsdl_httpDebug_t ) inz
000590000000      *
000591000000      *   POST data CCSID (1208 = UTF-8)
000592000000     D g_post_ccsid...
000593000000     D                 S             10I 0 inz(cPOST_DATA_CCSID)
000594000000      *
000595000000      *   Timeout in seconds used when connecting to the server
000596000000      *   or waiting for response from the server.
000597000000     D g_timeout...
000598000000     D                 S             10I 0 inz(HTTP_TIMEOUT)
000599000000      *
000600000000      *   User-agent used when connecting to the server.
000601000000     D g_userAgent...
000602000000     D                 S                   like(wsdl_userAgent_t )
000603000000     D                                     inz(HTTP_USERAGENT)
000604000000      *
000605000000      *   Name of the directory used to store attachments
000606000000     D g_attachmentFolder...
000607000000     D                 S                   like(wsdl_pathLong_t )
000608000000     D                                     inz(cATTACHMENT_FOLDER)
000609000000      *
000610000000      *   Redirect response status information
000611000000     D g_redirectResponse...
000612000000     D                 DS                  qualified
000613000000     D  isActive                       N   inz(cFalse)
000614000000     D  ccsid                        10I 0 inz
000615000000     D  auth                         10I 0 inz
000616000000     D  options                      10I 0 inz
000617000000     D  fd                           10I 0 inz(-1)
000618000000     D  path                               like(wsdl_pathLong_t ) inz
000619000000      *
000620000000      *   Web service error information
000621000000     D g_errors        DS                  likeds(wsdl_errors_t    ) inz
000622000000      *
000623000000      *   User callback to supply login information
000624000000      *   Returns WSDL_SUCCESS if successful, WSDL_ERROR upon error.
000625000000     D g_getLoginDataImpl...
000626000000     D                 S               *   procptr inz
000627000000      *
000628000000      *   User callback to supply login information
000629000000      *   Returns WSDL_SUCCESS if successful, WSDL_ERROR upon error.
000630000000      *
000631000000      *   Parameter description:
000632000000      *     i_authType         Authentication type:
000633000000      *                          WSDL_AUTH_TYPE_HTTP  - HTTP server.
000634000000      *                          WSDL_AUTH_TYPE_PROXY - Proxy server.
000635000000      *     i_realm            Authentication realm.
000636000000      *     i_numAttempts      Number of login attempts.
000637000000      *     o_user             UserName to use.
000638000000      *     o_password         Password to use.
000639000000      *
000640000000     D TLAddressFinderWSClassSoap_Port_supplyLoginData...
000641000000     D                 PR            10I 0
000642000000     D                                     extproc('+
000643000000     D                                     TLAddressFinderWSClassSoap+
000644000000     D                                     _Port_supplyLoginData+
000645000000     D                                     ')
000646000000     D  i_authType                   14A          const  varying
000647000000     D  i_realm                     126A          const  varying
000648000000     D  i_numAttempts                10I 0        const
000649000000     D  o_user                       50A                 varying
000650000000     D  o_password                   50A                 varying
000651000000      *
000652000000      * =====================================================================
000653000000      *   *** public ***
000654000000      *   Web service: Returns the endpoint of the Web service
000655000000      * =====================================================================
000656000000     P TLAddressFinderWSClassSoap_Endpoint_get...
000657000000     P                 B                   export
000658000000      *
000659000000     D TLAddressFinderWSClassSoap_Endpoint_get...
000660000000     D                 PI         32767A          varying
000661000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000662000000      /free
000663000000
000664000000         return getEndpoint();
000665000000
000666000000      /end-free
000667000000      *
000668000000     P TLAddressFinderWSClassSoap_Endpoint_get...
000669000000     P                 E
000670000000      *
000671000000      * =====================================================================
000672000000      *   *** public ***
000673000000      *   Web service: Sets the endpoint of the Web service
000674000000      * =====================================================================
000675000000     P TLAddressFinderWSClassSoap_Endpoint_set...
000676000000     P                 B                   export
000677000000      *
000678000000     D TLAddressFinderWSClassSoap_Endpoint_set...
000679000000     D                 PI
000680000000     D  i_url                     32767A   const varying  options(*varsize)
000681000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000682000000      /free
000683000000
000684000000         setEndpoint(%subst(i_url: 1: %len(i_url)));
000685000000
000686000000         return;
000687000000
000688000000      /end-free
000689000000      *
000690000000     P TLAddressFinderWSClassSoap_Endpoint_set...
000691000000     P                 E
000692000000      *
000693000000      * =====================================================================
000694000000      *   *** public ***
000695000000      *   Web service: Returns the host name of the Web Service endpoint
000696000000      * =====================================================================
000697000000     P TLAddressFinderWSClassSoap_Endpoint_getHost...
000698000000     P                 B                   export
000699000000      *
000700000000     D TLAddressFinderWSClassSoap_Endpoint_getHost...
000701000000     D                 PI         32767A          varying
000702000000      *
000703000000     D tmpUrl          S                   like(url_t ) inz
000704000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000705000000      /free
000706000000
000707000000         tmpUrl = URL_new(getEndpoint());
000708000000
000709000000         return URL_getHost(tmpUrl);
000710000000
000711000000      /end-free
000712000000      *
000713000000     P TLAddressFinderWSClassSoap_Endpoint_getHost...
000714000000     P                 E
000715000000      *
000716000000      * =====================================================================
000717000000      *   *** public ***
000718000000      *   Web service: Sets the host name of the Web service endpoint
000719000000      * =====================================================================
000720000000     P TLAddressFinderWSClassSoap_Endpoint_setHost...
000721000000     P                 B                   export
000722000000      *
000723000000     D TLAddressFinderWSClassSoap_Endpoint_setHost...
000724000000     D                 PI
000725000000     D  i_host                    32767A   const varying  options(*varsize)
000726000000      *
000727000000     D tmpUrl          S                   like(url_t ) inz
000728000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000729000000      /free
000730000000
000731000000         tmpUrl = URL_new(getEndpoint());
000732000000         URL_setHost(tmpUrl: %subst(i_host: 1: %len(i_host)));
000733000000         setEndpoint(URL_toString(tmpUrl));
000734000000
000735000000         return;
000736000000
000737000000      /end-free
000738000000      *
000739000000     P TLAddressFinderWSClassSoap_Endpoint_setHost...
000740000000     P                 E
000741000000      *
000742000000      * =====================================================================
000743000000      *   *** public ***
000744000000      *   Web service: Returns the port of the Web Service endpoint
000745000000      * =====================================================================
000746000000     P TLAddressFinderWSClassSoap_Endpoint_getPort...
000747000000     P                 B                   export
000748000000      *
000749000000     D TLAddressFinderWSClassSoap_Endpoint_getPort...
000750000000     D                 PI            10I 0
000751000000      *
000752000000     D tmpUrl          S                   like(url_t ) inz
000753000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000754000000      /free
000755000000
000756000000         tmpUrl = URL_new(getEndpoint());
000757000000
000758000000         return URL_getPort(tmpUrl);
000759000000
000760000000      /end-free
000761000000      *
000762000000     P TLAddressFinderWSClassSoap_Endpoint_getPort...
000763000000     P                 E
000764000000      *
000765000000      * =====================================================================
000766000000      *   *** public ***
000767000000      *   Web service: Sets the port of the Web service endpoint
000768000000      * =====================================================================
000769000000     P TLAddressFinderWSClassSoap_Endpoint_setPort...
000770000000     P                 B                   export
000771000000      *
000772000000     D TLAddressFinderWSClassSoap_Endpoint_setPort...
000773000000     D                 PI
000774000000     D  i_port                       10I 0 const
000775000000      *
000776000000     D tmpUrl          S                   like(url_t ) inz
000777000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000778000000      /free
000779000000
000780000000         tmpUrl = URL_new(getEndpoint());
000781000000         URL_setPort(tmpUrl: i_port);
000782000000         setEndpoint(URL_toString(tmpUrl));
000783000000
000784000000         return;
000785000000
000786000000      /end-free
000787000000      *
000788000000     P TLAddressFinderWSClassSoap_Endpoint_setPort...
000789000000     P                 E
000790000000      *
000791000000      * =====================================================================
000792000000      *   *** private, automatically called by WS_OPER() ***
000793000000      *   Web service: Initializes the web service port.
000794000000      * =====================================================================
000795000000     P TLAddressFinderWSClassSoap_Port_initialize...
000796000000     P                 B                   export
000797000000      *
000798000000     D TLAddressFinderWSClassSoap_Port_initialize...
000799000000     D                 PI
000800000000     D  i_operName                         const  like(wsdl_operName_t )
000801000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000802000000      /free
000803000000
000804000000         // This procedure is called from every web service
000805000000         // operation right at the beginning of the operation.
000806000000         // This procedure may be used to perform any type
000807000000         // of initialization that is the same for all web
000808000000         // service operations.
000809000000         // For example you may want to register a procedure
000810000000         // to supply login credentials like this:
000811000000
000812000000 B01     if (not TLAddressFinderWSClassSoap_Port_hasLoginCallback());
000813000000            TLAddressFinderWSClassSoap_Port_registerLoginCallback(
000814000000               %paddr('+
000815000000                  TLAddressFinderWSClassSoap_Port_supplyLoginData+
000816000000               '));
000817000000 E01     endif;
000818000000
000819000000         return;
000820000000
000821000000      /end-free
000822000000      *
000823000000     P TLAddressFinderWSClassSoap_Port_initialize...
000824000000     P                 E
000825000000      *
000826000000      * =====================================================================
000827000000      *   *** private, automatically called by *_Port_login() ***
000828000000      *   Web service: Supplies login credentials for web services that
000829000000      *                require BASIC or DIGEST authentication.
000830000000      * =====================================================================
000831000000     P TLAddressFinderWSClassSoap_Port_supplyLoginData...
000832000000     P                 B                   export
000833000000      *
000834000000     D TLAddressFinderWSClassSoap_Port_supplyLoginData...
000835000000     D                 PI            10I 0
000836000000     D  i_authType                   14A          const  varying
000837000000     D  i_realm                     126A          const  varying
000838000000     D  i_numAttempts                10I 0        const
000839000000     D  o_user                       50A                 varying
000840000000     D  o_password                   50A                 varying
000841000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000842000000      /free
000843000000
000844000000         // This procedure is called when a web service requires
000845000000         // BASIC or DIGEST authentication.
000846000000         // You may use the realm value for reading the credentials
000847000000         // from a file. Make sure that you do not get into an endless
000848000000         // loop in case the credentials are retrieved from a file.
000849000000         // The credentials might be wrong!
000850000000
000851000000         // Prevent endless loop when reading the credentials from a file
000852000000         // You may remove this IF statement when a user enters the
000853000000         // credentials.
000854000000 B01     if (i_numAttempts > 1);
000855000000            return WSDL_ERROR;
000856000000 E01     endif;
000857000000
000858000000         // Set o_user and o_password here and remove the error message.
000859000000         // Return WSDL_SUCCESS to let the caller know that user and
000860000000         // password have been set, otherwise return WSDL_ERROR.
000861000000
000862000000         clear USR0048;
000863000000         USR00481 = f_this();
000864000000         AppMsg_sendCancelMsg(AppMsg_newError('USR0048': USR0048));
000865000000
000866000000         return WSDL_ERROR;
000867000000
000868000000      /end-free
000869000000      *
000870000000     P TLAddressFinderWSClassSoap_Port_supplyLoginData...
000871000000     P                 E
000872000000      *
000873000000      * =====================================================================
000874000000      *   *** public ***
000875000000      *   Web service: Sets the proxy server to use for the connection
000876000000      * =====================================================================
000877000000     P TLAddressFinderWSClassSoap_Port_setHttpProxy...
000878000000     P                 B                   export
000879000000      *
000880000000     D TLAddressFinderWSClassSoap_Port_setHttpProxy...
000881000000     D                 PI
000882000000     D  i_server                    256A   const
000883000000     D  i_port                       10I 0 const
000884000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000885000000      /free
000886000000
000887000000         g_proxy.server = i_server;
000888000000
000889000000 B01     if (g_proxy.server = '');
000890000000            g_proxy.port = 0;
000891000000 X01     else;
000892000000            g_proxy.port = i_port;
000893000000 E01     endif;
000894000000
000895000000         return;
000896000000
000897000000      /end-free
000898000000      *
000899000000     P TLAddressFinderWSClassSoap_Port_setHttpProxy...
000900000000     P                 E
000901000000      *
000902000000      * =====================================================================
000903000000      *   *** public ***
000904000000      *   Web service: Returns the proxy server to use for the connection
000905000000      * =====================================================================
000906000000     P TLAddressFinderWSClassSoap_Port_getHttpProxy...
000907000000     P                 B                   export
000908000000      *
000909000000     D TLAddressFinderWSClassSoap_Port_getHttpProxy...
000910000000     D                 PI                         likeds(wsdl_proxy_t )
000911000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000912000000      /free
000913000000
000914000000         return g_proxy;
000915000000
000916000000      /end-free
000917000000      *
000918000000     P TLAddressFinderWSClassSoap_Port_getHttpProxy...
000919000000     P                 E
000920000000      *
000921000000      * =====================================================================
000922000000      *   *** public ***
000923000000      *   Web service: Enables/disables the debug log of HTTP API
000924000000      * =====================================================================
000925000000     P TLAddressFinderWSClassSoap_Port_setHttpDebug...
000926000000     P                 B                   export
000927000000      *
000928000000     D TLAddressFinderWSClassSoap_Port_setHttpDebug...
000929000000     D                 PI
000930000000     D   i_status                      N   const
000931000000     D   i_fileName                 500A   const  varying  options(*nopass)
000932000000     D   i_verbose                     N   const  options(*nopass)
000933000000      *
000934000000      *  Parameter positions
000935000000     D p_fileName      C                   2
000936000000     D p_verbose       C                   3
000937000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000938000000      /free
000939000000
000940000000         g_httpDebug.status = i_status;
000941000000
000942000000 B01     if (%parms() >= p_fileName);
000943000000            g_httpDebug.fileName = i_fileName;
000944000000 X01     else;
000945000000            g_httpDebug.fileName = '';
000946000000 E01     endif;
000947000000
000948000000 B01     if (i_status);
000949000000 B02        if (g_httpDebug.fileName = '');
000950000000               g_httpDebug.fileName = HTTP_API_DEFAULT_LOG_FILE;
000951000000 E02        endif;
000952000000 X01     else;
000953000000            g_httpDebug.fileName = '';
000954000000 E01     endif;
000955000000
000956000000 B01     if (i_status);
000957000000            http_DebugLog_open(g_httpDebug.fileName);
000958000000 X01     else;
000959000000            http_DebugLog_close();
000960000000 E01     endif;
000961000000
000962000000 B01     if (%parms() >= p_verbose);
000963000000            http_DebugLog_setVerbose(i_verbose);
000964000000 X01     else;
000965000000            http_DebugLog_setVerbose(cFalse);
000966000000 E01     endif;
000967000000
000968000000         return;
000969000000
000970000000      /end-free
000971000000      *
000972000000     P TLAddressFinderWSClassSoap_Port_setHttpDebug...
000973000000     P                 E
000974000000      *
000975000000      * =====================================================================
000976000000      *   *** public ***
000977000000      *   Web service: Returns the HTTP API debug settings
000978000000      * =====================================================================
000979000000     P TLAddressFinderWSClassSoap_Port_getHttpDebug...
000980000000     P                 B                   export
000981000000      *
000982000000     D TLAddressFinderWSClassSoap_Port_getHttpDebug...
000983000000     D                 PI                         likeds(wsdl_httpDebug_t )
000984000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
000985000000      /free
000986000000
000987000000 B01     if (g_httpDebug.fileName = '');
000988000000            g_httpDebug.fileName = HTTP_API_DEFAULT_LOG_FILE;
000989000000 E01     endif;
000990000000
000991000000         return g_httpDebug;
000992000000
000993000000      /end-free
000994000000      *
000995000000     P TLAddressFinderWSClassSoap_Port_getHttpDebug...
000996000000     P                 E
000997000000      *
000998000000      * =====================================================================
000999000000      *   *** public ***
001000000000      *   Web service: Sets the CCSID used for POST data.
001001000000      *   An application may call this procedure right before the web service
001002000000      *   operation in order to specify a POST ccsid different from 1208.
001003000000      *   Usually it is not necessary to call this procedure.
001004000000      * =====================================================================
001005000000     P TLAddressFinderWSClassSoap_Port_setPostCcsid...
001006000000     P                 B                   export
001007000000      *
001008000000     D TLAddressFinderWSClassSoap_Port_setPostCcsid...
001009000000     D                 PI
001010000000     D  i_post_ccsid                 10I 0 const
001011000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001012000000      /free
001013000000
001014000000         g_post_ccsid = i_post_ccsid;
001015000000
001016000000         return;
001017000000
001018000000      /end-free
001019000000      *
001020000000     P TLAddressFinderWSClassSoap_Port_setPostCcsid...
001021000000     P                 E
001022000000      *
001023000000      * =====================================================================
001024000000      *   *** public ***
001025000000      *   Web service: Returns the CCSID used for POST
001026000000      * =====================================================================
001027000000     P TLAddressFinderWSClassSoap_Port_getPostCcsid...
001028000000     P                 B                   export
001029000000      *
001030000000     D TLAddressFinderWSClassSoap_Port_getPostCcsid...
001031000000     D                 PI            10I 0
001032000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001033000000      /free
001034000000
001035000000         return g_post_ccsid;
001036000000
001037000000      /end-free
001038000000      *
001039000000     P TLAddressFinderWSClassSoap_Port_getPostCcsid...
001040000000     P                 E
001041000000      *
001042000000      * =====================================================================
001043000000      *   *** public ***
001044000000      *   Web service: Sets the timeout that HTTPAPI uses
001045000000      *   when connecting to the server or waiting for response.
001046000000      *   Usually it is not necessary to call this procedure.
001047000000      * =====================================================================
001048000000     P TLAddressFinderWSClassSoap_Port_setTimeout...
001049000000     P                 B                   export
001050000000      *
001051000000     D TLAddressFinderWSClassSoap_Port_setTimeout...
001052000000     D                 PI
001053000000     D  i_timeout                    10I 0 const
001054000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001055000000      /free
001056000000
001057000000         g_timeout = i_timeout;
001058000000
001059000000         return;
001060000000
001061000000      /end-free
001062000000      *
001063000000     P TLAddressFinderWSClassSoap_Port_setTimeout...
001064000000     P                 E
001065000000      *
001066000000      * =====================================================================
001067000000      *   *** public ***
001068000000      *   Web service: Returns the timeout that HTTPAPI uses
001069000000      *   when connecting to the server or waiting for response.
001070000000      * =====================================================================
001071000000     P TLAddressFinderWSClassSoap_Port_getTimeout...
001072000000     P                 B                   export
001073000000      *
001074000000     D TLAddressFinderWSClassSoap_Port_getTimeout...
001075000000     D                 PI            10I 0
001076000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001077000000      /free
001078000000
001079000000         return g_timeout;
001080000000
001081000000      /end-free
001082000000      *
001083000000     P TLAddressFinderWSClassSoap_Port_getTimeout...
001084000000     P                 E
001085000000      *
001086000000      * =====================================================================
001087000000      *   *** public ***
001088000000      *   Web service: Sets the user-agent that HTTPAPI uses
001089000000      *   to identify the client at the server.
001090000000      *   Usually it is not necessary to call this procedure.
001091000000      * =====================================================================
001092000000     P TLAddressFinderWSClassSoap_Port_setUserAgent...
001093000000     P                 B                   export
001094000000      *
001095000000     D TLAddressFinderWSClassSoap_Port_setUserAgent...
001096000000     D                 PI
001097000000     D  i_userAgent                        const  like(wsdl_userAgent_t )
001098000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001099000000      /free
001100000000
001101000000         g_userAgent = i_userAgent;
001102000000
001103000000         return;
001104000000
001105000000      /end-free
001106000000      *
001107000000     P TLAddressFinderWSClassSoap_Port_setUserAgent...
001108000000     P                 E
001109000000      *
001110000000      * =====================================================================
001111000000      *   *** public ***
001112000000      *   Web service: Returns the user-agent that HTTPAPI uses
001113000000      *   to identify the client at the server.
001114000000      * =====================================================================
001115000000     P TLAddressFinderWSClassSoap_Port_getUserAgent...
001116000000     P                 B                   export
001117000000      *
001118000000     D TLAddressFinderWSClassSoap_Port_getUserAgent...
001119000000     D                 PI                         like(wsdl_userAgent_t )
001120000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001121000000      /free
001122000000
001123000000         return g_userAgent;
001124000000
001125000000      /end-free
001126000000      *
001127000000     P TLAddressFinderWSClassSoap_Port_getUserAgent...
001128000000     P                 E
001129000000      *
001130000000      * =====================================================================
001131000000      *   *** private, automatically called by WS_OPER() ***
001132000000      *   Web service: Clears all error information.
001133000000      * =====================================================================
001134000000     P TLAddressFinderWSClassSoap_Port_clearErrors...
001135000000     P                 B                   export
001136000000      *
001137000000     D TLAddressFinderWSClassSoap_Port_clearErrors...
001138000000     D                 PI
001139000000     D  io_errors                                 likeds(wsdl_errors_t )
001140000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001141000000      /free
001142000000
001143000000         clear g_errors;
001144000000         g_errors.errType = WSDL_HTTP_SUCCESS;
001145000000
001146000000         io_errors = g_errors;
001147000000
001148000000         return;
001149000000
001150000000      /end-free
001151000000      *
001152000000     P TLAddressFinderWSClassSoap_Port_clearErrors...
001153000000     P                 E
001154000000      *
001155000000      * =====================================================================
001156000000      *   *** private, automatically called by WS_OPER() ***
001157000000      *   Web service: Sets error information of last service call.
001158000000      * =====================================================================
001159000000     P TLAddressFinderWSClassSoap_Port_setErrors...
001160000000     P                 B                   export
001161000000      *
001162000000     D TLAddressFinderWSClassSoap_Port_setErrors...
001163000000     D                 PI
001164000000     D  i_errors                           const  likeds(wsdl_errors_t )
001165000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001166000000      /free
001167000000
001168000000         g_errors = i_errors;
001169000000
001170000000         return;
001171000000
001172000000      /end-free
001173000000      *
001174000000     P TLAddressFinderWSClassSoap_Port_setErrors...
001175000000     P                 E
001176000000      *
001177000000      * =====================================================================
001178000000      *   *** public ***
001179000000      *   Http: Returns the last HTTP error (code) that occurred.
001180000000      *   An application should use this procedure to check whether or not
001181000000      *   the web service operation has bee successfully executed.
001182000000      * =====================================================================
001183000000     P TLAddressFinderWSClassSoap_Port_isError...
001184000000     P                 B                   export
001185000000      *
001186000000     D TLAddressFinderWSClassSoap_Port_isError...
001187000000     D                 PI              N
001188000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001189000000      /free
001190000000
001191000000 B01     if (g_errors.errType = WSDL_HTTP_SUCCESS);
001192000000            return cFalse;
001193000000 X01     else;
001194000000            return cTrue;
001195000000 E01     endif;
001196000000
001197000000      /end-free
001198000000      *
001199000000     P TLAddressFinderWSClassSoap_Port_isError...
001200000000     P                 E
001201000000      *
001202000000      * =====================================================================
001203000000      *   *** public ***
001204000000      *   Http: Returns the last HTTP error (code) that occurred.
001205000000      * =====================================================================
001206000000     P TLAddressFinderWSClassSoap_HttpError_getCode...
001207000000     P                 B                   export
001208000000      *
001209000000     D TLAddressFinderWSClassSoap_HttpError_getCode...
001210000000     D                 PI                  like(wsdl_http_ErrorNo_t  )
001211000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001212000000      /free
001213000000
001214000000         return g_errors.httpError.no;
001215000000
001216000000      /end-free
001217000000      *
001218000000     P TLAddressFinderWSClassSoap_HttpError_getCode...
001219000000     P                 E
001220000000      *
001221000000      * =====================================================================
001222000000      *   *** public ***
001223000000      *   Http: Returns the last HTTP error (text) that occurred.
001224000000      * =====================================================================
001225000000     P TLAddressFinderWSClassSoap_HttpError_getText...
001226000000     P                 B                   export
001227000000      *
001228000000     D TLAddressFinderWSClassSoap_HttpError_getText...
001229000000     D                 PI                  like(wsdl_http_ErrorText_t)
001230000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001231000000      /free
001232000000
001233000000         return g_errors.httpError.text;
001234000000
001235000000      /end-free
001236000000      *
001237000000     P TLAddressFinderWSClassSoap_HttpError_getText...
001238000000     P                 E
001239000000      *
001240000000      * =====================================================================
001241000000      *   *** public ***
001242000000      *   Soap: Returns the last SOAP error (code) that occurred.
001243000000      * =====================================================================
001244000000     P TLAddressFinderWSClassSoap_SoapError_getCode...
001245000000     P                 B                   export
001246000000      *
001247000000     D TLAddressFinderWSClassSoap_SoapError_getCode...
001248000000     D                 PI                  like(wsdl_soap_faultcode_t  )
001249000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001250000000      /free
001251000000
001252000000         return g_errors.soapFault.code;
001253000000
001254000000      /end-free
001255000000      *
001256000000     P TLAddressFinderWSClassSoap_SoapError_getCode...
001257000000     P                 E
001258000000      *
001259000000      * =====================================================================
001260000000      *   *** public ***
001261000000      *   Soap: Returns the last SOAP error (text) that occurred.
001262000000      * =====================================================================
001263000000     P TLAddressFinderWSClassSoap_SoapError_getText...
001264000000     P                 B                   export
001265000000      *
001266000000     D TLAddressFinderWSClassSoap_SoapError_getText...
001267000000     D                 PI                  like(wsdl_soap_faultstring_t)
001268000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001269000000      /free
001270000000
001271000000         return g_errors.soapFault.string;
001272000000
001273000000      /end-free
001274000000      *
001275000000     P TLAddressFinderWSClassSoap_SoapError_getText...
001276000000     P                 E
001277000000      *
001278000000      * =====================================================================
001279000000      *   *** public ***
001280000000      *   XML: Returns the last XML error (code) that occurred.
001281000000      * =====================================================================
001282000000     P TLAddressFinderWSClassSoap_XmlError_getCode...
001283000000     P                 B                   export
001284000000      *
001285000000     D TLAddressFinderWSClassSoap_XmlError_getCode...
001286000000     D                 PI                  like(wsdl_xml_ErrorNo_t    )
001287000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001288000000      /free
001289000000
001290000000         return g_errors.xmlError.code;
001291000000
001292000000      /end-free
001293000000      *
001294000000     P TLAddressFinderWSClassSoap_XmlError_getCode...
001295000000     P                 E
001296000000      *
001297000000      * =====================================================================
001298000000      *   *** public ***
001299000000      *   XML: Returns the last XML error (text) that occurred.
001300000000      * =====================================================================
001301000000     P TLAddressFinderWSClassSoap_XmlError_getText...
001302000000     P                 B                   export
001303000000      *
001304000000     D TLAddressFinderWSClassSoap_XmlError_getText...
001305000000     D                 PI                  like(wsdl_xml_ErrorText_t  )
001306000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001307000000      /free
001308000000
001309000000         return g_errors.xmlError.text;
001310000000
001311000000      /end-free
001312000000      *
001313000000     P TLAddressFinderWSClassSoap_XmlError_getText...
001314000000     P                 E
001315000000      *
001316000000      * =====================================================================
001317000000      *   *** public ***
001318000000      *   Registers an user callback procedure, that is called whenever
001319000000      *   a web service requires user authentification.
001320000000      *   An application may call this procedure in order to register a
001321000000      *   user and password provider different from *_Port_supplyLoginData().
001322000000      *   Usually *_Port_supplyLoginData() should be modified to match the
001323000000      *   requirements of the application.
001324000000      * =====================================================================
001325000000     P TLAddressFinderWSClassSoap_Port_registerLoginCallback...
001326000000     P                 B                   export
001327000000      *
001328000000     D TLAddressFinderWSClassSoap_Port_registerLoginCallback...
001329000000     D                 PI
001330000000  D  D  i_pLoginProc                   *   value  procptr
001331000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001332000000      /free
001333000000
001334000000         g_getLoginDataImpl = i_pLoginProc;
001335000000
001336000000         return;
001337000000
001338000000      /end-free
001339000000      *
001340000000     P TLAddressFinderWSClassSoap_Port_registerLoginCallback...
001341000000     P                 E
001342000000      *
001343000000      * =====================================================================
001344000000      *   *** public ***
001345000000      *   Returns *ON if a login procedures has been registered.
001346000000      *   This procedure is used by WS_OPER() but might also be called
001347000000      *   by the application to see whether or not a user and password
001348000000      *   provider is present.
001349000000      * =====================================================================
001350000000     P TLAddressFinderWSClassSoap_Port_hasLoginCallback...
001351000000     P                 B                   export
001352000000      *
001353000000     D TLAddressFinderWSClassSoap_Port_hasLoginCallback...
001354000000     D                 PI              N
001355000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001356000000      /free
001357000000
001358000000 B01     if (g_getLoginDataImpl <> *NULL);
001359000000            return *ON;
001360000000 E01     endif;
001361000000
001362000000         return *OFF;
001363000000
001364000000      /end-free
001365000000      *
001366000000     P TLAddressFinderWSClassSoap_Port_hasLoginCallback...
001367000000     P                 E
001368000000      *
001369000000      * =====================================================================
001370000000      *   *** private, automatically called by WS_OPER() ***
001371000000      *   Login to proxy server or web service.
001372000000      * =====================================================================
001373000000     P TLAddressFinderWSClassSoap_Port_login...
001374000000     P                 B                   export
001375000000      *
001376000000     D TLAddressFinderWSClassSoap_Port_login...
001377000000     D                 PI            10I 0
001378000000     D  i_http_err                   10I 0 value
001379000000     D  i_numAttempts                10I 0 value
001380000000      *
001381000000      *  Return value
001382000000     D rc              S             10I 0 inz
001383000000      *
001384000000      *  Helper fields
001385000000     D basic           S               N   inz
001386000000     D digest          S               N   inz
001387000000     D realm           S            124A   inz
001388000000     D authTarget      S             14A   inz varying
001389000000     D authType        S              1A   inz
001390000000     D userid          S             50A   inz varying
001391000000     D password        S             50A   inz varying
001392000000      *
001393000000     D getLoginDataImpl...
001394000000     D                 PR            10I 0
001395000000     D                                     extproc(g_getLoginDataImpl)
001396000000     D  i_authType                   14A          const  varying
001397000000     D  i_realm                     126A          const  varying
001398000000     D  i_numAttempts                10I 0        const
001399000000     D  o_user                       50A                 varying
001400000000     D  o_password                   50A                 varying
001401000000      *
001402000000     D authErr         S             10I 0 inz
001403000000     D err             S             10I 0 inz
001404000000     D errText         S             80A   inz
001405000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001406000000      /free
001407000000
001408000000 B01     if (i_http_err = HTTP_NDAUTH);
001409000000            http_getauth(basic: digest: realm);
001410000000            authTarget = WSDL_AUTH_TYPE_HTTP;
001411000000 X01     else;
001412000000            http_proxy_getauth(basic: realm);
001413000000            authTarget = WSDL_AUTH_TYPE_PROXY;
001414000000 E01     endif;
001415000000
001416000000         rc = getLoginDataImpl(authTarget: realm
001417000000                               : i_numAttempts: userid: password);
001418000000 B01     if (rc <> 1);
001419000000            userid = '';
001420000000            password = '';
001421000000            return rc;
001422000000 E01     endif;
001423000000
001424000000 B01     if (i_http_err = HTTP_NDAUTH);
001425000000 B02        select;
001426000000 X02        when (digest);
001427000000               authType = HTTP_AUTH_MD5_DIGEST;
001428000000               authErr = http_setAuth(HTTP_AUTH_MD5_DIGEST
001429000000                                      : userid: password);
001430000000 X02        when (basic);
001431000000               authType = HTTP_AUTH_BASIC;
001432000000               authErr = http_setAuth(HTTP_AUTH_BASIC
001433000000                                      : userid: password);
001434000000 X02        other;
001435000000               // WSDL_AUTH_NTLM must match the value of HTTP_AUTH_NTLM!
001436000000               authType = WSDL_AUTH_NTLM;
001437000000               authErr = http_setAuth(WSDL_AUTH_NTLM
001438000000                                      : userid: password);
001439000000 E02        endsl;
001440000000 X01     else;
001441000000 B02        select;
001442000000 X02        when (digest);
001443000000               authType = HTTP_AUTH_MD5_DIGEST;
001444000000               authErr = http_proxy_setAuth(HTTP_AUTH_MD5_DIGEST
001445000000                                            : userid: password);
001446000000 X02        when (basic);
001447000000               authType = HTTP_AUTH_BASIC;
001448000000               authErr = http_proxy_setAuth(HTTP_AUTH_BASIC
001449000000                                            : userid: password);
001450000000 X02        other;
001451000000               // not yet supported
001452000000               http_DebugLog_appendText(
001453000000                  '** NTLM authentication is not supported +
001454000000                   for proxy authentication');
001455000000               authErr = -1;
001456000000 E02        endsl;
001457000000 E01     endif;
001458000000
001459000000 B01     if (authErr = -1);
001460000000            errText = http_error(err);
001461000000            http_DebugLog_appendText('** Failed to login: ' + errText);
001462000000 B02        if (authtype = WSDL_AUTH_NTLM);
001463000000               http_DebugLog_appendText('** Your version of HTTPAPI +
001464000000                                         does not support NTLM authentication');
001465000000 E02        endif;
001466000000            rc = WSDL_ERROR;
001467000000 E01     endif;
001468000000
001469000000         userid = '';
001470000000         password = '';
001471000000
001472000000         return rc;
001473000000
001474000000      /end-free
001475000000      *
001476000000     P TLAddressFinderWSClassSoap_Port_login...
001477000000     P                 E
001478000000      *
001479000000      * =====================================================================
001480000000      *   *** public ***
001481000000      *   Returns the name of the web service port.
001482000000      *   This procedure is used by WS_OPER() but might also be called
001483000000      *   by the application for information purposes.
001484000000      * =====================================================================
001485000000     P TLAddressFinderWSClassSoap_Port_getName...
001486000000     P                 B                   export
001487000000      *
001488000000     D TLAddressFinderWSClassSoap_Port_getName...
001489000000     D                 PI                         like(wsdl_portName_t )
001490000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001491000000      /free
001492000000
001493000000         return cWEB_SERVICE_PORT_NAME;
001494000000
001495000000      /end-free
001496000000      *
001497000000     P TLAddressFinderWSClassSoap_Port_getName...
001498000000     P                 E
001499000000      *
001500000000      * =====================================================================
001501000000      *   *** private, automatically called by WS_OPER() ***
001502000000      *   Returns the UUID of the web service port.
001503000000      * =====================================================================
001504000000     P TLAddressFinderWSClassSoap_Port_getUuid...
001505000000     P                 B                   export
001506000000      *
001507000000     D TLAddressFinderWSClassSoap_Port_getUuid...
001508000000     D                 PI                         like(wsdl_uuid_t )
001509000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001510000000      /free
001511000000
001512000000         return cWEB_SERVICE_UUID;
001513000000
001514000000      /end-free
001515000000      *
001516000000     P TLAddressFinderWSClassSoap_Port_getUuid...
001517000000     P                 E
001518000000      *
001519000000      * =====================================================================
001520000000      *   *** private, automatically called by WS_OPER() ***
001521000000      *   Adds an attachments to the list of attachments.
001522000000      * =====================================================================
001523000000     P TLAddressFinderWSClassSoap_Attachments_put...
001524000000     P                 B                   export
001525000000      *
001526000000     D TLAddressFinderWSClassSoap_Attachments_put...
001527000000     D                 PI
001528000000     D  i_attachmentID...
001529000000     D                                     const  like(wsdl_attachmentID_t )
001530000000     D  i_fileName                         const  like(wsdl_path_t         )
001531000000     D  i_uuid                             const  like(wsdl_uuid_t         )
001532000000     D                                            options(*nopass)
001533000000      *
001534000000     D p_uuid          C                   3
001535000000      *
001536000000     D uuid            S                   like(i_uuid          ) inz
001537000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001538000000      /free
001539000000
001540000000 B01     if (%parms() >= p_uuid);
001541000000            uuid = i_uuid;
001542000000 X01     else;
001543000000            uuid = TLAddressFinderWSClassSoap_Port_getUuid();
001544000000 E01     endif;
001545000000
001546000000         Attachments_put(Attachments_theInstance()
001547000000                         : uuid
001548000000                         : i_attachmentID
001549000000                         : i_fileName);
001550000000
001551000000         return;
001552000000
001553000000      /end-free
001554000000      *
001555000000     P TLAddressFinderWSClassSoap_Attachments_put...
001556000000     P                 E
001557000000      *
001558000000      * =====================================================================
001559000000      *   *** public ***
001560000000      *   Returns the file name of the attachment that is associated to
001561000000      *   a given content ID.
001562000000      *   An application can use this procedure to get an attachments
001563000000      *   of the last web service operation.
001564000000      * =====================================================================
001565000000     P TLAddressFinderWSClassSoap_Attachments_get...
001566000000     P                 B                   export
001567000000      *
001568000000     D TLAddressFinderWSClassSoap_Attachments_get...
001569000000     D                 PI                  like(wsdl_path_t     )
001570000000     D  i_attachmentID...
001571000000     D                                     const  like(wsdl_attachmentID_t )
001572000000     D  i_uuid                             const  like(wsdl_uuid_t         )
001573000000     D                                            options(*nopass)
001574000000      *
001575000000     D p_uuid          C                   2
001576000000      *
001577000000     D uuid            S                   like(i_uuid          ) inz
001578000000     D fileName        S                   like(wsdl_path_t     ) inz
001579000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001580000000      /free
001581000000
001582000000 B01     if (%parms() >= p_uuid);
001583000000            uuid = i_uuid;
001584000000 X01     else;
001585000000            uuid = TLAddressFinderWSClassSoap_Port_getUuid();
001586000000 E01     endif;
001587000000
001588000000         fileName = Attachments_get(Attachments_theInstance()
001589000000                                    : uuid
001590000000                                    : i_attachmentID);
001591000000         return fileName;
001592000000
001593000000      /end-free
001594000000      *
001595000000     P TLAddressFinderWSClassSoap_Attachments_get...
001596000000     P                 E
001597000000      *
001598000000      * =====================================================================
001599000000      *   *** public ***
001600000000      *   Returns the file name of the attachment that is associated to
001601000000      *   a given index.
001602000000      *   An application can use this procedure to get an attachments
001603000000      *   of the last web service operation.
001604000000      * =====================================================================
001605000000     P TLAddressFinderWSClassSoap_Attachments_getAtPos...
001606000000     P                 B                   export
001607000000      *
001608000000     D TLAddressFinderWSClassSoap_Attachments_getAtPos...
001609000000     D                 PI                  likeds(wsdl_attachment_t )
001610000000     D  i_index                      10I 0 const
001611000000     D  i_uuid                             const  like(wsdl_uuid_t         )
001612000000     D                                            options(*nopass)
001613000000      *
001614000000     D p_uuid          C                   2
001615000000      *
001616000000     D uuid            S                   like(i_uuid          ) inz
001617000000     D attachment      DS                  likeds(wsdl_attachment_t ) inz
001618000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001619000000      /free
001620000000
001621000000 B01     if (%parms() >= p_uuid);
001622000000            uuid = i_uuid;
001623000000 X01     else;
001624000000            uuid = TLAddressFinderWSClassSoap_Port_getUuid();
001625000000 E01     endif;
001626000000
001627000000         attachment = Attachments_getAtPos(Attachments_theInstance()
001628000000                                           : uuid
001629000000                                           : i_index);
001630000000         return attachment;
001631000000
001632000000      /end-free
001633000000      *
001634000000     P TLAddressFinderWSClassSoap_Attachments_getAtPos...
001635000000     P                 E
001636000000      *
001637000000      * =====================================================================
001638000000      *   *** public ***
001639000000      *   Returns the number of attachments that were downloaded with
001640000000      *   the last call of the web service.
001641000000      * =====================================================================
001642000000     P TLAddressFinderWSClassSoap_Attachments_getNumE...
001643000000     P                 B                   export
001644000000      *
001645000000     D TLAddressFinderWSClassSoap_Attachments_getNumE...
001646000000     D                 PI            10I 0
001647000000     D  i_uuid                             const  like(wsdl_uuid_t         )
001648000000     D                                            options(*nopass)
001649000000      *
001650000000     D p_uuid          C                   1
001651000000      *
001652000000     D uuid            S                   like(i_uuid          ) inz
001653000000     D numE            S             10I 0 inz
001654000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001655000000      /free
001656000000
001657000000 B01     if (%parms() >= p_uuid);
001658000000            uuid = i_uuid;
001659000000 X01     else;
001660000000            uuid = TLAddressFinderWSClassSoap_Port_getUuid();
001661000000 E01     endif;
001662000000
001663000000         numE = Attachments_getNumAttachments(
001664000000                      Attachments_theInstance(): uuid);
001665000000
001666000000         return numE;
001667000000
001668000000      /end-free
001669000000      *
001670000000     P TLAddressFinderWSClassSoap_Attachments_getNumE...
001671000000     P                 E
001672000000      *
001673000000      * =====================================================================
001674000000      *   *** public ***
001675000000      *   Removes all attachments from the list of attachments of
001676000000      *   this web service.
001677000000      *   An application should call this procedure once that the
001678000000      *   attachments of the last web service operation are obsolete.
001679000000      *   This procedure is also used by WS_OPER() to remove all attachments
001680000000      *   before the next web service call.
001681000000      * =====================================================================
001682000000     P TLAddressFinderWSClassSoap_Attachments_removeAll...
001683000000     P                 B                   export
001684000000      *
001685000000     D TLAddressFinderWSClassSoap_Attachments_removeAll...
001686000000     D                 PI
001687000000     D  i_uuid                             const  like(wsdl_uuid_t         )
001688000000     D                                            options(*nopass)
001689000000      *
001690000000     D p_uuid          C                   1
001691000000      *
001692000000     D uuid            S                   like(i_uuid          ) inz
001693000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001694000000      /free
001695000000
001696000000 B01     if (%parms() >= p_uuid);
001697000000            uuid = i_uuid;
001698000000 X01     else;
001699000000            uuid = TLAddressFinderWSClassSoap_Port_getUuid();
001700000000 E01     endif;
001701000000
001702000000         Attachments_removeAll(Attachments_theInstance(): uuid);
001703000000
001704000000         return;
001705000000
001706000000      /end-free
001707000000      *
001708000000     P TLAddressFinderWSClassSoap_Attachments_removeAll...
001709000000     P                 E
001710000000      *
001711000000      * =====================================================================
001712000000      *   *** public ***
001713000000      *   Specifies the name of the folder where to put attachments in.
001714000000      *   An application may use this procedure to specify a folder where
001715000000      *   to store attachements. The default value is '/tmp/attachments/'.
001716000000      * =====================================================================
001717000000     P TLAddressFinderWSClassSoap_Attachments_setFolder...
001718000000     P                 B                   export
001719000000      *
001720000000     D TLAddressFinderWSClassSoap_Attachments_setFolder...
001721000000     D                 PI
001722000000     D  i_folder                           const  like(wsdl_pathLong_t )
001723000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001724000000      /free
001725000000
001726000000         g_attachmentFolder = i_folder;
001727000000
001728000000         g_attachmentFolder = %trimR(%xlate('': '/': g_attachmentFolder));
001729000000 B01     if (not f_endsWith('/': g_attachmentFolder));
001730000000            g_attachmentFolder = g_attachmentFolder + '/';
001731000000 E01     endif;
001732000000
001733000000         return;
001734000000
001735000000      /end-free
001736000000      *
001737000000     P TLAddressFinderWSClassSoap_Attachments_setFolder...
001738000000     P                 E
001739000000      *
001740000000      * =====================================================================
001741000000      *   *** public ***
001742000000      *   Returns the name of the folder where attachments are stored.
001743000000      * =====================================================================
001744000000     P TLAddressFinderWSClassSoap_Attachments_getFolder...
001745000000     P                 B                   export
001746000000      *
001747000000     D TLAddressFinderWSClassSoap_Attachments_getFolder...
001748000000     D                 PI                         like(wsdl_pathLong_t )
001749000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001750000000      /free
001751000000
001752000000         return g_attachmentFolder;
001753000000
001754000000      /end-free
001755000000      *
001756000000     P TLAddressFinderWSClassSoap_Attachments_getFolder...
001757000000     P                 E
001758000000      *
001759000000      * =====================================================================
001760000000      *   *** public ***
001761000000      *   Initializes the memory manager.
001762000000      *   This procedure has to be called by the application in case
001763000000      *   the web service stub has be generated for using dynamic arrays.
001764000000      * =====================================================================
001765000000     P TLAddressFinderWSClassSoap_initializeMemoryManager...
001766000000     P                 B                   export
001767000000      *
001768000000     D TLAddressFinderWSClassSoap_initializeMemoryManager...
001769000000     D                 PI                         like(wsdl_uuid_t )
001770000000     D  i_uuid                             const  like(wsdl_uuid_t )
001771000000     D                                            options(*nopass: *omit)
001772000000      *
001773000000      *  Parameter positions
001774000000     D p_uuid          C                   1
001775000000      *
001776000000      *  Fields for optional parameters
001777000000     D uuid            S                          like(i_uuid      )
001778000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001779000000      /free
001780000000
001781000000 B01     if (%parms() >= p_uuid and %addr(i_uuid) <> *NULL);
001782000000            uuid = i_uuid;
001783000000 X01     else;
001784000000            uuid = TLAddressFinderWSClassSoap_Port_getUuid();
001785000000 E01     endif;
001786000000
001787000000         // Start memory manager, do not use symbolic names
001788000000         // Note 1: It is strongly recommended not to use symbolic names
001789000000         //         due to high performance degradation.
001790000000         // Note 2: Set "use separate heaps" to cTRUE, if your
001791000000         //         request/response messages uses dynamic arrays
001792000000         //         and exceeds 16MB.
001793000000         MemoryManager_attachService(uuid       // web service uuid
001794000000                                     : cFalse   // do not use symbolic names for arrays
001795000000                                     : cFalse); // do not use separate heaps for arrays
001796000000
001797000000         return uuid;
001798000000
001799000000      /end-free
001800000000      *
001801000000     P TLAddressFinderWSClassSoap_initializeMemoryManager...
001802000000     P                 E
001803000000      *
001804000000      * =====================================================================
001805000000      *   *** public ***
001806000000      *   Frees all allocated memory blocks of all dynamic arrays.
001807000000      *   This procedure has to be called by the application in case
001808000000      *   the web service stub has be generated for using dynamic arrays.
001809000000      * =====================================================================
001810000000     P TLAddressFinderWSClassSoap_terminateMemoryManager...
001811000000     P                 B                   export
001812000000      *
001813000000     D TLAddressFinderWSClassSoap_terminateMemoryManager...
001814000000     D                 PI
001815000000     D  i_uuid                             const  like(wsdl_uuid_t )
001816000000     D                                            options(*nopass: *omit)
001817000000      *
001818000000      *  Parameter positions
001819000000     D p_uuid          C                   1
001820000000      *
001821000000      *  Fields for optional parameters
001822000000     D uuid            S                          like(i_uuid      )
001823000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001824000000      /free
001825000000
001826000000 B01     if (%parms() >= p_uuid and %addr(i_uuid) <> *NULL);
001827000000            uuid = i_uuid;
001828000000 X01     else;
001829000000            uuid = TLAddressFinderWSClassSoap_Port_getUuid();
001830000000 E01     endif;
001831000000
001832000000         // Terminate MemoryManager
001833000000         MemoryManager_detachService(uuid);
001834000000
001835000000         return;
001836000000
001837000000      /end-free
001838000000      *
001839000000     P TLAddressFinderWSClassSoap_terminateMemoryManager...
001840000000     P                 E
001841000000      *
001842000000      * =====================================================================
001843000000      *   *** public ***
001844000000      *   Enables redirection of the HTTP response message to a
001845000000      *   stream file in the IFS.
001846000000      * =====================================================================
001847000000     P TLAddressFinderWSClassSoap_RedirectResponse_toStmf...
001848000000     P                 B                   export
001849000000      *
001850000000     D TLAddressFinderWSClassSoap_RedirectResponse_toStmf...
001851000000     D                 PI
001852000000     D  i_stmf                             const  like(wsdl_pathLong_t )
001853000000     D  i_replace                      N   const  options(*nopass: *omit)
001854000000     D  i_ccsid                      10I 0 const  options(*nopass: *omit)
001855000000     D  i_auth                       10I 0 const  options(*nopass: *omit)
001856000000      *
001857000000      *  Parameter positions
001858000000     D p_replace       C                   2
001859000000     D p_ccsid         C                   3
001860000000     D p_auth          C                   4
001861000000      *
001862000000      *  Optional parameter fields
001863000000     D replace         S                   like(i_replace ) inz
001864000000     D ccsid           S                   like(i_ccsid   ) inz
001865000000     D auth            S                   like(i_auth    ) inz
001866000000      *
001867000000      *  Helper fields
001868000000     D options         S             10I 0 inz
001869000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001870000000      /free
001871000000
001872000000         TLAddressFinderWSClassSoap_RedirectResponse_terminate();
001873000000
001874000000 B01     if (%trim(i_stmf) = '');
001875000000            g_redirectResponse.isActive = cFalse;
001876000000            g_redirectResponse.ccsid    = 0;
001877000000            g_redirectResponse.auth     = 0;
001878000000            g_redirectResponse.options  = 0;
001879000000            g_redirectResponse.fd       = -1;
001880000000            g_redirectResponse.path     = '';
001881000000            return;
001882000000 E01     endif;
001883000000
001884000000         http_DebugLog_appendText(
001885000000         '** Response redirected to: ' + i_stmf);
001886000000
001887000000 B01     if (%parms() >= p_replace and %addr(i_replace) <> *NULL);
001888000000            replace = i_replace;
001889000000 X01     else;
001890000000            replace = cFalse;
001891000000 E01     endif;
001892000000
001893000000 B01     if (%parms() >= p_ccsid and %addr(i_ccsid) <> *NULL);
001894000000            ccsid = i_ccsid;
001895000000 X01     else;
001896000000            ccsid = 1208;   // UTF-8
001897000000 E01     endif;
001898000000
001899000000 B01     if (%parms() >= p_auth and %addr(i_auth) <> *NULL);
001900000000            auth = i_auth;
001901000000 X01     else;
001902000000            auth = S_IRWXU + S_IRWXG + S_IRWXO;
001903000000 E01     endif;
001904000000
001905000000         options = O_CREAT + O_SHARE_RDONLY + O_WRONLY + O_CCSID;
001906000000 B01     if (replace);
001907000000            options = options + O_TRUNC;
001908000000 X01     else;
001909000000            options = options + O_EXCL + O_APPEND;
001910000000 E01     endif;
001911000000
001912000000         g_redirectResponse.isActive = cTrue;
001913000000         g_redirectResponse.ccsid    = ccsid;
001914000000         g_redirectResponse.auth     = auth;
001915000000         g_redirectResponse.options  = options;
001916000000         g_redirectResponse.fd       = -1;
001917000000         g_redirectResponse.path     = i_stmf;
001918000000
001919000000         return;
001920000000
001921000000      /end-free
001922000000      *
001923000000     P TLAddressFinderWSClassSoap_RedirectResponse_toStmf...
001924000000     P                 E
001925000000      *
001926000000      * =====================================================================
001927000000      *   *** private, automatically called by WS_OPER() ***
001928000000      *   Returns cTrue if response redirection is active, otherwise cFalse.
001929000000      * =====================================================================
001930000000     P TLAddressFinderWSClassSoap_RedirectResponse_isActive...
001931000000     P                 B                   export
001932000000      *
001933000000     D TLAddressFinderWSClassSoap_RedirectResponse_isActive...
001934000000     D                 PI              N
001935000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001936000000      /free
001937000000
001938000000         return g_redirectResponse.isActive;
001939000000
001940000000      /end-free
001941000000      *
001942000000     P TLAddressFinderWSClassSoap_RedirectResponse_isActive...
001943000000     P                 E
001944000000      *
001945000000      * =====================================================================
001946000000      *   *** private, automatically called by WS_OPER() ***
001947000000      *   Terminates a response redirection and closes the
001948000000      *   file that receiced the response.
001949000000      * =====================================================================
001950000000     P TLAddressFinderWSClassSoap_RedirectResponse_write...
001951000000     P                 B                   export
001952000000      *
001953000000     D TLAddressFinderWSClassSoap_RedirectResponse_write...
001954000000     D                 PI              N
001955000000     D  i_data                         *   value
001956000000     D  i_length                     10I 0 value
001957000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
001958000000      /free
001959000000
001960000000         // Open output file
001961000000 B01     if (g_redirectResponse.fd = -1);
001962000000            g_redirectResponse.fd = open(g_redirectResponse.path
001963000000                                        : g_redirectResponse.options
001964000000                                        : g_redirectResponse.auth
001965000000                                        : g_redirectResponse.ccsid);
001966000000 B02        if (g_redirectResponse.fd = -1);
001967000000               http_DebugLog_appendText(
001968000000               '** '+ %char(%timestamp()) +': Failed to open: ' +
001969000000                                              g_redirectResponse.path);
001970000000               return cFalse;
001971000000 E02        endif;
001972000000 E01     endif;
001973000000
001974000000         // Append data to output file
001975000000 B01     if (write(g_redirectResponse.fd: i_data: i_length) <> i_length);
001976000000               http_DebugLog_appendText(
001977000000               '** '+ %char(%timestamp()) +': Failed to append ' +
001978000000                                              %char(i_length) + ' bytes to: ' +
001979000000                                              g_redirectResponse.path);
001980000000            return cFalse;
001981000000 E01     endif;
001982000000
001983000000         return cTrue;
001984000000
001985000000      /end-free
001986000000      *
001987000000     P TLAddressFinderWSClassSoap_RedirectResponse_write...
001988000000     P                 E
001989000000      *
001990000000      * =====================================================================
001991000000      *   *** private, automatically called by WS_OPER() ***
001992000000      *   Terminates a response redirection and closes the
001993000000      *   file that receiced the response.
001994000000      * =====================================================================
001995000000     P TLAddressFinderWSClassSoap_RedirectResponse_terminate...
001996000000     P                 B                   export
001997000000      *
001998000000     D TLAddressFinderWSClassSoap_RedirectResponse_terminate...
001999000000     D                 PI
002000000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
002001000000      /free
002002000000
002003000000 B01     if (g_redirectResponse.fd <> -1);
002004000000            callp close(g_redirectResponse.fd);
002005000000            g_redirectResponse.fd = -1;
002006000000 E01     endif;
002007000000
002008000000         g_redirectResponse.path = '';
002009000000         g_redirectResponse.isActive = cFalse;
002010000000
002011000000         return;
002012000000
002013000000      /end-free
002014000000      *
002015000000     P TLAddressFinderWSClassSoap_RedirectResponse_terminate...
002016000000     P                 E
002017000000      *
002018000000      * =====================================================================
002019000000      *   *** private, automatically called by WS_OPER() ***
002020000000      * This procedure adds a file attachment. The attachment
002021000000      * is sent to the server the next time the web service is called.
002022000000      * =====================================================================
002023000000     P TLAddressFinderWSClassSoap_Attachments_addFile...
002024000000     P                 B                   export
002025000000      *
002026000000     D TLAddressFinderWSClassSoap_Attachments_addFile...
002027000000     D                 PI                        like(wsdl_partID_t)
002028000000     D  i_hMsgCtx                          const like(wsdl_hMsgCtx_t)
002029000000     D  i_path                             const like(wsdl_path_t)
002030000000     D  i_contentType                      const like(wsdl_contentType_t)
002031000000     D  i_transferEncoding...
002032000000     D                                     const like(
002033000000     D                                           wsdl_contentTransferEncoding_t)
002034000000     D                                           options(*nopass: *omit)
002035000000     D  i_suggestedFileName...
002036000000     D                                     const like(wsdl_path_t)
002037000000     D                                           options(*nopass: *omit)
002038000000      *
002039000000      *  Return value
002040000000     D partID          S                   like(wsdl_partID_t) inz
002041000000      *
002042000000      *  Parameter positions
002043000000     D p_transferEncoding...
002044000000     D                 C                   4
002045000000     D p_suggestedFileName...
002046000000     D                 C                   5
002047000000      *
002048000000      *  Optional parameters
002049000000     D transferEncoding...
002050000000     D                 S                   like(i_transferEncoding)
002051000000     D suggestedFileName...
002052000000     D                 S                   like(i_suggestedFileName)
002053000000      *
002054000000      *  Local fields
002055000000     D hDataSource     S                   like(wsdl_hDataSource_t)
002056000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
002057000000      /free
002058000000
002059000000 B01     if (%parms() >= p_transferEncoding and
002060000000             %addr(i_transferEncoding) <> *NULL);
002061000000            transferEncoding = i_transferEncoding;
002062000000 X01     else;
002063000000            transferEncoding = WSDL_MIME_BINARY;
002064000000 E01     endif;
002065000000
002066000000 B01     if (%parms() >= p_suggestedFileName and
002067000000             %addr(i_suggestedFileName) <> *NULL);
002068000000            suggestedFileName = i_suggestedFileName;
002069000000 X01     else;
002070000000            suggestedFileName = File_getName(i_path);
002071000000 E01     endif;
002072000000
002073000000         // Create datasource that points to the file
002074000000         hDataSource = ManagedMemoryDataSource_new();
002075000000         ManagedMemoryDataSource_setPath(hDataSource: i_path: i_contentType);
002076000000
002077000000         // Add attachment to message context
002078000000         partID =
002079000000            MessageContext_addAttachment(
002080000000               i_hMsgCtx: hDataSource: transferEncoding: suggestedFileName);
002081000000
002082000000         return partID;
002083000000
002084000000      /end-free
002085000000      *
002086000000     P TLAddressFinderWSClassSoap_Attachments_addFile...
002087000000     P                 E
002088000000      *
002089000000      * =====================================================================
002090000000      *   *** private, automatically called by WS_OPER() ***
002091000000      * This procedure adds a buffer attachment. The attachment
002092000000      * is sent to the server the next time the web service is called.
002093000000      * =====================================================================
002094000000     P TLAddressFinderWSClassSoap_Attachments_addBuffer...
002095000000     P                 B                   export
002096000000      *
002097000000     D TLAddressFinderWSClassSoap_Attachments_addBuffer...
002098000000     D                 PI                        like(wsdl_partID_t)
002099000000     D  i_hMsgCtx                          const like(wsdl_hMsgCtx_t)
002100000000     D  i_name                             const like(wsdl_path_t)
002101000000     D  i_pBuffer                      *   const
002102000000     D  i_size                       10I 0 const
002103000000     D  i_contentType                      const like(wsdl_contentType_t)
002104000000     D  i_transferEncoding...
002105000000     D                                     const like(
002106000000     D                                           wsdl_contentTransferEncoding_t)
002107000000     D                                           options(*nopass: *omit)
002108000000     D  i_targetCcsid                10I 0 const options(*nopass: *omit)
002109000000      *
002110000000      *  Return value
002111000000     D partID          S                   like(wsdl_partID_t) inz
002112000000      *
002113000000      *  Parameter positions
002114000000     D p_transferEncoding...
002115000000     D                 C                   6
002116000000     D p_targetCcsid   C                   7
002117000000      *
002118000000      *  Optional parameters
002119000000     D transferEncoding...
002120000000     D                 S                   like(i_transferEncoding)
002121000000     D targetCcsid     S                   like(i_targetCcsid)
002122000000      *
002123000000      *  Local fields
002124000000     D hDataSource     S                   like(wsdl_hDataSource_t)
002125000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
002126000000      /free
002127000000
002128000000 B01     if (%parms() >= p_transferEncoding and
002129000000             %addr(i_transferEncoding) <> *NULL);
002130000000            transferEncoding = i_transferEncoding;
002131000000 X01     else;
002132000000            transferEncoding = WSDL_MIME_BINARY;
002133000000 E01     endif;
002134000000
002135000000 B01     if (%parms() >= p_targetCcsid and %addr(i_targetCcsid) <> *NULL);
002136000000            targetCcsid = i_targetCcsid;
002137000000 X01     else;
002138000000            targetCcsid = -1; // Binary data, no character translation
002139000000 E01     endif;
002140000000
002141000000         hDataSource = ManagedMemoryDataSource_new();
002142000000         ManagedMemoryDataSource_setBuffer(
002143000000            hDataSource: i_name: i_pBuffer: i_size: i_contentType: targetCcsid);
002144000000
002145000000         partID = MessageContext_addAttachment(
002146000000                        i_hMsgCtx: hDataSource: transferEncoding: '');
002147000000
002148000000         return partID;
002149000000
002150000000      /end-free
002151000000      *
002152000000     P TLAddressFinderWSClassSoap_Attachments_addBuffer...
002153000000     P                 E
002154000000      *
002155000000      * =====================================================================
002156000000      *   Internal procedure to get the endpoint.
002157000000      * =====================================================================
002158000000     P getEndpoint...
002159000000     P                 B
002160000000      *
002161000000     D getEndpoint...
002162000000     D                 PI         32767A          varying
002163000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
002164000000      /free
002165000000
002166000000         return g_url;
002167000000
002168000000      /end-free
002169000000      *
002170000000     P getEndpoint...
002171000000     P                 E
002172000000      *
002173000000      * =====================================================================
002174000000      *   Internal procedure to set the endpoint.
002175000000      * =====================================================================
002176000000     P setEndpoint...
002177000000     P                 B
002178000000      *
002179000000     D setEndpoint...
002180000000     D                 PI
002181000000     D  i_url                     32767A   const varying  options(*varsize)
002182000000      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
002183000000      /free
002184000000
002185000000         g_url = %subst(i_url: 1: %len(i_url));
002186000000
002187000000      /end-free
002188000000      *
002189000000     P setEndpoint...
002190000000     P                 E
002191000000      *
