000100930215     H              J
000200930215      *----------------------------------------------------*
000300930215      * Routine editazione campo numerico
000400930215      *----------------------------------------------------*
000500930215      * Riceve come parametro la DS esterna XANA06         *
000600930215      *                                                    *
000700930215      * Chiusura pgm con RT                                *
000800930215      *----------------------------------------------------*
000900930218      *  DS esterne :  XANA06
001000930218      *
001100930218      *  In entrata :  XA6IMP    Importo
001200930218      *                XA6LEN    Lunghezza
001300930218      *                XA6DEC    Nr.decimali
001400930218      *                XA6ERR    Flag errore (non gestito)
001500930218      *
001600930218      *  In uscita  :  XA6IMP    Importo editato
001700930218      *                XA6LEN    Lunghezza importo editato
001800930218      *
001900930218      *  N.B.  se XA6DEC=99
002000930218      *
002100930218      *        XA6IMP in input  é una data in formato aammgg
002200930218      *        XA6IMP in output è una data in formato gg/mm/aa
002300930218      *
002400930215      *----------------------------------------------------*
002500930215      * Indicatori:
002600930218      *
002700930215      *----------------------------------------------------*
002800930215      *
002900930215     E                    IMP        50  1               IMP. INPUT
003000930215     E                    KAM        50  1               SK.COMODO
003100930215      *
003200930215     IXANA06    E DS
003300930215      *---------------------------------------------------------------*
003400930215      *
003500930215     C           *ENTRY    PLIST
003600930215     C                     PARM           XANA06
003700930215      *
003800930215     C           XA6DEC    IFEQ 99
003900930215     C                     EXSR DATA
004000930215     C                     ELSE
004100930215     C                     EXSR EDIT
004200930215     C                     END
004300930215      *
004400930215     C                     SETON                     RT
004500930215      *
004600930215      *---------------------------------------------------------------*
004700930215      *
004800930215      *---------------------------------------------------------------*
004900930215     C           EDIT      BEGSR
005000930215      *
005100930215     C                     MOVE *BLANKS   IMP
005200930215     C                     MOVE *BLANKS   KAM
005300930215      *
005400930215     C                     Z-ADDXA6LEN    L       50
005500930215     C                     Z-ADD50        N       50
005600930218      *
005700930218     C                     MOVE *ZEROS    KOM198198
005800930218     C           L         SUBSTXA6IMP    KOM198
005900930218      *
006000930218      * -----
006100930218      *
006200930218     C           KOM198    IFNE *ZEROS
006300930218      *
006400930218     C                     MOVEAXA6IMP    IMP
006500930215      *
006600930215      * Tolgo gli zeri non significativi
006700930215      *
006800930215     C                     DO   50        X       50
006900930215     C           IMP,X     IFEQ '0'
007000930215     C                     MOVE ' '       IMP,X
007100930215     C                     ELSE
007200930215     C                     GOTO FUORI
007300930215     C                     END
007400930215     C                     END
007500930215      *
007600930215     C           FUORI     TAG
007700930215      *
007800930215      * -----
007900930215      *
008000930215     C           XA6DEC    IFNE *ZEROS
008100930215      *
008200930215     C                     DO   XA6DEC
008300930215     C           IMP,L     IFNE '0'
008400930215     C                     MOVE IMP,L     KAM,N
008500930215     C                     ELSE
008600930215     C                     MOVE '0'       KAM,N
008700930215     C                     END
008800930215     C                     SUB  1         L
008900930215     C                     SUB  1         N
009000930215     C                     END
009100930215      *
009200930215     C                     MOVE ','       KAM,N
009300930215     C                     SUB  1         N
009400930215     C           IMP,L     IFEQ ' '
009500930215     C                     MOVE '0'       IMP,L
009600930215     C                     END
009700930215      *
009800930215     C                     END
009900930215      *
010000930215      * -----
010100930215      *
010200930215     C           L         DOWGT*ZEROS
010300930215      *
010400930215     C                     DO   3
010500930215     C           L         IFGT *ZEROS
010600930215     C           IMP,L     IFNE ' '
010700930215     C                     MOVE IMP,L     KAM,N
010800930215     C                     SUB  1         L
010900930215     C                     SUB  1         N
011000930215     C                     ELSE
011100930215     C                     GOTO SOTTO
011200930215     C                     END
011300930215     C                     END
011400930215     C                     END
011500930215      *
011600930215     C           L         SUB  1         L2      50
011700930215     C           L2        IFGT *ZEROS
011800930215     C           IMP,L2    IFNE ' '
011900930215     C                     MOVE '.'       KAM,N
012000930215     C                     SUB  1         N
012100930215     C                     END
012200930215     C                     END
012300930215      *
012400930215     C                     END
012500930215      *
012600930215     C           SOTTO     TAG
012700930218      *
012800930218     C                     END                             KOM198<>0
012900930218      *
013000930218      * -----
013100930215      *
013200930215      * Calcolo lungh. campo editato
013300930215      *
013400930215     C           XA6LEN    SUB  XA6DEC    K1      50
013500930215     C                     DIV  3         K1
013600930215     C                     ADD  XA6LEN    K1
013700930215     C           XA6DEC    IFGT *ZEROS
013800930215     C                     ADD  1         K1
013900930215     C                     END
014000930215     C                     Z-ADDK1        XA6LEN
014100930215      *
014200930215     C                     MOVE *BLANKS   XA6IMP
014300930215      *
014400930215     C           50        SUB  K1        K2      50
014500930215     C                     ADD  1         K2
014600930215     C                     MOVEAKAM,K2    XA6IMP
014700930215      *
014800930215     C                     ENDSR
014900930215      *
015000930215      *---------------------------------------------------------------*
015100930215      *
015200930215      *---------------------------------------------------------------*
015300930215     C           DATA      BEGSR
015400930215      *
015500930215     C                     MOVE *BLANKS   IMP
015600930215     C                     MOVE *BLANKS   KAM
015700930215      *
015800930218     C                     MOVELXA6IMP    KOM6    60
015900930218      *
016000930218     C           KOM6      IFNE *ZEROS
016100930218     C                     MOVEAXA6IMP    IMP
016200930218     C                     MOVE IMP,6     KAM,2
016300930218     C           IMP,5     IFNE *ZEROS
016400930218     C                     MOVE IMP,5     KAM,1
016500930218     C                     END
016600930215     C                     MOVE '/'       KAM,6
016700930215     C                     MOVE IMP,4     KAM,5
016800930215     C                     MOVE IMP,3     KAM,4
016900930215     C                     MOVE '/'       KAM,3
017000930218     C                     MOVE IMP,2     KAM,8
017100930218     C                     MOVE IMP,1     KAM,7
017200930218     C                     END
017300930215      *
017400930215     C                     Z-ADD8         XA6LEN
017500930215      *
017600930215     C                     MOVEAKAM,1     XA6IMP
017700930215      *
017800930215     C                     ENDSR
017900930215      *
