000100170210--  Generazione SQL
000200170210--  Versione:                  V7R2M0 140418
000300170210--  Generata su:               10/02/17 14:43:10
000400170210--  Database relazionale:      AS888
000500170210--  Opzioni standard:          DB2 for i
000600170210
000700170210CREATE VIEW PJBARSOC/ISDEI9999V (
000800170210  TIPO ,
000900170210  SOCIETA ,
001000170210  PARTITA_IVA FOR COLUMN PARTITAIVA ,
001100170210  VALORE_EUR ,
001200170210  DATA_RIFERIMENTO FOR COLUMN DTRIF      ,
001300170210  DATA_DOCUMENTO FOR COLUMN DTDOC      ,
001400170210  NUMERO_DOCUMENTO FOR COLUMN NRDOC      ,
001500170210  RAGIONE_SOCIALE FOR COLUMN RAGSOC     ,
001600170210  SERIE_IVA ,
001700170210  NUMERO_IVA ,
001800170210  DATA_IVA )
001900170210  AS
002000170210  SELECT DISTINCT 'BENE' AS TIPO, ISDET00F.DETSOC AS SOCIETA, ISDET00F.DETSTA CONCAT ISDET00F.DETCIV
002100170210 AS PARTITA_IVA, DEC(CASE ISDET00F.DETSEG WHEN '-' THEN ISDET00F.DETVML * -1 ELSE ISDET00F.DETVML EN
002200170210D, 15, 2) AS VALORE_EUR, ISDET00F.DETDRF AS DATA_RIFERIMENTO, ISDET00F.DETDFT AS DATA_DOCUMENTO, ISD
002300170210ET00F.DETNFT AS NUMERO_DOCUMENTO, ANSOG00F.SOGDES AS RAGIONE_SOCIALE, '' AS SERIE_IVA, 0 AS NUMERO_I
002400170210VA, '0001-01-01' AS DATA_IVA
002500170210  	FROM PJBARSOC/ISDET00F ISDET00F
002600170210  	JOIN PJBARGRU/ANSOG98V ANSOG00F ON ISDET00F.DETSTA CONCAT ISDET00F.DETCIV = ANSOG00F.SOGPARTIVA
002700170210  	 --JOIN PJBARGRU.ANFRN00F ANFRN00F ON ISDET00F.DETSOC = ANFRN00F.FRNSOCIETA AND ANSOG00F.SOGSOGG
002800170210  --= ANFRN00F.FRNSOGG AND '' = ANFRN00F.FRNTPIND AND '' = ANFRN00F.FRNCDIND
002900170210  	WHERE ISDET00F.DETTRG = 'I'
003000170210  	UNION
003100170210  	SELECT DISTINCT 'SERVIZIO' AS TIPO, ISDES00F.DESSOC AS SOCIETA, ISDES00F.DESSTA CONCAT ISDES00F.D
003200170210ESCIV AS PARTITA_IVA, DEC(CASE ISDES00F.DESSEG WHEN '-' THEN ISDES00F.DESIFT * -1 ELSE ISDES00F.DESI
003300170210FT END, 15, 2) AS VALORE_EUR, ISDES00F.DESDRF AS DATA_RIFERIMENTO, ISDES00F.DESDTDOC AS DATA_DOCUMEN
003400170210TO, ISDES00F.DESNRDOC AS NUMERO_DOCUMENTO, ANSOG00F.SOGDES AS RAGIONE_SOCIALE, ISDES00F.DESSRPROT AS
003500170210 SERIE_IVA, ISDES00F.DESNRPROT AS NUMERO_IVA, ISDES00F.DESDTPROT AS DATA_IVA
003600170210  	FROM PJBARSOC/ISDES00F ISDES00F
003700170210  	JOIN PJBARGRU/ANSOG98V ANSOG00F ON ISDES00F.DESSTA CONCAT ISDES00F.DESCIV = ANSOG00F.SOGPARTIVA
003800170210  	 --JOIN PJBARGRU.ANFRN00F ANFRN00F ON ISDES00F.DESSOC = ANFRN00F.FRNSOCIETA AND ANSOG00F.SOGSOGG
003900170210  --= ANFRN00F.FRNSOGG AND '' = ANFRN00F.FRNTPIND AND '' = ANFRN00F.FRNCDIND
004000170210  	WHERE ISDES00F.DESTRG = 'I'
004100170210  RCDFMT ISDEI9999V ;
004200170210
004300170210LABEL ON TABLE PJBARSOC/ISDEI9999V
004400170210  IS 'Dettaglio intrastat importazioni.' ;
004500170210
004600170210LABEL ON COLUMN PJBARSOC/ISDEI9999V
004700170210( SOCIETA IS 'Soc' ,
004800170210  DATA_RIFERIMENTO IS 'DATA                RIF.' ,
004900170210  DATA_DOCUMENTO IS 'DATA                FATT/NOTA' ,
005000170210  NUMERO_DOCUMENTO IS 'N°FATT/             NOTA' ) ;
005100170210
005200170210LABEL ON COLUMN PJBARSOC/ISDEI9999V
005300170210( SOCIETA TEXT IS 'Società ....................' ,
005400170210  DATA_RIFERIMENTO TEXT IS 'DATA DI RIFERIMENTO' ,
005500170210  DATA_DOCUMENTO TEXT IS 'DATA FATTURA/NOTA ACCRED.' ,
005600170210  NUMERO_DOCUMENTO TEXT IS 'N° FATTURA/NOTA ACCRED.' ) ;
005700170210
005800170210GRANT SELECT
005900170210ON PJBARSOC/ISDEI9999V TO PUBLIC ;
006000170210
006100170210GRANT ALTER , REFERENCES , SELECT
006200170210ON PJBARSOC/ISDEI9999V TO QPGMR WITH GRANT OPTION ;
006300170210
