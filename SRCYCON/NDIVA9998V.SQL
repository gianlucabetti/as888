000100170207--  Generazione SQL
000200170207--  Versione:                  V7R2M0 140418
000300170207--  Generata su:               07/02/17 14:20:29
000400170207--  Database relazionale:      AS888
000500170207--  Opzioni standard:          DB2 for i
000600170207
000700170207CREATE VIEW PJBARSOC/NDIVA9998V (
000800170207  SOCIETA ,
000900170207  ANNO ,
001000170207  REGISTRO ,
001100170207  LIVELLO1 ,
001200170207  ARTICOLO ,
001300170207  LIVELLO2 ,
001400170207  IMPONIBILE ,
001500170207  "DATA" ,
001600170207  NUMERO ,
001700170207  LIBRO ,
001800170207  CAPOCONTO_SOGGETTO FOR COLUMN CAPOC00001 ,
001900170207  SOTTOCONTO_SOGGETTO FOR COLUMN SOTTO00001 ,
002000170207  DESCRIZIONE_SOGGETTO FOR COLUMN DESCR00001 ,
002100170207  PIVA_SOGGETTO FOR COLUMN PIVA_00001 ,
002200170207  CF_SOGGETTO FOR COLUMN CF_SO00001 )
002300170207  AS
002400170207  WITH IVA (SOCIETA, ANNO, REGISTRO, LIVELLO1, ARTICOLO, LIVELLO2, IMPONIBILE, DATA, NUMERO, LIBRO,
002500170207CAPOCONTO_SOGGETTO, SOTTOCONTO_SOGGETTO, DESCRIZIONE_SOGGETTO, PIVA_SOGGETTO, CF_SOGGETTO) AS (
002600170207  				SELECT IVASOCIETA AS SOCIETA, YEAR(IVADTRIF) AS ANNO_LIQUIDAZIONE, IVATPREG AS REGISTRO, 0 AS
002700170207LIVELLO_1, IVARIFIVA AS ARTICOLO, 0 AS LIVELLO_2, DEC(IVAIMPONIB * (IVADARE - IVAAVERE), 15, 2) AS I
002800170207MPONIBILE, CHAR(IVADTREG) AS DATA_PROTOCOLLO, CHAR(IVANRREG) AS NUMERO_PROTOCOLLO, IVALIBRO AS LIBRO
002900170207, IVAKCCCP AS CAPOCONTO_SOGGETTO, IVAKSCCP AS SOTTOCONTO_SOGGETTO, ANRCO99V.DESCRIZ, ANSOG00F.SOGPAR
003000170207TIVA, ANSOG00F.SOGCDFISC
003100170207  				FROM PJBARSOC/NDIVA00F NDIVA00F
003200170207  				JOIN PJBARGRU/ANRCO99V ANRCO99V ON NDIVA00F.IVASOCIETA = ANRCO99V.RCOSOCIETA AND NDIVA00F.IVAK
003300170207CCCP = ANRCO99V.RCOKCC AND NDIVA00F.IVAKSCCP = ANRCO99V.RCOKSC
003400170207  				JOIN PJBARGRU/ANSOG00F ANSOG00F ON ANRCO99V.RCOSOGG = ANSOG00F.SOGSOGG
003500170207  				WHERE IVAALIQ = 0 AND IVADTRIF > '2014-12-31' AND IVARIFIVA NOT IN ('150','151','231')
003600170207  				UNION
003700170207  				SELECT IVASOCIETA, YEAR(IVADTRIF), IVATPREG, 0, IVARIFIVA, 9, DEC(SUM(IVAIMPONIB * (IVADARE -
003800170207IVAAVERE)), 15, 2), 'TOTALE', 'ARTICOLO', '', '', '', '', '', ''
003900170207  				FROM PJBARSOC/NDIVA00F
004000170207  				WHERE IVAALIQ = 0 AND IVADTRIF > '2014-12-31' AND IVARIFIVA NOT IN ('150','151','231')
004100170207  				GROUP BY IVASOCIETA, YEAR(IVADTRIF), IVATPREG, IVARIFIVA
004200170207  				UNION
004300170207  				SELECT IVASOCIETA, YEAR(IVADTRIF), IVATPREG, 9, '', 9, DEC(SUM(IVAIMPONIB * (IVADARE - IVAAVER
004400170207E)), 15, 2), 'TOTALE', 'REGISTRO', '', '', '', '', '', ''
004500170207  				FROM PJBARSOC/NDIVA00F
004600170207  				WHERE IVAALIQ = 0 AND IVADTRIF > '2014-12-31' AND IVARIFIVA NOT IN ('150','151','231')
004700170207  				GROUP BY IVASOCIETA, YEAR(IVADTRIF), IVATPREG
004800170207  				)
004900170207  				SELECT *
005000170207  				FROM IVA
005100170207  RCDFMT NDIVA9998V ;
005200170207
005300170207LABEL ON TABLE PJBARSOC/NDIVA9998V
005400170207  IS 'Movimenti IVA esenti (dettaglio + totale).' ;
005500170207
005600170207LABEL ON COLUMN PJBARSOC/NDIVA9998V
005700170207( SOCIETA TEXT IS 'Società ....................' ,
005800170207  REGISTRO TEXT IS 'Tipo registro I.V.A. .......' ,
005900170207  ARTICOLO TEXT IS 'Riferimento IVA ............' ,
006000170207  LIBRO TEXT IS 'Libro IVA ..................' ,
006100170207  CAPOCONTO_SOGGETTO TEXT IS 'Capoconto contropartita ....' ,
006200170207  SOTTOCONTO_SOGGETTO TEXT IS 'Sottoconto contropartita ...' ,
006300170207  PIVA_SOGGETTO TEXT IS 'Partita IVA ................' ,
006400170207  CF_SOGGETTO TEXT IS 'Codice Fiscale .............' ) ;
006500170207
006600170207GRANT SELECT
006700170207ON PJBARSOC/NDIVA9998V TO PUBLIC ;
006800170207
006900170207GRANT ALTER , REFERENCES , SELECT
007000170207ON PJBARSOC/NDIVA9998V TO QPGMR WITH GRANT OPTION ;
007100170207
