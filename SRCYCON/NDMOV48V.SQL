000100131128--  Generazione SQL
000200131128--  Versione:                  V7R1M0 100423
000300131128--  Generata su:               28/11/13 17:03:32
000400131128--  Database relazionale:      SETRAS
000500131128--  Opzioni standard:          DB2 for i
000600131128
000700131128CREATE VIEW PJBARSOC/NDMOV_201_000204_00000048 (
000800131128  IMPORTO ,
000900131128  CONTEGGIO_DARE FOR COLUMN COUNTDARE  ,
001000131128  CONTEGGIO_AVERE FOR COLUMN COUNTAVERE ,
001100131128  SALDO ,
001200131128  DATA_REGISTRAZIONE_DARE FOR COLUMN DTREGDARE  ,
001300131128  DATA_REGISTRAZIONE_AVERE FOR COLUMN DTREGAVERE )
001400131128  AS
001500131128  SELECT DEC(NDMOV00F.MOVIMPORTO, 15, 2) AS IMPORTO
001600131128  , SUM(MOVDARE) AS CONTEGGIO_DARE
001700131128  , SUM(MOVAVERE) AS CONTEGGIO_AVERE
001800131128  , DEC(SUM(NDMOV00F.MOVIMPORTO * (NDMOV00F.MOVDARE - NDMOV00F.MOVAVERE)), 15, 2) AS SALDO
001900131128  , MAX(CASE MOVDARE WHEN 1 THEN NDMOV00F.MOVDTREG ELSE NULL END) AS DATA_REGISTRAZIONE_DARE
002000131128  , MAX(CASE MOVDARE WHEN 0 THEN NDMOV00F.MOVDTREG ELSE NULL END) AS DATA_REGISTRAZIONE_AVERE
002100131128   	FROM PJBARSOC/NDMOV00F NDMOV00F
002200131128  	WHERE NDMOV00F.MOVSOCIETA = '201' AND NDMOV00F.MOVCTB = 'CG' AND NDMOV00F.MOVKCC = '000204' AND
002300131128  NDMOV00F.MOVKSC = '00000048' AND NDMOV00F.MOVDTREG > (SELECT ANDAT00F.DATDATA FROM PJBARGRU/ANDAT0
0024001311280F ANDAT00F
002500131128  WHERE ANDAT00F.DATSOCIETA = '201' AND ANDAT00F.DATTIPO = 'PULESE')
002600131128  AND NDMOV00F.MOVCAUSTES NOT IN ('BILA','BILC')
002700131128   	GROUP BY NDMOV00F.MOVIMPORTO
002800131128   	HAVING SUM(NDMOV00F.MOVIMPORTO * (NDMOV00F.MOVDARE - MOVAVERE)) <> 0
002900131128  RCDFMT NDMOV00001 ;
003000131128
003100131128LABEL ON TABLE PJBARSOC/NDMOV_201_000204_00000048
003200131128  IS 'Saldi intermedi conto 201 000204 00000048.' ;
003300131128
003400131128GRANT SELECT
003500131128ON PJBARSOC/NDMOV_201_000204_00000048 TO PUBLIC ;
003600131128
003700131128GRANT ALTER , REFERENCES , SELECT
003800131128ON PJBARSOC/NDMOV_201_000204_00000048 TO QPGMR WITH GRANT OPTION ;
003900131128
