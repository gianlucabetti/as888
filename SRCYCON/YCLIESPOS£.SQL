000100141112--  Generazione SQL
000200141112--  Versione:                  V7R1M0 100423
000300141112--  Generata su:               13/11/14 14:11:22
000400141112--  Database relazionale:      AS888
000500141112--  Opzioni standard:          DB2 for i
000600141112
000700141112CREATE VIEW PJBARGRU/YCLIESPOS (
000800141112  ID_CLIENTE ,
000900141112  RAGIONE_SOCIALE_CLIENTE FOR COLUMN RAGIO00001 ,
001000141112  CODICE_IVA_CLIENTE FOR COLUMN CODIC00001 ,
001100141112  CODICE_FISCALE_CLIENTE FOR COLUMN CODIC00002 )
001200141112  AS
001300141112  WITH SCP (SOCIETA, KSC) AS (
001400141112  	SELECT NDSCP00F.SCPSOCIETA, NDSCP00F.SCPKSC
001500141112  	FROM PJBARSOC/NDSCP00F NDSCP00F
001600141112  	WHERE NDSCP00F.SCPSOCIETA = '201' AND NDSCP00F.SCPCTB = 'CG' AND NDSCP00F.SCPTPSCAD = '0' AND NDS
001700141112CP00F.SCPSNATURA = 'C' AND NDSCP00F.SCPDETT = 'P' AND SUBSTR(NDSCP00F.SCPKSC, 5, 4) NOT IN ('8888',
001800141112'9999')
001900141112  	GROUP BY NDSCP00F.SCPSOCIETA, NDSCP00F.SCPCTB, NDSCP00F.SCPTPSCAD, NDSCP00F.SCPDETT, NDSCP00F.SCP
002000141112KCC, NDSCP00F.SCPKSC
002100141112  	)
002200141112  	SELECT SCP.KSC AS ID_CLIENTE, ANSOG00F.SOGDES AS RAGIONE_SOCIALE_CLIENTE, ANSOG00F.SOGPARTIVA AS
002300141112CODICE_IVA_CLIENTE, ANSOG00F.SOGCDFISC AS CODICE_FISCALE_CLIENTE
002400141112  	FROM SCP SCP
002500141112  	JOIN PJBARGRU/ANRCO00F ANRCO00F ON SCP.SOCIETA = ANRCO00F.RCOSOCIETA AND 'C' = ANRCO00F.RCOSNATUR
002600141112A AND SCP.KSC = ANRCO00F.RCOKSC
002700141112  	JOIN PJBARGRU/ANSOG00F ANSOG00F ON ANRCO00F.RCOSOGG = ANSOG00F.SOGSOGG
002800141112  	WHERE ANRCO00F.RCOCTGAN03 < ' 41'
002900141112  RCDFMT YCLIESPOS  ;
003000141112
003100141112LABEL ON TABLE PJBARGRU/YCLIESPOS
003200141112  IS 'Clienti BRT con esposizione e non in contenzioso.' ;
003300141112
003400141112LABEL ON COLUMN PJBARGRU/YCLIESPOS
003500141112( RAGIONE_SOCIALE_CLIENTE IS 'Ragione             sociale' ,
003600141112  CODICE_IVA_CLIENTE IS 'Partita IVA' ,
003700141112  CODICE_FISCALE_CLIENTE IS 'Cd fiscale' ) ;
003800141112
003900141112LABEL ON COLUMN PJBARGRU/YCLIESPOS
004000141112( ID_CLIENTE TEXT IS 'Sottoconto .................' ,
004100141112  RAGIONE_SOCIALE_CLIENTE TEXT IS 'Ragione sociale ............' ,
004200141112  CODICE_IVA_CLIENTE TEXT IS 'Partita IVA ................' ,
004300141112  CODICE_FISCALE_CLIENTE TEXT IS 'Codice Fiscale .............' ) ;
004400141112
004500141112GRANT SELECT
004600141112ON PJBARGRU/YCLIESPOS TO PUBLIC ;
004700141112
004800141112GRANT ALTER , REFERENCES , SELECT
004900141112ON PJBARGRU/YCLIESPOS TO QPGMR WITH GRANT OPTION ;
005000141112
